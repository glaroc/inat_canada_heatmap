(function(){const L=document.createElement("link").relList;if(L&&L.supports&&L.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))V(W);new MutationObserver(W=>{for(const ne of W)if(ne.type==="childList")for(const M of ne.addedNodes)M.tagName==="LINK"&&M.rel==="modulepreload"&&V(M)}).observe(document,{childList:!0,subtree:!0});function z(W){const ne={};return W.integrity&&(ne.integrity=W.integrity),W.referrerPolicy&&(ne.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?ne.credentials="include":W.crossOrigin==="anonymous"?ne.credentials="omit":ne.credentials="same-origin",ne}function V(W){if(W.ep)return;W.ep=!0;const ne=z(W);fetch(W.href,ne)}})();function Ad(E){return E&&E.__esModule&&Object.prototype.hasOwnProperty.call(E,"default")?E.default:E}function gy(E){if(Object.prototype.hasOwnProperty.call(E,"__esModule"))return E;var L=E.default;if(typeof L=="function"){var z=function V(){return this instanceof V?Reflect.construct(L,arguments,this.constructor):L.apply(this,arguments)};z.prototype=L.prototype}else z={};return Object.defineProperty(z,"__esModule",{value:!0}),Object.keys(E).forEach(function(V){var W=Object.getOwnPropertyDescriptor(E,V);Object.defineProperty(z,V,W.get?W:{enumerable:!0,get:function(){return E[V]}})}),z}var Jp={exports:{}},Cd={},ef={exports:{}},Tr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm;function _y(){if(Dm)return Tr;Dm=1;var E=Symbol.for("react.element"),L=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),M=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),Me=Symbol.for("react.suspense"),Ze=Symbol.for("react.memo"),qe=Symbol.for("react.lazy"),Ve=Symbol.iterator;function ze(me){return me===null||typeof me!="object"?null:(me=Ve&&me[Ve]||me["@@iterator"],typeof me=="function"?me:null)}var ce={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ge=Object.assign,nt={};function gt(me,Ae,kt){this.props=me,this.context=Ae,this.refs=nt,this.updater=kt||ce}gt.prototype.isReactComponent={},gt.prototype.setState=function(me,Ae){if(typeof me!="object"&&typeof me!="function"&&me!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,me,Ae,"setState")},gt.prototype.forceUpdate=function(me){this.updater.enqueueForceUpdate(this,me,"forceUpdate")};function qt(){}qt.prototype=gt.prototype;function Ft(me,Ae,kt){this.props=me,this.context=Ae,this.refs=nt,this.updater=kt||ce}var Jt=Ft.prototype=new qt;Jt.constructor=Ft,Ge(Jt,gt.prototype),Jt.isPureReactComponent=!0;var Mt=Array.isArray,cr=Object.prototype.hasOwnProperty,Je={current:null},pt={key:!0,ref:!0,__self:!0,__source:!0};function Lt(me,Ae,kt){var ut,Xe={},st=null,xt=null;if(Ae!=null)for(ut in Ae.ref!==void 0&&(xt=Ae.ref),Ae.key!==void 0&&(st=""+Ae.key),Ae)cr.call(Ae,ut)&&!pt.hasOwnProperty(ut)&&(Xe[ut]=Ae[ut]);var mt=arguments.length-2;if(mt===1)Xe.children=kt;else if(1<mt){for(var St=Array(mt),lr=0;lr<mt;lr++)St[lr]=arguments[lr+2];Xe.children=St}if(me&&me.defaultProps)for(ut in mt=me.defaultProps,mt)Xe[ut]===void 0&&(Xe[ut]=mt[ut]);return{$$typeof:E,type:me,key:st,ref:xt,props:Xe,_owner:Je.current}}function Ct(me,Ae){return{$$typeof:E,type:me.type,key:Ae,ref:me.ref,props:me.props,_owner:me._owner}}function rr(me){return typeof me=="object"&&me!==null&&me.$$typeof===E}function sr(me){var Ae={"=":"=0",":":"=2"};return"$"+me.replace(/[=:]/g,function(kt){return Ae[kt]})}var Er=/\/+/g;function _r(me,Ae){return typeof me=="object"&&me!==null&&me.key!=null?sr(""+me.key):Ae.toString(36)}function Tt(me,Ae,kt,ut,Xe){var st=typeof me;(st==="undefined"||st==="boolean")&&(me=null);var xt=!1;if(me===null)xt=!0;else switch(st){case"string":case"number":xt=!0;break;case"object":switch(me.$$typeof){case E:case L:xt=!0}}if(xt)return xt=me,Xe=Xe(xt),me=ut===""?"."+_r(xt,0):ut,Mt(Xe)?(kt="",me!=null&&(kt=me.replace(Er,"$&/")+"/"),Tt(Xe,Ae,kt,"",function(lr){return lr})):Xe!=null&&(rr(Xe)&&(Xe=Ct(Xe,kt+(!Xe.key||xt&&xt.key===Xe.key?"":(""+Xe.key).replace(Er,"$&/")+"/")+me)),Ae.push(Xe)),1;if(xt=0,ut=ut===""?".":ut+":",Mt(me))for(var mt=0;mt<me.length;mt++){st=me[mt];var St=ut+_r(st,mt);xt+=Tt(st,Ae,kt,St,Xe)}else if(St=ze(me),typeof St=="function")for(me=St.call(me),mt=0;!(st=me.next()).done;)st=st.value,St=ut+_r(st,mt++),xt+=Tt(st,Ae,kt,St,Xe);else if(st==="object")throw Ae=String(me),Error("Objects are not valid as a React child (found: "+(Ae==="[object Object]"?"object with keys {"+Object.keys(me).join(", ")+"}":Ae)+"). If you meant to render a collection of children, use an array instead.");return xt}function Nt(me,Ae,kt){if(me==null)return me;var ut=[],Xe=0;return Tt(me,ut,"","",function(st){return Ae.call(kt,st,Xe++)}),ut}function bt(me){if(me._status===-1){var Ae=me._result;Ae=Ae(),Ae.then(function(kt){(me._status===0||me._status===-1)&&(me._status=1,me._result=kt)},function(kt){(me._status===0||me._status===-1)&&(me._status=2,me._result=kt)}),me._status===-1&&(me._status=0,me._result=Ae)}if(me._status===1)return me._result.default;throw me._result}var _t={current:null},Re={transition:null},et={ReactCurrentDispatcher:_t,ReactCurrentBatchConfig:Re,ReactCurrentOwner:Je};function rt(){throw Error("act(...) is not supported in production builds of React.")}return Tr.Children={map:Nt,forEach:function(me,Ae,kt){Nt(me,function(){Ae.apply(this,arguments)},kt)},count:function(me){var Ae=0;return Nt(me,function(){Ae++}),Ae},toArray:function(me){return Nt(me,function(Ae){return Ae})||[]},only:function(me){if(!rr(me))throw Error("React.Children.only expected to receive a single React element child.");return me}},Tr.Component=gt,Tr.Fragment=z,Tr.Profiler=W,Tr.PureComponent=Ft,Tr.StrictMode=V,Tr.Suspense=Me,Tr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=et,Tr.act=rt,Tr.cloneElement=function(me,Ae,kt){if(me==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+me+".");var ut=Ge({},me.props),Xe=me.key,st=me.ref,xt=me._owner;if(Ae!=null){if(Ae.ref!==void 0&&(st=Ae.ref,xt=Je.current),Ae.key!==void 0&&(Xe=""+Ae.key),me.type&&me.type.defaultProps)var mt=me.type.defaultProps;for(St in Ae)cr.call(Ae,St)&&!pt.hasOwnProperty(St)&&(ut[St]=Ae[St]===void 0&&mt!==void 0?mt[St]:Ae[St])}var St=arguments.length-2;if(St===1)ut.children=kt;else if(1<St){mt=Array(St);for(var lr=0;lr<St;lr++)mt[lr]=arguments[lr+2];ut.children=mt}return{$$typeof:E,type:me.type,key:Xe,ref:st,props:ut,_owner:xt}},Tr.createContext=function(me){return me={$$typeof:M,_currentValue:me,_currentValue2:me,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},me.Provider={$$typeof:ne,_context:me},me.Consumer=me},Tr.createElement=Lt,Tr.createFactory=function(me){var Ae=Lt.bind(null,me);return Ae.type=me,Ae},Tr.createRef=function(){return{current:null}},Tr.forwardRef=function(me){return{$$typeof:h,render:me}},Tr.isValidElement=rr,Tr.lazy=function(me){return{$$typeof:qe,_payload:{_status:-1,_result:me},_init:bt}},Tr.memo=function(me,Ae){return{$$typeof:Ze,type:me,compare:Ae===void 0?null:Ae}},Tr.startTransition=function(me){var Ae=Re.transition;Re.transition={};try{me()}finally{Re.transition=Ae}},Tr.unstable_act=rt,Tr.useCallback=function(me,Ae){return _t.current.useCallback(me,Ae)},Tr.useContext=function(me){return _t.current.useContext(me)},Tr.useDebugValue=function(){},Tr.useDeferredValue=function(me){return _t.current.useDeferredValue(me)},Tr.useEffect=function(me,Ae){return _t.current.useEffect(me,Ae)},Tr.useId=function(){return _t.current.useId()},Tr.useImperativeHandle=function(me,Ae,kt){return _t.current.useImperativeHandle(me,Ae,kt)},Tr.useInsertionEffect=function(me,Ae){return _t.current.useInsertionEffect(me,Ae)},Tr.useLayoutEffect=function(me,Ae){return _t.current.useLayoutEffect(me,Ae)},Tr.useMemo=function(me,Ae){return _t.current.useMemo(me,Ae)},Tr.useReducer=function(me,Ae,kt){return _t.current.useReducer(me,Ae,kt)},Tr.useRef=function(me){return _t.current.useRef(me)},Tr.useState=function(me){return _t.current.useState(me)},Tr.useSyncExternalStore=function(me,Ae,kt){return _t.current.useSyncExternalStore(me,Ae,kt)},Tr.useTransition=function(){return _t.current.useTransition()},Tr.version="18.3.1",Tr}var Lm;function kp(){return Lm||(Lm=1,ef.exports=_y()),ef.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Om;function yy(){if(Om)return Cd;Om=1;var E=kp(),L=Symbol.for("react.element"),z=Symbol.for("react.fragment"),V=Object.prototype.hasOwnProperty,W=E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ne={key:!0,ref:!0,__self:!0,__source:!0};function M(h,Me,Ze){var qe,Ve={},ze=null,ce=null;Ze!==void 0&&(ze=""+Ze),Me.key!==void 0&&(ze=""+Me.key),Me.ref!==void 0&&(ce=Me.ref);for(qe in Me)V.call(Me,qe)&&!ne.hasOwnProperty(qe)&&(Ve[qe]=Me[qe]);if(h&&h.defaultProps)for(qe in Me=h.defaultProps,Me)Ve[qe]===void 0&&(Ve[qe]=Me[qe]);return{$$typeof:L,type:h,key:ze,ref:ce,props:Ve,_owner:W.current}}return Cd.Fragment=z,Cd.jsx=M,Cd.jsxs=M,Cd}var Fm;function vy(){return Fm||(Fm=1,Jp.exports=yy()),Jp.exports}var ei=vy(),fp={},tf={exports:{}},Oo={},rf={exports:{}},nf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bm;function xy(){return Bm||(Bm=1,function(E){function L(Re,et){var rt=Re.length;Re.push(et);e:for(;0<rt;){var me=rt-1>>>1,Ae=Re[me];if(0<W(Ae,et))Re[me]=et,Re[rt]=Ae,rt=me;else break e}}function z(Re){return Re.length===0?null:Re[0]}function V(Re){if(Re.length===0)return null;var et=Re[0],rt=Re.pop();if(rt!==et){Re[0]=rt;e:for(var me=0,Ae=Re.length,kt=Ae>>>1;me<kt;){var ut=2*(me+1)-1,Xe=Re[ut],st=ut+1,xt=Re[st];if(0>W(Xe,rt))st<Ae&&0>W(xt,Xe)?(Re[me]=xt,Re[st]=rt,me=st):(Re[me]=Xe,Re[ut]=rt,me=ut);else if(st<Ae&&0>W(xt,rt))Re[me]=xt,Re[st]=rt,me=st;else break e}}return et}function W(Re,et){var rt=Re.sortIndex-et.sortIndex;return rt!==0?rt:Re.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var ne=performance;E.unstable_now=function(){return ne.now()}}else{var M=Date,h=M.now();E.unstable_now=function(){return M.now()-h}}var Me=[],Ze=[],qe=1,Ve=null,ze=3,ce=!1,Ge=!1,nt=!1,gt=typeof setTimeout=="function"?setTimeout:null,qt=typeof clearTimeout=="function"?clearTimeout:null,Ft=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Jt(Re){for(var et=z(Ze);et!==null;){if(et.callback===null)V(Ze);else if(et.startTime<=Re)V(Ze),et.sortIndex=et.expirationTime,L(Me,et);else break;et=z(Ze)}}function Mt(Re){if(nt=!1,Jt(Re),!Ge)if(z(Me)!==null)Ge=!0,bt(cr);else{var et=z(Ze);et!==null&&_t(Mt,et.startTime-Re)}}function cr(Re,et){Ge=!1,nt&&(nt=!1,qt(Lt),Lt=-1),ce=!0;var rt=ze;try{for(Jt(et),Ve=z(Me);Ve!==null&&(!(Ve.expirationTime>et)||Re&&!sr());){var me=Ve.callback;if(typeof me=="function"){Ve.callback=null,ze=Ve.priorityLevel;var Ae=me(Ve.expirationTime<=et);et=E.unstable_now(),typeof Ae=="function"?Ve.callback=Ae:Ve===z(Me)&&V(Me),Jt(et)}else V(Me);Ve=z(Me)}if(Ve!==null)var kt=!0;else{var ut=z(Ze);ut!==null&&_t(Mt,ut.startTime-et),kt=!1}return kt}finally{Ve=null,ze=rt,ce=!1}}var Je=!1,pt=null,Lt=-1,Ct=5,rr=-1;function sr(){return!(E.unstable_now()-rr<Ct)}function Er(){if(pt!==null){var Re=E.unstable_now();rr=Re;var et=!0;try{et=pt(!0,Re)}finally{et?_r():(Je=!1,pt=null)}}else Je=!1}var _r;if(typeof Ft=="function")_r=function(){Ft(Er)};else if(typeof MessageChannel<"u"){var Tt=new MessageChannel,Nt=Tt.port2;Tt.port1.onmessage=Er,_r=function(){Nt.postMessage(null)}}else _r=function(){gt(Er,0)};function bt(Re){pt=Re,Je||(Je=!0,_r())}function _t(Re,et){Lt=gt(function(){Re(E.unstable_now())},et)}E.unstable_IdlePriority=5,E.unstable_ImmediatePriority=1,E.unstable_LowPriority=4,E.unstable_NormalPriority=3,E.unstable_Profiling=null,E.unstable_UserBlockingPriority=2,E.unstable_cancelCallback=function(Re){Re.callback=null},E.unstable_continueExecution=function(){Ge||ce||(Ge=!0,bt(cr))},E.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ct=0<Re?Math.floor(1e3/Re):5},E.unstable_getCurrentPriorityLevel=function(){return ze},E.unstable_getFirstCallbackNode=function(){return z(Me)},E.unstable_next=function(Re){switch(ze){case 1:case 2:case 3:var et=3;break;default:et=ze}var rt=ze;ze=et;try{return Re()}finally{ze=rt}},E.unstable_pauseExecution=function(){},E.unstable_requestPaint=function(){},E.unstable_runWithPriority=function(Re,et){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var rt=ze;ze=Re;try{return et()}finally{ze=rt}},E.unstable_scheduleCallback=function(Re,et,rt){var me=E.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?me+rt:me):rt=me,Re){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=rt+Ae,Re={id:qe++,callback:et,priorityLevel:Re,startTime:rt,expirationTime:Ae,sortIndex:-1},rt>me?(Re.sortIndex=rt,L(Ze,Re),z(Me)===null&&Re===z(Ze)&&(nt?(qt(Lt),Lt=-1):nt=!0,_t(Mt,rt-me))):(Re.sortIndex=Ae,L(Me,Re),Ge||ce||(Ge=!0,bt(cr))),Re},E.unstable_shouldYield=sr,E.unstable_wrapCallback=function(Re){var et=ze;return function(){var rt=ze;ze=et;try{return Re.apply(this,arguments)}finally{ze=rt}}}}(nf)),nf}var jm;function by(){return jm||(jm=1,rf.exports=xy()),rf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function wy(){if(Nm)return Oo;Nm=1;var E=kp(),L=by();function z(o){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+o,m=1;m<arguments.length;m++)s+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+o+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var V=new Set,W={};function ne(o,s){M(o,s),M(o+"Capture",s)}function M(o,s){for(W[o]=s,o=0;o<s.length;o++)V.add(s[o])}var h=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Me=Object.prototype.hasOwnProperty,Ze=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qe={},Ve={};function ze(o){return Me.call(Ve,o)?!0:Me.call(qe,o)?!1:Ze.test(o)?Ve[o]=!0:(qe[o]=!0,!1)}function ce(o,s,m,v){if(m!==null&&m.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function Ge(o,s,m,v){if(s===null||typeof s>"u"||ce(o,s,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function nt(o,s,m,v,S,I,G){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=v,this.attributeNamespace=S,this.mustUseProperty=m,this.propertyName=o,this.type=s,this.sanitizeURL=I,this.removeEmptyString=G}var gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){gt[o]=new nt(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var s=o[0];gt[s]=new nt(s,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){gt[o]=new nt(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){gt[o]=new nt(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){gt[o]=new nt(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){gt[o]=new nt(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){gt[o]=new nt(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){gt[o]=new nt(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){gt[o]=new nt(o,5,!1,o.toLowerCase(),null,!1,!1)});var qt=/[\-:]([a-z])/g;function Ft(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var s=o.replace(qt,Ft);gt[s]=new nt(s,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var s=o.replace(qt,Ft);gt[s]=new nt(s,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var s=o.replace(qt,Ft);gt[s]=new nt(s,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){gt[o]=new nt(o,1,!1,o.toLowerCase(),null,!1,!1)}),gt.xlinkHref=new nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){gt[o]=new nt(o,1,!1,o.toLowerCase(),null,!0,!0)});function Jt(o,s,m,v){var S=gt.hasOwnProperty(s)?gt[s]:null;(S!==null?S.type!==0:v||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(Ge(s,m,S,v)&&(m=null),v||S===null?ze(s)&&(m===null?o.removeAttribute(s):o.setAttribute(s,""+m)):S.mustUseProperty?o[S.propertyName]=m===null?S.type===3?!1:"":m:(s=S.attributeName,v=S.attributeNamespace,m===null?o.removeAttribute(s):(S=S.type,m=S===3||S===4&&m===!0?"":""+m,v?o.setAttributeNS(v,s,m):o.setAttribute(s,m))))}var Mt=E.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cr=Symbol.for("react.element"),Je=Symbol.for("react.portal"),pt=Symbol.for("react.fragment"),Lt=Symbol.for("react.strict_mode"),Ct=Symbol.for("react.profiler"),rr=Symbol.for("react.provider"),sr=Symbol.for("react.context"),Er=Symbol.for("react.forward_ref"),_r=Symbol.for("react.suspense"),Tt=Symbol.for("react.suspense_list"),Nt=Symbol.for("react.memo"),bt=Symbol.for("react.lazy"),_t=Symbol.for("react.offscreen"),Re=Symbol.iterator;function et(o){return o===null||typeof o!="object"?null:(o=Re&&o[Re]||o["@@iterator"],typeof o=="function"?o:null)}var rt=Object.assign,me;function Ae(o){if(me===void 0)try{throw Error()}catch(m){var s=m.stack.trim().match(/\n( *(at )?)/);me=s&&s[1]||""}return`
`+me+o}var kt=!1;function ut(o,s){if(!o||kt)return"";kt=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(Le){var v=Le}Reflect.construct(o,[],s)}else{try{s.call()}catch(Le){v=Le}o.call(s.prototype)}else{try{throw Error()}catch(Le){v=Le}o()}}catch(Le){if(Le&&v&&typeof Le.stack=="string"){for(var S=Le.stack.split(`
`),I=v.stack.split(`
`),G=S.length-1,oe=I.length-1;1<=G&&0<=oe&&S[G]!==I[oe];)oe--;for(;1<=G&&0<=oe;G--,oe--)if(S[G]!==I[oe]){if(G!==1||oe!==1)do if(G--,oe--,0>oe||S[G]!==I[oe]){var ge=`
`+S[G].replace(" at new "," at ");return o.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",o.displayName)),ge}while(1<=G&&0<=oe);break}}}finally{kt=!1,Error.prepareStackTrace=m}return(o=o?o.displayName||o.name:"")?Ae(o):""}function Xe(o){switch(o.tag){case 5:return Ae(o.type);case 16:return Ae("Lazy");case 13:return Ae("Suspense");case 19:return Ae("SuspenseList");case 0:case 2:case 15:return o=ut(o.type,!1),o;case 11:return o=ut(o.type.render,!1),o;case 1:return o=ut(o.type,!0),o;default:return""}}function st(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case pt:return"Fragment";case Je:return"Portal";case Ct:return"Profiler";case Lt:return"StrictMode";case _r:return"Suspense";case Tt:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case sr:return(o.displayName||"Context")+".Consumer";case rr:return(o._context.displayName||"Context")+".Provider";case Er:var s=o.render;return o=o.displayName,o||(o=s.displayName||s.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case Nt:return s=o.displayName||null,s!==null?s:st(o.type)||"Memo";case bt:s=o._payload,o=o._init;try{return st(o(s))}catch{}}return null}function xt(o){var s=o.type;switch(o.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=s.render,o=o.displayName||o.name||"",s.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return st(s);case 8:return s===Lt?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function mt(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function St(o){var s=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function lr(o){var s=St(o)?"checked":"value",m=Object.getOwnPropertyDescriptor(o.constructor.prototype,s),v=""+o[s];if(!o.hasOwnProperty(s)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var S=m.get,I=m.set;return Object.defineProperty(o,s,{configurable:!0,get:function(){return S.call(this)},set:function(G){v=""+G,I.call(this,G)}}),Object.defineProperty(o,s,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(G){v=""+G},stopTracking:function(){o._valueTracker=null,delete o[s]}}}}function or(o){o._valueTracker||(o._valueTracker=lr(o))}function Mr(o){if(!o)return!1;var s=o._valueTracker;if(!s)return!0;var m=s.getValue(),v="";return o&&(v=St(o)?o.checked?"true":"false":o.value),o=v,o!==m?(s.setValue(o),!0):!1}function kr(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function Ar(o,s){var m=s.checked;return rt({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??o._wrapperState.initialChecked})}function di(o,s){var m=s.defaultValue==null?"":s.defaultValue,v=s.checked!=null?s.checked:s.defaultChecked;m=mt(s.value!=null?s.value:m),o._wrapperState={initialChecked:v,initialValue:m,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function $i(o,s){s=s.checked,s!=null&&Jt(o,"checked",s,!1)}function Tn(o,s){$i(o,s);var m=mt(s.value),v=s.type;if(m!=null)v==="number"?(m===0&&o.value===""||o.value!=m)&&(o.value=""+m):o.value!==""+m&&(o.value=""+m);else if(v==="submit"||v==="reset"){o.removeAttribute("value");return}s.hasOwnProperty("value")?ri(o,s.type,m):s.hasOwnProperty("defaultValue")&&ri(o,s.type,mt(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(o.defaultChecked=!!s.defaultChecked)}function tn(o,s,m){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var v=s.type;if(!(v!=="submit"&&v!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+o._wrapperState.initialValue,m||s===o.value||(o.value=s),o.defaultValue=s}m=o.name,m!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,m!==""&&(o.name=m)}function ri(o,s,m){(s!=="number"||kr(o.ownerDocument)!==o)&&(m==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+m&&(o.defaultValue=""+m))}var zn=Array.isArray;function rn(o,s,m,v){if(o=o.options,s){s={};for(var S=0;S<m.length;S++)s["$"+m[S]]=!0;for(m=0;m<o.length;m++)S=s.hasOwnProperty("$"+o[m].value),o[m].selected!==S&&(o[m].selected=S),S&&v&&(o[m].defaultSelected=!0)}else{for(m=""+mt(m),s=null,S=0;S<o.length;S++){if(o[S].value===m){o[S].selected=!0,v&&(o[S].defaultSelected=!0);return}s!==null||o[S].disabled||(s=o[S])}s!==null&&(s.selected=!0)}}function Nn(o,s){if(s.dangerouslySetInnerHTML!=null)throw Error(z(91));return rt({},s,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function Ui(o,s){var m=s.value;if(m==null){if(m=s.children,s=s.defaultValue,m!=null){if(s!=null)throw Error(z(92));if(zn(m)){if(1<m.length)throw Error(z(93));m=m[0]}s=m}s==null&&(s=""),m=s}o._wrapperState={initialValue:mt(m)}}function ao(o,s){var m=mt(s.value),v=mt(s.defaultValue);m!=null&&(m=""+m,m!==o.value&&(o.value=m),s.defaultValue==null&&o.defaultValue!==m&&(o.defaultValue=m)),v!=null&&(o.defaultValue=""+v)}function wo(o){var s=o.textContent;s===o._wrapperState.initialValue&&s!==""&&s!==null&&(o.value=s)}function Zi(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pi(o,s){return o==null||o==="http://www.w3.org/1999/xhtml"?Zi(s):o==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var ni,fi=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,m,v,S){MSApp.execUnsafeLocalFunction(function(){return o(s,m,v,S)})}:o}(function(o,s){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=s;else{for(ni=ni||document.createElement("div"),ni.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=ni.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;s.firstChild;)o.appendChild(s.firstChild)}});function mi(o,s){if(s){var m=o.firstChild;if(m&&m===o.lastChild&&m.nodeType===3){m.nodeValue=s;return}}o.textContent=s}var Gi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},so=["Webkit","ms","Moz","O"];Object.keys(Gi).forEach(function(o){so.forEach(function(s){s=s+o.charAt(0).toUpperCase()+o.substring(1),Gi[s]=Gi[o]})});function na(o,s,m){return s==null||typeof s=="boolean"||s===""?"":m||typeof s!="number"||s===0||Gi.hasOwnProperty(o)&&Gi[o]?(""+s).trim():s+"px"}function Ai(o,s){o=o.style;for(var m in s)if(s.hasOwnProperty(m)){var v=m.indexOf("--")===0,S=na(m,s[m],v);m==="float"&&(m="cssFloat"),v?o.setProperty(m,S):o[m]=S}}var xe=rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function R(o,s){if(s){if(xe[o]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(z(137,o));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(z(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(z(61))}if(s.style!=null&&typeof s.style!="object")throw Error(z(62))}}function q(o,s){if(o.indexOf("-")===-1)return typeof s.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X=null;function ee(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var he=null,ye=null,Pe=null;function _e(o){if(o=Vr(o)){if(typeof he!="function")throw Error(z(280));var s=o.stateNode;s&&(s=Ms(s),he(o.stateNode,o.type,s))}}function Ne(o){ye?Pe?Pe.push(o):Pe=[o]:ye=o}function De(){if(ye){var o=ye,s=Pe;if(Pe=ye=null,_e(o),s)for(o=0;o<s.length;o++)_e(s[o])}}function Te(o,s){return o(s)}function We(){}var Se=!1;function dt(o,s,m){if(Se)return o(s,m);Se=!0;try{return Te(o,s,m)}finally{Se=!1,(ye!==null||Pe!==null)&&(We(),De())}}function Et(o,s){var m=o.stateNode;if(m===null)return null;var v=Ms(m);if(v===null)return null;m=v[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(m&&typeof m!="function")throw Error(z(231,s,typeof m));return m}var Kt=!1;if(h)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){Kt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch{Kt=!1}function $e(o,s,m,v,S,I,G,oe,ge){var Le=Array.prototype.slice.call(arguments,3);try{s.apply(m,Le)}catch(ot){this.onError(ot)}}var vt=!1,yt=null,er=!1,Wt=null,ir={onError:function(o){vt=!0,yt=o}};function Bt(o,s,m,v,S,I,G,oe,ge){vt=!1,yt=null,$e.apply(ir,arguments)}function Da(o,s,m,v,S,I,G,oe,ge){if(Bt.apply(this,arguments),vt){if(vt){var Le=yt;vt=!1,yt=null}else throw Error(z(198));er||(er=!0,Wt=Le)}}function Zr(o){var s=o,m=o;if(o.alternate)for(;s.return;)s=s.return;else{o=s;do s=o,(s.flags&4098)!==0&&(m=s.return),o=s.return;while(o)}return s.tag===3?m:null}function on(o){if(o.tag===13){var s=o.memoizedState;if(s===null&&(o=o.alternate,o!==null&&(s=o.memoizedState)),s!==null)return s.dehydrated}return null}function jr(o){if(Zr(o)!==o)throw Error(z(188))}function Ol(o){var s=o.alternate;if(!s){if(s=Zr(o),s===null)throw Error(z(188));return s!==o?null:o}for(var m=o,v=s;;){var S=m.return;if(S===null)break;var I=S.alternate;if(I===null){if(v=S.return,v!==null){m=v;continue}break}if(S.child===I.child){for(I=S.child;I;){if(I===m)return jr(S),o;if(I===v)return jr(S),s;I=I.sibling}throw Error(z(188))}if(m.return!==v.return)m=S,v=I;else{for(var G=!1,oe=S.child;oe;){if(oe===m){G=!0,m=S,v=I;break}if(oe===v){G=!0,v=S,m=I;break}oe=oe.sibling}if(!G){for(oe=I.child;oe;){if(oe===m){G=!0,m=I,v=S;break}if(oe===v){G=!0,v=I,m=S;break}oe=oe.sibling}if(!G)throw Error(z(189))}}if(m.alternate!==v)throw Error(z(190))}if(m.tag!==3)throw Error(z(188));return m.stateNode.current===m?o:s}function ii(o){return o=Ol(o),o!==null?Dr(o):null}function Dr(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var s=Dr(o);if(s!==null)return s;o=o.sibling}return null}var Fu=L.unstable_scheduleCallback,cs=L.unstable_cancelCallback,Bu=L.unstable_shouldYield,ia=L.unstable_requestPaint,Gr=L.unstable_now,ju=L.unstable_getCurrentPriorityLevel,Fl=L.unstable_ImmediatePriority,Nu=L.unstable_UserBlockingPriority,Bo=L.unstable_NormalPriority,Vc=L.unstable_LowPriority,$c=L.unstable_IdlePriority,Bl=null,To=null;function Vu(o){if(To&&typeof To.onCommitFiberRoot=="function")try{To.onCommitFiberRoot(Bl,o,void 0,(o.current.flags&128)===128)}catch{}}var Vn=Math.clz32?Math.clz32:hs,$u=Math.log,Uu=Math.LN2;function hs(o){return o>>>=0,o===0?32:31-($u(o)/Uu|0)|0}var ds=64,ps=4194304;function oa(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function fs(o,s){var m=o.pendingLanes;if(m===0)return 0;var v=0,S=o.suspendedLanes,I=o.pingedLanes,G=m&268435455;if(G!==0){var oe=G&~S;oe!==0?v=oa(oe):(I&=G,I!==0&&(v=oa(I)))}else G=m&~S,G!==0?v=oa(G):I!==0&&(v=oa(I));if(v===0)return 0;if(s!==0&&s!==v&&(s&S)===0&&(S=v&-v,I=s&-s,S>=I||S===16&&(I&4194240)!==0))return s;if((v&4)!==0&&(v|=m&16),s=o.entangledLanes,s!==0)for(o=o.entanglements,s&=v;0<s;)m=31-Vn(s),S=1<<m,v|=o[m],s&=~S;return v}function La(o,s){switch(o){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lo(o,s){for(var m=o.suspendedLanes,v=o.pingedLanes,S=o.expirationTimes,I=o.pendingLanes;0<I;){var G=31-Vn(I),oe=1<<G,ge=S[G];ge===-1?((oe&m)===0||(oe&v)!==0)&&(S[G]=La(oe,s)):ge<=s&&(o.expiredLanes|=oe),I&=~oe}}function fr(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function gi(){var o=ds;return ds<<=1,(ds&4194240)===0&&(ds=64),o}function _i(o){for(var s=[],m=0;31>m;m++)s.push(o);return s}function ur(o,s,m){o.pendingLanes|=s,s!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,s=31-Vn(s),o[s]=m}function jl(o,s){var m=o.pendingLanes&~s;o.pendingLanes=s,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=s,o.mutableReadLanes&=s,o.entangledLanes&=s,s=o.entanglements;var v=o.eventTimes;for(o=o.expirationTimes;0<m;){var S=31-Vn(m),I=1<<S;s[S]=0,v[S]=-1,o[S]=-1,m&=~I}}function qs(o,s){var m=o.entangledLanes|=s;for(o=o.entanglements;m;){var v=31-Vn(m),S=1<<v;S&s|o[v]&s&&(o[v]|=s),m&=~S}}var ar=0;function Sn(o){return o&=-o,1<o?4<o?(o&268435455)!==0?16:536870912:4:1}var cn,Wr,Nl,hn,$n,Un=!1,Oa=[],Pn=null,Nr=null,oi=null,Zn=new Map,jo=new Map,dn=[],Zu="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qi(o,s){switch(o){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":Nr=null;break;case"mouseover":case"mouseout":oi=null;break;case"pointerover":case"pointerout":Zn.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":jo.delete(s.pointerId)}}function Lr(o,s,m,v,S,I){return o===null||o.nativeEvent!==I?(o={blockedOn:s,domEventName:m,eventSystemFlags:v,nativeEvent:I,targetContainers:[S]},s!==null&&(s=Vr(s),s!==null&&Wr(s)),o):(o.eventSystemFlags|=v,s=o.targetContainers,S!==null&&s.indexOf(S)===-1&&s.push(S),o)}function Vl(o,s,m,v,S){switch(s){case"focusin":return Pn=Lr(Pn,o,s,m,v,S),!0;case"dragenter":return Nr=Lr(Nr,o,s,m,v,S),!0;case"mouseover":return oi=Lr(oi,o,s,m,v,S),!0;case"pointerover":var I=S.pointerId;return Zn.set(I,Lr(Zn.get(I)||null,o,s,m,v,S)),!0;case"gotpointercapture":return I=S.pointerId,jo.set(I,Lr(jo.get(I)||null,o,s,m,v,S)),!0}return!1}function hr(o){var s=Ki(o.target);if(s!==null){var m=Zr(s);if(m!==null){if(s=m.tag,s===13){if(s=on(m),s!==null){o.blockedOn=s,$n(o.priority,function(){Nl(m)});return}}else if(s===3&&m.stateNode.current.memoizedState.isDehydrated){o.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Qt(o){if(o.blockedOn!==null)return!1;for(var s=o.targetContainers;0<s.length;){var m=gs(o.domEventName,o.eventSystemFlags,s[0],o.nativeEvent);if(m===null){m=o.nativeEvent;var v=new m.constructor(m.type,m);X=v,m.target.dispatchEvent(v),X=null}else return s=Vr(m),s!==null&&Wr(s),o.blockedOn=m,!1;s.shift()}return!0}function Fa(o,s,m){Qt(o)&&m.delete(s)}function yr(){Un=!1,Pn!==null&&Qt(Pn)&&(Pn=null),Nr!==null&&Qt(Nr)&&(Nr=null),oi!==null&&Qt(oi)&&(oi=null),Zn.forEach(Fa),jo.forEach(Fa)}function No(o,s){o.blockedOn===s&&(o.blockedOn=null,Un||(Un=!0,L.unstable_scheduleCallback(L.unstable_NormalPriority,yr)))}function Gn(o){function s(S){return No(S,o)}if(0<Oa.length){No(Oa[0],o);for(var m=1;m<Oa.length;m++){var v=Oa[m];v.blockedOn===o&&(v.blockedOn=null)}}for(Pn!==null&&No(Pn,o),Nr!==null&&No(Nr,o),oi!==null&&No(oi,o),Zn.forEach(s),jo.forEach(s),m=0;m<dn.length;m++)v=dn[m],v.blockedOn===o&&(v.blockedOn=null);for(;0<dn.length&&(m=dn[0],m.blockedOn===null);)hr(m),m.blockedOn===null&&dn.shift()}var So=Mt.ReactCurrentBatchConfig,Ba=!0;function Ws(o,s,m,v){var S=ar,I=So.transition;So.transition=null;try{ar=1,aa(o,s,m,v)}finally{ar=S,So.transition=I}}function ms(o,s,m,v){var S=ar,I=So.transition;So.transition=null;try{ar=4,aa(o,s,m,v)}finally{ar=S,So.transition=I}}function aa(o,s,m,v){if(Ba){var S=gs(o,s,m,v);if(S===null)al(o,s,v,$l,m),qi(o,v);else if(Vl(S,o,s,m,v))v.stopPropagation();else if(qi(o,v),s&4&&-1<Zu.indexOf(o)){for(;S!==null;){var I=Vr(S);if(I!==null&&cn(I),I=gs(o,s,m,v),I===null&&al(o,s,v,$l,m),I===S)break;S=I}S!==null&&v.stopPropagation()}else al(o,s,v,null,m)}}var $l=null;function gs(o,s,m,v){if($l=null,o=ee(v),o=Ki(o),o!==null)if(s=Zr(o),s===null)o=null;else if(m=s.tag,m===13){if(o=on(s),o!==null)return o;o=null}else if(m===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;o=null}else s!==o&&(o=null);return $l=o,null}function Ul(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ju()){case Fl:return 1;case Nu:return 4;case Bo:case Vc:return 16;case $c:return 536870912;default:return 16}default:return 16}}var Wi=null,Cn=null,pn=null;function Hs(){if(pn)return pn;var o,s=Cn,m=s.length,v,S="value"in Wi?Wi.value:Wi.textContent,I=S.length;for(o=0;o<m&&s[o]===S[o];o++);var G=m-o;for(v=1;v<=G&&s[m-v]===S[I-v];v++);return pn=S.slice(o,1<v?1-v:void 0)}function qn(o){var s=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&s===13&&(o=13)):o=s,o===10&&(o=13),32<=o||o===13?o:0}function Xr(){return!0}function Zl(){return!1}function Wn(o){function s(m,v,S,I,G){this._reactName=m,this._targetInst=S,this.type=v,this.nativeEvent=I,this.target=G,this.currentTarget=null;for(var oe in o)o.hasOwnProperty(oe)&&(m=o[oe],this[oe]=m?m(I):I[oe]);return this.isDefaultPrevented=(I.defaultPrevented!=null?I.defaultPrevented:I.returnValue===!1)?Xr:Zl,this.isPropagationStopped=Zl,this}return rt(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Xr)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Xr)},persist:function(){},isPersistent:Xr}),s}var Hi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gu=Wn(Hi),sa=rt({},Hi,{view:0,detail:0}),qu=Wn(sa),Wu,_s,la,Rn=rt({},sa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ku,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==la&&(la&&o.type==="mousemove"?(Wu=o.screenX-la.screenX,_s=o.screenY-la.screenY):_s=Wu=0,la=o),Wu)},movementY:function(o){return"movementY"in o?o.movementY:_s}}),Xs=Wn(Rn),ja=rt({},Rn,{dataTransfer:0}),Hu=Wn(ja),Ks=rt({},sa,{relatedTarget:0}),Xi=Wn(Ks),Uh=rt({},Hi,{animationName:0,elapsedTime:0,pseudoElement:0}),Xu=Wn(Uh),Ys=rt({},Hi,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),ua=Wn(Ys),Zh=rt({},Hi,{data:0}),ys=Wn(Zh),Uc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Gc(o){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(o):(o=Zc[o])?!!s[o]:!1}function Ku(){return Gc}var qc=rt({},sa,{key:function(o){if(o.key){var s=Uc[o.key]||o.key;if(s!=="Unidentified")return s}return o.type==="keypress"?(o=qn(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?vs[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ku,charCode:function(o){return o.type==="keypress"?qn(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?qn(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Yu=Wn(qc),Wc=rt({},Rn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gl=Wn(Wc),Qu=rt({},sa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ku}),Ju=Wn(Qu),Na=rt({},Hi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hc=Wn(Na),Xc=rt({},Rn,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Va=Wn(Xc),Gh=[9,13,27,32],xs=h&&"CompositionEvent"in window,Qs=null;h&&"documentMode"in document&&(Qs=document.documentMode);var Kc=h&&"TextEvent"in window&&!Qs,ql=h&&(!xs||Qs&&8<Qs&&11>=Qs),ec=" ",tc=!1;function Js(o,s){switch(o){case"keyup":return Gh.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wl(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Vo=!1;function $o(o,s){switch(o){case"compositionend":return Wl(s);case"keypress":return s.which!==32?null:(tc=!0,ec);case"textInput":return o=s.data,o===ec&&tc?null:o;default:return null}}function rc(o,s){if(Vo)return o==="compositionend"||!xs&&Js(o,s)?(o=Hs(),pn=Cn=Wi=null,Vo=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ql&&s.locale!=="ko"?null:s.data;default:return null}}var Hl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xl(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s==="input"?!!Hl[o.type]:s==="textarea"}function nc(o,s,m,v){Ne(v),s=ma(s,"onChange"),0<s.length&&(m=new Gu("onChange","change",null,m,v),o.push({event:m,listeners:s}))}var $a=null,uo=null;function br(o){ol(o,0)}function Kl(o){var s=fn(o);if(Mr(s))return o}function qh(o,s){if(o==="change")return s}var Yc=!1;if(h){var ic;if(h){var Yl="oninput"in document;if(!Yl){var Qc=document.createElement("div");Qc.setAttribute("oninput","return;"),Yl=typeof Qc.oninput=="function"}ic=Yl}else ic=!1;Yc=ic&&(!document.documentMode||9<document.documentMode)}function oc(){$a&&($a.detachEvent("onpropertychange",el),uo=$a=null)}function el(o){if(o.propertyName==="value"&&Kl(uo)){var s=[];nc(s,uo,o,ee(o)),dt(br,s)}}function Ql(o,s,m){o==="focusin"?(oc(),$a=s,uo=m,$a.attachEvent("onpropertychange",el)):o==="focusout"&&oc()}function Jl(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Kl(uo)}function ac(o,s){if(o==="click")return Kl(s)}function Ua(o,s){if(o==="input"||o==="change")return Kl(s)}function bs(o,s){return o===s&&(o!==0||1/o===1/s)||o!==o&&s!==s}var Qr=typeof Object.is=="function"?Object.is:bs;function ws(o,s){if(Qr(o,s))return!0;if(typeof o!="object"||o===null||typeof s!="object"||s===null)return!1;var m=Object.keys(o),v=Object.keys(s);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var S=m[v];if(!Me.call(s,S)||!Qr(o[S],s[S]))return!1}return!0}function sc(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function eu(o,s){var m=sc(o);o=0;for(var v;m;){if(m.nodeType===3){if(v=o+m.textContent.length,o<=s&&v>=s)return{node:m,offset:s-o};o=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=sc(m)}}function ca(o,s){return o&&s?o===s?!0:o&&o.nodeType===3?!1:s&&s.nodeType===3?ca(o,s.parentNode):"contains"in o?o.contains(s):o.compareDocumentPosition?!!(o.compareDocumentPosition(s)&16):!1:!1}function tl(){for(var o=window,s=kr();s instanceof o.HTMLIFrameElement;){try{var m=typeof s.contentWindow.location.href=="string"}catch{m=!1}if(m)o=s.contentWindow;else break;s=kr(o.document)}return s}function Ts(o){var s=o&&o.nodeName&&o.nodeName.toLowerCase();return s&&(s==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||s==="textarea"||o.contentEditable==="true")}function rl(o){var s=tl(),m=o.focusedElem,v=o.selectionRange;if(s!==m&&m&&m.ownerDocument&&ca(m.ownerDocument.documentElement,m)){if(v!==null&&Ts(m)){if(s=v.start,o=v.end,o===void 0&&(o=s),"selectionStart"in m)m.selectionStart=s,m.selectionEnd=Math.min(o,m.value.length);else if(o=(s=m.ownerDocument||document)&&s.defaultView||window,o.getSelection){o=o.getSelection();var S=m.textContent.length,I=Math.min(v.start,S);v=v.end===void 0?I:Math.min(v.end,S),!o.extend&&I>v&&(S=v,v=I,I=S),S=eu(m,I);var G=eu(m,v);S&&G&&(o.rangeCount!==1||o.anchorNode!==S.node||o.anchorOffset!==S.offset||o.focusNode!==G.node||o.focusOffset!==G.offset)&&(s=s.createRange(),s.setStart(S.node,S.offset),o.removeAllRanges(),I>v?(o.addRange(s),o.extend(G.node,G.offset)):(s.setEnd(G.node,G.offset),o.addRange(s)))}}for(s=[],o=m;o=o.parentNode;)o.nodeType===1&&s.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<s.length;m++)o=s[m],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var tu=h&&"documentMode"in document&&11>=document.documentMode,Za=null,ha=null,Po=null,ru=!1;function nu(o,s,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;ru||Za==null||Za!==kr(v)||(v=Za,"selectionStart"in v&&Ts(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Po&&ws(Po,v)||(Po=v,v=ma(ha,"onSelect"),0<v.length&&(s=new Gu("onSelect","select",null,s,m),o.push({event:s,listeners:v}),s.target=Za)))}function dr(o,s){var m={};return m[o.toLowerCase()]=s.toLowerCase(),m["Webkit"+o]="webkit"+s,m["Moz"+o]="moz"+s,m}var Uo={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionend:dr("Transition","TransitionEnd")},lc={},uc={};h&&(uc=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function Co(o){if(lc[o])return lc[o];if(!Uo[o])return o;var s=Uo[o],m;for(m in s)if(s.hasOwnProperty(m)&&m in uc)return lc[o]=s[m];return o}var Jc=Co("animationend"),eh=Co("animationiteration"),cc=Co("animationstart"),hc=Co("transitionend"),iu=new Map,nl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yi(o,s){iu.set(o,s),ne(s,[o])}for(var Ss=0;Ss<nl.length;Ss++){var il=nl[Ss],th=il.toLowerCase(),ou=il[0].toUpperCase()+il.slice(1);yi(th,"on"+ou)}yi(Jc,"onAnimationEnd"),yi(eh,"onAnimationIteration"),yi(cc,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(hc,"onTransitionEnd"),M("onMouseEnter",["mouseout","mouseover"]),M("onMouseLeave",["mouseout","mouseover"]),M("onPointerEnter",["pointerout","pointerover"]),M("onPointerLeave",["pointerout","pointerover"]),ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var da="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dc=new Set("cancel close invalid load scroll toggle".split(" ").concat(da));function pc(o,s,m){var v=o.type||"unknown-event";o.currentTarget=m,Da(v,s,void 0,o),o.currentTarget=null}function ol(o,s){s=(s&4)!==0;for(var m=0;m<o.length;m++){var v=o[m],S=v.event;v=v.listeners;e:{var I=void 0;if(s)for(var G=v.length-1;0<=G;G--){var oe=v[G],ge=oe.instance,Le=oe.currentTarget;if(oe=oe.listener,ge!==I&&S.isPropagationStopped())break e;pc(S,oe,Le),I=ge}else for(G=0;G<v.length;G++){if(oe=v[G],ge=oe.instance,Le=oe.currentTarget,oe=oe.listener,ge!==I&&S.isPropagationStopped())break e;pc(S,oe,Le),I=ge}}}if(er)throw o=Wt,er=!1,Wt=null,o}function Hr(o,s){var m=s[cu];m===void 0&&(m=s[cu]=new Set);var v=o+"__bubble";m.has(v)||(su(s,o,2,!1),m.add(v))}function au(o,s,m){var v=0;s&&(v|=4),su(m,o,v,s)}var pa="_reactListening"+Math.random().toString(36).slice(2);function fa(o){if(!o[pa]){o[pa]=!0,V.forEach(function(m){m!=="selectionchange"&&(dc.has(m)||au(m,!1,o),au(m,!0,o))});var s=o.nodeType===9?o:o.ownerDocument;s===null||s[pa]||(s[pa]=!0,au("selectionchange",!1,s))}}function su(o,s,m,v){switch(Ul(s)){case 1:var S=Ws;break;case 4:S=ms;break;default:S=aa}m=S.bind(null,s,m,o),S=void 0,!Kt||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(S=!0),v?S!==void 0?o.addEventListener(s,m,{capture:!0,passive:S}):o.addEventListener(s,m,!0):S!==void 0?o.addEventListener(s,m,{passive:S}):o.addEventListener(s,m,!1)}function al(o,s,m,v,S){var I=v;if((s&1)===0&&(s&2)===0&&v!==null)e:for(;;){if(v===null)return;var G=v.tag;if(G===3||G===4){var oe=v.stateNode.containerInfo;if(oe===S||oe.nodeType===8&&oe.parentNode===S)break;if(G===4)for(G=v.return;G!==null;){var ge=G.tag;if((ge===3||ge===4)&&(ge=G.stateNode.containerInfo,ge===S||ge.nodeType===8&&ge.parentNode===S))return;G=G.return}for(;oe!==null;){if(G=Ki(oe),G===null)return;if(ge=G.tag,ge===5||ge===6){v=I=G;continue e}oe=oe.parentNode}}v=v.return}dt(function(){var Le=I,ot=ee(m),ct=[];e:{var it=iu.get(o);if(it!==void 0){var It=Gu,Ot=o;switch(o){case"keypress":if(qn(m)===0)break e;case"keydown":case"keyup":It=Yu;break;case"focusin":Ot="focus",It=Xi;break;case"focusout":Ot="blur",It=Xi;break;case"beforeblur":case"afterblur":It=Xi;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":It=Xs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":It=Hu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":It=Ju;break;case Jc:case eh:case cc:It=Xu;break;case hc:It=Hc;break;case"scroll":It=qu;break;case"wheel":It=Va;break;case"copy":case"cut":case"paste":It=ua;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":It=Gl}var jt=(s&4)!==0,wn=!jt&&o==="scroll",Ee=jt?it!==null?it+"Capture":null:it;jt=[];for(var ve=Le,Ie;ve!==null;){Ie=ve;var ht=Ie.stateNode;if(Ie.tag===5&&ht!==null&&(Ie=ht,Ee!==null&&(ht=Et(ve,Ee),ht!=null&&jt.push(Eo(ve,ht,Ie)))),wn)break;ve=ve.return}0<jt.length&&(it=new It(it,Ot,null,m,ot),ct.push({event:it,listeners:jt}))}}if((s&7)===0){e:{if(it=o==="mouseover"||o==="pointerover",It=o==="mouseout"||o==="pointerout",it&&m!==X&&(Ot=m.relatedTarget||m.fromElement)&&(Ki(Ot)||Ot[Io]))break e;if((It||it)&&(it=ot.window===ot?ot:(it=ot.ownerDocument)?it.defaultView||it.parentWindow:window,It?(Ot=m.relatedTarget||m.toElement,It=Le,Ot=Ot?Ki(Ot):null,Ot!==null&&(wn=Zr(Ot),Ot!==wn||Ot.tag!==5&&Ot.tag!==6)&&(Ot=null)):(It=null,Ot=Le),It!==Ot)){if(jt=Xs,ht="onMouseLeave",Ee="onMouseEnter",ve="mouse",(o==="pointerout"||o==="pointerover")&&(jt=Gl,ht="onPointerLeave",Ee="onPointerEnter",ve="pointer"),wn=It==null?it:fn(It),Ie=Ot==null?it:fn(Ot),it=new jt(ht,ve+"leave",It,m,ot),it.target=wn,it.relatedTarget=Ie,ht=null,Ki(ot)===Le&&(jt=new jt(Ee,ve+"enter",Ot,m,ot),jt.target=Ie,jt.relatedTarget=wn,ht=jt),wn=ht,It&&Ot)t:{for(jt=It,Ee=Ot,ve=0,Ie=jt;Ie;Ie=ga(Ie))ve++;for(Ie=0,ht=Ee;ht;ht=ga(ht))Ie++;for(;0<ve-Ie;)jt=ga(jt),ve--;for(;0<Ie-ve;)Ee=ga(Ee),Ie--;for(;ve--;){if(jt===Ee||Ee!==null&&jt===Ee.alternate)break t;jt=ga(jt),Ee=ga(Ee)}jt=null}else jt=null;It!==null&&Ps(ct,it,It,jt,!1),Ot!==null&&wn!==null&&Ps(ct,wn,Ot,jt,!0)}}e:{if(it=Le?fn(Le):window,It=it.nodeName&&it.nodeName.toLowerCase(),It==="select"||It==="input"&&it.type==="file")var Ut=qh;else if(Xl(it))if(Yc)Ut=Ua;else{Ut=Jl;var Ht=Ql}else(It=it.nodeName)&&It.toLowerCase()==="input"&&(it.type==="checkbox"||it.type==="radio")&&(Ut=ac);if(Ut&&(Ut=Ut(o,Le))){nc(ct,Ut,m,ot);break e}Ht&&Ht(o,it,Le),o==="focusout"&&(Ht=it._wrapperState)&&Ht.controlled&&it.type==="number"&&ri(it,"number",it.value)}switch(Ht=Le?fn(Le):window,o){case"focusin":(Xl(Ht)||Ht.contentEditable==="true")&&(Za=Ht,ha=Le,Po=null);break;case"focusout":Po=ha=Za=null;break;case"mousedown":ru=!0;break;case"contextmenu":case"mouseup":case"dragend":ru=!1,nu(ct,m,ot);break;case"selectionchange":if(tu)break;case"keydown":case"keyup":nu(ct,m,ot)}var Xt;if(xs)e:{switch(o){case"compositionstart":var tr="onCompositionStart";break e;case"compositionend":tr="onCompositionEnd";break e;case"compositionupdate":tr="onCompositionUpdate";break e}tr=void 0}else Vo?Js(o,m)&&(tr="onCompositionEnd"):o==="keydown"&&m.keyCode===229&&(tr="onCompositionStart");tr&&(ql&&m.locale!=="ko"&&(Vo||tr!=="onCompositionStart"?tr==="onCompositionEnd"&&Vo&&(Xt=Hs()):(Wi=ot,Cn="value"in Wi?Wi.value:Wi.textContent,Vo=!0)),Ht=ma(Le,tr),0<Ht.length&&(tr=new ys(tr,o,null,m,ot),ct.push({event:tr,listeners:Ht}),Xt?tr.data=Xt:(Xt=Wl(m),Xt!==null&&(tr.data=Xt)))),(Xt=Kc?$o(o,m):rc(o,m))&&(Le=ma(Le,"onBeforeInput"),0<Le.length&&(ot=new ys("onBeforeInput","beforeinput",null,m,ot),ct.push({event:ot,listeners:Le}),ot.data=Xt))}ol(ct,s)})}function Eo(o,s,m){return{instance:o,listener:s,currentTarget:m}}function ma(o,s){for(var m=s+"Capture",v=[];o!==null;){var S=o,I=S.stateNode;S.tag===5&&I!==null&&(S=I,I=Et(o,m),I!=null&&v.unshift(Eo(o,I,S)),I=Et(o,s),I!=null&&v.push(Eo(o,I,S))),o=o.return}return v}function ga(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Ps(o,s,m,v,S){for(var I=s._reactName,G=[];m!==null&&m!==v;){var oe=m,ge=oe.alternate,Le=oe.stateNode;if(ge!==null&&ge===v)break;oe.tag===5&&Le!==null&&(oe=Le,S?(ge=Et(m,I),ge!=null&&G.unshift(Eo(m,ge,oe))):S||(ge=Et(m,I),ge!=null&&G.push(Eo(m,ge,oe)))),m=m.return}G.length!==0&&o.push({event:s,listeners:G})}var Jr=/\r\n?/g,Ga=/\u0000|\uFFFD/g;function zi(o){return(typeof o=="string"?o:""+o).replace(Jr,`
`).replace(Ga,"")}function Cs(o,s,m){if(s=zi(s),zi(o)!==s&&m)throw Error(z(425))}function Es(){}var lu=null,Zo=null;function _a(o,s){return o==="textarea"||o==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ya=typeof setTimeout=="function"?setTimeout:void 0,rh=typeof clearTimeout=="function"?clearTimeout:void 0,uu=typeof Promise=="function"?Promise:void 0,fc=typeof queueMicrotask=="function"?queueMicrotask:typeof uu<"u"?function(o){return uu.resolve(null).then(o).catch(nh)}:ya;function nh(o){setTimeout(function(){throw o})}function sl(o,s){var m=s,v=0;do{var S=m.nextSibling;if(o.removeChild(m),S&&S.nodeType===8)if(m=S.data,m==="/$"){if(v===0){o.removeChild(S),Gn(s);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=S}while(m);Gn(s)}function ai(o){for(;o!=null;o=o.nextSibling){var s=o.nodeType;if(s===1||s===3)break;if(s===8){if(s=o.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return o}function qa(o){o=o.previousSibling;for(var s=0;o;){if(o.nodeType===8){var m=o.data;if(m==="$"||m==="$!"||m==="$?"){if(s===0)return o;s--}else m==="/$"&&s++}o=o.previousSibling}return null}var Wa=Math.random().toString(36).slice(2),co="__reactFiber$"+Wa,Is="__reactProps$"+Wa,Io="__reactContainer$"+Wa,cu="__reactEvents$"+Wa,ih="__reactListeners$"+Wa,va="__reactHandles$"+Wa;function Ki(o){var s=o[co];if(s)return s;for(var m=o.parentNode;m;){if(s=m[Io]||m[co]){if(m=s.alternate,s.child!==null||m!==null&&m.child!==null)for(o=qa(o);o!==null;){if(m=o[co])return m;o=qa(o)}return s}o=m,m=o.parentNode}return null}function Vr(o){return o=o[co]||o[Io],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function fn(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(z(33))}function Ms(o){return o[Is]||null}var Yi=[],ho=-1;function Qi(o){return{current:o}}function qr(o){0>ho||(o.current=Yi[ho],Yi[ho]=null,ho--)}function Or(o,s){ho++,Yi[ho]=o.current,o.current=s}var xa={},mn=Qi(xa),En=Qi(!1),gn=xa;function ft(o,s){var m=o.type.contextTypes;if(!m)return xa;var v=o.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===s)return v.__reactInternalMemoizedMaskedChildContext;var S={},I;for(I in m)S[I]=s[I];return v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=s,o.__reactInternalMemoizedMaskedChildContext=S),S}function _n(o){return o=o.childContextTypes,o!=null}function ks(){qr(En),qr(mn)}function mc(o,s,m){if(mn.current!==xa)throw Error(z(168));Or(mn,s),Or(En,m)}function Go(o,s,m){var v=o.stateNode;if(s=s.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var S in v)if(!(S in s))throw Error(z(108,xt(o)||"Unknown",S));return rt({},m,v)}function ba(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||xa,gn=mn.current,Or(mn,o),Or(En,En.current),!0}function ll(o,s,m){var v=o.stateNode;if(!v)throw Error(z(169));m?(o=Go(o,s,gn),v.__reactInternalMemoizedMergedChildContext=o,qr(En),qr(mn),Or(mn,o)):qr(En),Or(En,m)}var Yt=null,Ha=!1,hu=!1;function ul(o){Yt===null?Yt=[o]:Yt.push(o)}function oh(o){Ha=!0,ul(o)}function Mo(){if(!hu&&Yt!==null){hu=!0;var o=0,s=ar;try{var m=Yt;for(ar=1;o<m.length;o++){var v=m[o];do v=v(!0);while(v!==null)}Yt=null,Ha=!1}catch(S){throw Yt!==null&&(Yt=Yt.slice(o+1)),Fu(Fl,Mo),S}finally{ar=s,hu=!1}}return null}var wa=[],Ta=0,As=null,du=0,vi=[],Ri=0,Sa=null,Hn=1,Sr="";function po(o,s){wa[Ta++]=du,wa[Ta++]=As,As=o,du=s}function cl(o,s,m){vi[Ri++]=Hn,vi[Ri++]=Sr,vi[Ri++]=Sa,Sa=o;var v=Hn;o=Sr;var S=32-Vn(v)-1;v&=~(1<<S),m+=1;var I=32-Vn(s)+S;if(30<I){var G=S-S%5;I=(v&(1<<G)-1).toString(32),v>>=G,S-=G,Hn=1<<32-Vn(s)+S|m<<S|v,Sr=I+o}else Hn=1<<I|m<<S|v,Sr=o}function hl(o){o.return!==null&&(po(o,1),cl(o,1,0))}function dl(o){for(;o===As;)As=wa[--Ta],wa[Ta]=null,du=wa[--Ta],wa[Ta]=null;for(;o===Sa;)Sa=vi[--Ri],vi[Ri]=null,Sr=vi[--Ri],vi[Ri]=null,Hn=vi[--Ri],vi[Ri]=null}var Dn=null,Di=null,xr=!1,xi=null;function zt(o,s){var m=Ni(5,null,null,0);m.elementType="DELETED",m.stateNode=s,m.return=o,s=o.deletions,s===null?(o.deletions=[m],o.flags|=16):s.push(m)}function $t(o,s){switch(o.tag){case 5:var m=o.type;return s=s.nodeType!==1||m.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(o.stateNode=s,Dn=o,Di=ai(s.firstChild),!0):!1;case 6:return s=o.pendingProps===""||s.nodeType!==3?null:s,s!==null?(o.stateNode=s,Dn=o,Di=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(m=Sa!==null?{id:Hn,overflow:Sr}:null,o.memoizedState={dehydrated:s,treeContext:m,retryLane:1073741824},m=Ni(18,null,null,0),m.stateNode=s,m.return=o,o.child=m,Dn=o,Di=null,!0):!1;default:return!1}}function Xa(o){return(o.mode&1)!==0&&(o.flags&128)===0}function zs(o){if(xr){var s=Di;if(s){var m=s;if(!$t(o,s)){if(Xa(o))throw Error(z(418));s=ai(m.nextSibling);var v=Dn;s&&$t(o,s)?zt(v,m):(o.flags=o.flags&-4097|2,xr=!1,Dn=o)}}else{if(Xa(o))throw Error(z(418));o.flags=o.flags&-4097|2,xr=!1,Dn=o}}}function pu(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;Dn=o}function Ln(o){if(o!==Dn)return!1;if(!xr)return pu(o),xr=!0,!1;var s;if((s=o.tag!==3)&&!(s=o.tag!==5)&&(s=o.type,s=s!=="head"&&s!=="body"&&!_a(o.type,o.memoizedProps)),s&&(s=Di)){if(Xa(o))throw gc(),Error(z(418));for(;s;)zt(o,s),s=ai(s.nextSibling)}if(pu(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(z(317));e:{for(o=o.nextSibling,s=0;o;){if(o.nodeType===8){var m=o.data;if(m==="/$"){if(s===0){Di=ai(o.nextSibling);break e}s--}else m!=="$"&&m!=="$!"&&m!=="$?"||s++}o=o.nextSibling}Di=null}}else Di=Dn?ai(o.stateNode.nextSibling):null;return!0}function gc(){for(var o=Di;o;)o=ai(o.nextSibling)}function si(){Di=Dn=null,xr=!1}function _c(o){xi===null?xi=[o]:xi.push(o)}var ko=Mt.ReactCurrentBatchConfig;function $r(o,s,m){if(o=m.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(z(309));var v=m.stateNode}if(!v)throw Error(z(147,o));var S=v,I=""+o;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===I?s.ref:(s=function(G){var oe=S.refs;G===null?delete oe[I]:oe[I]=G},s._stringRef=I,s)}if(typeof o!="string")throw Error(z(284));if(!m._owner)throw Error(z(290,o))}return o}function Kr(o,s){throw o=Object.prototype.toString.call(s),Error(z(31,o==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":o))}function yc(o){var s=o._init;return s(o._payload)}function Ka(o){function s(Ee,ve){if(o){var Ie=Ee.deletions;Ie===null?(Ee.deletions=[ve],Ee.flags|=16):Ie.push(ve)}}function m(Ee,ve){if(!o)return null;for(;ve!==null;)s(Ee,ve),ve=ve.sibling;return null}function v(Ee,ve){for(Ee=new Map;ve!==null;)ve.key!==null?Ee.set(ve.key,ve):Ee.set(ve.index,ve),ve=ve.sibling;return Ee}function S(Ee,ve){return Ee=Yo(Ee,ve),Ee.index=0,Ee.sibling=null,Ee}function I(Ee,ve,Ie){return Ee.index=Ie,o?(Ie=Ee.alternate,Ie!==null?(Ie=Ie.index,Ie<ve?(Ee.flags|=2,ve):Ie):(Ee.flags|=2,ve)):(Ee.flags|=1048576,ve)}function G(Ee){return o&&Ee.alternate===null&&(Ee.flags|=2),Ee}function oe(Ee,ve,Ie,ht){return ve===null||ve.tag!==6?(ve=Sh(Ie,Ee.mode,ht),ve.return=Ee,ve):(ve=S(ve,Ie),ve.return=Ee,ve)}function ge(Ee,ve,Ie,ht){var Ut=Ie.type;return Ut===pt?ot(Ee,ve,Ie.props.children,ht,Ie.key):ve!==null&&(ve.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===bt&&yc(Ut)===ve.type)?(ht=S(ve,Ie.props),ht.ref=$r(Ee,ve,Ie),ht.return=Ee,ht):(ht=Ml(Ie.type,Ie.key,Ie.props,null,Ee.mode,ht),ht.ref=$r(Ee,ve,Ie),ht.return=Ee,ht)}function Le(Ee,ve,Ie,ht){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Ie.containerInfo||ve.stateNode.implementation!==Ie.implementation?(ve=Ph(Ie,Ee.mode,ht),ve.return=Ee,ve):(ve=S(ve,Ie.children||[]),ve.return=Ee,ve)}function ot(Ee,ve,Ie,ht,Ut){return ve===null||ve.tag!==7?(ve=kl(Ie,Ee.mode,ht,Ut),ve.return=Ee,ve):(ve=S(ve,Ie),ve.return=Ee,ve)}function ct(Ee,ve,Ie){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return ve=Sh(""+ve,Ee.mode,Ie),ve.return=Ee,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case cr:return Ie=Ml(ve.type,ve.key,ve.props,null,Ee.mode,Ie),Ie.ref=$r(Ee,null,ve),Ie.return=Ee,Ie;case Je:return ve=Ph(ve,Ee.mode,Ie),ve.return=Ee,ve;case bt:var ht=ve._init;return ct(Ee,ht(ve._payload),Ie)}if(zn(ve)||et(ve))return ve=kl(ve,Ee.mode,Ie,null),ve.return=Ee,ve;Kr(Ee,ve)}return null}function it(Ee,ve,Ie,ht){var Ut=ve!==null?ve.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number")return Ut!==null?null:oe(Ee,ve,""+Ie,ht);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case cr:return Ie.key===Ut?ge(Ee,ve,Ie,ht):null;case Je:return Ie.key===Ut?Le(Ee,ve,Ie,ht):null;case bt:return Ut=Ie._init,it(Ee,ve,Ut(Ie._payload),ht)}if(zn(Ie)||et(Ie))return Ut!==null?null:ot(Ee,ve,Ie,ht,null);Kr(Ee,Ie)}return null}function It(Ee,ve,Ie,ht,Ut){if(typeof ht=="string"&&ht!==""||typeof ht=="number")return Ee=Ee.get(Ie)||null,oe(ve,Ee,""+ht,Ut);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case cr:return Ee=Ee.get(ht.key===null?Ie:ht.key)||null,ge(ve,Ee,ht,Ut);case Je:return Ee=Ee.get(ht.key===null?Ie:ht.key)||null,Le(ve,Ee,ht,Ut);case bt:var Ht=ht._init;return It(Ee,ve,Ie,Ht(ht._payload),Ut)}if(zn(ht)||et(ht))return Ee=Ee.get(Ie)||null,ot(ve,Ee,ht,Ut,null);Kr(ve,ht)}return null}function Ot(Ee,ve,Ie,ht){for(var Ut=null,Ht=null,Xt=ve,tr=ve=0,Fn=null;Xt!==null&&tr<Ie.length;tr++){Xt.index>tr?(Fn=Xt,Xt=null):Fn=Xt.sibling;var Ir=it(Ee,Xt,Ie[tr],ht);if(Ir===null){Xt===null&&(Xt=Fn);break}o&&Xt&&Ir.alternate===null&&s(Ee,Xt),ve=I(Ir,ve,tr),Ht===null?Ut=Ir:Ht.sibling=Ir,Ht=Ir,Xt=Fn}if(tr===Ie.length)return m(Ee,Xt),xr&&po(Ee,tr),Ut;if(Xt===null){for(;tr<Ie.length;tr++)Xt=ct(Ee,Ie[tr],ht),Xt!==null&&(ve=I(Xt,ve,tr),Ht===null?Ut=Xt:Ht.sibling=Xt,Ht=Xt);return xr&&po(Ee,tr),Ut}for(Xt=v(Ee,Xt);tr<Ie.length;tr++)Fn=It(Xt,Ee,tr,Ie[tr],ht),Fn!==null&&(o&&Fn.alternate!==null&&Xt.delete(Fn.key===null?tr:Fn.key),ve=I(Fn,ve,tr),Ht===null?Ut=Fn:Ht.sibling=Fn,Ht=Fn);return o&&Xt.forEach(function(is){return s(Ee,is)}),xr&&po(Ee,tr),Ut}function jt(Ee,ve,Ie,ht){var Ut=et(Ie);if(typeof Ut!="function")throw Error(z(150));if(Ie=Ut.call(Ie),Ie==null)throw Error(z(151));for(var Ht=Ut=null,Xt=ve,tr=ve=0,Fn=null,Ir=Ie.next();Xt!==null&&!Ir.done;tr++,Ir=Ie.next()){Xt.index>tr?(Fn=Xt,Xt=null):Fn=Xt.sibling;var is=it(Ee,Xt,Ir.value,ht);if(is===null){Xt===null&&(Xt=Fn);break}o&&Xt&&is.alternate===null&&s(Ee,Xt),ve=I(is,ve,tr),Ht===null?Ut=is:Ht.sibling=is,Ht=is,Xt=Fn}if(Ir.done)return m(Ee,Xt),xr&&po(Ee,tr),Ut;if(Xt===null){for(;!Ir.done;tr++,Ir=Ie.next())Ir=ct(Ee,Ir.value,ht),Ir!==null&&(ve=I(Ir,ve,tr),Ht===null?Ut=Ir:Ht.sibling=Ir,Ht=Ir);return xr&&po(Ee,tr),Ut}for(Xt=v(Ee,Xt);!Ir.done;tr++,Ir=Ie.next())Ir=It(Xt,Ee,tr,Ir.value,ht),Ir!==null&&(o&&Ir.alternate!==null&&Xt.delete(Ir.key===null?tr:Ir.key),ve=I(Ir,ve,tr),Ht===null?Ut=Ir:Ht.sibling=Ir,Ht=Ir);return o&&Xt.forEach(function(Dc){return s(Ee,Dc)}),xr&&po(Ee,tr),Ut}function wn(Ee,ve,Ie,ht){if(typeof Ie=="object"&&Ie!==null&&Ie.type===pt&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case cr:e:{for(var Ut=Ie.key,Ht=ve;Ht!==null;){if(Ht.key===Ut){if(Ut=Ie.type,Ut===pt){if(Ht.tag===7){m(Ee,Ht.sibling),ve=S(Ht,Ie.props.children),ve.return=Ee,Ee=ve;break e}}else if(Ht.elementType===Ut||typeof Ut=="object"&&Ut!==null&&Ut.$$typeof===bt&&yc(Ut)===Ht.type){m(Ee,Ht.sibling),ve=S(Ht,Ie.props),ve.ref=$r(Ee,Ht,Ie),ve.return=Ee,Ee=ve;break e}m(Ee,Ht);break}else s(Ee,Ht);Ht=Ht.sibling}Ie.type===pt?(ve=kl(Ie.props.children,Ee.mode,ht,Ie.key),ve.return=Ee,Ee=ve):(ht=Ml(Ie.type,Ie.key,Ie.props,null,Ee.mode,ht),ht.ref=$r(Ee,ve,Ie),ht.return=Ee,Ee=ht)}return G(Ee);case Je:e:{for(Ht=Ie.key;ve!==null;){if(ve.key===Ht)if(ve.tag===4&&ve.stateNode.containerInfo===Ie.containerInfo&&ve.stateNode.implementation===Ie.implementation){m(Ee,ve.sibling),ve=S(ve,Ie.children||[]),ve.return=Ee,Ee=ve;break e}else{m(Ee,ve);break}else s(Ee,ve);ve=ve.sibling}ve=Ph(Ie,Ee.mode,ht),ve.return=Ee,Ee=ve}return G(Ee);case bt:return Ht=Ie._init,wn(Ee,ve,Ht(Ie._payload),ht)}if(zn(Ie))return Ot(Ee,ve,Ie,ht);if(et(Ie))return jt(Ee,ve,Ie,ht);Kr(Ee,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"?(Ie=""+Ie,ve!==null&&ve.tag===6?(m(Ee,ve.sibling),ve=S(ve,Ie),ve.return=Ee,Ee=ve):(m(Ee,ve),ve=Sh(Ie,Ee.mode,ht),ve.return=Ee,Ee=ve),G(Ee)):m(Ee,ve)}return wn}var qo=Ka(!0),fu=Ka(!1),Ji=Qi(null),Ya=null,eo=null,Rs=null;function Qa(){Rs=eo=Ya=null}function pl(o){var s=Ji.current;qr(Ji),o._currentValue=s}function Pa(o,s,m){for(;o!==null;){var v=o.alternate;if((o.childLanes&s)!==s?(o.childLanes|=s,v!==null&&(v.childLanes|=s)):v!==null&&(v.childLanes&s)!==s&&(v.childLanes|=s),o===m)break;o=o.return}}function to(o,s){Ya=o,Rs=eo=null,o=o.dependencies,o!==null&&o.firstContext!==null&&((o.lanes&s)!==0&&(Oi=!0),o.firstContext=null)}function bi(o){var s=o._currentValue;if(Rs!==o)if(o={context:o,memoizedValue:s,next:null},eo===null){if(Ya===null)throw Error(z(308));eo=o,Ya.dependencies={lanes:0,firstContext:o}}else eo=eo.next=o;return s}var Ao=null;function Wo(o){Ao===null?Ao=[o]:Ao.push(o)}function fl(o,s,m,v){var S=s.interleaved;return S===null?(m.next=m,Wo(s)):(m.next=S.next,S.next=m),s.interleaved=m,fo(o,v)}function fo(o,s){o.lanes|=s;var m=o.alternate;for(m!==null&&(m.lanes|=s),m=o,o=o.return;o!==null;)o.childLanes|=s,m=o.alternate,m!==null&&(m.childLanes|=s),m=o,o=o.return;return m.tag===3?m.stateNode:null}var mo=!1;function Ds(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function d(o,s){o=o.updateQueue,s.updateQueue===o&&(s.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function e(o,s){return{eventTime:o,lane:s,tag:0,payload:null,callback:null,next:null}}function r(o,s,m){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(Cr&2)!==0){var S=v.pending;return S===null?s.next=s:(s.next=S.next,S.next=s),v.pending=s,fo(o,m)}return S=v.interleaved,S===null?(s.next=s,Wo(v)):(s.next=S.next,S.next=s),v.interleaved=s,fo(o,m)}function l(o,s,m){if(s=s.updateQueue,s!==null&&(s=s.shared,(m&4194240)!==0)){var v=s.lanes;v&=o.pendingLanes,m|=v,s.lanes=m,qs(o,m)}}function u(o,s){var m=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var S=null,I=null;if(m=m.firstBaseUpdate,m!==null){do{var G={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};I===null?S=I=G:I=I.next=G,m=m.next}while(m!==null);I===null?S=I=s:I=I.next=s}else S=I=s;m={baseState:v.baseState,firstBaseUpdate:S,lastBaseUpdate:I,shared:v.shared,effects:v.effects},o.updateQueue=m;return}o=m.lastBaseUpdate,o===null?m.firstBaseUpdate=s:o.next=s,m.lastBaseUpdate=s}function p(o,s,m,v){var S=o.updateQueue;mo=!1;var I=S.firstBaseUpdate,G=S.lastBaseUpdate,oe=S.shared.pending;if(oe!==null){S.shared.pending=null;var ge=oe,Le=ge.next;ge.next=null,G===null?I=Le:G.next=Le,G=ge;var ot=o.alternate;ot!==null&&(ot=ot.updateQueue,oe=ot.lastBaseUpdate,oe!==G&&(oe===null?ot.firstBaseUpdate=Le:oe.next=Le,ot.lastBaseUpdate=ge))}if(I!==null){var ct=S.baseState;G=0,ot=Le=ge=null,oe=I;do{var it=oe.lane,It=oe.eventTime;if((v&it)===it){ot!==null&&(ot=ot.next={eventTime:It,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Ot=o,jt=oe;switch(it=s,It=m,jt.tag){case 1:if(Ot=jt.payload,typeof Ot=="function"){ct=Ot.call(It,ct,it);break e}ct=Ot;break e;case 3:Ot.flags=Ot.flags&-65537|128;case 0:if(Ot=jt.payload,it=typeof Ot=="function"?Ot.call(It,ct,it):Ot,it==null)break e;ct=rt({},ct,it);break e;case 2:mo=!0}}oe.callback!==null&&oe.lane!==0&&(o.flags|=64,it=S.effects,it===null?S.effects=[oe]:it.push(oe))}else It={eventTime:It,lane:it,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},ot===null?(Le=ot=It,ge=ct):ot=ot.next=It,G|=it;if(oe=oe.next,oe===null){if(oe=S.shared.pending,oe===null)break;it=oe,oe=it.next,it.next=null,S.lastBaseUpdate=it,S.shared.pending=null}}while(!0);if(ot===null&&(ge=ct),S.baseState=ge,S.firstBaseUpdate=Le,S.lastBaseUpdate=ot,s=S.shared.interleaved,s!==null){S=s;do G|=S.lane,S=S.next;while(S!==s)}else I===null&&(S.shared.lanes=0);wl|=G,o.lanes=G,o.memoizedState=ct}}function _(o,s,m){if(o=s.effects,s.effects=null,o!==null)for(s=0;s<o.length;s++){var v=o[s],S=v.callback;if(S!==null){if(v.callback=null,v=m,typeof S!="function")throw Error(z(191,S));S.call(v)}}}var x={},w=Qi(x),P=Qi(x),A=Qi(x);function D(o){if(o===x)throw Error(z(174));return o}function O(o,s){switch(Or(A,s),Or(P,o),Or(w,x),o=s.nodeType,o){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:pi(null,"");break;default:o=o===8?s.parentNode:s,s=o.namespaceURI||null,o=o.tagName,s=pi(s,o)}qr(w),Or(w,s)}function $(){qr(w),qr(P),qr(A)}function U(o){D(A.current);var s=D(w.current),m=pi(s,o.type);s!==m&&(Or(P,o),Or(w,m))}function Q(o){P.current===o&&(qr(w),qr(P))}var Y=Qi(0);function J(o){for(var s=o;s!==null;){if(s.tag===13){var m=s.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var re=[];function le(){for(var o=0;o<re.length;o++)re[o]._workInProgressVersionPrimary=null;re.length=0}var ue=Mt.ReactCurrentDispatcher,de=Mt.ReactCurrentBatchConfig,pe=0,se=null,be=null,we=null,Fe=!1,je=!1,Oe=0,lt=0;function Qe(){throw Error(z(321))}function He(o,s){if(s===null)return!1;for(var m=0;m<s.length&&m<o.length;m++)if(!Qr(o[m],s[m]))return!1;return!0}function Pt(o,s,m,v,S,I){if(pe=I,se=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ue.current=o===null||o.memoizedState===null?gu:_u,o=m(v,S),je){I=0;do{if(je=!1,Oe=0,25<=I)throw Error(z(301));I+=1,we=be=null,s.updateQueue=null,ue.current=sh,o=m(v,S)}while(je)}if(ue.current=ml,s=be!==null&&be.next!==null,pe=0,we=be=se=null,Fe=!1,s)throw Error(z(300));return o}function Rt(){var o=Oe!==0;return Oe=0,o}function nr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return we===null?se.memoizedState=we=o:we=we.next=o,we}function pr(){if(be===null){var o=se.alternate;o=o!==null?o.memoizedState:null}else o=be.next;var s=we===null?se.memoizedState:we.next;if(s!==null)we=s,be=o;else{if(o===null)throw Error(z(310));be=o,o={memoizedState:be.memoizedState,baseState:be.baseState,baseQueue:be.baseQueue,queue:be.queue,next:null},we===null?se.memoizedState=we=o:we=we.next=o}return we}function Pr(o,s){return typeof s=="function"?s(o):s}function Ur(o){var s=pr(),m=s.queue;if(m===null)throw Error(z(311));m.lastRenderedReducer=o;var v=be,S=v.baseQueue,I=m.pending;if(I!==null){if(S!==null){var G=S.next;S.next=I.next,I.next=G}v.baseQueue=S=I,m.pending=null}if(S!==null){I=S.next,v=v.baseState;var oe=G=null,ge=null,Le=I;do{var ot=Le.lane;if((pe&ot)===ot)ge!==null&&(ge=ge.next={lane:0,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null}),v=Le.hasEagerState?Le.eagerState:o(v,Le.action);else{var ct={lane:ot,action:Le.action,hasEagerState:Le.hasEagerState,eagerState:Le.eagerState,next:null};ge===null?(oe=ge=ct,G=v):ge=ge.next=ct,se.lanes|=ot,wl|=ot}Le=Le.next}while(Le!==null&&Le!==I);ge===null?G=v:ge.next=oe,Qr(v,s.memoizedState)||(Oi=!0),s.memoizedState=v,s.baseState=G,s.baseQueue=ge,m.lastRenderedState=v}if(o=m.interleaved,o!==null){S=o;do I=S.lane,se.lanes|=I,wl|=I,S=S.next;while(S!==o)}else S===null&&(m.lanes=0);return[s.memoizedState,m.dispatch]}function Fr(o){var s=pr(),m=s.queue;if(m===null)throw Error(z(311));m.lastRenderedReducer=o;var v=m.dispatch,S=m.pending,I=s.memoizedState;if(S!==null){m.pending=null;var G=S=S.next;do I=o(I,G.action),G=G.next;while(G!==S);Qr(I,s.memoizedState)||(Oi=!0),s.memoizedState=I,s.baseQueue===null&&(s.baseState=I),m.lastRenderedState=I}return[I,v]}function wr(){}function zr(o,s){var m=se,v=pr(),S=s(),I=!Qr(v.memoizedState,S);if(I&&(v.memoizedState=S,Oi=!0),v=v.queue,Ti(an.bind(null,m,v,o),[o]),v.getSnapshot!==s||I||we!==null&&we.memoizedState.tag&1){if(m.flags|=2048,wi(9,vn.bind(null,m,v,S,s),void 0,null),On===null)throw Error(z(349));(pe&30)!==0||yn(m,s,S)}return S}function yn(o,s,m){o.flags|=16384,o={getSnapshot:s,value:m},s=se.updateQueue,s===null?(s={lastEffect:null,stores:null},se.updateQueue=s,s.stores=[o]):(m=s.stores,m===null?s.stores=[o]:m.push(o))}function vn(o,s,m,v){s.value=m,s.getSnapshot=v,In(s)&&Ho(o)}function an(o,s,m){return m(function(){In(s)&&Ho(o)})}function In(o){var s=o.getSnapshot;o=o.value;try{var m=s();return!Qr(o,m)}catch{return!0}}function Ho(o){var s=fo(o,1);s!==null&&Lo(s,o,1,-1)}function zo(o){var s=nr();return typeof o=="function"&&(o=o()),s.memoizedState=s.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pr,lastRenderedState:o},s.queue=o,o=o.dispatch=ah.bind(null,se,o),[s.memoizedState,o]}function wi(o,s,m,v){return o={tag:o,create:s,destroy:m,deps:v,next:null},s=se.updateQueue,s===null?(s={lastEffect:null,stores:null},se.updateQueue=s,s.lastEffect=o.next=o):(m=s.lastEffect,m===null?s.lastEffect=o.next=o:(v=m.next,m.next=o,o.next=v,s.lastEffect=o)),o}function Li(){return pr().memoizedState}function Ro(o,s,m,v){var S=nr();se.flags|=o,S.memoizedState=wi(1|s,m,void 0,v===void 0?null:v)}function Ca(o,s,m,v){var S=pr();v=v===void 0?null:v;var I=void 0;if(be!==null){var G=be.memoizedState;if(I=G.destroy,v!==null&&He(v,G.deps)){S.memoizedState=wi(s,m,I,v);return}}se.flags|=o,S.memoizedState=wi(1|s,m,I,v)}function Ea(o,s){return Ro(8390656,8,o,s)}function Ti(o,s){return Ca(2048,8,o,s)}function go(o,s){return Ca(4,2,o,s)}function ro(o,s){return Ca(4,4,o,s)}function _o(o,s){if(typeof s=="function")return o=o(),s(o),function(){s(null)};if(s!=null)return o=o(),s.current=o,function(){s.current=null}}function Br(o,s,m){return m=m!=null?m.concat([o]):null,Ca(4,4,_o.bind(null,s,o),m)}function Rr(){}function sn(o,s){var m=pr();s=s===void 0?null:s;var v=m.memoizedState;return v!==null&&s!==null&&He(s,v[1])?v[0]:(m.memoizedState=[o,s],o)}function ln(o,s){var m=pr();s=s===void 0?null:s;var v=m.memoizedState;return v!==null&&s!==null&&He(s,v[1])?v[0]:(o=o(),m.memoizedState=[o,s],o)}function Ia(o,s,m){return(pe&21)===0?(o.baseState&&(o.baseState=!1,Oi=!0),o.memoizedState=m):(Qr(m,s)||(m=gi(),se.lanes|=m,wl|=m,o.baseState=!0),s)}function Wh(o,s){var m=ar;ar=m!==0&&4>m?m:4,o(!0);var v=de.transition;de.transition={};try{o(!1),s()}finally{ar=m,de.transition=v}}function vc(){return pr().memoizedState}function xc(o,s,m){var v=Aa(o);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},Ma(o))Si(s,m);else if(m=fl(o,s,m,v),m!==null){var S=Ii();Lo(m,o,v,S),mu(m,s,v)}}function ah(o,s,m){var v=Aa(o),S={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(Ma(o))Si(s,S);else{var I=o.alternate;if(o.lanes===0&&(I===null||I.lanes===0)&&(I=s.lastRenderedReducer,I!==null))try{var G=s.lastRenderedState,oe=I(G,m);if(S.hasEagerState=!0,S.eagerState=oe,Qr(oe,G)){var ge=s.interleaved;ge===null?(S.next=S,Wo(s)):(S.next=ge.next,ge.next=S),s.interleaved=S;return}}catch{}finally{}m=fl(o,s,S,v),m!==null&&(S=Ii(),Lo(m,o,v,S),mu(m,s,v))}}function Ma(o){var s=o.alternate;return o===se||s!==null&&s===se}function Si(o,s){je=Fe=!0;var m=o.pending;m===null?s.next=s:(s.next=m.next,m.next=s),o.pending=s}function mu(o,s,m){if((m&4194240)!==0){var v=s.lanes;v&=o.pendingLanes,m|=v,s.lanes=m,qs(o,m)}}var ml={readContext:bi,useCallback:Qe,useContext:Qe,useEffect:Qe,useImperativeHandle:Qe,useInsertionEffect:Qe,useLayoutEffect:Qe,useMemo:Qe,useReducer:Qe,useRef:Qe,useState:Qe,useDebugValue:Qe,useDeferredValue:Qe,useTransition:Qe,useMutableSource:Qe,useSyncExternalStore:Qe,useId:Qe,unstable_isNewReconciler:!1},gu={readContext:bi,useCallback:function(o,s){return nr().memoizedState=[o,s===void 0?null:s],o},useContext:bi,useEffect:Ea,useImperativeHandle:function(o,s,m){return m=m!=null?m.concat([o]):null,Ro(4194308,4,_o.bind(null,s,o),m)},useLayoutEffect:function(o,s){return Ro(4194308,4,o,s)},useInsertionEffect:function(o,s){return Ro(4,2,o,s)},useMemo:function(o,s){var m=nr();return s=s===void 0?null:s,o=o(),m.memoizedState=[o,s],o},useReducer:function(o,s,m){var v=nr();return s=m!==void 0?m(s):s,v.memoizedState=v.baseState=s,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:s},v.queue=o,o=o.dispatch=xc.bind(null,se,o),[v.memoizedState,o]},useRef:function(o){var s=nr();return o={current:o},s.memoizedState=o},useState:zo,useDebugValue:Rr,useDeferredValue:function(o){return nr().memoizedState=o},useTransition:function(){var o=zo(!1),s=o[0];return o=Wh.bind(null,o[1]),nr().memoizedState=o,[s,o]},useMutableSource:function(){},useSyncExternalStore:function(o,s,m){var v=se,S=nr();if(xr){if(m===void 0)throw Error(z(407));m=m()}else{if(m=s(),On===null)throw Error(z(349));(pe&30)!==0||yn(v,s,m)}S.memoizedState=m;var I={value:m,getSnapshot:s};return S.queue=I,Ea(an.bind(null,v,I,o),[o]),v.flags|=2048,wi(9,vn.bind(null,v,I,m,s),void 0,null),m},useId:function(){var o=nr(),s=On.identifierPrefix;if(xr){var m=Sr,v=Hn;m=(v&~(1<<32-Vn(v)-1)).toString(32)+m,s=":"+s+"R"+m,m=Oe++,0<m&&(s+="H"+m.toString(32)),s+=":"}else m=lt++,s=":"+s+"r"+m.toString(32)+":";return o.memoizedState=s},unstable_isNewReconciler:!1},_u={readContext:bi,useCallback:sn,useContext:bi,useEffect:Ti,useImperativeHandle:Br,useInsertionEffect:go,useLayoutEffect:ro,useMemo:ln,useReducer:Ur,useRef:Li,useState:function(){return Ur(Pr)},useDebugValue:Rr,useDeferredValue:function(o){var s=pr();return Ia(s,be.memoizedState,o)},useTransition:function(){var o=Ur(Pr)[0],s=pr().memoizedState;return[o,s]},useMutableSource:wr,useSyncExternalStore:zr,useId:vc,unstable_isNewReconciler:!1},sh={readContext:bi,useCallback:sn,useContext:bi,useEffect:Ti,useImperativeHandle:Br,useInsertionEffect:go,useLayoutEffect:ro,useMemo:ln,useReducer:Fr,useRef:Li,useState:function(){return Fr(Pr)},useDebugValue:Rr,useDeferredValue:function(o){var s=pr();return be===null?s.memoizedState=o:Ia(s,be.memoizedState,o)},useTransition:function(){var o=Fr(Pr)[0],s=pr().memoizedState;return[o,s]},useMutableSource:wr,useSyncExternalStore:zr,useId:vc,unstable_isNewReconciler:!1};function Pi(o,s){if(o&&o.defaultProps){s=rt({},s),o=o.defaultProps;for(var m in o)s[m]===void 0&&(s[m]=o[m]);return s}return s}function Hh(o,s,m,v){s=o.memoizedState,m=m(v,s),m=m==null?s:rt({},s,m),o.memoizedState=m,o.lanes===0&&(o.updateQueue.baseState=m)}var yu={isMounted:function(o){return(o=o._reactInternals)?Zr(o)===o:!1},enqueueSetState:function(o,s,m){o=o._reactInternals;var v=Ii(),S=Aa(o),I=e(v,S);I.payload=s,m!=null&&(I.callback=m),s=r(o,I,S),s!==null&&(Lo(s,o,S,v),l(s,o,S))},enqueueReplaceState:function(o,s,m){o=o._reactInternals;var v=Ii(),S=Aa(o),I=e(v,S);I.tag=1,I.payload=s,m!=null&&(I.callback=m),s=r(o,I,S),s!==null&&(Lo(s,o,S,v),l(s,o,S))},enqueueForceUpdate:function(o,s){o=o._reactInternals;var m=Ii(),v=Aa(o),S=e(m,v);S.tag=2,s!=null&&(S.callback=s),s=r(o,S,v),s!==null&&(Lo(s,o,v,m),l(s,o,v))}};function Od(o,s,m,v,S,I,G){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,I,G):s.prototype&&s.prototype.isPureReactComponent?!ws(m,v)||!ws(S,I):!0}function lh(o,s,m){var v=!1,S=xa,I=s.contextType;return typeof I=="object"&&I!==null?I=bi(I):(S=_n(s)?gn:mn.current,v=s.contextTypes,I=(v=v!=null)?ft(o,S):xa),s=new s(m,I),o.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=yu,o.stateNode=s,s._reactInternals=o,v&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=S,o.__reactInternalMemoizedMaskedChildContext=I),s}function Xh(o,s,m,v){o=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(m,v),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(m,v),s.state!==o&&yu.enqueueReplaceState(s,s.state,null)}function uh(o,s,m,v){var S=o.stateNode;S.props=m,S.state=o.memoizedState,S.refs={},Ds(o);var I=s.contextType;typeof I=="object"&&I!==null?S.context=bi(I):(I=_n(s)?gn:mn.current,S.context=ft(o,I)),S.state=o.memoizedState,I=s.getDerivedStateFromProps,typeof I=="function"&&(Hh(o,s,I,m),S.state=o.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(s=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),s!==S.state&&yu.enqueueReplaceState(S,S.state,null),p(o,m,S,v),S.state=o.memoizedState),typeof S.componentDidMount=="function"&&(o.flags|=4194308)}function Xo(o,s){try{var m="",v=s;do m+=Xe(v),v=v.return;while(v);var S=m}catch(I){S=`
Error generating stack: `+I.message+`
`+I.stack}return{value:o,source:s,stack:S,digest:null}}function Kh(o,s,m){return{value:o,source:null,stack:m??null,digest:s??null}}function gl(o,s){try{console.error(s.value)}catch(m){setTimeout(function(){throw m})}}var ch=typeof WeakMap=="function"?WeakMap:Map;function bc(o,s,m){m=e(-1,m),m.tag=3,m.payload={element:null};var v=s.value;return m.callback=function(){mh||(mh=!0,pd=v),gl(o,s)},m}function Yh(o,s,m){m=e(-1,m),m.tag=3;var v=o.type.getDerivedStateFromError;if(typeof v=="function"){var S=s.value;m.payload=function(){return v(S)},m.callback=function(){gl(o,s)}}var I=o.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(m.callback=function(){gl(o,s),typeof v!="function"&&(Do===null?Do=new Set([this]):Do.add(this));var G=s.stack;this.componentDidCatch(s.value,{componentStack:G!==null?G:""})}),m}function Qh(o,s,m){var v=o.pingCache;if(v===null){v=o.pingCache=new ch;var S=new Set;v.set(s,S)}else S=v.get(s),S===void 0&&(S=new Set,v.set(s,S));S.has(m)||(S.add(m),o=Fp.bind(null,o,s,m),s.then(o,o))}function Fd(o){do{var s;if((s=o.tag===13)&&(s=o.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return o;o=o.return}while(o!==null);return null}function Bd(o,s,m,v,S){return(o.mode&1)===0?(o===s?o.flags|=65536:(o.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(s=e(-1,1),s.tag=2,r(m,s,1))),m.lanes|=1),o):(o.flags|=65536,o.lanes=S,o)}var jd=Mt.ReactCurrentOwner,Oi=!1;function Ci(o,s,m,v){s.child=o===null?fu(s,null,m,v):qo(s,o.child,m,v)}function Nd(o,s,m,v,S){m=m.render;var I=s.ref;return to(s,S),v=Pt(o,s,m,v,I,S),m=Rt(),o!==null&&!Oi?(s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~S,es(o,s,S)):(xr&&m&&hl(s),s.flags|=1,Ci(o,s,v,S),s.child)}function hh(o,s,m,v,S){if(o===null){var I=m.type;return typeof I=="function"&&!Il(I)&&I.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(s.tag=15,s.type=I,Jh(o,s,I,v,S)):(o=Ml(m.type,null,v,s,s.mode,S),o.ref=s.ref,o.return=s,s.child=o)}if(I=o.child,(o.lanes&S)===0){var G=I.memoizedProps;if(m=m.compare,m=m!==null?m:ws,m(G,v)&&o.ref===s.ref)return es(o,s,S)}return s.flags|=1,o=Yo(I,v),o.ref=s.ref,o.return=s,s.child=o}function Jh(o,s,m,v,S){if(o!==null){var I=o.memoizedProps;if(ws(I,v)&&o.ref===s.ref)if(Oi=!1,s.pendingProps=v=I,(o.lanes&S)!==0)(o.flags&131072)!==0&&(Oi=!0);else return s.lanes=o.lanes,es(o,s,S)}return Fi(o,s,m,v,S)}function dh(o,s,m){var v=s.pendingProps,S=v.children,I=o!==null?o.memoizedState:null;if(v.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Or(bl,no),no|=m;else{if((m&1073741824)===0)return o=I!==null?I.baseLanes|m:m,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:o,cachePool:null,transitions:null},s.updateQueue=null,Or(bl,no),no|=o,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=I!==null?I.baseLanes:m,Or(bl,no),no|=v}else I!==null?(v=I.baseLanes|m,s.memoizedState=null):v=m,Or(bl,no),no|=v;return Ci(o,s,S,m),s.child}function vu(o,s){var m=s.ref;(o===null&&m!==null||o!==null&&o.ref!==m)&&(s.flags|=512,s.flags|=2097152)}function Fi(o,s,m,v,S){var I=_n(m)?gn:mn.current;return I=ft(s,I),to(s,S),m=Pt(o,s,m,v,I,S),v=Rt(),o!==null&&!Oi?(s.updateQueue=o.updateQueue,s.flags&=-2053,o.lanes&=~S,es(o,s,S)):(xr&&v&&hl(s),s.flags|=1,Ci(o,s,m,S),s.child)}function ed(o,s,m,v,S){if(_n(m)){var I=!0;ba(s)}else I=!1;if(to(s,S),s.stateNode===null)ph(o,s),lh(s,m,v),uh(s,m,v,S),v=!0;else if(o===null){var G=s.stateNode,oe=s.memoizedProps;G.props=oe;var ge=G.context,Le=m.contextType;typeof Le=="object"&&Le!==null?Le=bi(Le):(Le=_n(m)?gn:mn.current,Le=ft(s,Le));var ot=m.getDerivedStateFromProps,ct=typeof ot=="function"||typeof G.getSnapshotBeforeUpdate=="function";ct||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(oe!==v||ge!==Le)&&Xh(s,G,v,Le),mo=!1;var it=s.memoizedState;G.state=it,p(s,v,G,S),ge=s.memoizedState,oe!==v||it!==ge||En.current||mo?(typeof ot=="function"&&(Hh(s,m,ot,v),ge=s.memoizedState),(oe=mo||Od(s,m,oe,v,it,ge,Le))?(ct||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(s.flags|=4194308)):(typeof G.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=v,s.memoizedState=ge),G.props=v,G.state=ge,G.context=Le,v=oe):(typeof G.componentDidMount=="function"&&(s.flags|=4194308),v=!1)}else{G=s.stateNode,d(o,s),oe=s.memoizedProps,Le=s.type===s.elementType?oe:Pi(s.type,oe),G.props=Le,ct=s.pendingProps,it=G.context,ge=m.contextType,typeof ge=="object"&&ge!==null?ge=bi(ge):(ge=_n(m)?gn:mn.current,ge=ft(s,ge));var It=m.getDerivedStateFromProps;(ot=typeof It=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(oe!==ct||it!==ge)&&Xh(s,G,v,ge),mo=!1,it=s.memoizedState,G.state=it,p(s,v,G,S);var Ot=s.memoizedState;oe!==ct||it!==Ot||En.current||mo?(typeof It=="function"&&(Hh(s,m,It,v),Ot=s.memoizedState),(Le=mo||Od(s,m,Le,v,it,Ot,ge)||!1)?(ot||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(v,Ot,ge),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(v,Ot,ge)),typeof G.componentDidUpdate=="function"&&(s.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof G.componentDidUpdate!="function"||oe===o.memoizedProps&&it===o.memoizedState||(s.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||oe===o.memoizedProps&&it===o.memoizedState||(s.flags|=1024),s.memoizedProps=v,s.memoizedState=Ot),G.props=v,G.state=Ot,G.context=ge,v=Le):(typeof G.componentDidUpdate!="function"||oe===o.memoizedProps&&it===o.memoizedState||(s.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||oe===o.memoizedProps&&it===o.memoizedState||(s.flags|=1024),v=!1)}return wc(o,s,m,v,I,S)}function wc(o,s,m,v,S,I){vu(o,s);var G=(s.flags&128)!==0;if(!v&&!G)return S&&ll(s,m,!1),es(o,s,I);v=s.stateNode,jd.current=s;var oe=G&&typeof m.getDerivedStateFromError!="function"?null:v.render();return s.flags|=1,o!==null&&G?(s.child=qo(s,o.child,null,I),s.child=qo(s,null,oe,I)):Ci(o,s,oe,I),s.memoizedState=v.state,S&&ll(s,m,!0),s.child}function Vd(o){var s=o.stateNode;s.pendingContext?mc(o,s.pendingContext,s.pendingContext!==s.context):s.context&&mc(o,s.context,!1),O(o,s.containerInfo)}function td(o,s,m,v,S){return si(),_c(S),s.flags|=256,Ci(o,s,m,v),s.child}var rd={dehydrated:null,treeContext:null,retryLane:0};function nd(o){return{baseLanes:o,cachePool:null,transitions:null}}function $d(o,s,m){var v=s.pendingProps,S=Y.current,I=!1,G=(s.flags&128)!==0,oe;if((oe=G)||(oe=o!==null&&o.memoizedState===null?!1:(S&2)!==0),oe?(I=!0,s.flags&=-129):(o===null||o.memoizedState!==null)&&(S|=1),Or(Y,S&1),o===null)return zs(s),o=s.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?((s.mode&1)===0?s.lanes=1:o.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(G=v.children,o=v.fallback,I?(v=s.mode,I=s.child,G={mode:"hidden",children:G},(v&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=G):I=Th(G,v,0,null),o=kl(o,v,m,null),I.return=s,o.return=s,I.sibling=o,s.child=I,s.child.memoizedState=nd(m),s.memoizedState=rd,o):id(s,G));if(S=o.memoizedState,S!==null&&(oe=S.dehydrated,oe!==null))return od(o,s,G,v,oe,S,m);if(I){I=v.fallback,G=s.mode,S=o.child,oe=S.sibling;var ge={mode:"hidden",children:v.children};return(G&1)===0&&s.child!==S?(v=s.child,v.childLanes=0,v.pendingProps=ge,s.deletions=null):(v=Yo(S,ge),v.subtreeFlags=S.subtreeFlags&14680064),oe!==null?I=Yo(oe,I):(I=kl(I,G,m,null),I.flags|=2),I.return=s,v.return=s,v.sibling=I,s.child=v,v=I,I=s.child,G=o.child.memoizedState,G=G===null?nd(m):{baseLanes:G.baseLanes|m,cachePool:null,transitions:G.transitions},I.memoizedState=G,I.childLanes=o.childLanes&~m,s.memoizedState=rd,v}return I=o.child,o=I.sibling,v=Yo(I,{mode:"visible",children:v.children}),(s.mode&1)===0&&(v.lanes=m),v.return=s,v.sibling=null,o!==null&&(m=s.deletions,m===null?(s.deletions=[o],s.flags|=16):m.push(o)),s.child=v,s.memoizedState=null,v}function id(o,s){return s=Th({mode:"visible",children:s},o.mode,0,null),s.return=o,o.child=s}function xu(o,s,m,v){return v!==null&&_c(v),qo(s,o.child,null,m),o=id(s,s.pendingProps.children),o.flags|=2,s.memoizedState=null,o}function od(o,s,m,v,S,I,G){if(m)return s.flags&256?(s.flags&=-257,v=Kh(Error(z(422))),xu(o,s,G,v)):s.memoizedState!==null?(s.child=o.child,s.flags|=128,null):(I=v.fallback,S=s.mode,v=Th({mode:"visible",children:v.children},S,0,null),I=kl(I,S,G,null),I.flags|=2,v.return=s,I.return=s,v.sibling=I,s.child=v,(s.mode&1)!==0&&qo(s,o.child,null,G),s.child.memoizedState=nd(G),s.memoizedState=rd,I);if((s.mode&1)===0)return xu(o,s,G,null);if(S.data==="$!"){if(v=S.nextSibling&&S.nextSibling.dataset,v)var oe=v.dgst;return v=oe,I=Error(z(419)),v=Kh(I,v,void 0),xu(o,s,G,v)}if(oe=(G&o.childLanes)!==0,Oi||oe){if(v=On,v!==null){switch(G&-G){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(v.suspendedLanes|G))!==0?0:S,S!==0&&S!==I.retryLane&&(I.retryLane=S,fo(o,S),Lo(v,o,S,-1))}return xh(),v=Kh(Error(z(421))),xu(o,s,G,v)}return S.data==="$?"?(s.flags|=128,s.child=o.child,s=ip.bind(null,o),S._reactRetry=s,null):(o=I.treeContext,Di=ai(S.nextSibling),Dn=s,xr=!0,xi=null,o!==null&&(vi[Ri++]=Hn,vi[Ri++]=Sr,vi[Ri++]=Sa,Hn=o.id,Sr=o.overflow,Sa=s),s=id(s,v.children),s.flags|=4096,s)}function ad(o,s,m){o.lanes|=s;var v=o.alternate;v!==null&&(v.lanes|=s),Pa(o.return,s,m)}function Ja(o,s,m,v,S){var I=o.memoizedState;I===null?o.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:S}:(I.isBackwards=s,I.rendering=null,I.renderingStartTime=0,I.last=v,I.tail=m,I.tailMode=S)}function bu(o,s,m){var v=s.pendingProps,S=v.revealOrder,I=v.tail;if(Ci(o,s,v.children,m),v=Y.current,(v&2)!==0)v=v&1|2,s.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=s.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&ad(o,m,s);else if(o.tag===19)ad(o,m,s);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}if(Or(Y,v),(s.mode&1)===0)s.memoizedState=null;else switch(S){case"forwards":for(m=s.child,S=null;m!==null;)o=m.alternate,o!==null&&J(o)===null&&(S=m),m=m.sibling;m=S,m===null?(S=s.child,s.child=null):(S=m.sibling,m.sibling=null),Ja(s,!1,S,m,I);break;case"backwards":for(m=null,S=s.child,s.child=null;S!==null;){if(o=S.alternate,o!==null&&J(o)===null){s.child=S;break}o=S.sibling,S.sibling=m,m=S,S=o}Ja(s,!0,m,null,I);break;case"together":Ja(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ph(o,s){(s.mode&1)===0&&o!==null&&(o.alternate=null,s.alternate=null,s.flags|=2)}function es(o,s,m){if(o!==null&&(s.dependencies=o.dependencies),wl|=s.lanes,(m&s.childLanes)===0)return null;if(o!==null&&s.child!==o.child)throw Error(z(153));if(s.child!==null){for(o=s.child,m=Yo(o,o.pendingProps),s.child=m,m.return=s;o.sibling!==null;)o=o.sibling,m=m.sibling=Yo(o,o.pendingProps),m.return=s;m.sibling=null}return s.child}function Dp(o,s,m){switch(s.tag){case 3:Vd(s),si();break;case 5:U(s);break;case 1:_n(s.type)&&ba(s);break;case 4:O(s,s.stateNode.containerInfo);break;case 10:var v=s.type._context,S=s.memoizedProps.value;Or(Ji,v._currentValue),v._currentValue=S;break;case 13:if(v=s.memoizedState,v!==null)return v.dehydrated!==null?(Or(Y,Y.current&1),s.flags|=128,null):(m&s.child.childLanes)!==0?$d(o,s,m):(Or(Y,Y.current&1),o=es(o,s,m),o!==null?o.sibling:null);Or(Y,Y.current&1);break;case 19:if(v=(m&s.childLanes)!==0,(o.flags&128)!==0){if(v)return bu(o,s,m);s.flags|=128}if(S=s.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),Or(Y,Y.current),v)break;return null;case 22:case 23:return s.lanes=0,dh(o,s,m)}return es(o,s,m)}var Ud,sd,Zd,Gd;Ud=function(o,s){for(var m=s.child;m!==null;){if(m.tag===5||m.tag===6)o.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===s)break;for(;m.sibling===null;){if(m.return===null||m.return===s)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},sd=function(){},Zd=function(o,s,m,v){var S=o.memoizedProps;if(S!==v){o=s.stateNode,D(w.current);var I=null;switch(m){case"input":S=Ar(o,S),v=Ar(o,v),I=[];break;case"select":S=rt({},S,{value:void 0}),v=rt({},v,{value:void 0}),I=[];break;case"textarea":S=Nn(o,S),v=Nn(o,v),I=[];break;default:typeof S.onClick!="function"&&typeof v.onClick=="function"&&(o.onclick=Es)}R(m,v);var G;m=null;for(Le in S)if(!v.hasOwnProperty(Le)&&S.hasOwnProperty(Le)&&S[Le]!=null)if(Le==="style"){var oe=S[Le];for(G in oe)oe.hasOwnProperty(G)&&(m||(m={}),m[G]="")}else Le!=="dangerouslySetInnerHTML"&&Le!=="children"&&Le!=="suppressContentEditableWarning"&&Le!=="suppressHydrationWarning"&&Le!=="autoFocus"&&(W.hasOwnProperty(Le)?I||(I=[]):(I=I||[]).push(Le,null));for(Le in v){var ge=v[Le];if(oe=S!=null?S[Le]:void 0,v.hasOwnProperty(Le)&&ge!==oe&&(ge!=null||oe!=null))if(Le==="style")if(oe){for(G in oe)!oe.hasOwnProperty(G)||ge&&ge.hasOwnProperty(G)||(m||(m={}),m[G]="");for(G in ge)ge.hasOwnProperty(G)&&oe[G]!==ge[G]&&(m||(m={}),m[G]=ge[G])}else m||(I||(I=[]),I.push(Le,m)),m=ge;else Le==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,oe=oe?oe.__html:void 0,ge!=null&&oe!==ge&&(I=I||[]).push(Le,ge)):Le==="children"?typeof ge!="string"&&typeof ge!="number"||(I=I||[]).push(Le,""+ge):Le!=="suppressContentEditableWarning"&&Le!=="suppressHydrationWarning"&&(W.hasOwnProperty(Le)?(ge!=null&&Le==="onScroll"&&Hr("scroll",o),I||oe===ge||(I=[])):(I=I||[]).push(Le,ge))}m&&(I=I||[]).push("style",m);var Le=I;(s.updateQueue=Le)&&(s.flags|=4)}},Gd=function(o,s,m,v){m!==v&&(s.flags|=4)};function _l(o,s){if(!xr)switch(o.tailMode){case"hidden":s=o.tail;for(var m=null;s!==null;)s.alternate!==null&&(m=s),s=s.sibling;m===null?o.tail=null:m.sibling=null;break;case"collapsed":m=o.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?s||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function Ei(o){var s=o.alternate!==null&&o.alternate.child===o.child,m=0,v=0;if(s)for(var S=o.child;S!==null;)m|=S.lanes|S.childLanes,v|=S.subtreeFlags&14680064,v|=S.flags&14680064,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)m|=S.lanes|S.childLanes,v|=S.subtreeFlags,v|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=v,o.childLanes=m,s}function qd(o,s,m){var v=s.pendingProps;switch(dl(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(s),null;case 1:return _n(s.type)&&ks(),Ei(s),null;case 3:return v=s.stateNode,$(),qr(En),qr(mn),le(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(o===null||o.child===null)&&(Ln(s)?s.flags|=4:o===null||o.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,xi!==null&&(Iu(xi),xi=null))),sd(o,s),Ei(s),null;case 5:Q(s);var S=D(A.current);if(m=s.type,o!==null&&s.stateNode!=null)Zd(o,s,m,v,S),o.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!v){if(s.stateNode===null)throw Error(z(166));return Ei(s),null}if(o=D(w.current),Ln(s)){v=s.stateNode,m=s.type;var I=s.memoizedProps;switch(v[co]=s,v[Is]=I,o=(s.mode&1)!==0,m){case"dialog":Hr("cancel",v),Hr("close",v);break;case"iframe":case"object":case"embed":Hr("load",v);break;case"video":case"audio":for(S=0;S<da.length;S++)Hr(da[S],v);break;case"source":Hr("error",v);break;case"img":case"image":case"link":Hr("error",v),Hr("load",v);break;case"details":Hr("toggle",v);break;case"input":di(v,I),Hr("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!I.multiple},Hr("invalid",v);break;case"textarea":Ui(v,I),Hr("invalid",v)}R(m,I),S=null;for(var G in I)if(I.hasOwnProperty(G)){var oe=I[G];G==="children"?typeof oe=="string"?v.textContent!==oe&&(I.suppressHydrationWarning!==!0&&Cs(v.textContent,oe,o),S=["children",oe]):typeof oe=="number"&&v.textContent!==""+oe&&(I.suppressHydrationWarning!==!0&&Cs(v.textContent,oe,o),S=["children",""+oe]):W.hasOwnProperty(G)&&oe!=null&&G==="onScroll"&&Hr("scroll",v)}switch(m){case"input":or(v),tn(v,I,!0);break;case"textarea":or(v),wo(v);break;case"select":case"option":break;default:typeof I.onClick=="function"&&(v.onclick=Es)}v=S,s.updateQueue=v,v!==null&&(s.flags|=4)}else{G=S.nodeType===9?S:S.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Zi(m)),o==="http://www.w3.org/1999/xhtml"?m==="script"?(o=G.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof v.is=="string"?o=G.createElement(m,{is:v.is}):(o=G.createElement(m),m==="select"&&(G=o,v.multiple?G.multiple=!0:v.size&&(G.size=v.size))):o=G.createElementNS(o,m),o[co]=s,o[Is]=v,Ud(o,s,!1,!1),s.stateNode=o;e:{switch(G=q(m,v),m){case"dialog":Hr("cancel",o),Hr("close",o),S=v;break;case"iframe":case"object":case"embed":Hr("load",o),S=v;break;case"video":case"audio":for(S=0;S<da.length;S++)Hr(da[S],o);S=v;break;case"source":Hr("error",o),S=v;break;case"img":case"image":case"link":Hr("error",o),Hr("load",o),S=v;break;case"details":Hr("toggle",o),S=v;break;case"input":di(o,v),S=Ar(o,v),Hr("invalid",o);break;case"option":S=v;break;case"select":o._wrapperState={wasMultiple:!!v.multiple},S=rt({},v,{value:void 0}),Hr("invalid",o);break;case"textarea":Ui(o,v),S=Nn(o,v),Hr("invalid",o);break;default:S=v}R(m,S),oe=S;for(I in oe)if(oe.hasOwnProperty(I)){var ge=oe[I];I==="style"?Ai(o,ge):I==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&fi(o,ge)):I==="children"?typeof ge=="string"?(m!=="textarea"||ge!=="")&&mi(o,ge):typeof ge=="number"&&mi(o,""+ge):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(W.hasOwnProperty(I)?ge!=null&&I==="onScroll"&&Hr("scroll",o):ge!=null&&Jt(o,I,ge,G))}switch(m){case"input":or(o),tn(o,v,!1);break;case"textarea":or(o),wo(o);break;case"option":v.value!=null&&o.setAttribute("value",""+mt(v.value));break;case"select":o.multiple=!!v.multiple,I=v.value,I!=null?rn(o,!!v.multiple,I,!1):v.defaultValue!=null&&rn(o,!!v.multiple,v.defaultValue,!0);break;default:typeof S.onClick=="function"&&(o.onclick=Es)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Ei(s),null;case 6:if(o&&s.stateNode!=null)Gd(o,s,o.memoizedProps,v);else{if(typeof v!="string"&&s.stateNode===null)throw Error(z(166));if(m=D(A.current),D(w.current),Ln(s)){if(v=s.stateNode,m=s.memoizedProps,v[co]=s,(I=v.nodeValue!==m)&&(o=Dn,o!==null))switch(o.tag){case 3:Cs(v.nodeValue,m,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Cs(v.nodeValue,m,(o.mode&1)!==0)}I&&(s.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[co]=s,s.stateNode=v}return Ei(s),null;case 13:if(qr(Y),v=s.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(xr&&Di!==null&&(s.mode&1)!==0&&(s.flags&128)===0)gc(),si(),s.flags|=98560,I=!1;else if(I=Ln(s),v!==null&&v.dehydrated!==null){if(o===null){if(!I)throw Error(z(318));if(I=s.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error(z(317));I[co]=s}else si(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ei(s),I=!1}else xi!==null&&(Iu(xi),xi=null),I=!0;if(!I)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=m,s):(v=v!==null,v!==(o!==null&&o.memoizedState!==null)&&v&&(s.child.flags|=8192,(s.mode&1)!==0&&(o===null||(Y.current&1)!==0?kn===0&&(kn=3):xh())),s.updateQueue!==null&&(s.flags|=4),Ei(s),null);case 4:return $(),sd(o,s),o===null&&fa(s.stateNode.containerInfo),Ei(s),null;case 10:return pl(s.type._context),Ei(s),null;case 17:return _n(s.type)&&ks(),Ei(s),null;case 19:if(qr(Y),I=s.memoizedState,I===null)return Ei(s),null;if(v=(s.flags&128)!==0,G=I.rendering,G===null)if(v)_l(I,!1);else{if(kn!==0||o!==null&&(o.flags&128)!==0)for(o=s.child;o!==null;){if(G=J(o),G!==null){for(s.flags|=128,_l(I,!1),v=G.updateQueue,v!==null&&(s.updateQueue=v,s.flags|=4),s.subtreeFlags=0,v=m,m=s.child;m!==null;)I=m,o=v,I.flags&=14680066,G=I.alternate,G===null?(I.childLanes=0,I.lanes=o,I.child=null,I.subtreeFlags=0,I.memoizedProps=null,I.memoizedState=null,I.updateQueue=null,I.dependencies=null,I.stateNode=null):(I.childLanes=G.childLanes,I.lanes=G.lanes,I.child=G.child,I.subtreeFlags=0,I.deletions=null,I.memoizedProps=G.memoizedProps,I.memoizedState=G.memoizedState,I.updateQueue=G.updateQueue,I.type=G.type,o=G.dependencies,I.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),m=m.sibling;return Or(Y,Y.current&1|2),s.child}o=o.sibling}I.tail!==null&&Gr()>Pl&&(s.flags|=128,v=!0,_l(I,!1),s.lanes=4194304)}else{if(!v)if(o=J(G),o!==null){if(s.flags|=128,v=!0,m=o.updateQueue,m!==null&&(s.updateQueue=m,s.flags|=4),_l(I,!0),I.tail===null&&I.tailMode==="hidden"&&!G.alternate&&!xr)return Ei(s),null}else 2*Gr()-I.renderingStartTime>Pl&&m!==1073741824&&(s.flags|=128,v=!0,_l(I,!1),s.lanes=4194304);I.isBackwards?(G.sibling=s.child,s.child=G):(m=I.last,m!==null?m.sibling=G:s.child=G,I.last=G)}return I.tail!==null?(s=I.tail,I.rendering=s,I.tail=s.sibling,I.renderingStartTime=Gr(),s.sibling=null,m=Y.current,Or(Y,v?m&1|2:m&1),s):(Ei(s),null);case 22:case 23:return vh(),v=s.memoizedState!==null,o!==null&&o.memoizedState!==null!==v&&(s.flags|=8192),v&&(s.mode&1)!==0?(no&1073741824)!==0&&(Ei(s),s.subtreeFlags&6&&(s.flags|=8192)):Ei(s),null;case 24:return null;case 25:return null}throw Error(z(156,s.tag))}function Tc(o,s){switch(dl(s),s.tag){case 1:return _n(s.type)&&ks(),o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 3:return $(),qr(En),qr(mn),le(),o=s.flags,(o&65536)!==0&&(o&128)===0?(s.flags=o&-65537|128,s):null;case 5:return Q(s),null;case 13:if(qr(Y),o=s.memoizedState,o!==null&&o.dehydrated!==null){if(s.alternate===null)throw Error(z(340));si()}return o=s.flags,o&65536?(s.flags=o&-65537|128,s):null;case 19:return qr(Y),null;case 4:return $(),null;case 10:return pl(s.type._context),null;case 22:case 23:return vh(),null;case 24:return null;default:return null}}var fh=!1,vr=!1,wu=typeof WeakSet=="function"?WeakSet:Set,Dt=null;function ts(o,s){var m=o.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){un(o,s,v)}else m.current=null}function Tu(o,s,m){try{m()}catch(v){un(o,s,v)}}var Su=!1;function Wd(o,s){if(lu=Ba,o=tl(),Ts(o)){if("selectionStart"in o)var m={start:o.selectionStart,end:o.selectionEnd};else e:{m=(m=o.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var S=v.anchorOffset,I=v.focusNode;v=v.focusOffset;try{m.nodeType,I.nodeType}catch{m=null;break e}var G=0,oe=-1,ge=-1,Le=0,ot=0,ct=o,it=null;t:for(;;){for(var It;ct!==m||S!==0&&ct.nodeType!==3||(oe=G+S),ct!==I||v!==0&&ct.nodeType!==3||(ge=G+v),ct.nodeType===3&&(G+=ct.nodeValue.length),(It=ct.firstChild)!==null;)it=ct,ct=It;for(;;){if(ct===o)break t;if(it===m&&++Le===S&&(oe=G),it===I&&++ot===v&&(ge=G),(It=ct.nextSibling)!==null)break;ct=it,it=ct.parentNode}ct=It}m=oe===-1||ge===-1?null:{start:oe,end:ge}}else m=null}m=m||{start:0,end:0}}else m=null;for(Zo={focusedElem:o,selectionRange:m},Ba=!1,Dt=s;Dt!==null;)if(s=Dt,o=s.child,(s.subtreeFlags&1028)!==0&&o!==null)o.return=s,Dt=o;else for(;Dt!==null;){s=Dt;try{var Ot=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(Ot!==null){var jt=Ot.memoizedProps,wn=Ot.memoizedState,Ee=s.stateNode,ve=Ee.getSnapshotBeforeUpdate(s.elementType===s.type?jt:Pi(s.type,jt),wn);Ee.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:var Ie=s.stateNode.containerInfo;Ie.nodeType===1?Ie.textContent="":Ie.nodeType===9&&Ie.documentElement&&Ie.removeChild(Ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(ht){un(s,s.return,ht)}if(o=s.sibling,o!==null){o.return=s.return,Dt=o;break}Dt=s.return}return Ot=Su,Su=!1,Ot}function Pu(o,s,m){var v=s.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var S=v=v.next;do{if((S.tag&o)===o){var I=S.destroy;S.destroy=void 0,I!==void 0&&Tu(s,m,I)}S=S.next}while(S!==v)}}function Ls(o,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var m=s=s.next;do{if((m.tag&o)===o){var v=m.create;m.destroy=v()}m=m.next}while(m!==s)}}function Sc(o){var s=o.ref;if(s!==null){var m=o.stateNode;switch(o.tag){case 5:o=m;break;default:o=m}typeof s=="function"?s(o):s.current=o}}function yl(o){var s=o.alternate;s!==null&&(o.alternate=null,yl(s)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(s=o.stateNode,s!==null&&(delete s[co],delete s[Is],delete s[cu],delete s[ih],delete s[va])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Pc(o){return o.tag===5||o.tag===3||o.tag===4}function vl(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Pc(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function xl(o,s,m){var v=o.tag;if(v===5||v===6)o=o.stateNode,s?m.nodeType===8?m.parentNode.insertBefore(o,s):m.insertBefore(o,s):(m.nodeType===8?(s=m.parentNode,s.insertBefore(o,m)):(s=m,s.appendChild(o)),m=m._reactRootContainer,m!=null||s.onclick!==null||(s.onclick=Es));else if(v!==4&&(o=o.child,o!==null))for(xl(o,s,m),o=o.sibling;o!==null;)xl(o,s,m),o=o.sibling}function ld(o,s,m){var v=o.tag;if(v===5||v===6)o=o.stateNode,s?m.insertBefore(o,s):m.appendChild(o);else if(v!==4&&(o=o.child,o!==null))for(ld(o,s,m),o=o.sibling;o!==null;)ld(o,s,m),o=o.sibling}var Xn=null,li=!1;function Os(o,s,m){for(m=m.child;m!==null;)ud(o,s,m),m=m.sibling}function ud(o,s,m){if(To&&typeof To.onCommitFiberUnmount=="function")try{To.onCommitFiberUnmount(Bl,m)}catch{}switch(m.tag){case 5:vr||ts(m,s);case 6:var v=Xn,S=li;Xn=null,Os(o,s,m),Xn=v,li=S,Xn!==null&&(li?(o=Xn,m=m.stateNode,o.nodeType===8?o.parentNode.removeChild(m):o.removeChild(m)):Xn.removeChild(m.stateNode));break;case 18:Xn!==null&&(li?(o=Xn,m=m.stateNode,o.nodeType===8?sl(o.parentNode,m):o.nodeType===1&&sl(o,m),Gn(o)):sl(Xn,m.stateNode));break;case 4:v=Xn,S=li,Xn=m.stateNode.containerInfo,li=!0,Os(o,s,m),Xn=v,li=S;break;case 0:case 11:case 14:case 15:if(!vr&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){S=v=v.next;do{var I=S,G=I.destroy;I=I.tag,G!==void 0&&((I&2)!==0||(I&4)!==0)&&Tu(m,s,G),S=S.next}while(S!==v)}Os(o,s,m);break;case 1:if(!vr&&(ts(m,s),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(oe){un(m,s,oe)}Os(o,s,m);break;case 21:Os(o,s,m);break;case 22:m.mode&1?(vr=(v=vr)||m.memoizedState!==null,Os(o,s,m),vr=v):Os(o,s,m);break;default:Os(o,s,m)}}function Cu(o){var s=o.updateQueue;if(s!==null){o.updateQueue=null;var m=o.stateNode;m===null&&(m=o.stateNode=new wu),s.forEach(function(v){var S=ji.bind(null,o,v);m.has(v)||(m.add(v),v.then(S,S))})}}function yo(o,s){var m=s.deletions;if(m!==null)for(var v=0;v<m.length;v++){var S=m[v];try{var I=o,G=s,oe=G;e:for(;oe!==null;){switch(oe.tag){case 5:Xn=oe.stateNode,li=!1;break e;case 3:Xn=oe.stateNode.containerInfo,li=!0;break e;case 4:Xn=oe.stateNode.containerInfo,li=!0;break e}oe=oe.return}if(Xn===null)throw Error(z(160));ud(I,G,S),Xn=null,li=!1;var ge=S.alternate;ge!==null&&(ge.return=null),S.return=null}catch(Le){un(S,s,Le)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)cd(s,o),s=s.sibling}function cd(o,s){var m=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(yo(s,o),Ko(o),v&4){try{Pu(3,o,o.return),Ls(3,o)}catch(jt){un(o,o.return,jt)}try{Pu(5,o,o.return)}catch(jt){un(o,o.return,jt)}}break;case 1:yo(s,o),Ko(o),v&512&&m!==null&&ts(m,m.return);break;case 5:if(yo(s,o),Ko(o),v&512&&m!==null&&ts(m,m.return),o.flags&32){var S=o.stateNode;try{mi(S,"")}catch(jt){un(o,o.return,jt)}}if(v&4&&(S=o.stateNode,S!=null)){var I=o.memoizedProps,G=m!==null?m.memoizedProps:I,oe=o.type,ge=o.updateQueue;if(o.updateQueue=null,ge!==null)try{oe==="input"&&I.type==="radio"&&I.name!=null&&$i(S,I),q(oe,G);var Le=q(oe,I);for(G=0;G<ge.length;G+=2){var ot=ge[G],ct=ge[G+1];ot==="style"?Ai(S,ct):ot==="dangerouslySetInnerHTML"?fi(S,ct):ot==="children"?mi(S,ct):Jt(S,ot,ct,Le)}switch(oe){case"input":Tn(S,I);break;case"textarea":ao(S,I);break;case"select":var it=S._wrapperState.wasMultiple;S._wrapperState.wasMultiple=!!I.multiple;var It=I.value;It!=null?rn(S,!!I.multiple,It,!1):it!==!!I.multiple&&(I.defaultValue!=null?rn(S,!!I.multiple,I.defaultValue,!0):rn(S,!!I.multiple,I.multiple?[]:"",!1))}S[Is]=I}catch(jt){un(o,o.return,jt)}}break;case 6:if(yo(s,o),Ko(o),v&4){if(o.stateNode===null)throw Error(z(162));S=o.stateNode,I=o.memoizedProps;try{S.nodeValue=I}catch(jt){un(o,o.return,jt)}}break;case 3:if(yo(s,o),Ko(o),v&4&&m!==null&&m.memoizedState.isDehydrated)try{Gn(s.containerInfo)}catch(jt){un(o,o.return,jt)}break;case 4:yo(s,o),Ko(o);break;case 13:yo(s,o),Ko(o),S=o.child,S.flags&8192&&(I=S.memoizedState!==null,S.stateNode.isHidden=I,!I||S.alternate!==null&&S.alternate.memoizedState!==null||(dd=Gr())),v&4&&Cu(o);break;case 22:if(ot=m!==null&&m.memoizedState!==null,o.mode&1?(vr=(Le=vr)||ot,yo(s,o),vr=Le):yo(s,o),Ko(o),v&8192){if(Le=o.memoizedState!==null,(o.stateNode.isHidden=Le)&&!ot&&(o.mode&1)!==0)for(Dt=o,ot=o.child;ot!==null;){for(ct=Dt=ot;Dt!==null;){switch(it=Dt,It=it.child,it.tag){case 0:case 11:case 14:case 15:Pu(4,it,it.return);break;case 1:ts(it,it.return);var Ot=it.stateNode;if(typeof Ot.componentWillUnmount=="function"){v=it,m=it.return;try{s=v,Ot.props=s.memoizedProps,Ot.state=s.memoizedState,Ot.componentWillUnmount()}catch(jt){un(v,m,jt)}}break;case 5:ts(it,it.return);break;case 22:if(it.memoizedState!==null){Kd(ct);continue}}It!==null?(It.return=it,Dt=It):Kd(ct)}ot=ot.sibling}e:for(ot=null,ct=o;;){if(ct.tag===5){if(ot===null){ot=ct;try{S=ct.stateNode,Le?(I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none"):(oe=ct.stateNode,ge=ct.memoizedProps.style,G=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,oe.style.display=na("display",G))}catch(jt){un(o,o.return,jt)}}}else if(ct.tag===6){if(ot===null)try{ct.stateNode.nodeValue=Le?"":ct.memoizedProps}catch(jt){un(o,o.return,jt)}}else if((ct.tag!==22&&ct.tag!==23||ct.memoizedState===null||ct===o)&&ct.child!==null){ct.child.return=ct,ct=ct.child;continue}if(ct===o)break e;for(;ct.sibling===null;){if(ct.return===null||ct.return===o)break e;ot===ct&&(ot=null),ct=ct.return}ot===ct&&(ot=null),ct.sibling.return=ct.return,ct=ct.sibling}}break;case 19:yo(s,o),Ko(o),v&4&&Cu(o);break;case 21:break;default:yo(s,o),Ko(o)}}function Ko(o){var s=o.flags;if(s&2){try{e:{for(var m=o.return;m!==null;){if(Pc(m)){var v=m;break e}m=m.return}throw Error(z(160))}switch(v.tag){case 5:var S=v.stateNode;v.flags&32&&(mi(S,""),v.flags&=-33);var I=vl(o);ld(o,I,S);break;case 3:case 4:var G=v.stateNode.containerInfo,oe=vl(o);xl(o,oe,G);break;default:throw Error(z(161))}}catch(ge){un(o,o.return,ge)}o.flags&=-3}s&4096&&(o.flags&=-4097)}function Lp(o,s,m){Dt=o,Hd(o)}function Hd(o,s,m){for(var v=(o.mode&1)!==0;Dt!==null;){var S=Dt,I=S.child;if(S.tag===22&&v){var G=S.memoizedState!==null||fh;if(!G){var oe=S.alternate,ge=oe!==null&&oe.memoizedState!==null||vr;oe=fh;var Le=vr;if(fh=G,(vr=ge)&&!Le)for(Dt=S;Dt!==null;)G=Dt,ge=G.child,G.tag===22&&G.memoizedState!==null?Yd(S):ge!==null?(ge.return=G,Dt=ge):Yd(S);for(;I!==null;)Dt=I,Hd(I),I=I.sibling;Dt=S,fh=oe,vr=Le}Xd(o)}else(S.subtreeFlags&8772)!==0&&I!==null?(I.return=S,Dt=I):Xd(o)}}function Xd(o){for(;Dt!==null;){var s=Dt;if((s.flags&8772)!==0){var m=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:vr||Ls(5,s);break;case 1:var v=s.stateNode;if(s.flags&4&&!vr)if(m===null)v.componentDidMount();else{var S=s.elementType===s.type?m.memoizedProps:Pi(s.type,m.memoizedProps);v.componentDidUpdate(S,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var I=s.updateQueue;I!==null&&_(s,I,v);break;case 3:var G=s.updateQueue;if(G!==null){if(m=null,s.child!==null)switch(s.child.tag){case 5:m=s.child.stateNode;break;case 1:m=s.child.stateNode}_(s,G,m)}break;case 5:var oe=s.stateNode;if(m===null&&s.flags&4){m=oe;var ge=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&m.focus();break;case"img":ge.src&&(m.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var Le=s.alternate;if(Le!==null){var ot=Le.memoizedState;if(ot!==null){var ct=ot.dehydrated;ct!==null&&Gn(ct)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}vr||s.flags&512&&Sc(s)}catch(it){un(s,s.return,it)}}if(s===o){Dt=null;break}if(m=s.sibling,m!==null){m.return=s.return,Dt=m;break}Dt=s.return}}function Kd(o){for(;Dt!==null;){var s=Dt;if(s===o){Dt=null;break}var m=s.sibling;if(m!==null){m.return=s.return,Dt=m;break}Dt=s.return}}function Yd(o){for(;Dt!==null;){var s=Dt;try{switch(s.tag){case 0:case 11:case 15:var m=s.return;try{Ls(4,s)}catch(ge){un(s,m,ge)}break;case 1:var v=s.stateNode;if(typeof v.componentDidMount=="function"){var S=s.return;try{v.componentDidMount()}catch(ge){un(s,S,ge)}}var I=s.return;try{Sc(s)}catch(ge){un(s,I,ge)}break;case 5:var G=s.return;try{Sc(s)}catch(ge){un(s,G,ge)}}}catch(ge){un(s,s.return,ge)}if(s===o){Dt=null;break}var oe=s.sibling;if(oe!==null){oe.return=s.return,Dt=oe;break}Dt=s.return}}var hd=Math.ceil,Cc=Mt.ReactCurrentDispatcher,Ec=Mt.ReactCurrentOwner,vo=Mt.ReactCurrentBatchConfig,Cr=0,On=null,xn=null,Mn=0,no=0,bl=Qi(0),kn=0,rs=null,wl=0,Eu=0,Tl=0,Sl=null,io=null,dd=0,Pl=1/0,ka=null,mh=!1,pd=null,Do=null,Ic=!1,Fs=null,gh=0,Mc=0,fd=null,_h=-1,yh=0;function Ii(){return(Cr&6)!==0?Gr():_h!==-1?_h:_h=Gr()}function Aa(o){return(o.mode&1)===0?1:(Cr&2)!==0&&Mn!==0?Mn&-Mn:ko.transition!==null?(yh===0&&(yh=gi()),yh):(o=ar,o!==0||(o=window.event,o=o===void 0?16:Ul(o.type)),o)}function Lo(o,s,m,v){if(50<Mc)throw Mc=0,fd=null,Error(z(185));ur(o,m,v),((Cr&2)===0||o!==On)&&(o===On&&((Cr&2)===0&&(Eu|=m),kn===4&&ns(o,Mn)),Bi(o,v),m===1&&Cr===0&&(s.mode&1)===0&&(Pl=Gr()+500,Ha&&Mo()))}function Bi(o,s){var m=o.callbackNode;lo(o,s);var v=fs(o,o===On?Mn:0);if(v===0)m!==null&&cs(m),o.callbackNode=null,o.callbackPriority=0;else if(s=v&-v,o.callbackPriority!==s){if(m!=null&&cs(m),s===1)o.tag===0?oh(Qd.bind(null,o)):ul(Qd.bind(null,o)),fc(function(){(Cr&6)===0&&Mo()}),m=null;else{switch(Sn(v)){case 1:m=Fl;break;case 4:m=Nu;break;case 16:m=Bo;break;case 536870912:m=$c;break;default:m=Bo}m=vd(m,md.bind(null,o))}o.callbackPriority=s,o.callbackNode=m}}function md(o,s){if(_h=-1,yh=0,(Cr&6)!==0)throw Error(z(327));var m=o.callbackNode;if(js()&&o.callbackNode!==m)return null;var v=fs(o,o===On?Mn:0);if(v===0)return null;if((v&30)!==0||(v&o.expiredLanes)!==0||s)s=ku(o,v);else{s=v;var S=Cr;Cr|=2;var I=Mu();(On!==o||Mn!==s)&&(ka=null,Pl=Gr()+500,El(o,s));do try{bn();break}catch(oe){Jd(o,oe)}while(!0);Qa(),Cc.current=I,Cr=S,xn!==null?s=0:(On=null,Mn=0,s=kn)}if(s!==0){if(s===2&&(S=fr(o),S!==0&&(v=S,s=gd(o,S))),s===1)throw m=rs,El(o,0),ns(o,v),Bi(o,Gr()),m;if(s===6)ns(o,v);else{if(S=o.current.alternate,(v&30)===0&&!Op(S)&&(s=ku(o,v),s===2&&(I=fr(o),I!==0&&(v=I,s=gd(o,I))),s===1))throw m=rs,El(o,0),ns(o,v),Bi(o,Gr()),m;switch(o.finishedWork=S,o.finishedLanes=v,s){case 0:case 1:throw Error(z(345));case 2:Bs(o,io,ka);break;case 3:if(ns(o,v),(v&130023424)===v&&(s=dd+500-Gr(),10<s)){if(fs(o,0)!==0)break;if(S=o.suspendedLanes,(S&v)!==v){Ii(),o.pingedLanes|=o.suspendedLanes&S;break}o.timeoutHandle=ya(Bs.bind(null,o,io,ka),s);break}Bs(o,io,ka);break;case 4:if(ns(o,v),(v&4194240)===v)break;for(s=o.eventTimes,S=-1;0<v;){var G=31-Vn(v);I=1<<G,G=s[G],G>S&&(S=G),v&=~I}if(v=S,v=Gr()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*hd(v/1960))-v,10<v){o.timeoutHandle=ya(Bs.bind(null,o,io,ka),v);break}Bs(o,io,ka);break;case 5:Bs(o,io,ka);break;default:throw Error(z(329))}}}return Bi(o,Gr()),o.callbackNode===m?md.bind(null,o):null}function gd(o,s){var m=Sl;return o.current.memoizedState.isDehydrated&&(El(o,s).flags|=256),o=ku(o,s),o!==2&&(s=io,io=m,s!==null&&Iu(s)),o}function Iu(o){io===null?io=o:io.push.apply(io,o)}function Op(o){for(var s=o;;){if(s.flags&16384){var m=s.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var S=m[v],I=S.getSnapshot;S=S.value;try{if(!Qr(I(),S))return!1}catch{return!1}}}if(m=s.child,s.subtreeFlags&16384&&m!==null)m.return=s,s=m;else{if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ns(o,s){for(s&=~Tl,s&=~Eu,o.suspendedLanes|=s,o.pingedLanes&=~s,o=o.expirationTimes;0<s;){var m=31-Vn(s),v=1<<m;o[m]=-1,s&=~v}}function Qd(o){if((Cr&6)!==0)throw Error(z(327));js();var s=fs(o,0);if((s&1)===0)return Bi(o,Gr()),null;var m=ku(o,s);if(o.tag!==0&&m===2){var v=fr(o);v!==0&&(s=v,m=gd(o,v))}if(m===1)throw m=rs,El(o,0),ns(o,s),Bi(o,Gr()),m;if(m===6)throw Error(z(345));return o.finishedWork=o.current.alternate,o.finishedLanes=s,Bs(o,io,ka),Bi(o,Gr()),null}function _d(o,s){var m=Cr;Cr|=1;try{return o(s)}finally{Cr=m,Cr===0&&(Pl=Gr()+500,Ha&&Mo())}}function Cl(o){Fs!==null&&Fs.tag===0&&(Cr&6)===0&&js();var s=Cr;Cr|=1;var m=vo.transition,v=ar;try{if(vo.transition=null,ar=1,o)return o()}finally{ar=v,vo.transition=m,Cr=s,(Cr&6)===0&&Mo()}}function vh(){no=bl.current,qr(bl)}function El(o,s){o.finishedWork=null,o.finishedLanes=0;var m=o.timeoutHandle;if(m!==-1&&(o.timeoutHandle=-1,rh(m)),xn!==null)for(m=xn.return;m!==null;){var v=m;switch(dl(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&ks();break;case 3:$(),qr(En),qr(mn),le();break;case 5:Q(v);break;case 4:$();break;case 13:qr(Y);break;case 19:qr(Y);break;case 10:pl(v.type._context);break;case 22:case 23:vh()}m=m.return}if(On=o,xn=o=Yo(o.current,null),Mn=no=s,kn=0,rs=null,Tl=Eu=wl=0,io=Sl=null,Ao!==null){for(s=0;s<Ao.length;s++)if(m=Ao[s],v=m.interleaved,v!==null){m.interleaved=null;var S=v.next,I=m.pending;if(I!==null){var G=I.next;I.next=S,v.next=G}m.pending=v}Ao=null}return o}function Jd(o,s){do{var m=xn;try{if(Qa(),ue.current=ml,Fe){for(var v=se.memoizedState;v!==null;){var S=v.queue;S!==null&&(S.pending=null),v=v.next}Fe=!1}if(pe=0,we=be=se=null,je=!1,Oe=0,Ec.current=null,m===null||m.return===null){kn=1,rs=s,xn=null;break}e:{var I=o,G=m.return,oe=m,ge=s;if(s=Mn,oe.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Le=ge,ot=oe,ct=ot.tag;if((ot.mode&1)===0&&(ct===0||ct===11||ct===15)){var it=ot.alternate;it?(ot.updateQueue=it.updateQueue,ot.memoizedState=it.memoizedState,ot.lanes=it.lanes):(ot.updateQueue=null,ot.memoizedState=null)}var It=Fd(G);if(It!==null){It.flags&=-257,Bd(It,G,oe,I,s),It.mode&1&&Qh(I,Le,s),s=It,ge=Le;var Ot=s.updateQueue;if(Ot===null){var jt=new Set;jt.add(ge),s.updateQueue=jt}else Ot.add(ge);break e}else{if((s&1)===0){Qh(I,Le,s),xh();break e}ge=Error(z(426))}}else if(xr&&oe.mode&1){var wn=Fd(G);if(wn!==null){(wn.flags&65536)===0&&(wn.flags|=256),Bd(wn,G,oe,I,s),_c(Xo(ge,oe));break e}}I=ge=Xo(ge,oe),kn!==4&&(kn=2),Sl===null?Sl=[I]:Sl.push(I),I=G;do{switch(I.tag){case 3:I.flags|=65536,s&=-s,I.lanes|=s;var Ee=bc(I,ge,s);u(I,Ee);break e;case 1:oe=ge;var ve=I.type,Ie=I.stateNode;if((I.flags&128)===0&&(typeof ve.getDerivedStateFromError=="function"||Ie!==null&&typeof Ie.componentDidCatch=="function"&&(Do===null||!Do.has(Ie)))){I.flags|=65536,s&=-s,I.lanes|=s;var ht=Yh(I,oe,s);u(I,ht);break e}}I=I.return}while(I!==null)}tp(m)}catch(Ut){s=Ut,xn===m&&m!==null&&(xn=m=m.return);continue}break}while(!0)}function Mu(){var o=Cc.current;return Cc.current=ml,o===null?ml:o}function xh(){(kn===0||kn===3||kn===2)&&(kn=4),On===null||(wl&268435455)===0&&(Eu&268435455)===0||ns(On,Mn)}function ku(o,s){var m=Cr;Cr|=2;var v=Mu();(On!==o||Mn!==s)&&(ka=null,El(o,s));do try{ep();break}catch(S){Jd(o,S)}while(!0);if(Qa(),Cr=m,Cc.current=v,xn!==null)throw Error(z(261));return On=null,Mn=0,kn}function ep(){for(;xn!==null;)bh(xn)}function bn(){for(;xn!==null&&!Bu();)bh(xn)}function bh(o){var s=wh(o.alternate,o,no);o.memoizedProps=o.pendingProps,s===null?tp(o):xn=s,Ec.current=null}function tp(o){var s=o;do{var m=s.alternate;if(o=s.return,(s.flags&32768)===0){if(m=qd(m,s,no),m!==null){xn=m;return}}else{if(m=Tc(m,s),m!==null){m.flags&=32767,xn=m;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{kn=6,xn=null;return}}if(s=s.sibling,s!==null){xn=s;return}xn=s=o}while(s!==null);kn===0&&(kn=5)}function Bs(o,s,m){var v=ar,S=vo.transition;try{vo.transition=null,ar=1,yd(o,s,m,v)}finally{vo.transition=S,ar=v}return null}function yd(o,s,m,v){do js();while(Fs!==null);if((Cr&6)!==0)throw Error(z(327));m=o.finishedWork;var S=o.finishedLanes;if(m===null)return null;if(o.finishedWork=null,o.finishedLanes=0,m===o.current)throw Error(z(177));o.callbackNode=null,o.callbackPriority=0;var I=m.lanes|m.childLanes;if(jl(o,I),o===On&&(xn=On=null,Mn=0),(m.subtreeFlags&2064)===0&&(m.flags&2064)===0||Ic||(Ic=!0,vd(Bo,function(){return js(),null})),I=(m.flags&15990)!==0,(m.subtreeFlags&15990)!==0||I){I=vo.transition,vo.transition=null;var G=ar;ar=1;var oe=Cr;Cr|=4,Ec.current=null,Wd(o,m),cd(m,o),rl(Zo),Ba=!!lu,Zo=lu=null,o.current=m,Lp(m),ia(),Cr=oe,ar=G,vo.transition=I}else o.current=m;if(Ic&&(Ic=!1,Fs=o,gh=S),I=o.pendingLanes,I===0&&(Do=null),Vu(m.stateNode),Bi(o,Gr()),s!==null)for(v=o.onRecoverableError,m=0;m<s.length;m++)S=s[m],v(S.value,{componentStack:S.stack,digest:S.digest});if(mh)throw mh=!1,o=pd,pd=null,o;return(gh&1)!==0&&o.tag!==0&&js(),I=o.pendingLanes,(I&1)!==0?o===fd?Mc++:(Mc=0,fd=o):Mc=0,Mo(),null}function js(){if(Fs!==null){var o=Sn(gh),s=vo.transition,m=ar;try{if(vo.transition=null,ar=16>o?16:o,Fs===null)var v=!1;else{if(o=Fs,Fs=null,gh=0,(Cr&6)!==0)throw Error(z(331));var S=Cr;for(Cr|=4,Dt=o.current;Dt!==null;){var I=Dt,G=I.child;if((Dt.flags&16)!==0){var oe=I.deletions;if(oe!==null){for(var ge=0;ge<oe.length;ge++){var Le=oe[ge];for(Dt=Le;Dt!==null;){var ot=Dt;switch(ot.tag){case 0:case 11:case 15:Pu(8,ot,I)}var ct=ot.child;if(ct!==null)ct.return=ot,Dt=ct;else for(;Dt!==null;){ot=Dt;var it=ot.sibling,It=ot.return;if(yl(ot),ot===Le){Dt=null;break}if(it!==null){it.return=It,Dt=it;break}Dt=It}}}var Ot=I.alternate;if(Ot!==null){var jt=Ot.child;if(jt!==null){Ot.child=null;do{var wn=jt.sibling;jt.sibling=null,jt=wn}while(jt!==null)}}Dt=I}}if((I.subtreeFlags&2064)!==0&&G!==null)G.return=I,Dt=G;else e:for(;Dt!==null;){if(I=Dt,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:Pu(9,I,I.return)}var Ee=I.sibling;if(Ee!==null){Ee.return=I.return,Dt=Ee;break e}Dt=I.return}}var ve=o.current;for(Dt=ve;Dt!==null;){G=Dt;var Ie=G.child;if((G.subtreeFlags&2064)!==0&&Ie!==null)Ie.return=G,Dt=Ie;else e:for(G=ve;Dt!==null;){if(oe=Dt,(oe.flags&2048)!==0)try{switch(oe.tag){case 0:case 11:case 15:Ls(9,oe)}}catch(Ut){un(oe,oe.return,Ut)}if(oe===G){Dt=null;break e}var ht=oe.sibling;if(ht!==null){ht.return=oe.return,Dt=ht;break e}Dt=oe.return}}if(Cr=S,Mo(),To&&typeof To.onPostCommitFiberRoot=="function")try{To.onPostCommitFiberRoot(Bl,o)}catch{}v=!0}return v}finally{ar=m,vo.transition=s}}return!1}function rp(o,s,m){s=Xo(m,s),s=bc(o,s,1),o=r(o,s,1),s=Ii(),o!==null&&(ur(o,1,s),Bi(o,s))}function un(o,s,m){if(o.tag===3)rp(o,o,m);else for(;s!==null;){if(s.tag===3){rp(s,o,m);break}else if(s.tag===1){var v=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Do===null||!Do.has(v))){o=Xo(m,o),o=Yh(s,o,1),s=r(s,o,1),o=Ii(),s!==null&&(ur(s,1,o),Bi(s,o));break}}s=s.return}}function Fp(o,s,m){var v=o.pingCache;v!==null&&v.delete(s),s=Ii(),o.pingedLanes|=o.suspendedLanes&m,On===o&&(Mn&m)===m&&(kn===4||kn===3&&(Mn&130023424)===Mn&&500>Gr()-dd?El(o,0):Tl|=m),Bi(o,s)}function np(o,s){s===0&&((o.mode&1)===0?s=1:(s=ps,ps<<=1,(ps&130023424)===0&&(ps=4194304)));var m=Ii();o=fo(o,s),o!==null&&(ur(o,s,m),Bi(o,m))}function ip(o){var s=o.memoizedState,m=0;s!==null&&(m=s.retryLane),np(o,m)}function ji(o,s){var m=0;switch(o.tag){case 13:var v=o.stateNode,S=o.memoizedState;S!==null&&(m=S.retryLane);break;case 19:v=o.stateNode;break;default:throw Error(z(314))}v!==null&&v.delete(s),np(o,m)}var wh;wh=function(o,s,m){if(o!==null)if(o.memoizedProps!==s.pendingProps||En.current)Oi=!0;else{if((o.lanes&m)===0&&(s.flags&128)===0)return Oi=!1,Dp(o,s,m);Oi=(o.flags&131072)!==0}else Oi=!1,xr&&(s.flags&1048576)!==0&&cl(s,du,s.index);switch(s.lanes=0,s.tag){case 2:var v=s.type;ph(o,s),o=s.pendingProps;var S=ft(s,mn.current);to(s,m),S=Pt(null,s,v,o,S,m);var I=Rt();return s.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,_n(v)?(I=!0,ba(s)):I=!1,s.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,Ds(s),S.updater=yu,s.stateNode=S,S._reactInternals=s,uh(s,v,o,m),s=wc(null,s,v,!0,I,m)):(s.tag=0,xr&&I&&hl(s),Ci(null,s,S,m),s=s.child),s;case 16:v=s.elementType;e:{switch(ph(o,s),o=s.pendingProps,S=v._init,v=S(v._payload),s.type=v,S=s.tag=Au(v),o=Pi(v,o),S){case 0:s=Fi(null,s,v,o,m);break e;case 1:s=ed(null,s,v,o,m);break e;case 11:s=Nd(null,s,v,o,m);break e;case 14:s=hh(null,s,v,Pi(v.type,o),m);break e}throw Error(z(306,v,""))}return s;case 0:return v=s.type,S=s.pendingProps,S=s.elementType===v?S:Pi(v,S),Fi(o,s,v,S,m);case 1:return v=s.type,S=s.pendingProps,S=s.elementType===v?S:Pi(v,S),ed(o,s,v,S,m);case 3:e:{if(Vd(s),o===null)throw Error(z(387));v=s.pendingProps,I=s.memoizedState,S=I.element,d(o,s),p(s,v,null,m);var G=s.memoizedState;if(v=G.element,I.isDehydrated)if(I={element:v,isDehydrated:!1,cache:G.cache,pendingSuspenseBoundaries:G.pendingSuspenseBoundaries,transitions:G.transitions},s.updateQueue.baseState=I,s.memoizedState=I,s.flags&256){S=Xo(Error(z(423)),s),s=td(o,s,v,m,S);break e}else if(v!==S){S=Xo(Error(z(424)),s),s=td(o,s,v,m,S);break e}else for(Di=ai(s.stateNode.containerInfo.firstChild),Dn=s,xr=!0,xi=null,m=fu(s,null,v,m),s.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(si(),v===S){s=es(o,s,m);break e}Ci(o,s,v,m)}s=s.child}return s;case 5:return U(s),o===null&&zs(s),v=s.type,S=s.pendingProps,I=o!==null?o.memoizedProps:null,G=S.children,_a(v,S)?G=null:I!==null&&_a(v,I)&&(s.flags|=32),vu(o,s),Ci(o,s,G,m),s.child;case 6:return o===null&&zs(s),null;case 13:return $d(o,s,m);case 4:return O(s,s.stateNode.containerInfo),v=s.pendingProps,o===null?s.child=qo(s,null,v,m):Ci(o,s,v,m),s.child;case 11:return v=s.type,S=s.pendingProps,S=s.elementType===v?S:Pi(v,S),Nd(o,s,v,S,m);case 7:return Ci(o,s,s.pendingProps,m),s.child;case 8:return Ci(o,s,s.pendingProps.children,m),s.child;case 12:return Ci(o,s,s.pendingProps.children,m),s.child;case 10:e:{if(v=s.type._context,S=s.pendingProps,I=s.memoizedProps,G=S.value,Or(Ji,v._currentValue),v._currentValue=G,I!==null)if(Qr(I.value,G)){if(I.children===S.children&&!En.current){s=es(o,s,m);break e}}else for(I=s.child,I!==null&&(I.return=s);I!==null;){var oe=I.dependencies;if(oe!==null){G=I.child;for(var ge=oe.firstContext;ge!==null;){if(ge.context===v){if(I.tag===1){ge=e(-1,m&-m),ge.tag=2;var Le=I.updateQueue;if(Le!==null){Le=Le.shared;var ot=Le.pending;ot===null?ge.next=ge:(ge.next=ot.next,ot.next=ge),Le.pending=ge}}I.lanes|=m,ge=I.alternate,ge!==null&&(ge.lanes|=m),Pa(I.return,m,s),oe.lanes|=m;break}ge=ge.next}}else if(I.tag===10)G=I.type===s.type?null:I.child;else if(I.tag===18){if(G=I.return,G===null)throw Error(z(341));G.lanes|=m,oe=G.alternate,oe!==null&&(oe.lanes|=m),Pa(G,m,s),G=I.sibling}else G=I.child;if(G!==null)G.return=I;else for(G=I;G!==null;){if(G===s){G=null;break}if(I=G.sibling,I!==null){I.return=G.return,G=I;break}G=G.return}I=G}Ci(o,s,S.children,m),s=s.child}return s;case 9:return S=s.type,v=s.pendingProps.children,to(s,m),S=bi(S),v=v(S),s.flags|=1,Ci(o,s,v,m),s.child;case 14:return v=s.type,S=Pi(v,s.pendingProps),S=Pi(v.type,S),hh(o,s,v,S,m);case 15:return Jh(o,s,s.type,s.pendingProps,m);case 17:return v=s.type,S=s.pendingProps,S=s.elementType===v?S:Pi(v,S),ph(o,s),s.tag=1,_n(v)?(o=!0,ba(s)):o=!1,to(s,m),lh(s,v,S),uh(s,v,S,m),wc(null,s,v,!0,o,m);case 19:return bu(o,s,m);case 22:return dh(o,s,m)}throw Error(z(156,s.tag))};function vd(o,s){return Fu(o,s)}function Ns(o,s,m,v){this.tag=o,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ni(o,s,m,v){return new Ns(o,s,m,v)}function Il(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Au(o){if(typeof o=="function")return Il(o)?1:0;if(o!=null){if(o=o.$$typeof,o===Er)return 11;if(o===Nt)return 14}return 2}function Yo(o,s){var m=o.alternate;return m===null?(m=Ni(o.tag,s,o.key,o.mode),m.elementType=o.elementType,m.type=o.type,m.stateNode=o.stateNode,m.alternate=o,o.alternate=m):(m.pendingProps=s,m.type=o.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=o.flags&14680064,m.childLanes=o.childLanes,m.lanes=o.lanes,m.child=o.child,m.memoizedProps=o.memoizedProps,m.memoizedState=o.memoizedState,m.updateQueue=o.updateQueue,s=o.dependencies,m.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},m.sibling=o.sibling,m.index=o.index,m.ref=o.ref,m}function Ml(o,s,m,v,S,I){var G=2;if(v=o,typeof o=="function")Il(o)&&(G=1);else if(typeof o=="string")G=5;else e:switch(o){case pt:return kl(m.children,S,I,s);case Lt:G=8,S|=8;break;case Ct:return o=Ni(12,m,s,S|2),o.elementType=Ct,o.lanes=I,o;case _r:return o=Ni(13,m,s,S),o.elementType=_r,o.lanes=I,o;case Tt:return o=Ni(19,m,s,S),o.elementType=Tt,o.lanes=I,o;case _t:return Th(m,S,I,s);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case rr:G=10;break e;case sr:G=9;break e;case Er:G=11;break e;case Nt:G=14;break e;case bt:G=16,v=null;break e}throw Error(z(130,o==null?o:typeof o,""))}return s=Ni(G,m,s,S),s.elementType=o,s.type=v,s.lanes=I,s}function kl(o,s,m,v){return o=Ni(7,o,v,s),o.lanes=m,o}function Th(o,s,m,v){return o=Ni(22,o,v,s),o.elementType=_t,o.lanes=m,o.stateNode={isHidden:!1},o}function Sh(o,s,m){return o=Ni(6,o,null,s),o.lanes=m,o}function Ph(o,s,m){return s=Ni(4,o.children!==null?o.children:[],o.key,s),s.lanes=m,s.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},s}function Bp(o,s,m,v,S){this.tag=s,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_i(0),this.expirationTimes=_i(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_i(0),this.identifierPrefix=v,this.onRecoverableError=S,this.mutableSourceEagerHydrationData=null}function Ch(o,s,m,v,S,I,G,oe,ge){return o=new Bp(o,s,m,oe,ge),s===1?(s=1,I===!0&&(s|=8)):s=0,I=Ni(3,null,null,s),o.current=I,I.stateNode=o,I.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ds(I),o}function op(o,s,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Je,key:v==null?null:""+v,children:o,containerInfo:s,implementation:m}}function Eh(o){if(!o)return xa;o=o._reactInternals;e:{if(Zr(o)!==o||o.tag!==1)throw Error(z(170));var s=o;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(_n(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(z(171))}if(o.tag===1){var m=o.type;if(_n(m))return Go(o,m,s)}return s}function Ih(o,s,m,v,S,I,G,oe,ge){return o=Ch(m,v,!0,o,S,I,G,oe,ge),o.context=Eh(null),m=o.current,v=Ii(),S=Aa(m),I=e(v,S),I.callback=s??null,r(m,I,S),o.current.lanes=S,ur(o,S,v),Bi(o,v),o}function Mh(o,s,m,v){var S=s.current,I=Ii(),G=Aa(S);return m=Eh(m),s.context===null?s.context=m:s.pendingContext=m,s=e(I,G),s.payload={element:o},v=v===void 0?null:v,v!==null&&(s.callback=v),o=r(S,s,G),o!==null&&(Lo(o,S,G,I),l(o,S,G)),G}function kc(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function ap(o,s){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var m=o.retryLane;o.retryLane=m!==0&&m<s?m:s}}function xd(o,s){ap(o,s),(o=o.alternate)&&ap(o,s)}function jp(){return null}var sp=typeof reportError=="function"?reportError:function(o){console.error(o)};function bd(o){this._internalRoot=o}Ac.prototype.render=bd.prototype.render=function(o){var s=this._internalRoot;if(s===null)throw Error(z(409));Mh(o,s,null,null)},Ac.prototype.unmount=bd.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var s=o.containerInfo;Cl(function(){Mh(null,o,null,null)}),s[Io]=null}};function Ac(o){this._internalRoot=o}Ac.prototype.unstable_scheduleHydration=function(o){if(o){var s=hn();o={blockedOn:null,target:o,priority:s};for(var m=0;m<dn.length&&s!==0&&s<dn[m].priority;m++);dn.splice(m,0,o),m===0&&hr(o)}};function kh(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Vs(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function Qo(){}function $s(o,s,m,v,S){if(S){if(typeof v=="function"){var I=v;v=function(){var Le=kc(G);I.call(Le)}}var G=Ih(s,v,o,0,null,!1,!1,"",Qo);return o._reactRootContainer=G,o[Io]=G.current,fa(o.nodeType===8?o.parentNode:o),Cl(),G}for(;S=o.lastChild;)o.removeChild(S);if(typeof v=="function"){var oe=v;v=function(){var Le=kc(ge);oe.call(Le)}}var ge=Ch(o,0,!1,null,null,!1,!1,"",Qo);return o._reactRootContainer=ge,o[Io]=ge.current,fa(o.nodeType===8?o.parentNode:o),Cl(function(){Mh(s,ge,m,v)}),ge}function zc(o,s,m,v,S){var I=m._reactRootContainer;if(I){var G=I;if(typeof S=="function"){var oe=S;S=function(){var ge=kc(G);oe.call(ge)}}Mh(s,G,o,S)}else G=$s(m,s,o,S,v);return kc(G)}cn=function(o){switch(o.tag){case 3:var s=o.stateNode;if(s.current.memoizedState.isDehydrated){var m=oa(s.pendingLanes);m!==0&&(qs(s,m|1),Bi(s,Gr()),(Cr&6)===0&&(Pl=Gr()+500,Mo()))}break;case 13:Cl(function(){var v=fo(o,1);if(v!==null){var S=Ii();Lo(v,o,1,S)}}),xd(o,1)}},Wr=function(o){if(o.tag===13){var s=fo(o,134217728);if(s!==null){var m=Ii();Lo(s,o,134217728,m)}xd(o,134217728)}},Nl=function(o){if(o.tag===13){var s=Aa(o),m=fo(o,s);if(m!==null){var v=Ii();Lo(m,o,s,v)}xd(o,s)}},hn=function(){return ar},$n=function(o,s){var m=ar;try{return ar=o,s()}finally{ar=m}},he=function(o,s,m){switch(s){case"input":if(Tn(o,m),s=m.name,m.type==="radio"&&s!=null){for(m=o;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<m.length;s++){var v=m[s];if(v!==o&&v.form===o.form){var S=Ms(v);if(!S)throw Error(z(90));Mr(v),Tn(v,S)}}}break;case"textarea":ao(o,m);break;case"select":s=m.value,s!=null&&rn(o,!!m.multiple,s,!1)}},Te=_d,We=Cl;var wd={usingClientEntryPoint:!1,Events:[Vr,fn,Ms,Ne,De,_d]},Rc={findFiberByHostInstance:Ki,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Np={bundleType:Rc.bundleType,version:Rc.version,rendererPackageName:Rc.rendererPackageName,rendererConfig:Rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mt.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=ii(o),o===null?null:o.stateNode},findFiberByHostInstance:Rc.findFiberByHostInstance||jp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Al.isDisabled&&Al.supportsFiber)try{Bl=Al.inject(Np),To=Al}catch{}}return Oo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wd,Oo.createPortal=function(o,s){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kh(s))throw Error(z(200));return op(o,s,null,m)},Oo.createRoot=function(o,s){if(!kh(o))throw Error(z(299));var m=!1,v="",S=sp;return s!=null&&(s.unstable_strictMode===!0&&(m=!0),s.identifierPrefix!==void 0&&(v=s.identifierPrefix),s.onRecoverableError!==void 0&&(S=s.onRecoverableError)),s=Ch(o,1,!1,null,null,m,!1,v,S),o[Io]=s.current,fa(o.nodeType===8?o.parentNode:o),new bd(s)},Oo.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var s=o._reactInternals;if(s===void 0)throw typeof o.render=="function"?Error(z(188)):(o=Object.keys(o).join(","),Error(z(268,o)));return o=ii(s),o=o===null?null:o.stateNode,o},Oo.flushSync=function(o){return Cl(o)},Oo.hydrate=function(o,s,m){if(!Vs(s))throw Error(z(200));return zc(null,o,s,!0,m)},Oo.hydrateRoot=function(o,s,m){if(!kh(o))throw Error(z(405));var v=m!=null&&m.hydratedSources||null,S=!1,I="",G=sp;if(m!=null&&(m.unstable_strictMode===!0&&(S=!0),m.identifierPrefix!==void 0&&(I=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),s=Ih(s,null,o,1,m??null,S,!1,I,G),o[Io]=s.current,fa(o),v)for(o=0;o<v.length;o++)m=v[o],S=m._getVersion,S=S(m._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[m,S]:s.mutableSourceEagerHydrationData.push(m,S);return new Ac(s)},Oo.render=function(o,s,m){if(!Vs(s))throw Error(z(200));return zc(null,o,s,!1,m)},Oo.unmountComponentAtNode=function(o){if(!Vs(o))throw Error(z(40));return o._reactRootContainer?(Cl(function(){zc(null,null,o,!1,function(){o._reactRootContainer=null,o[Io]=null})}),!0):!1},Oo.unstable_batchedUpdates=_d,Oo.unstable_renderSubtreeIntoContainer=function(o,s,m,v){if(!Vs(m))throw Error(z(200));if(o==null||o._reactInternals===void 0)throw Error(z(38));return zc(o,s,m,!1,v)},Oo.version="18.3.1-next-f1338f8080-20240426",Oo}var Vm;function Ty(){if(Vm)return tf.exports;Vm=1;function E(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E)}catch(L){console.error(L)}}return E(),tf.exports=wy(),tf.exports}var $m;function Sy(){if($m)return fp;$m=1;var E=Ty();return fp.createRoot=E.createRoot,fp.hydrateRoot=E.hydrateRoot,fp}var Py=Sy(),Du=kp();const ti=Ad(Du);var of={exports:{}},af={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var Um;function Cy(){return Um||(Um=1,function(E){(function(){var L={}.hasOwnProperty;function z(){for(var ne="",M=0;M<arguments.length;M++){var h=arguments[M];h&&(ne=W(ne,V(h)))}return ne}function V(ne){if(typeof ne=="string"||typeof ne=="number")return ne;if(typeof ne!="object")return"";if(Array.isArray(ne))return z.apply(null,ne);if(ne.toString!==Object.prototype.toString&&!ne.toString.toString().includes("[native code]"))return ne.toString();var M="";for(var h in ne)L.call(ne,h)&&ne[h]&&(M=W(M,h));return M}function W(ne,M){return M?ne?ne+" "+M:ne+M:ne}E.exports?(z.default=z,E.exports=z):window.classNames=z})()}(af)),af.exports}var sf={exports:{}},lf,Zm;function Ey(){if(Zm)return lf;Zm=1;var E="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return lf=E,lf}var uf,Gm;function Iy(){if(Gm)return uf;Gm=1;var E=Ey();function L(){}function z(){}return z.resetWarningCache=L,uf=function(){function V(M,h,Me,Ze,qe,Ve){if(Ve!==E){var ze=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw ze.name="Invariant Violation",ze}}V.isRequired=V;function W(){return V}var ne={array:V,bigint:V,bool:V,func:V,number:V,object:V,string:V,symbol:V,any:V,arrayOf:W,element:V,elementType:V,instanceOf:W,node:V,objectOf:W,oneOf:W,oneOfType:W,shape:W,exact:W,checkPropTypes:z,resetWarningCache:L};return ne.PropTypes=ne,ne},uf}var qm;function Zg(){return qm||(qm=1,sf.exports=Iy()()),sf.exports}var mp={},Wm;function My(){return Wm||(Wm=1,Object.defineProperty(mp,"__esModule",{value:!0}),mp.default=function(){for(var E=arguments.length,L=Array(E),z=0;z<E;z++)L[z]=arguments[z];return L.filter(function(V){return typeof V=="function"}).reduce(function(V,W){return V===null?W:function(){for(var M=arguments.length,h=Array(M),Me=0;Me<M;Me++)h[Me]=arguments[Me];V.apply(this,h),W.apply(this,h)}},null)}),mp}var cf,Hm;function ky(){if(Hm)return cf;Hm=1;var E=My(),L=z(E);function z(V){return V&&V.__esModule?V:{default:V}}return cf=L.default,cf}function Rl(){return Rl=Object.assign?Object.assign.bind():function(E){for(var L=1;L<arguments.length;L++){var z=arguments[L];for(var V in z)({}).hasOwnProperty.call(z,V)&&(E[V]=z[V])}return E},Rl.apply(null,arguments)}function Gg(E,L){if(E==null)return{};var z={};for(var V in E)if({}.hasOwnProperty.call(E,V)){if(L.indexOf(V)!==-1)continue;z[V]=E[V]}return z}var hf,Xm;function Ay(){if(Xm)return hf;Xm=1;var E=function(L,z,V,W,ne,M,h,Me){if(!L){var Ze;if(z===void 0)Ze=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var qe=[V,W,ne,M,h,Me],Ve=0;Ze=new Error(z.replace(/%s/g,function(){return qe[Ve++]})),Ze.name="Invariant Violation"}throw Ze.framesToPop=1,Ze}};return hf=E,hf}var zy=Ay();const Ry=Ad(zy);var Dy=function(){};function Ly(E,L){var z={};return Object.keys(E).forEach(function(V){z[Nh(V)]=Dy}),z}function Km(E,L){return E[L]!==void 0}function Nh(E){return"default"+E.charAt(0).toUpperCase()+E.substr(1)}function Oy(E){return!!E&&(typeof E!="function"||E.prototype&&E.prototype.isReactComponent)}function Fy(E){var L=By(E,"string");return typeof L=="symbol"?L:String(L)}function By(E,L){if(typeof E!="object"||E===null)return E;var z=E[Symbol.toPrimitive];if(z!==void 0){var V=z.call(E,L);if(typeof V!="object")return V;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(E)}function qg(E,L,z){var V=Du.useRef(E!==void 0),W=Du.useState(L),ne=W[0],M=W[1],h=E!==void 0,Me=V.current;return V.current=h,!h&&Me&&ne!==L&&M(L),[h?E:ne,Du.useCallback(function(Ze){for(var qe=arguments.length,Ve=new Array(qe>1?qe-1:0),ze=1;ze<qe;ze++)Ve[ze-1]=arguments[ze];z&&z.apply(void 0,[Ze].concat(Ve)),M(Ze)},[z])]}function jy(E,L){return Object.keys(L).reduce(function(z,V){var W,ne=z,M=ne[Nh(V)],h=ne[V],Me=Gg(ne,[Nh(V),V].map(Fy)),Ze=L[V],qe=qg(h,M,E[Ze]),Ve=qe[0],ze=qe[1];return Rl({},Me,(W={},W[V]=Ve,W[Ze]=ze,W))},E)}function zf(E,L){return zf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(z,V){return z.__proto__=V,z},zf(E,L)}function Ny(E,L){E.prototype=Object.create(L.prototype),E.prototype.constructor=E,zf(E,L)}function Wg(){var E=this.constructor.getDerivedStateFromProps(this.props,this.state);E!=null&&this.setState(E)}function Hg(E){function L(z){var V=this.constructor.getDerivedStateFromProps(E,z);return V??null}this.setState(L.bind(this))}function Xg(E,L){try{var z=this.props,V=this.state;this.props=E,this.state=L,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(z,V)}finally{this.props=z,this.state=V}}Wg.__suppressDeprecationWarning=!0;Hg.__suppressDeprecationWarning=!0;Xg.__suppressDeprecationWarning=!0;function Vy(E){var L=E.prototype;if(!L||!L.isReactComponent)throw new Error("Can only polyfill class components");if(typeof E.getDerivedStateFromProps!="function"&&typeof L.getSnapshotBeforeUpdate!="function")return E;var z=null,V=null,W=null;if(typeof L.componentWillMount=="function"?z="componentWillMount":typeof L.UNSAFE_componentWillMount=="function"&&(z="UNSAFE_componentWillMount"),typeof L.componentWillReceiveProps=="function"?V="componentWillReceiveProps":typeof L.UNSAFE_componentWillReceiveProps=="function"&&(V="UNSAFE_componentWillReceiveProps"),typeof L.componentWillUpdate=="function"?W="componentWillUpdate":typeof L.UNSAFE_componentWillUpdate=="function"&&(W="UNSAFE_componentWillUpdate"),z!==null||V!==null||W!==null){var ne=E.displayName||E.name,M=typeof E.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+ne+" uses "+M+" but also contains the following legacy lifecycles:"+(z!==null?`
  `+z:"")+(V!==null?`
  `+V:"")+(W!==null?`
  `+W:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof E.getDerivedStateFromProps=="function"&&(L.componentWillMount=Wg,L.componentWillReceiveProps=Hg),typeof L.getSnapshotBeforeUpdate=="function"){if(typeof L.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");L.componentWillUpdate=Xg;var h=L.componentDidUpdate;L.componentDidUpdate=function(Ze,qe,Ve){var ze=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:Ve;h.call(this,Ze,qe,ze)}}return E}var $y="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function Kg(E,L,z){z===void 0&&(z=[]);var V=E.displayName||E.name||"Component",W=Oy(E),ne=Object.keys(L),M=ne.map(Nh);W||!z.length||Ry(!1);var h=function(Ze){Ny(qe,Ze);function qe(){for(var ze,ce=arguments.length,Ge=new Array(ce),nt=0;nt<ce;nt++)Ge[nt]=arguments[nt];ze=Ze.call.apply(Ze,[this].concat(Ge))||this,ze.handlers=Object.create(null),ne.forEach(function(qt){var Ft=L[qt],Jt=function(cr){if(ze.props[Ft]){var Je;ze._notifying=!0;for(var pt=arguments.length,Lt=new Array(pt>1?pt-1:0),Ct=1;Ct<pt;Ct++)Lt[Ct-1]=arguments[Ct];(Je=ze.props)[Ft].apply(Je,[cr].concat(Lt)),ze._notifying=!1}ze.unmounted||ze.setState(function(rr){var sr,Er=rr.values;return{values:Rl(Object.create(null),Er,(sr={},sr[qt]=cr,sr))}})};ze.handlers[Ft]=Jt}),z.length&&(ze.attachRef=function(qt){ze.inner=qt});var gt=Object.create(null);return ne.forEach(function(qt){gt[qt]=ze.props[Nh(qt)]}),ze.state={values:gt,prevProps:{}},ze}var Ve=qe.prototype;return Ve.shouldComponentUpdate=function(){return!this._notifying},qe.getDerivedStateFromProps=function(ce,Ge){var nt=Ge.values,gt=Ge.prevProps,qt={values:Rl(Object.create(null),nt),prevProps:{}};return ne.forEach(function(Ft){qt.prevProps[Ft]=ce[Ft],!Km(ce,Ft)&&Km(gt,Ft)&&(qt.values[Ft]=ce[Nh(Ft)])}),qt},Ve.componentWillUnmount=function(){this.unmounted=!0},Ve.render=function(){var ce=this,Ge=this.props,nt=Ge.innerRef,gt=Gg(Ge,["innerRef"]);M.forEach(function(Ft){delete gt[Ft]});var qt={};return ne.forEach(function(Ft){var Jt=ce.props[Ft];qt[Ft]=Jt!==void 0?Jt:ce.state.values[Ft]}),ti.createElement(E,Rl({},gt,qt,this.handlers,{ref:nt||this.attachRef}))},qe}(ti.Component);Vy(h),h.displayName="Uncontrolled("+V+")",h.propTypes=Rl({innerRef:function(){}},Ly(L)),z.forEach(function(Ze){h.prototype[Ze]=function(){var Ve;return(Ve=this.inner)[Ze].apply(Ve,arguments)}});var Me=h;return ti.forwardRef&&(Me=ti.forwardRef(function(Ze,qe){return ti.createElement(h,Rl({},Ze,{innerRef:qe,__source:{fileName:$y,lineNumber:128},__self:this}))}),Me.propTypes=h.propTypes),Me.ControlledComponent=E,Me.deferControlTo=function(Ze,qe,Ve){return qe===void 0&&(qe={}),Kg(Ze,Rl({},L,qe),Ve)},Me}const Uy=Object.freeze(Object.defineProperty({__proto__:null,uncontrollable:Kg,useUncontrolled:jy,useUncontrolledProp:qg},Symbol.toStringTag,{value:"Module"})),Zy=gy(Uy);var df,Ym;function Gy(){if(Ym)return df;Ym=1;var E=function(){};return df=E,df}/*! react-sidenav v0.5.0 | (c) 2020 Trend Micro Inc. | MIT | https://github.com/trendmicro-frontend/react-sidenav */var Qm;function qy(){return Qm||(Qm=1,function(E){E.exports=function(L){var z={};function V(W){if(z[W])return z[W].exports;var ne=z[W]={i:W,l:!1,exports:{}};return L[W].call(ne.exports,ne,ne.exports,V),ne.l=!0,ne.exports}return V.m=L,V.c=z,V.d=function(W,ne,M){V.o(W,ne)||Object.defineProperty(W,ne,{configurable:!1,enumerable:!0,get:M})},V.n=function(W){var ne=W&&W.__esModule?function(){return W.default}:function(){return W};return V.d(ne,"a",ne),ne},V.o=function(W,ne){return Object.prototype.hasOwnProperty.call(W,ne)},V.p="",V(V.s=11)}([function(L,z){L.exports=kp()},function(L,z){L.exports=Cy()},function(L,z){L.exports=Zg()},function(L,z){L.exports={sidenav:"sidenav---sidenav---_2tBP",collapsed:"sidenav---collapsed---LQDEv","sidenav-nav":"sidenav---sidenav-nav---3tvij",sidenavNav:"sidenav---sidenav-nav---3tvij","sidenav-navitem":"sidenav---sidenav-navitem---uwIJ-",sidenavNavitem:"sidenav---sidenav-navitem---uwIJ-","sidenav-subnav":"sidenav---sidenav-subnav---1EN61",sidenavSubnav:"sidenav---sidenav-subnav---1EN61",expanded:"sidenav---expanded---1KdUL",navicon:"sidenav---navicon---3gCRo",navtext:"sidenav---navtext---1AE_f",expandable:"sidenav---expandable---3_dr7",navitem:"sidenav---navitem---9uL5T","sidenav-subnavitem":"sidenav---sidenav-subnavitem---1cD47",sidenavSubnavitem:"sidenav---sidenav-subnavitem---1cD47",selected:"sidenav---selected---1EK3y","sidenav-toggle":"sidenav---sidenav-toggle---1KRjR",sidenavToggle:"sidenav---sidenav-toggle---1KRjR","icon-bar":"sidenav---icon-bar---u1f02",iconBar:"sidenav---icon-bar---u1f02",highlighted:"sidenav---highlighted---oUx9u"}},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=function(M){return function(h){return!!(h.type===M||h.props&&h.props.componentType===M)}};z.default=W},function(L,z){L.exports=ky()},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(Re){for(var et=1;et<arguments.length;et++){var rt=arguments[et];for(var me in rt)Object.prototype.hasOwnProperty.call(rt,me)&&(Re[me]=rt[me])}return Re},ne=function(){function Re(et,rt){for(var me=0;me<rt.length;me++){var Ae=rt[me];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(et,Ae.key,Ae)}}return function(et,rt,me){return rt&&Re(et.prototype,rt),me&&Re(et,me),et}}(),M,h,Me=V(5),Ze=rr(Me),qe=V(1),Ve=rr(qe),ze=V(2),ce=rr(ze),Ge=V(0),nt=rr(Ge),gt=V(7),qt=rr(gt),Ft=V(8),Jt=rr(Ft),Mt=V(12),cr=rr(Mt),Je=V(4),pt=rr(Je),Lt=V(3),Ct=rr(Lt);function rr(Re){return Re&&Re.__esModule?Re:{default:Re}}function sr(Re,et,rt){return et in Re?Object.defineProperty(Re,et,{value:rt,enumerable:!0,configurable:!0,writable:!0}):Re[et]=rt,Re}function Er(Re,et){var rt={};for(var me in Re)et.indexOf(me)>=0||Object.prototype.hasOwnProperty.call(Re,me)&&(rt[me]=Re[me]);return rt}function _r(Re,et){if(!(Re instanceof et))throw new TypeError("Cannot call a class as a function")}function Tt(Re,et){if(!Re)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return et&&(typeof et=="object"||typeof et=="function")?et:Re}function Nt(Re,et){if(typeof et!="function"&&et!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof et);Re.prototype=Object.create(et&&et.prototype,{constructor:{value:Re,enumerable:!1,writable:!0,configurable:!0}}),et&&(Object.setPrototypeOf?Object.setPrototypeOf(Re,et):Re.__proto__=et)}var bt=function(){},_t=(h=M=function(Re){Nt(et,Re);function et(){var rt,me,Ae,kt;_r(this,et);for(var ut=arguments.length,Xe=Array(ut),st=0;st<ut;st++)Xe[st]=arguments[st];return kt=(me=(Ae=Tt(this,(rt=et.__proto__||Object.getPrototypeOf(et)).call.apply(rt,[this].concat(Xe))),Ae),Ae.findNavIcon=(0,cr.default)(qt.default),Ae.findNavText=(0,cr.default)(Jt.default),Ae.isNavItem=(0,pt.default)(et),Ae.isNavIcon=(0,pt.default)(qt.default),Ae.isNavText=(0,pt.default)(Jt.default),Ae.handleSelect=function(xt){var mt=Ae.props,St=mt.disabled,lr=mt.onSelect,or=mt.eventKey;if(St){xt.preventDefault();return}lr&&lr(or,xt)},me),Tt(Ae,kt)}return ne(et,[{key:"render",value:function(){var me=this,Ae,kt,ut=this.props;ut.componentType;var Xe=ut.componentClass,st=ut.active,xt=ut.disabled,mt=ut.expanded;ut.eventKey;var St=ut.onClick,lr=ut.onSelect,or=ut.selected,Mr=ut.subnav,kr=ut.navitemClassName,Ar=ut.navitemStyle,di=ut.subnavClassName,$i=ut.subnavStyle,Tn=ut.className,tn=ut.style,ri=ut.children,zn=Er(ut,["componentType","componentClass","active","disabled","expanded","eventKey","onClick","onSelect","selected","subnav","navitemClassName","navitemStyle","subnavClassName","subnavStyle","className","style","children"]),rn=this.findNavIcon(ri),Nn=this.findNavText(ri),Ui=rn?W({},rn.props):{};Ui.componentType;var ao=Ui.navIconClassName,wo=Er(Ui,["componentType","navIconClassName"]),Zi=Nn?W({},Nn.props):{};Zi.componentType;var pi=Zi.navTextClassName,ni=Er(Zi,["componentType","navTextClassName"]);if(Mr){var fi,mi=st||!!or&&or===this.props.eventKey;return nt.default.createElement(Xe,{role:"presentation",className:(0,Ve.default)(Tn,Ct.default.sidenavSubnavitem,(fi={},sr(fi,Ct.default.selected,mi),sr(fi,Ct.default.disabled,xt),fi)),style:tn},nt.default.createElement("div",W({},zn,{className:(0,Ve.default)(kr,Ct.default.navitem),style:Ar,disabled:xt,role:"menuitem",tabIndex:"-1",onClick:(0,Ze.default)(St,this.handleSelect)}),rn&&nt.default.createElement("div",W({},wo,{className:(0,Ve.default)(ao,Ct.default.navicon)})),Nn&&nt.default.createElement("div",W({},ni,{className:(0,Ve.default)(pi,Ct.default.navtext)}))))}var Gi=[],so=nt.default.Children.toArray(ri).filter(function(X){return nt.default.isValidElement(X)&&me.isNavItem(X)}).map(function(X){return(X.props.active||or&&or===X.props.eventKey)&&Gi.push(X),(0,Ge.cloneElement)(X,{subnav:!0,selected:or,onSelect:(0,Ze.default)(X.props.onSelect,lr)})}),na=nt.default.Children.toArray(ri).filter(function(X){return!(nt.default.isValidElement(X)&&(me.isNavIcon(X)||me.isNavText(X)||me.isNavItem(X)))}),Ai=st||!!or&&or===this.props.eventKey||Gi.length>0,xe=so.length>0,R=xe&&mt,q=R||Ai;return nt.default.createElement(Xe,{role:"presentation",className:(0,Ve.default)(Tn,Ct.default.sidenavNavitem,(Ae={},sr(Ae,Ct.default.selected,Ai),sr(Ae,Ct.default.highlighted,q),sr(Ae,Ct.default.expandable,xe),sr(Ae,Ct.default.expanded,R),sr(Ae,Ct.default.disabled,xt),Ae)),style:tn},nt.default.createElement("div",W({},zn,{className:(0,Ve.default)(kr,Ct.default.navitem),style:Ar,disabled:xt,role:"menuitem",tabIndex:"-1",onClick:(0,Ze.default)(St,so.length===0?this.handleSelect:bt)}),rn&&nt.default.createElement("div",W({},wo,{className:(0,Ve.default)(ao,Ct.default.navicon)})),Nn&&nt.default.createElement("div",W({},ni,{className:(0,Ve.default)(pi,Ct.default.navtext)})),na),so.length>0&&nt.default.createElement("div",{role:"menu",className:(0,Ve.default)(di,Ct.default.sidenavSubnav),style:$i},nt.default.createElement(Xe,{role:"heading",className:(0,Ve.default)(Ct.default.sidenavSubnavitem,(kt={},sr(kt,Ct.default.highlighted,st),sr(kt,Ct.default.disabled,xt),kt)),style:tn},Nn&&Nn.props?Nn.props.children:null),so))}}]),et}(Ge.PureComponent),M.propTypes={componentType:ce.default.any,componentClass:ce.default.oneOfType([ce.default.string,ce.default.func]),active:ce.default.bool,disabled:ce.default.bool,expanded:ce.default.bool,eventKey:ce.default.any,onClick:ce.default.func,onSelect:ce.default.func,selected:ce.default.any,subnav:ce.default.bool,navitemClassName:ce.default.string,navitemStyle:ce.default.object,subnavClassName:ce.default.string,subnavStyle:ce.default.object},M.defaultProps={componentClass:"div",active:!1,disabled:!1,expanded:!1},h);_t.defaultProps.componentType=_t,z.default=_t},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(M){for(var h=1;h<arguments.length;h++){var Me=arguments[h];for(var Ze in Me)Object.prototype.hasOwnProperty.call(Me,Ze)&&(M[Ze]=Me[Ze])}return M},ne=function(){throw new Error("should not render NavIcon component")};ne.defaultProps=W({},ne.defaultProps,{componentType:ne}),z.default=ne},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(M){for(var h=1;h<arguments.length;h++){var Me=arguments[h];for(var Ze in Me)Object.prototype.hasOwnProperty.call(Me,Ze)&&(M[Ze]=Me[Ze])}return M},ne=function(){throw new Error("should not render NavText component")};ne.defaultProps=W({},ne.defaultProps,{componentType:ne}),z.default=ne},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(Je){for(var pt=1;pt<arguments.length;pt++){var Lt=arguments[pt];for(var Ct in Lt)Object.prototype.hasOwnProperty.call(Lt,Ct)&&(Je[Ct]=Lt[Ct])}return Je},ne=function(){function Je(pt,Lt){for(var Ct=0;Ct<Lt.length;Ct++){var rr=Lt[Ct];rr.enumerable=rr.enumerable||!1,rr.configurable=!0,"value"in rr&&(rr.writable=!0),Object.defineProperty(pt,rr.key,rr)}}return function(pt,Lt,Ct){return Lt&&Je(pt.prototype,Lt),Ct&&Je(pt,Ct),pt}}(),M,h,Me=V(1),Ze=gt(Me),qe=V(2),Ve=gt(qe),ze=V(0),ce=gt(ze),Ge=V(3),nt=gt(Ge);function gt(Je){return Je&&Je.__esModule?Je:{default:Je}}function qt(Je,pt){var Lt={};for(var Ct in Je)pt.indexOf(Ct)>=0||Object.prototype.hasOwnProperty.call(Je,Ct)&&(Lt[Ct]=Je[Ct]);return Lt}function Ft(Je,pt){if(!(Je instanceof pt))throw new TypeError("Cannot call a class as a function")}function Jt(Je,pt){if(!Je)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return pt&&(typeof pt=="object"||typeof pt=="function")?pt:Je}function Mt(Je,pt){if(typeof pt!="function"&&pt!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof pt);Je.prototype=Object.create(pt&&pt.prototype,{constructor:{value:Je,enumerable:!1,writable:!0,configurable:!0}}),pt&&(Object.setPrototypeOf?Object.setPrototypeOf(Je,pt):Je.__proto__=pt)}var cr=(h=M=function(Je){Mt(pt,Je);function pt(){return Ft(this,pt),Jt(this,(pt.__proto__||Object.getPrototypeOf(pt)).apply(this,arguments))}return ne(pt,[{key:"render",value:function(){var Ct=this.props;Ct.componentType;var rr=Ct.componentClass,sr=Ct.expanded,Er=Ct.className,_r=Ct.children,Tt=qt(Ct,["componentType","componentClass","expanded","className","children"]);return ce.default.createElement(rr,W({},Tt,{role:"button",className:(0,Ze.default)(Er,nt.default.sidenavToggle),"aria-expanded":sr}),ce.default.createElement("span",{className:nt.default.iconBar}),ce.default.createElement("span",{className:nt.default.iconBar}),ce.default.createElement("span",{className:nt.default.iconBar}),_r)}}]),pt}(ze.PureComponent),M.propTypes={componentType:Ve.default.any,componentClass:Ve.default.oneOfType([Ve.default.string,Ve.default.func]),disabled:Ve.default.bool,expanded:Ve.default.bool},M.defaultProps={componentClass:"button",disabled:!1,expanded:!1},h);cr.defaultProps.componentType=cr,z.default=cr},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(Tt){for(var Nt=1;Nt<arguments.length;Nt++){var bt=arguments[Nt];for(var _t in bt)Object.prototype.hasOwnProperty.call(bt,_t)&&(Tt[_t]=bt[_t])}return Tt},ne=function(){function Tt(Nt,bt){for(var _t=0;_t<bt.length;_t++){var Re=bt[_t];Re.enumerable=Re.enumerable||!1,Re.configurable=!0,"value"in Re&&(Re.writable=!0),Object.defineProperty(Nt,Re.key,Re)}}return function(Nt,bt,_t){return bt&&Tt(Nt.prototype,bt),_t&&Tt(Nt,_t),Nt}}(),M,h,Me=V(5),Ze=Je(Me),qe=V(1),Ve=Je(qe),ze=V(2),ce=Je(ze),Ge=V(0),nt=Je(Ge),gt=V(6),qt=Je(gt),Ft=V(4),Jt=Je(Ft),Mt=V(3),cr=Je(Mt);function Je(Tt){return Tt&&Tt.__esModule?Tt:{default:Tt}}function pt(Tt,Nt,bt){return Nt in Tt?Object.defineProperty(Tt,Nt,{value:bt,enumerable:!0,configurable:!0,writable:!0}):Tt[Nt]=bt,Tt}function Lt(Tt,Nt){var bt={};for(var _t in Tt)Nt.indexOf(_t)>=0||Object.prototype.hasOwnProperty.call(Tt,_t)&&(bt[_t]=Tt[_t]);return bt}function Ct(Tt,Nt){if(!(Tt instanceof Nt))throw new TypeError("Cannot call a class as a function")}function rr(Tt,Nt){if(!Tt)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Nt&&(typeof Nt=="object"||typeof Nt=="function")?Nt:Tt}function sr(Tt,Nt){if(typeof Nt!="function"&&Nt!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Nt);Tt.prototype=Object.create(Nt&&Nt.prototype,{constructor:{value:Tt,enumerable:!1,writable:!0,configurable:!0}}),Nt&&(Object.setPrototypeOf?Object.setPrototypeOf(Tt,Nt):Tt.__proto__=Nt)}var Er=function(){},_r=(h=M=function(Tt){sr(Nt,Tt);function Nt(){var bt,_t,Re,et;Ct(this,Nt);for(var rt=arguments.length,me=Array(rt),Ae=0;Ae<rt;Ae++)me[Ae]=arguments[Ae];return et=(_t=(Re=rr(this,(bt=Nt.__proto__||Object.getPrototypeOf(Nt)).call.apply(bt,[this].concat(me))),Re),Re.state={expandedNavItem:null,selected:Re.props.defaultSelected,defaultSelected:Re.props.defaultSelected},Re.isNavItem=(0,Jt.default)(qt.default),_t),rr(Re,et)}return ne(Nt,[{key:"handleClickOnExpanded",value:function(_t,Re){this.props.expanded&&this.setState(function(et){return{expandedNavItem:et.expandedNavItem!==_t?_t:""}})}},{key:"renderNavItem",value:function(_t,Re){var et=this,rt=Re.onSelect,me=Lt(Re,["onSelect"]),Ae=W({},_t.props),kt=Ae.eventKey;return(0,Ge.cloneElement)(_t,W({},me,{onClick:(0,Ze.default)(_t.props.onClick,function(ut){et.handleClickOnExpanded(kt,ut)}),onSelect:(0,Ze.default)(this.state.defaultSelected?function(ut){et.setState({selected:ut})}:Er,_t.props.onSelect,rt)}))}},{key:"render",value:function(){var _t=this,Re=this.props;Re.componentType;var et=Re.componentClass,rt=Re.onSelect,me=Re.selected;Re.defaultSelected;var Ae=Re.expanded,kt=Re.className,ut=Re.children,Xe=Lt(Re,["componentType","componentClass","onSelect","selected","defaultSelected","expanded","className","children"]),st=this.state.defaultSelected?this.state.selected:me;return nt.default.createElement(et,W({},Xe,{role:"menu",className:(0,Ve.default)(kt,cr.default.sidenavNav,pt({},cr.default.expanded,Ae))}),nt.default.Children.map(ut,function(xt){return nt.default.isValidElement(xt)&&_t.isNavItem(xt)?_t.renderNavItem(xt,{onSelect:rt,selected:st,expanded:!!xt.props.expanded||Ae&&!!_t.state.expandedNavItem&&_t.state.expandedNavItem===xt.props.eventKey}):xt}))}}]),Nt}(Ge.PureComponent),M.propTypes={componentType:ce.default.any,componentClass:ce.default.oneOfType([ce.default.string,ce.default.func]),onSelect:ce.default.func,selected:ce.default.any,defaultSelected:ce.default.any,expanded:ce.default.bool},M.defaultProps={componentClass:"div"},h);_r.defaultProps.componentType=_r,z.default=_r},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0}),z.NavText=z.NavIcon=z.NavItem=z.Nav=z.Toggle=void 0;var W=V(9);Object.defineProperty(z,"Toggle",{enumerable:!0,get:function(){return Ve(W).default}});var ne=V(10);Object.defineProperty(z,"Nav",{enumerable:!0,get:function(){return Ve(ne).default}});var M=V(6);Object.defineProperty(z,"NavItem",{enumerable:!0,get:function(){return Ve(M).default}});var h=V(7);Object.defineProperty(z,"NavIcon",{enumerable:!0,get:function(){return Ve(h).default}});var Me=V(8);Object.defineProperty(z,"NavText",{enumerable:!0,get:function(){return Ve(Me).default}});var Ze=V(13),qe=Ve(Ze);function Ve(ze){return ze&&ze.__esModule?ze:{default:ze}}L.exports=qe.default},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=V(0),ne=Me(W),M=V(4),h=Me(M);function Me(qe){return qe&&qe.__esModule?qe:{default:qe}}var Ze=function(Ve){return function(ze){var ce=(0,h.default)(Ve);return ne.default.Children.toArray(ze).reduce(function(Ge,nt){return Ge===null&&nt!==null&&ce(nt)?nt:Ge},null)}};z.default=Ze},function(L,z,V){Object.defineProperty(z,"__esModule",{value:!0});var W=Object.assign||function(Xe){for(var st=1;st<arguments.length;st++){var xt=arguments[st];for(var mt in xt)Object.prototype.hasOwnProperty.call(xt,mt)&&(Xe[mt]=xt[mt])}return Xe},ne=function(){function Xe(st,xt){for(var mt=0;mt<xt.length;mt++){var St=xt[mt];St.enumerable=St.enumerable||!1,St.configurable=!0,"value"in St&&(St.writable=!0),Object.defineProperty(st,St.key,St)}}return function(st,xt,mt){return xt&&Xe(st.prototype,xt),mt&&Xe(st,mt),st}}(),M,h,Me=V(5),Ze=_t(Me),qe=V(1),Ve=_t(qe),ze=V(2),ce=_t(ze),Ge=V(0),nt=_t(Ge),gt=V(14),qt=V(15),Ft=_t(qt),Jt=V(9),Mt=_t(Jt),cr=V(10),Je=_t(cr),pt=V(6),Lt=_t(pt),Ct=V(7),rr=_t(Ct),sr=V(8),Er=_t(sr),_r=V(3),Tt=_t(_r),Nt=V(4),bt=_t(Nt);function _t(Xe){return Xe&&Xe.__esModule?Xe:{default:Xe}}function Re(Xe,st,xt){return st in Xe?Object.defineProperty(Xe,st,{value:xt,enumerable:!0,configurable:!0,writable:!0}):Xe[st]=xt,Xe}function et(Xe,st){var xt={};for(var mt in Xe)st.indexOf(mt)>=0||Object.prototype.hasOwnProperty.call(Xe,mt)&&(xt[mt]=Xe[mt]);return xt}function rt(Xe,st){if(!(Xe instanceof st))throw new TypeError("Cannot call a class as a function")}function me(Xe,st){if(!Xe)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return st&&(typeof st=="object"||typeof st=="function")?st:Xe}function Ae(Xe,st){if(typeof st!="function"&&st!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof st);Xe.prototype=Object.create(st&&st.prototype,{constructor:{value:Xe,enumerable:!1,writable:!0,configurable:!0}}),st&&(Object.setPrototypeOf?Object.setPrototypeOf(Xe,st):Xe.__proto__=st)}var kt=(h=M=function(Xe){Ae(st,Xe);function st(){var xt,mt,St,lr;rt(this,st);for(var or=arguments.length,Mr=Array(or),kr=0;kr<or;kr++)Mr[kr]=arguments[kr];return lr=(mt=(St=me(this,(xt=st.__proto__||Object.getPrototypeOf(st)).call.apply(xt,[this].concat(Mr))),St),St.isToggle=(0,bt.default)(Mt.default),St.isNav=(0,bt.default)(Je.default),St.child={toggle:null,nav:null},St.handleClick=function(Ar){St.props.disabled||St.toggleExpanded("click")},mt),me(St,lr)}return ne(st,[{key:"toggleExpanded",value:function(mt){var St=!this.props.expanded;this.props.onToggle&&this.props.onToggle(St)}},{key:"renderToggle",value:function(mt,St){var lr=this,or=function(kr){lr.child.toggle=kr};return typeof mt.ref=="string"?(0,Ft.default)(!1,"String refs are not supported on `<SideNav.Toggle>` component. To apply a ref to the component use the callback signature:\n\n https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"):or=(0,Ze.default)(mt.ref,or),(0,Ge.cloneElement)(mt,W({},St,{ref:or,onClick:(0,Ze.default)(mt.props.onClick,this.handleClick)}))}},{key:"renderNav",value:function(mt,St){var lr=this,or=St.onSelect,Mr=et(St,["onSelect"]),kr=function(di){lr.child.nav=di};return typeof mt.ref=="string"?(0,Ft.default)(!1,"String refs are not supported on `<SideNav.Nav>` component. To apply a ref to the component use the callback signature:\n\n https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"):kr=(0,Ze.default)(mt.ref,kr),(0,Ge.cloneElement)(mt,W({},Mr,{ref:kr,onSelect:(0,Ze.default)(mt.props.onSelect,or)}))}},{key:"render",value:function(){var mt,St=this,lr=this.props;lr.componentType;var or=lr.componentClass,Mr=lr.disabled,kr=lr.expanded;lr.onToggle;var Ar=lr.onSelect,di=lr.className,$i=lr.children,Tn=et(lr,["componentType","componentClass","disabled","expanded","onToggle","onSelect","className","children"]);return nt.default.createElement(or,W({},Tn,{className:(0,Ve.default)(di,Tt.default.sidenav,(mt={},Re(mt,Tt.default.disabled,Mr),Re(mt,Tt.default.expanded,kr),Re(mt,Tt.default.collapsed,!kr),mt))}),nt.default.Children.map($i,function(tn){return nt.default.isValidElement(tn)?St.isToggle(tn)?St.renderToggle(tn,{disabled:Mr,expanded:kr}):St.isNav(tn)?St.renderNav(tn,{onSelect:Ar,expanded:kr}):tn:tn}))}}]),st}(Ge.PureComponent),M.propTypes={componentType:ce.default.any,componentClass:ce.default.oneOfType([ce.default.string,ce.default.func]),disabled:ce.default.bool,expanded:ce.default.bool,onToggle:ce.default.func,onSelect:ce.default.func},M.defaultProps={componentClass:"nav"},h);kt.defaultProps.componentType=kt;var ut=(0,gt.uncontrollable)(kt,{expanded:"onToggle"});ut.Toggle=Mt.default,ut.Nav=Je.default,ut.NavItem=Lt.default,ut.NavIcon=rr.default,ut.NavText=Er.default,z.default=ut},function(L,z){L.exports=Zy},function(L,z){L.exports=Gy()}])}(of)),of.exports}var Bc=qy();const Jm=Ad(Bc);var Yg={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},eg=ti.createContext&&ti.createContext(Yg),Lu=function(){return Lu=Object.assign||function(E){for(var L,z=1,V=arguments.length;z<V;z++){L=arguments[z];for(var W in L)Object.prototype.hasOwnProperty.call(L,W)&&(E[W]=L[W])}return E},Lu.apply(this,arguments)},Wy=function(E,L){var z={};for(var V in E)Object.prototype.hasOwnProperty.call(E,V)&&L.indexOf(V)<0&&(z[V]=E[V]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,V=Object.getOwnPropertySymbols(E);W<V.length;W++)L.indexOf(V[W])<0&&Object.prototype.propertyIsEnumerable.call(E,V[W])&&(z[V[W]]=E[V[W]]);return z};function Qg(E){return E&&E.map(function(L,z){return ti.createElement(L.tag,Lu({key:z},L.attr),Qg(L.child))})}function Vh(E){return function(L){return ti.createElement(Hy,Lu({attr:Lu({},E.attr)},L),Qg(E.child))}}function Hy(E){var L=function(z){var V=E.attr,W=E.size,ne=E.title,M=Wy(E,["attr","size","title"]),h=W||z.size||"1em",Me;return z.className&&(Me=z.className),E.className&&(Me=(Me?Me+" ":"")+E.className),ti.createElement("svg",Lu({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},z.attr,V,M,{className:Me,style:Lu(Lu({color:E.color||z.color},z.style),E.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),ne&&ti.createElement("title",null,ne),E.children)};return eg!==void 0?ti.createElement(eg.Consumer,null,function(z){return L(z)}):L(Yg)}function Xy(E){return Vh({attr:{viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}},{tag:"path",attr:{d:"M2 9a10 10 0 1 0 20 0"}},{tag:"path",attr:{d:"M12 19a10 10 0 0 1 10 -10"}},{tag:"path",attr:{d:"M2 9a10 10 0 0 1 10 10"}},{tag:"path",attr:{d:"M12 4a9.7 9.7 0 0 1 2.99 7.5"}},{tag:"path",attr:{d:"M9.01 11.5a9.7 9.7 0 0 1 2.99 -7.5"}}]})(E)}function Ky(E){return Vh({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M335.7 88.94c-4.742.194-9.563 1.486-14.204 4.165-38.934 22.48-89.77 21.953-127.79.002-6.09-3.516-12.285-4.61-18.145-3.892 5.914 7.778 9.438 17.572 9.438 28.09 0 23.15-17.037 42.83-39.176 45.095-12.775 14.92-21.553 31.807-24.386 49.983 44.73-23.79 90.947-35.572 137.064-35.508 46.15.064 92.197 11.987 136.56 35.62-2.69-18.15-11.216-35.043-23.794-49.92-.585.026-1.17.048-1.76.048-24.18 0-43.447-20.7-43.447-45.318 0-10.64 3.6-20.543 9.64-28.364zm-194.15 3.216c-12.67 0-23.277 10.85-23.277 25.15 0 14.297 10.608 25.147 23.278 25.147 12.67 0 23.276-10.85 23.276-25.148s-10.606-25.15-23.275-25.15zm227.956 0c-12.67 0-23.277 10.85-23.277 25.15 0 14.297 10.607 25.147 23.276 25.147 12.67 0 23.277-10.85 23.277-25.148s-10.608-25.15-23.277-25.15zm67.572 93.367c-8.525.088-17.893 1.546-27.853 4.243 6.926 19.457 8.57 40.725 2.695 62.656-4.26 15.896.933 37.475 11.7 54.758l4.69 7.53-7.02 5.43c-19.765 15.28-36.44 25.107-46.104 35.264-9.664 10.158-13.887 19.59-10.915 40.875l1.525 10.91c3.596 4.7 7.678 9.43 12.142 14.06 19.876-14.55 36.01-23.887 68.344-4.094-6.738-18.804 15.938-29.762 46.72-29.78-36.91-15.88-64.98-25.62-86.438-30.376 67.492-72.188 97.182-127.96 66-159.188-8.172-8.183-19.356-12.034-33.28-12.28-.73-.014-1.463-.016-2.204-.01zm-361.617.002c-.806-.01-1.606-.008-2.397.006-13.925.248-25.14 4.1-33.313 12.282-31.182 31.227-1.492 87 66 159.188-21.456 4.756-49.528 14.497-86.438 30.375 30.782.02 53.458 10.977 46.72 29.78 32.332-19.792 48.468-10.454 68.343 4.095 6.713-6.962 12.572-14.146 17.188-21.12l.537-3.85c2.972-21.283-1.25-30.716-10.914-40.874-9.664-10.157-26.34-19.984-46.106-35.265l-7.02-5.427 4.692-7.53c10.73-17.228 15.858-39.233 11.7-54.76-5.782-21.572-4.185-42.44 2.536-61.56-11.336-3.388-21.954-5.216-31.527-5.338zm183.038 9.66c-46.096-.065-92.3 12.827-137.574 38.846.47 4.387 1.292 8.825 2.494 13.31v.002c5.453 20.354.593 42.93-9.484 62.297 15.89 11.634 30.343 20.526 41.478 32.23 10.36 10.89 16.795 25.132 16.955 43.712-1.096 16.308-9.157 39.273-22.347 59.244 24.59-14.237 42.134-15.333 45.29 3.492 14.097-17.783 25.698-20.386 38.985-8.035-3.745-31.452-11.117-52.887-17.258-65.097-14.896-36.567-42.816-61.484-73.742-83.424l11.36-16.014c38.788 27.517 76.798 62.663 89.124 119.566 9.628.705 19.25.65 28.85-.16 12.362-56.81 50.334-91.918 89.085-119.408l11.36 16.016c-31.19 22.127-59.333 47.28-74.13 84.363-6.045 12.357-13.14 33.493-16.793 64.158 13.29-12.35 24.89-9.748 38.987 8.035 3.153-18.825 20.697-17.73 45.288-3.492-13.51-20.455-21.645-44.058-22.42-60.424.415-18.01 6.81-31.872 16.95-42.533 11.135-11.705 25.586-20.595 41.474-32.23-10.064-19.29-14.99-41.736-9.48-62.302 1.198-4.467 2.028-8.89 2.51-13.266-44.85-25.79-90.852-38.82-136.964-38.886z"}}]})(E)}function Yy(E){return Vh({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M139.7 23.52c-9.1 30.54-16.5 61.64-12.7 91.58 4.2 32.7 21 64.9 65.7 95.7-53.6 74.8-86.1 204.4-59.3 277.7 10.9-54 14.2-97.8 53.5-144.6 77.5-25.6 123.9-37.6 140.3-125.7 6.2-14.7 12.6-19.3 31.9-24.7 10.6-2.9 22.2-7.5 22.1-19.2-.2-49.3-28.3-68.4-57.6-67.9-29.4.5-60 20.6-65.4 49.8-6 1.8-11.9 4.5-17.7 8-62.9-43.7-82.1-85.86-100.8-140.68zM32.03 107c10.8 27.2 26.44 54.6 49.2 76.1 24.27 22.9 56.47 39.3 100.87 42.2-34.5-24.2-54.8-50.3-65.2-77.2-29.4-10.9-56.47-25-84.87-41.1zm300.07 26.3a12.24 12.24 0 0 1 12.2 12.2 12.24 12.24 0 0 1-12.2 12.2 12.24 12.24 0 0 1-12.2-12.2 12.24 12.24 0 0 1 12.2-12.2zm60 56.1c-3.5 5.1-7.1 10.2-16.1 13.2 33.9 25.3 79.1 76.5 104 105-11.2-33.2-55.8-88.6-87.9-118.2z"}}]})(E)}function Qy(E){return Vh({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M437.507 294.138l-46.303 2.675a134.099 134.099 0 0 0-20.03-93.167l31.28-40.404-12.296-50.65-16.76 4.088 10.364 42.529-23.308 30.07A134.315 134.315 0 0 0 302.21 149.9l13.342-62.762-18.077-66.223-16.696 4.605 17.01 62.18-12.276 57.724a132.664 132.664 0 0 0-29.542-2.631 27.536 27.536 0 0 0-27.06-30.297 48.946 48.946 0 0 0-30.805-22.866 28.873 28.873 0 0 1 5.015 12.058 29.316 29.316 0 0 1-57.757 10.031 48.31 48.31 0 0 0-6.774 32.584 49.14 49.14 0 0 0 1.327 6.04 27.514 27.514 0 0 0 13.083 44.696 134.455 134.455 0 0 0-17.829 31.02l-45.106-7.356-51.232-57.434L26 172.755l55.244 61.997 48.374 7.895a133.096 133.096 0 0 0-.528 65.501q1.305 5.393 3.02 10.495l-28.927 3.128-48.612-38.182-10.656 13.569 54.145 42.517 40.835-4.422a133.344 133.344 0 0 0 46.38 52.753l-16.396 50.693-3.947 51.06 17.257 1.326 3.786-49.021 14.658-45.3a133.743 133.743 0 0 0 186.646-82.478l46.551-2.697 44.33 22.618 7.841-15.37zm-152.283-104.04c8.628-12.65 27.158-15.1 41.288-5.392 14.129 9.707 18.573 27.795 9.9 40.446-8.67 12.652-27.158 15.1-41.287 5.393-14.13-9.707-18.573-27.784-9.901-40.446zm-77.312-2.512c12.695-8.165 28.776-5.77 35.916 5.328 7.14 11.098 2.632 26.727-10.063 34.892-12.695 8.164-28.776 5.77-35.916-5.328-7.14-11.099-2.643-26.727 10.063-34.892zm-5.792 179.172c-3.98 4.93-12.414 4.735-18.832-.442-6.417-5.177-8.413-13.374-4.433-18.336 3.98-4.961 12.415-4.735 18.832.442 6.418 5.177 8.402 13.407 4.433 18.336zm-.928-42.194c-16.178 3.937-32.745-7.237-37.06-24.958-4.314-17.72 5.275-35.28 21.42-39.217 16.147-3.936 32.747 7.238 37.06 24.958 4.315 17.721-5.273 35.291-21.42 39.228zm42.82 54.306c-17.872-3.645-29.812-19.09-26.663-34.514 3.15-15.423 20.18-24.958 38.052-21.312 17.872 3.645 29.812 19.09 26.663 34.514-3.15 15.423-20.18 24.958-38.052 21.323zm54.608 16.179c-8.068 1.726-15.65-1.693-16.923-7.658-1.273-5.964 4.228-12.188 12.296-13.913 8.067-1.726 15.65 1.693 16.922 7.657 1.273 5.965-4.25 12.231-12.295 13.957zm59.817-69.18c-9.707 14.119-27.827 18.52-40.446 9.826-12.62-8.693-14.992-27.18-5.274-41.288 9.718-14.107 27.827-18.519 40.446-9.825 12.62 8.693 14.98 27.18 5.274 41.287zm6.062-55.805c-6.072.734-11.79-5.317-12.781-13.504-.992-8.186 3.128-15.434 9.2-16.178 6.072-.744 11.789 5.317 12.78 13.504.993 8.186-3.127 15.412-9.2 16.178z"}}]})(E)}function Jy(E){return Vh({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M206.135 23.568c-61.993.106-133.212 38.319-173.762 85.328 0 0 94.532-8.388 109.732 35.477 24.55 70.846-103.768 62.832-105.619 173.623-1.394 83.471 89.36 169.758 176.1 169.812 4.214 1.405 181.953 0 181.953 0 19.783-.28 20.606-22.551-48.812-36.637 145.592-147.853-86.742-159.073-85.456-45.779-17.956-18.803.577-99.816 97.692-95.832 32.91 23.48 51.817 27.373 88.56 19.284 6.982-1.537 12.05-25.665-5.462-27.064l-31.78-2.54c-28.106-25.677-34.818-36.477-6.67-57.463 68.87 18.058 77.047 12.076 77.016-13.33-.03-24.855-9.527-90.633-65.832-93.815-7.701-10.311 9.79-42.042-3.953-42.957-19.014-1.266-50.482 28.417-46.266 43.787-18.335 7.755-38.728 31.156-59.15 59.614-69.316 25.43-119.49 142.639-120.15 170.632-.579-182.435 153.242-180.594 140.216-244.77-14.07-69.324-66.992-97.458-118.357-97.37zM432.807 169.97c7.164 0 12.972 5.808 12.972 12.973 0 7.164-5.808 12.972-12.972 12.972-7.165 0-12.973-5.808-12.973-12.972 0-7.165 5.808-12.973 12.973-12.973z"}}]})(E)}function ev(E){return Vh({attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M12 0a2.4 2.4 0 00-2.4 2.4A2.4 2.4 0 0012 4.8a2.4 2.4 0 002.4-2.4A2.4 2.4 0 0012 0zM9.543 9.543v4.914h4.914V9.543zM2.4 9.6A2.4 2.4 0 000 12a2.4 2.4 0 002.4 2.4A2.4 2.4 0 004.8 12a2.4 2.4 0 00-2.4-2.4zm19.2 0a2.4 2.4 0 00-2.4 2.4 2.4 2.4 0 002.4 2.4A2.4 2.4 0 0024 12a2.4 2.4 0 00-2.4-2.4zM12 19.2a2.4 2.4 0 00-2.4 2.4A2.4 2.4 0 0012 24a2.4 2.4 0 002.4-2.4 2.4 2.4 0 00-2.4-2.4z"}}]})(E)}var tv=Zg();const gr=Ad(tv);var tg=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),rv=new Uint8Array(16);function nv(){if(!tg)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return tg(rv)}var Jg=[];for(var gp=0;gp<256;++gp)Jg[gp]=(gp+256).toString(16).substr(1);function iv(E,L){var z=0,V=Jg;return[V[E[z++]],V[E[z++]],V[E[z++]],V[E[z++]],"-",V[E[z++]],V[E[z++]],"-",V[E[z++]],V[E[z++]],"-",V[E[z++]],V[E[z++]],"-",V[E[z++]],V[E[z++]],V[E[z++]],V[E[z++]],V[E[z++]],V[E[z++]]].join("")}function ov(E,L,z){var V=L&&z||0;typeof E=="string"&&(L=E==="binary"?new Array(16):null,E=null),E=E||{};var W=E.random||(E.rng||nv)();if(W[6]=W[6]&15|64,W[8]=W[8]&63|128,L)for(var ne=0;ne<16;++ne)L[V+ne]=W[ne];return L||iv(W)}function rg(E,L){var z=Object.keys(E);if(Object.getOwnPropertySymbols){var V=Object.getOwnPropertySymbols(E);L&&(V=V.filter(function(W){return Object.getOwnPropertyDescriptor(E,W).enumerable})),z.push.apply(z,V)}return z}function Rf(E){for(var L=1;L<arguments.length;L++){var z=arguments[L]!=null?arguments[L]:{};L%2?rg(Object(z),!0).forEach(function(V){kd(E,V,z[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(z)):rg(Object(z)).forEach(function(V){Object.defineProperty(E,V,Object.getOwnPropertyDescriptor(z,V))})}return E}function av(E,L){if(!(E instanceof L))throw new TypeError("Cannot call a class as a function")}function ng(E,L){for(var z=0;z<L.length;z++){var V=L[z];V.enumerable=V.enumerable||!1,V.configurable=!0,"value"in V&&(V.writable=!0),Object.defineProperty(E,V.key,V)}}function sv(E,L,z){return L&&ng(E.prototype,L),z&&ng(E,z),Object.defineProperty(E,"prototype",{writable:!1}),E}function kd(E,L,z){return L in E?Object.defineProperty(E,L,{value:z,enumerable:!0,configurable:!0,writable:!0}):E[L]=z,E}function Cp(){return Cp=Object.assign?Object.assign.bind():function(E){for(var L=1;L<arguments.length;L++){var z=arguments[L];for(var V in z)Object.prototype.hasOwnProperty.call(z,V)&&(E[V]=z[V])}return E},Cp.apply(this,arguments)}function lv(E,L){if(typeof L!="function"&&L!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(L&&L.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),Object.defineProperty(E,"prototype",{writable:!1}),L&&Df(E,L)}function Ep(E){return Ep=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(z){return z.__proto__||Object.getPrototypeOf(z)},Ep(E)}function Df(E,L){return Df=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(V,W){return V.__proto__=W,V},Df(E,L)}function uv(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function cv(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function hv(E,L){if(L&&(typeof L=="object"||typeof L=="function"))return L;if(L!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cv(E)}function dv(E){var L=uv();return function(){var V=Ep(E),W;if(L){var ne=Ep(this).constructor;W=Reflect.construct(V,arguments,ne)}else W=V.apply(this,arguments);return hv(this,W)}}function pv(E,L){if(E){if(typeof E=="string")return ig(E,L);var z=Object.prototype.toString.call(E).slice(8,-1);if(z==="Object"&&E.constructor&&(z=E.constructor.name),z==="Map"||z==="Set")return Array.from(E);if(z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(z))return ig(E,L)}}function ig(E,L){(L==null||L>E.length)&&(L=E.length);for(var z=0,V=new Array(L);z<L;z++)V[z]=E[z];return V}function fv(E,L){var z=typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(!z){if(Array.isArray(E)||(z=pv(E))||L){z&&(E=z);var V=0,W=function(){};return{s:W,n:function(){return V>=E.length?{done:!0}:{done:!1,value:E[V++]}},e:function(Me){throw Me},f:W}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ne=!0,M=!1,h;return{s:function(){z=z.call(E)},n:function(){var Me=z.next();return ne=Me.done,Me},e:function(Me){M=!0,h=Me},f:function(){try{!ne&&z.return!=null&&z.return()}finally{if(M)throw h}}}}var og=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_p=function(E){return E&&E.Math==Math&&E},Dl=_p(typeof globalThis=="object"&&globalThis)||_p(typeof window=="object"&&window)||_p(typeof self=="object"&&self)||_p(typeof og=="object"&&og)||function(){return this}()||Function("return this")(),Xf={},Ll=function(E){try{return!!E()}catch{return!0}},mv=Ll,Ou=!mv(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),gv=Ll,Kf=!gv(function(){var E=(function(){}).bind();return typeof E!="function"||E.hasOwnProperty("prototype")}),_v=Kf,yp=Function.prototype.call,Yf=_v?yp.bind(yp):function(){return yp.apply(yp,arguments)},e_={},t_={}.propertyIsEnumerable,r_=Object.getOwnPropertyDescriptor,yv=r_&&!t_.call({1:2},1);e_.f=yv?function(L){var z=r_(this,L);return!!z&&z.enumerable}:t_;var n_=function(E,L){return{enumerable:!(E&1),configurable:!(E&2),writable:!(E&4),value:L}},i_=Kf,o_=Function.prototype,Lf=o_.call,vv=i_&&o_.bind.bind(Lf,Lf),a_=function(E){return i_?vv(E):function(){return Lf.apply(E,arguments)}},s_=a_,xv=s_({}.toString),bv=s_("".slice),Ap=function(E){return bv(xv(E),8,-1)},wv=Ap,Tv=a_,Gs=function(E){if(wv(E)==="Function")return Tv(E)},Sv=Gs,Pv=Ll,Cv=Ap,pf=Object,Ev=Sv("".split),l_=Pv(function(){return!pf("z").propertyIsEnumerable(0)})?function(E){return Cv(E)=="String"?Ev(E,""):pf(E)}:pf,u_=function(E){return E==null},Iv=u_,Mv=TypeError,c_=function(E){if(Iv(E))throw Mv("Can't call method on "+E);return E},kv=l_,Av=c_,zp=function(E){return kv(Av(E))},Of=typeof document=="object"&&document.all,zv=typeof Of>"u"&&Of!==void 0,h_={all:Of,IS_HTMLDDA:zv},d_=h_,Rv=d_.all,Ra=d_.IS_HTMLDDA?function(E){return typeof E=="function"||E===Rv}:function(E){return typeof E=="function"},ag=Ra,p_=h_,Dv=p_.all,zd=p_.IS_HTMLDDA?function(E){return typeof E=="object"?E!==null:ag(E)||E===Dv}:function(E){return typeof E=="object"?E!==null:ag(E)},ff=Dl,Lv=Ra,Ov=function(E){return Lv(E)?E:void 0},Rd=function(E,L){return arguments.length<2?Ov(ff[E]):ff[E]&&ff[E][L]},Fv=Gs,Bv=Fv({}.isPrototypeOf),jv=Rd,Nv=jv("navigator","userAgent")||"",f_=Dl,mf=Nv,sg=f_.process,lg=f_.Deno,ug=sg&&sg.versions||lg&&lg.version,cg=ug&&ug.v8,us,Ip;cg&&(us=cg.split("."),Ip=us[0]>0&&us[0]<4?1:+(us[0]+us[1]));!Ip&&mf&&(us=mf.match(/Edge\/(\d+)/),(!us||us[1]>=74)&&(us=mf.match(/Chrome\/(\d+)/),us&&(Ip=+us[1])));var Vv=Ip,hg=Vv,$v=Ll,m_=!!Object.getOwnPropertySymbols&&!$v(function(){var E=Symbol();return!String(E)||!(Object(E)instanceof Symbol)||!Symbol.sham&&hg&&hg<41}),Uv=m_,g_=Uv&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Zv=Rd,Gv=Ra,qv=Bv,Wv=g_,Hv=Object,__=Wv?function(E){return typeof E=="symbol"}:function(E){var L=Zv("Symbol");return Gv(L)&&qv(L.prototype,Hv(E))},Xv=String,Kv=function(E){try{return Xv(E)}catch{return"Object"}},Yv=Ra,Qv=Kv,Jv=TypeError,y_=function(E){if(Yv(E))return E;throw Jv(Qv(E)+" is not a function")},e0=y_,t0=u_,r0=function(E,L){var z=E[L];return t0(z)?void 0:e0(z)},gf=Yf,_f=Ra,yf=zd,n0=TypeError,i0=function(E,L){var z,V;if(L==="string"&&_f(z=E.toString)&&!yf(V=gf(z,E))||_f(z=E.valueOf)&&!yf(V=gf(z,E))||L!=="string"&&_f(z=E.toString)&&!yf(V=gf(z,E)))return V;throw n0("Can't convert object to primitive value")},Qf={exports:{}},dg=Dl,o0=Object.defineProperty,Jf=function(E,L){try{o0(dg,E,{value:L,configurable:!0,writable:!0})}catch{dg[E]=L}return L},a0=Dl,s0=Jf,pg="__core-js_shared__",l0=a0[pg]||s0(pg,{}),em=l0,fg=em;(Qf.exports=function(E,L){return fg[E]||(fg[E]=L!==void 0?L:{})})("versions",[]).push({version:"3.25.5",mode:"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.5/LICENSE",source:"https://github.com/zloirock/core-js"});var u0=c_,c0=Object,v_=function(E){return c0(u0(E))},h0=Gs,d0=v_,p0=h0({}.hasOwnProperty),Nc=Object.hasOwn||function(L,z){return p0(d0(L),z)},f0=Gs,m0=0,g0=Math.random(),_0=f0(1 .toString),x_=function(E){return"Symbol("+(E===void 0?"":E)+")_"+_0(++m0+g0,36)},y0=Dl,v0=Qf.exports,mg=Nc,x0=x_,gg=m_,b_=g_,Bh=v0("wks"),jc=y0.Symbol,_g=jc&&jc.for,b0=b_?jc:jc&&jc.withoutSetter||x0,Dd=function(E){if(!mg(Bh,E)||!(gg||typeof Bh[E]=="string")){var L="Symbol."+E;gg&&mg(jc,E)?Bh[E]=jc[E]:b_&&_g?Bh[E]=_g(L):Bh[E]=b0(L)}return Bh[E]},w0=Yf,yg=zd,vg=__,T0=r0,S0=i0,P0=Dd,C0=TypeError,E0=P0("toPrimitive"),I0=function(E,L){if(!yg(E)||vg(E))return E;var z=T0(E,E0),V;if(z){if(L===void 0&&(L="default"),V=w0(z,E,L),!yg(V)||vg(V))return V;throw C0("Can't convert object to primitive value")}return L===void 0&&(L="number"),S0(E,L)},M0=I0,k0=__,w_=function(E){var L=M0(E,"string");return k0(L)?L:L+""},A0=Dl,xg=zd,Ff=A0.document,z0=xg(Ff)&&xg(Ff.createElement),T_=function(E){return z0?Ff.createElement(E):{}},R0=Ou,D0=Ll,L0=T_,S_=!R0&&!D0(function(){return Object.defineProperty(L0("div"),"a",{get:function(){return 7}}).a!=7}),O0=Ou,F0=Yf,B0=e_,j0=n_,N0=zp,V0=w_,$0=Nc,U0=S_,bg=Object.getOwnPropertyDescriptor;Xf.f=O0?bg:function(L,z){if(L=N0(L),z=V0(z),U0)try{return bg(L,z)}catch{}if($0(L,z))return j0(!F0(B0.f,L,z),L[z])};var $h={},Z0=Ou,G0=Ll,P_=Z0&&G0(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),q0=zd,W0=String,H0=TypeError,Rp=function(E){if(q0(E))return E;throw H0(W0(E)+" is not an object")},X0=Ou,K0=S_,Y0=P_,vp=Rp,wg=w_,Q0=TypeError,vf=Object.defineProperty,J0=Object.getOwnPropertyDescriptor,xf="enumerable",bf="configurable",wf="writable";$h.f=X0?Y0?function(L,z,V){if(vp(L),z=wg(z),vp(V),typeof L=="function"&&z==="prototype"&&"value"in V&&wf in V&&!V[wf]){var W=J0(L,z);W&&W[wf]&&(L[z]=V.value,V={configurable:bf in V?V[bf]:W[bf],enumerable:xf in V?V[xf]:W[xf],writable:!1})}return vf(L,z,V)}:vf:function(L,z,V){if(vp(L),z=wg(z),vp(V),K0)try{return vf(L,z,V)}catch{}if("get"in V||"set"in V)throw Q0("Accessors not supported");return"value"in V&&(L[z]=V.value),L};var ex=Ou,tx=$h,rx=n_,C_=ex?function(E,L,z){return tx.f(E,L,rx(1,z))}:function(E,L,z){return E[L]=z,E},E_={exports:{}},Bf=Ou,nx=Nc,I_=Function.prototype,ix=Bf&&Object.getOwnPropertyDescriptor,ox=nx(I_,"name"),ax=ox&&(!Bf||Bf&&ix(I_,"name").configurable),sx={CONFIGURABLE:ax},lx=Gs,ux=Ra,jf=em,cx=lx(Function.toString);ux(jf.inspectSource)||(jf.inspectSource=function(E){return cx(E)});var M_=jf.inspectSource,hx=Dl,dx=Ra,Tg=hx.WeakMap,px=dx(Tg)&&/native code/.test(String(Tg)),fx=Qf.exports,mx=x_,Sg=fx("keys"),k_=function(E){return Sg[E]||(Sg[E]=mx(E))},tm={},gx=px,A_=Dl,_x=C_,Tf=Nc,Sf=em,yx=k_,vx=tm,Pg="Object already initialized",Cg=A_.TypeError,xx=A_.WeakMap,Nf,Mp,Vf,bx=function(E){return Vf(E)?Mp(E):Nf(E,{})};if(gx||Sf.state){var Zs=Sf.state||(Sf.state=new xx);Zs.get=Zs.get,Zs.has=Zs.has,Zs.set=Zs.set,Nf=function(E,L){if(Zs.has(E))throw Cg(Pg);return L.facade=E,Zs.set(E,L),L},Mp=function(E){return Zs.get(E)||{}},Vf=function(E){return Zs.has(E)}}else{var jh=yx("state");vx[jh]=!0,Nf=function(E,L){if(Tf(E,jh))throw Cg(Pg);return L.facade=E,_x(E,jh,L),L},Mp=function(E){return Tf(E,jh)?E[jh]:{}},Vf=function(E){return Tf(E,jh)}}var wx={get:Mp,enforce:bx},Tx=Ll,Sx=Ra,xp=Nc,$f=Ou,Px=sx.CONFIGURABLE,Cx=M_,z_=wx,Ex=z_.enforce,Ix=z_.get,wp=Object.defineProperty,Mx=$f&&!Tx(function(){return wp(function(){},"length",{value:8}).length!==8}),kx=String(String).split("String"),Ax=E_.exports=function(E,L,z){String(L).slice(0,7)==="Symbol("&&(L="["+String(L).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),z&&z.getter&&(L="get "+L),z&&z.setter&&(L="set "+L),(!xp(E,"name")||Px&&E.name!==L)&&($f?wp(E,"name",{value:L,configurable:!0}):E.name=L),Mx&&z&&xp(z,"arity")&&E.length!==z.arity&&wp(E,"length",{value:z.arity});try{z&&xp(z,"constructor")&&z.constructor?$f&&wp(E,"prototype",{writable:!1}):E.prototype&&(E.prototype=void 0)}catch{}var V=Ex(E);return xp(V,"source")||(V.source=kx.join(typeof L=="string"?L:"")),E};Function.prototype.toString=Ax(function(){return Sx(this)&&Ix(this).source||Cx(this)},"toString");var zx=Ra,Rx=$h,Dx=E_.exports,Lx=Jf,Ox=function(E,L,z,V){V||(V={});var W=V.enumerable,ne=V.name!==void 0?V.name:L;if(zx(z)&&Dx(z,ne,V),V.global)W?E[L]=z:Lx(L,z);else{try{V.unsafe?E[L]&&(W=!0):delete E[L]}catch{}W?E[L]=z:Rx.f(E,L,{value:z,enumerable:!1,configurable:!V.nonConfigurable,writable:!V.nonWritable})}return E},R_={},Fx=Math.ceil,Bx=Math.floor,jx=Math.trunc||function(L){var z=+L;return(z>0?Bx:Fx)(z)},Nx=jx,D_=function(E){var L=+E;return L!==L||L===0?0:Nx(L)},Vx=D_,$x=Math.max,Ux=Math.min,Zx=function(E,L){var z=Vx(E);return z<0?$x(z+L,0):Ux(z,L)},Gx=D_,qx=Math.min,Wx=function(E){return E>0?qx(Gx(E),9007199254740991):0},Hx=Wx,L_=function(E){return Hx(E.length)},Xx=zp,Kx=Zx,Yx=L_,Qx=function(E){return function(L,z,V){var W=Xx(L),ne=Yx(W),M=Kx(V,ne),h;if(E&&z!=z){for(;ne>M;)if(h=W[M++],h!=h)return!0}else for(;ne>M;M++)if((E||M in W)&&W[M]===z)return E||M||0;return!E&&-1}},Jx={indexOf:Qx(!1)},e1=Gs,Pf=Nc,t1=zp,r1=Jx.indexOf,n1=tm,Eg=e1([].push),O_=function(E,L){var z=t1(E),V=0,W=[],ne;for(ne in z)!Pf(n1,ne)&&Pf(z,ne)&&Eg(W,ne);for(;L.length>V;)Pf(z,ne=L[V++])&&(~r1(W,ne)||Eg(W,ne));return W},rm=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],i1=O_,o1=rm,a1=o1.concat("length","prototype");R_.f=Object.getOwnPropertyNames||function(L){return i1(L,a1)};var F_={};F_.f=Object.getOwnPropertySymbols;var s1=Rd,l1=Gs,u1=R_,c1=F_,h1=Rp,d1=l1([].concat),p1=s1("Reflect","ownKeys")||function(L){var z=u1.f(h1(L)),V=c1.f;return V?d1(z,V(L)):z},Ig=Nc,f1=p1,m1=Xf,g1=$h,_1=function(E,L,z){for(var V=f1(L),W=g1.f,ne=m1.f,M=0;M<V.length;M++){var h=V[M];!Ig(E,h)&&!(z&&Ig(z,h))&&W(E,h,ne(L,h))}},y1=Ll,v1=Ra,x1=/#|\.prototype\./,Ld=function(E,L){var z=w1[b1(E)];return z==S1?!0:z==T1?!1:v1(L)?y1(L):!!L},b1=Ld.normalize=function(E){return String(E).replace(x1,".").toLowerCase()},w1=Ld.data={},T1=Ld.NATIVE="N",S1=Ld.POLYFILL="P",P1=Ld,Cf=Dl,C1=Xf.f,E1=C_,I1=Ox,M1=Jf,k1=_1,A1=P1,z1=function(E,L){var z=E.target,V=E.global,W=E.stat,ne,M,h,Me,Ze,qe;if(V?M=Cf:W?M=Cf[z]||M1(z,{}):M=(Cf[z]||{}).prototype,M)for(h in L){if(Ze=L[h],E.dontCallGetSet?(qe=C1(M,h),Me=qe&&qe.value):Me=M[h],ne=A1(V?h:z+(W?".":"#")+h,E.forced),!ne&&Me!==void 0){if(typeof Ze==typeof Me)continue;k1(Ze,Me)}(E.sham||Me&&Me.sham)&&E1(Ze,"sham",!0),I1(M,h,Ze,E)}},Mg=Gs,R1=y_,D1=Kf,L1=Mg(Mg.bind),O1=function(E,L){return R1(E),L===void 0?E:D1?L1(E,L):function(){return E.apply(L,arguments)}},F1=Ap,B1=Array.isArray||function(L){return F1(L)=="Array"},j1=Dd,N1=j1("toStringTag"),B_={};B_[N1]="z";var V1=String(B_)==="[object z]",$1=V1,U1=Ra,Tp=Ap,Z1=Dd,G1=Z1("toStringTag"),q1=Object,W1=Tp(function(){return arguments}())=="Arguments",H1=function(E,L){try{return E[L]}catch{}},X1=$1?Tp:function(E){var L,z,V;return E===void 0?"Undefined":E===null?"Null":typeof(z=H1(L=q1(E),G1))=="string"?z:W1?Tp(L):(V=Tp(L))=="Object"&&U1(L.callee)?"Arguments":V},K1=Gs,Y1=Ll,j_=Ra,Q1=X1,J1=Rd,eb=M_,N_=function(){},tb=[],V_=J1("Reflect","construct"),nm=/^\s*(?:class|function)\b/,rb=K1(nm.exec),nb=!nm.exec(N_),Ed=function(L){if(!j_(L))return!1;try{return V_(N_,tb,L),!0}catch{return!1}},$_=function(L){if(!j_(L))return!1;switch(Q1(L)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return nb||!!rb(nm,eb(L))}catch{return!0}};$_.sham=!0;var ib=!V_||Y1(function(){var E;return Ed(Ed.call)||!Ed(Object)||!Ed(function(){E=!0})||E})?$_:Ed,kg=B1,ob=ib,ab=zd,sb=Dd,lb=sb("species"),Ag=Array,ub=function(E){var L;return kg(E)&&(L=E.constructor,ob(L)&&(L===Ag||kg(L.prototype))?L=void 0:ab(L)&&(L=L[lb],L===null&&(L=void 0))),L===void 0?Ag:L},cb=ub,hb=function(E,L){return new(cb(E))(L===0?0:L)},db=O1,pb=Gs,fb=l_,mb=v_,gb=L_,_b=hb,zg=pb([].push),yb=function(E){var L=E==1,z=E==2,V=E==3,W=E==4,ne=E==6,M=E==7,h=E==5||ne;return function(Me,Ze,qe,Ve){for(var ze=mb(Me),ce=fb(ze),Ge=db(Ze,qe),nt=gb(ce),gt=0,qt=Ve||_b,Ft=L?qt(Me,nt):z||M?qt(Me,0):void 0,Jt,Mt;nt>gt;gt++)if((h||gt in ce)&&(Jt=ce[gt],Mt=Ge(Jt,gt,ze),E))if(L)Ft[gt]=Mt;else if(Mt)switch(E){case 3:return!0;case 5:return Jt;case 6:return gt;case 2:zg(Ft,Jt)}else switch(E){case 4:return!1;case 7:zg(Ft,Jt)}return ne?-1:V||W?W:Ft}},vb={find:yb(5)},U_={},xb=O_,bb=rm,wb=Object.keys||function(L){return xb(L,bb)},Tb=Ou,Sb=P_,Pb=$h,Cb=Rp,Eb=zp,Ib=wb;U_.f=Tb&&!Sb?Object.defineProperties:function(L,z){Cb(L);for(var V=Eb(z),W=Ib(z),ne=W.length,M=0,h;ne>M;)Pb.f(L,h=W[M++],V[h]);return L};var Mb=Rd,kb=Mb("document","documentElement"),Ab=Rp,zb=U_,Rg=rm,Rb=tm,Db=kb,Lb=T_,Ob=k_,Dg=">",Lg="<",Uf="prototype",Zf="script",Z_=Ob("IE_PROTO"),Ef=function(){},G_=function(E){return Lg+Zf+Dg+E+Lg+"/"+Zf+Dg},Og=function(E){E.write(G_("")),E.close();var L=E.parentWindow.Object;return E=null,L},Fb=function(){var E=Lb("iframe"),L="java"+Zf+":",z;return E.style.display="none",Db.appendChild(E),E.src=String(L),z=E.contentWindow.document,z.open(),z.write(G_("document.F=Object")),z.close(),z.F},bp,Sp=function(){try{bp=new ActiveXObject("htmlfile")}catch{}Sp=typeof document<"u"?document.domain&&bp?Og(bp):Fb():Og(bp);for(var E=Rg.length;E--;)delete Sp[Uf][Rg[E]];return Sp()};Rb[Z_]=!0;var Bb=Object.create||function(L,z){var V;return L!==null?(Ef[Uf]=Ab(L),V=new Ef,Ef[Uf]=null,V[Z_]=L):V=Sp(),z===void 0?V:zb.f(V,z)},jb=Dd,Nb=Bb,Vb=$h.f,Gf=jb("unscopables"),qf=Array.prototype;qf[Gf]==null&&Vb(qf,Gf,{configurable:!0,value:Nb(null)});var $b=function(E){qf[Gf][E]=!0},Ub=z1,Zb=vb.find,Gb=$b,Wf="find",q_=!0;Wf in[]&&Array(1)[Wf](function(){q_=!1});Ub({target:"Array",proto:!0,forced:q_},{find:function(L){return Zb(this,L,arguments.length>1?arguments[1]:void 0)}});Gb(Wf);var za={GLOBAL:{HIDE:"__react_tooltip_hide_event",REBUILD:"__react_tooltip_rebuild_event",SHOW:"__react_tooltip_show_event"}},If=function(L,z){var V;typeof window.CustomEvent=="function"?V=new window.CustomEvent(L,{detail:z}):(V=document.createEvent("Event"),V.initEvent(L,!1,!0,z)),window.dispatchEvent(V)};function qb(E){E.hide=function(L){If(za.GLOBAL.HIDE,{target:L})},E.rebuild=function(){If(za.GLOBAL.REBUILD)},E.show=function(L){If(za.GLOBAL.SHOW,{target:L})},E.prototype.globalRebuild=function(){this.mount&&(this.unbindListener(),this.bindListener())},E.prototype.globalShow=function(L){if(this.mount){var z=L&&L.detail&&L.detail.target&&!0||!1;this.showTooltip({currentTarget:z&&L.detail.target},!0)}},E.prototype.globalHide=function(L){if(this.mount){var z=L&&L.detail&&L.detail.target&&!0||!1;this.hideTooltip({currentTarget:z&&L.detail.target},z)}}}function Wb(E){E.prototype.bindWindowEvents=function(L){window.removeEventListener(za.GLOBAL.HIDE,this.globalHide),window.addEventListener(za.GLOBAL.HIDE,this.globalHide,!1),window.removeEventListener(za.GLOBAL.REBUILD,this.globalRebuild),window.addEventListener(za.GLOBAL.REBUILD,this.globalRebuild,!1),window.removeEventListener(za.GLOBAL.SHOW,this.globalShow),window.addEventListener(za.GLOBAL.SHOW,this.globalShow,!1),L&&(window.removeEventListener("resize",this.onWindowResize),window.addEventListener("resize",this.onWindowResize,!1))},E.prototype.unbindWindowEvents=function(){window.removeEventListener(za.GLOBAL.HIDE,this.globalHide),window.removeEventListener(za.GLOBAL.REBUILD,this.globalRebuild),window.removeEventListener(za.GLOBAL.SHOW,this.globalShow),window.removeEventListener("resize",this.onWindowResize)},E.prototype.onWindowResize=function(){this.mount&&this.hideTooltip()}}var W_=function(L,z){var V=this.state.show,W=this.props.id,ne=this.isCapture(z.currentTarget),M=z.currentTarget.getAttribute("currentItem");ne||z.stopPropagation(),V&&M==="true"?L||this.hideTooltip(z):(z.currentTarget.setAttribute("currentItem","true"),Hb(z.currentTarget,this.getTargetArray(W)),this.showTooltip(z))},Hb=function(L,z){for(var V=0;V<z.length;V++)L!==z[V]?z[V].setAttribute("currentItem","false"):z[V].setAttribute("currentItem","true")},Mf={id:"9b69f92e-d3fe-498b-b1b4-c5e63a51b0cf",set:function(L,z,V){if(this.id in L){var W=L[this.id];W[z]=V}else Object.defineProperty(L,this.id,{configurable:!0,value:kd({},z,V)})},get:function(L,z){var V=L[this.id];if(V!==void 0)return V[z]}};function Xb(E){E.prototype.isCustomEvent=function(L){var z=this.state.event;return z||!!L.getAttribute("data-event")},E.prototype.customBindListener=function(L){var z=this,V=this.state,W=V.event,ne=V.eventOff,M=L.getAttribute("data-event")||W,h=L.getAttribute("data-event-off")||ne;M.split(" ").forEach(function(Me){L.removeEventListener(Me,Mf.get(L,Me));var Ze=W_.bind(z,h);Mf.set(L,Me,Ze),L.addEventListener(Me,Ze,!1)}),h&&h.split(" ").forEach(function(Me){L.removeEventListener(Me,z.hideTooltip),L.addEventListener(Me,z.hideTooltip,!1)})},E.prototype.customUnbindListener=function(L){var z=this.state,V=z.event,W=z.eventOff,ne=V||L.getAttribute("data-event"),M=W||L.getAttribute("data-event-off");L.removeEventListener(ne,Mf.get(L,V)),M&&L.removeEventListener(M,this.hideTooltip)}}function Kb(E){E.prototype.isCapture=function(L){return L&&L.getAttribute("data-iscapture")==="true"||this.props.isCapture||!1}}function Yb(E){E.prototype.getEffect=function(L){var z=L.getAttribute("data-effect");return z||this.props.effect||"float"}}var Qb=function(L){var z={};for(var V in L)typeof L[V]=="function"?z[V]=L[V].bind(L):z[V]=L[V];return z},Id=function(L,z,V){for(var W=z.respectEffect,ne=W===void 0?!1:W,M=z.customEvent,h=M===void 0?!1:M,Me=this.props.id,Ze=null,qe,Ve=V.target,ze;Ze===null&&Ve!==null;)ze=Ve,Ze=Ve.getAttribute("data-tip")||null,qe=Ve.getAttribute("data-for")||null,Ve=Ve.parentElement;if(Ve=ze||V.target,!(this.isCustomEvent(Ve)&&!h)){var ce=Me==null&&qe==null||qe===Me;if(Ze!=null&&(!ne||this.getEffect(Ve)==="float")&&ce){var Ge=Qb(V);Ge.currentTarget=Ve,L(Ge)}}},Fg=function(L,z){var V={};return L.forEach(function(W){var ne=W.getAttribute(z);ne&&ne.split(" ").forEach(function(M){return V[M]=!0})}),V},Bg=function(){return document.getElementsByTagName("body")[0]};function Jb(E){E.prototype.isBodyMode=function(){return!!this.props.bodyMode},E.prototype.bindBodyListener=function(L){var z=this,V=this.state,W=V.event,ne=V.eventOff,M=V.possibleCustomEvents,h=V.possibleCustomEventsOff,Me=Bg(),Ze=Fg(L,"data-event"),qe=Fg(L,"data-event-off");W!=null&&(Ze[W]=!0),ne!=null&&(qe[ne]=!0),M.split(" ").forEach(function(nt){return Ze[nt]=!0}),h.split(" ").forEach(function(nt){return qe[nt]=!0}),this.unbindBodyListener(Me);var Ve=this.bodyModeListeners={};W==null&&(Ve.mouseover=Id.bind(this,this.showTooltip,{}),Ve.mousemove=Id.bind(this,this.updateTooltip,{respectEffect:!0}),Ve.mouseout=Id.bind(this,this.hideTooltip,{}));for(var ze in Ze)Ve[ze]=Id.bind(this,function(nt){var gt=nt.currentTarget.getAttribute("data-event-off")||ne;W_.call(z,gt,nt)},{customEvent:!0});for(var ce in qe)Ve[ce]=Id.bind(this,this.hideTooltip,{customEvent:!0});for(var Ge in Ve)Me.addEventListener(Ge,Ve[Ge])},E.prototype.unbindBodyListener=function(L){L=L||Bg();var z=this.bodyModeListeners;for(var V in z)L.removeEventListener(V,z[V])}}var ew=function(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver};function tw(E){E.prototype.bindRemovalTracker=function(){var L=this,z=ew();if(z!=null){var V=new z(function(W){for(var ne=0;ne<W.length;ne++)for(var M=W[ne],h=0;h<M.removedNodes.length;h++){var Me=M.removedNodes[h];if(Me===L.state.currentTarget){L.hideTooltip();return}}});V.observe(window.document,{childList:!0,subtree:!0}),this.removalTracker=V}},E.prototype.unbindRemovalTracker=function(){this.removalTracker&&(this.removalTracker.disconnect(),this.removalTracker=null)}}function jg(E,L,z,V,W,ne,M){var h=Hf(z),Me=h.width,Ze=h.height,qe=Hf(L),Ve=qe.width,ze=qe.height,ce=rw(E,L,ne),Ge=ce.mouseX,nt=ce.mouseY,gt=nw(ne,Ve,ze,Me,Ze),qt=iw(M),Ft=qt.extraOffsetX,Jt=qt.extraOffsetY,Mt=window.innerWidth,cr=window.innerHeight,Je=ow(z),pt=Je.parentTop,Lt=Je.parentLeft,Ct=function(Xe){var st=gt[Xe].l;return Ge+st+Ft},rr=function(Xe){var st=gt[Xe].r;return Ge+st+Ft},sr=function(Xe){var st=gt[Xe].t;return nt+st+Jt},Er=function(Xe){var st=gt[Xe].b;return nt+st+Jt},_r=function(Xe){return Ct(Xe)<0},Tt=function(Xe){return rr(Xe)>Mt},Nt=function(Xe){return sr(Xe)<0},bt=function(Xe){return Er(Xe)>cr},_t=function(Xe){return _r(Xe)||Tt(Xe)||Nt(Xe)||bt(Xe)},Re=function(Xe){return!_t(Xe)},et={top:Re("top"),bottom:Re("bottom"),left:Re("left"),right:Re("right")};function rt(){var ut=W.split(",").concat(V,["top","bottom","left","right"]),Xe=fv(ut),st;try{for(Xe.s();!(st=Xe.n()).done;){var xt=st.value;if(et[xt])return xt}}catch(mt){Xe.e(mt)}finally{Xe.f()}return V}var me=rt(),Ae=!1,kt;return me&&me!==V&&(Ae=!0,kt=me),Ae?{isNewState:!0,newState:{place:kt}}:{isNewState:!1,position:{left:parseInt(Ct(V)-Lt,10),top:parseInt(sr(V)-pt,10)}}}var Hf=function(L){var z=L.getBoundingClientRect(),V=z.height,W=z.width;return{height:parseInt(V,10),width:parseInt(W,10)}},rw=function(L,z,V){var W=z.getBoundingClientRect(),ne=W.top,M=W.left,h=Hf(z),Me=h.width,Ze=h.height;return V==="float"?{mouseX:L.clientX,mouseY:L.clientY}:{mouseX:M+Me/2,mouseY:ne+Ze/2}},nw=function(L,z,V,W,ne){var M,h,Me,Ze,qe=3,Ve=2,ze=12;return L==="float"?(M={l:-(W/2),r:W/2,t:-(ne+qe+Ve),b:-3},Me={l:-(W/2),r:W/2,t:qe+ze,b:ne+qe+Ve+ze},Ze={l:-(W+qe+Ve),r:-3,t:-(ne/2),b:ne/2},h={l:qe,r:W+qe+Ve,t:-(ne/2),b:ne/2}):L==="solid"&&(M={l:-(W/2),r:W/2,t:-(V/2+ne+Ve),b:-(V/2)},Me={l:-(W/2),r:W/2,t:V/2,b:V/2+ne+Ve},Ze={l:-(W+z/2+Ve),r:-(z/2),t:-(ne/2),b:ne/2},h={l:z/2,r:W+z/2+Ve,t:-(ne/2),b:ne/2}),{top:M,bottom:Me,left:Ze,right:h}},iw=function(L){var z=0,V=0;Object.prototype.toString.apply(L)==="[object String]"&&(L=JSON.parse(L.toString().replace(/'/g,'"')));for(var W in L)W==="top"?V-=parseInt(L[W],10):W==="bottom"?V+=parseInt(L[W],10):W==="left"?z-=parseInt(L[W],10):W==="right"&&(z+=parseInt(L[W],10));return{extraOffsetX:z,extraOffsetY:V}},ow=function(L){for(var z=L;z;){var V=window.getComputedStyle(z);if(V.getPropertyValue("transform")!=="none"||V.getPropertyValue("will-change")==="transform")break;z=z.parentElement}var W=z&&z.getBoundingClientRect().top||0,ne=z&&z.getBoundingClientRect().left||0;return{parentTop:W,parentLeft:ne}};function Ng(E,L,z,V){if(L)return L;if(z!=null)return z;if(z===null)return null;var W=/<br\s*\/?>/;return!V||V==="false"||!W.test(E)?E:E.split(W).map(function(ne,M){return ti.createElement("span",{key:M,className:"multi-line"},ne)})}function Vg(E){var L={};return Object.keys(E).filter(function(z){return/(^aria-\w+$|^role$)/.test(z)}).forEach(function(z){L[z]=E[z]}),L}function kf(E){var L=E.length;return E.hasOwnProperty?Array.prototype.slice.call(E):new Array(L).fill().map(function(z){return E[z]})}function aw(){return"t"+ov()}var sw=`.__react_component_tooltip {
  border-radius: 3px;
  display: inline-block;
  font-size: 13px;
  left: -999em;
  opacity: 0;
  position: fixed;
  pointer-events: none;
  transition: opacity 0.3s ease-out;
  top: -999em;
  visibility: hidden;
  z-index: 999;
}
.__react_component_tooltip.allow_hover, .__react_component_tooltip.allow_click {
  pointer-events: auto;
}
.__react_component_tooltip::before, .__react_component_tooltip::after {
  content: "";
  width: 0;
  height: 0;
  position: absolute;
}
.__react_component_tooltip.show {
  opacity: 0.9;
  margin-top: 0;
  margin-left: 0;
  visibility: visible;
}
.__react_component_tooltip.place-top::before {
  bottom: 0;
  left: 50%;
  margin-left: -11px;
}
.__react_component_tooltip.place-bottom::before {
  top: 0;
  left: 50%;
  margin-left: -11px;
}
.__react_component_tooltip.place-left::before {
  right: 0;
  top: 50%;
  margin-top: -9px;
}
.__react_component_tooltip.place-right::before {
  left: 0;
  top: 50%;
  margin-top: -9px;
}
.__react_component_tooltip .multi-line {
  display: block;
  padding: 2px 0;
  text-align: center;
}`,$g={dark:{text:"#fff",background:"#222",border:"transparent",arrow:"#222"},success:{text:"#fff",background:"#8DC572",border:"transparent",arrow:"#8DC572"},warning:{text:"#fff",background:"#F0AD4E",border:"transparent",arrow:"#F0AD4E"},error:{text:"#fff",background:"#BE6464",border:"transparent",arrow:"#BE6464"},info:{text:"#fff",background:"#337AB7",border:"transparent",arrow:"#337AB7"},light:{text:"#222",background:"#fff",border:"transparent",arrow:"#fff"}};function lw(E){return $g[E]?Rf({},$g[E]):void 0}var uw="8px 21px",cw={tooltip:3,arrow:0};function hw(E,L,z,V,W,ne){return dw(E,pw(L,z,V),W,ne)}function dw(E,L){var z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uw,V=arguments.length>3&&arguments[3]!==void 0?arguments[3]:cw,W=L.text,ne=L.background,M=L.border,h=L.arrow,Me=V.arrow,Ze=V.tooltip;return`
  	.`.concat(E,` {
	    color: `).concat(W,`;
	    background: `).concat(ne,`;
	    border: 1px solid `).concat(M,`;
	    border-radius: `).concat(Ze,`px;
	    padding: `).concat(z,`;
  	}

  	.`).concat(E,`.place-top {
        margin-top: -10px;
    }
    .`).concat(E,`.place-top::before {
        content: "";
        background-color: inherit;
        position: absolute;
        z-index: 2;
        width: 20px;
        height: 12px;
    }
    .`).concat(E,`.place-top::after {
        content: "";
        position: absolute;
        width: 10px;
        height: 10px;
        border-top-right-radius: `).concat(Me,`px;
        border: 1px solid `).concat(M,`;
        background-color: `).concat(h,`;
        z-index: -2;
        bottom: -6px;
        left: 50%;
        margin-left: -6px;
        transform: rotate(135deg);
    }

    .`).concat(E,`.place-bottom {
        margin-top: 10px;
    }
    .`).concat(E,`.place-bottom::before {
        content: "";
        background-color: inherit;
        position: absolute;
        z-index: -1;
        width: 18px;
        height: 10px;
    }
    .`).concat(E,`.place-bottom::after {
        content: "";
        position: absolute;
        width: 10px;
        height: 10px;
        border-top-right-radius: `).concat(Me,`px;
        border: 1px solid `).concat(M,`;
        background-color: `).concat(h,`;
        z-index: -2;
        top: -6px;
        left: 50%;
        margin-left: -6px;
        transform: rotate(45deg);
    }

    .`).concat(E,`.place-left {
        margin-left: -10px;
    }
    .`).concat(E,`.place-left::before {
        content: "";
        background-color: inherit;
        position: absolute;
        z-index: -1;
        width: 10px;
        height: 18px;
    }
    .`).concat(E,`.place-left::after {
        content: "";
        position: absolute;
        width: 10px;
        height: 10px;
        border-top-right-radius: `).concat(Me,`px;
        border: 1px solid `).concat(M,`;
        background-color: `).concat(h,`;
        z-index: -2;
        right: -6px;
        top: 50%;
        margin-top: -6px;
        transform: rotate(45deg);
    }

    .`).concat(E,`.place-right {
        margin-left: 10px;
    }
    .`).concat(E,`.place-right::before {
        content: "";
        background-color: inherit;
        position: absolute;
        z-index: -1;
        width: 10px;
        height: 18px;
    }
    .`).concat(E,`.place-right::after {
        content: "";
        position: absolute;
        width: 10px;
        height: 10px;
        border-top-right-radius: `).concat(Me,`px;
        border: 1px solid `).concat(M,`;
        background-color: `).concat(h,`;
        z-index: -2;
        left: -6px;
        top: 50%;
        margin-top: -6px;
        transform: rotate(-135deg);
    }
  `)}function pw(E,L,z){var V=E.text,W=E.background,ne=E.border,M=E.arrow?E.arrow:E.background,h=lw(L);return V&&(h.text=V),W&&(h.background=W),z&&(ne?h.border=ne:h.border=L==="light"?"black":"white"),M&&(h.arrow=M),h}var Fo,Md,fw=qb(Fo=Wb(Fo=Xb(Fo=Kb(Fo=Yb(Fo=Jb(Fo=tw(Fo=(Md=function(E){lv(z,E);var L=dv(z);function z(V){var W;return av(this,z),W=L.call(this,V),W.state={uuid:V.uuid||aw(),place:V.place||"top",desiredPlace:V.place||"top",type:V.type||"dark",effect:V.effect||"float",show:!1,border:!1,borderClass:"border",customColors:{},customRadius:{},offset:{},padding:V.padding,extraClass:"",html:!1,delayHide:0,delayShow:0,event:V.event||null,eventOff:V.eventOff||null,currentEvent:null,currentTarget:null,ariaProps:Vg(V),isEmptyTip:!1,disable:!1,possibleCustomEvents:V.possibleCustomEvents||"",possibleCustomEventsOff:V.possibleCustomEventsOff||"",originTooltip:null,isMultiline:!1},W.bind(["showTooltip","updateTooltip","hideTooltip","hideTooltipOnScroll","getTooltipContent","globalRebuild","globalShow","globalHide","onWindowResize","mouseOnToolTip"]),W.mount=!0,W.delayShowLoop=null,W.delayHideLoop=null,W.delayReshow=null,W.intervalUpdateContent=null,W}return sv(z,[{key:"bind",value:function(W){var ne=this;W.forEach(function(M){ne[M]=ne[M].bind(ne)})}},{key:"componentDidMount",value:function(){var W=this.props;W.insecure;var ne=W.resizeHide,M=W.disableInternalStyle;this.mount=!0,this.bindListener(),this.bindWindowEvents(ne),M||this.injectStyles()}},{key:"componentWillUnmount",value:function(){this.mount=!1,this.clearTimer(),this.unbindListener(),this.removeScrollListener(this.state.currentTarget),this.unbindWindowEvents()}},{key:"injectStyles",value:function(){var W=this.tooltipRef;if(W){for(var ne=W.parentNode;ne.parentNode;)ne=ne.parentNode;var M;switch(ne.constructor.name){case"Document":case"HTMLDocument":case void 0:M=ne.head;break;case"ShadowRoot":default:M=ne;break}if(!M.querySelector("style[data-react-tooltip]")){var h=document.createElement("style");h.textContent=sw,h.setAttribute("data-react-tooltip","true"),M.appendChild(h)}}}},{key:"mouseOnToolTip",value:function(){var W=this.state.show;return W&&this.tooltipRef?(this.tooltipRef.matches||(this.tooltipRef.msMatchesSelector?this.tooltipRef.matches=this.tooltipRef.msMatchesSelector:this.tooltipRef.matches=this.tooltipRef.mozMatchesSelector),this.tooltipRef.matches(":hover")):!1}},{key:"getTargetArray",value:function(W){var ne=[],M;if(!W)M="[data-tip]:not([data-for])";else{var h=W.replace(/\\/g,"\\\\").replace(/"/g,'\\"');M='[data-tip][data-for="'.concat(h,'"]')}return kf(document.getElementsByTagName("*")).filter(function(Me){return Me.shadowRoot}).forEach(function(Me){ne=ne.concat(kf(Me.shadowRoot.querySelectorAll(M)))}),ne.concat(kf(document.querySelectorAll(M)))}},{key:"bindListener",value:function(){var W=this,ne=this.props,M=ne.id,h=ne.globalEventOff,Me=ne.isCapture,Ze=this.getTargetArray(M);Ze.forEach(function(qe){qe.getAttribute("currentItem")===null&&qe.setAttribute("currentItem","false"),W.unbindBasicListener(qe),W.isCustomEvent(qe)&&W.customUnbindListener(qe)}),this.isBodyMode()?this.bindBodyListener(Ze):Ze.forEach(function(qe){var Ve=W.isCapture(qe),ze=W.getEffect(qe);if(W.isCustomEvent(qe)){W.customBindListener(qe);return}qe.addEventListener("mouseenter",W.showTooltip,Ve),qe.addEventListener("focus",W.showTooltip,Ve),ze==="float"&&qe.addEventListener("mousemove",W.updateTooltip,Ve),qe.addEventListener("mouseleave",W.hideTooltip,Ve),qe.addEventListener("blur",W.hideTooltip,Ve)}),h&&(window.removeEventListener(h,this.hideTooltip),window.addEventListener(h,this.hideTooltip,Me)),this.bindRemovalTracker()}},{key:"unbindListener",value:function(){var W=this,ne=this.props,M=ne.id,h=ne.globalEventOff;if(this.isBodyMode())this.unbindBodyListener();else{var Me=this.getTargetArray(M);Me.forEach(function(Ze){W.unbindBasicListener(Ze),W.isCustomEvent(Ze)&&W.customUnbindListener(Ze)})}h&&window.removeEventListener(h,this.hideTooltip),this.unbindRemovalTracker()}},{key:"unbindBasicListener",value:function(W){var ne=this.isCapture(W);W.removeEventListener("mouseenter",this.showTooltip,ne),W.removeEventListener("mousemove",this.updateTooltip,ne),W.removeEventListener("mouseleave",this.hideTooltip,ne)}},{key:"getTooltipContent",value:function(){var W=this.props,ne=W.getContent,M=W.children,h;return ne&&(Array.isArray(ne)?h=ne[0]&&ne[0](this.state.originTooltip):h=ne(this.state.originTooltip)),Ng(this.state.originTooltip,M,h,this.state.isMultiline)}},{key:"isEmptyTip",value:function(W){return typeof W=="string"&&W===""||W===null}},{key:"showTooltip",value:function(W,ne){if(this.tooltipRef){if(ne){var M=this.getTargetArray(this.props.id),h=M.some(function(Lt){return Lt===W.currentTarget});if(!h)return}var Me=this.props,Ze=Me.multiline,qe=Me.getContent,Ve=W.currentTarget.getAttribute("data-tip"),ze=W.currentTarget.getAttribute("data-multiline")||Ze||!1,ce=W instanceof window.FocusEvent||ne,Ge=!0;W.currentTarget.getAttribute("data-scroll-hide")?Ge=W.currentTarget.getAttribute("data-scroll-hide")==="true":this.props.scrollHide!=null&&(Ge=this.props.scrollHide),W&&W.currentTarget&&W.currentTarget.setAttribute&&W.currentTarget.setAttribute("aria-describedby",this.props.id||this.state.uuid);var nt=W.currentTarget.getAttribute("data-place")||this.props.place||"top",gt=ce&&"solid"||this.getEffect(W.currentTarget),qt=W.currentTarget.getAttribute("data-offset")||this.props.offset||{},Ft=jg(W,W.currentTarget,this.tooltipRef,nt.split(",")[0],nt,gt,qt);Ft.position&&this.props.overridePosition&&(Ft.position=this.props.overridePosition(Ft.position,W,W.currentTarget,this.tooltipRef,nt,nt,gt,qt));var Jt=Ft.isNewState?Ft.newState.place:nt.split(",")[0];this.clearTimer();var Mt=W.currentTarget,cr=this.state.show?Mt.getAttribute("data-delay-update")||this.props.delayUpdate:0,Je=this,pt=function(){Je.setState({originTooltip:Ve,isMultiline:ze,desiredPlace:nt,place:Jt,type:Mt.getAttribute("data-type")||Je.props.type||"dark",customColors:{text:Mt.getAttribute("data-text-color")||Je.props.textColor||null,background:Mt.getAttribute("data-background-color")||Je.props.backgroundColor||null,border:Mt.getAttribute("data-border-color")||Je.props.borderColor||null,arrow:Mt.getAttribute("data-arrow-color")||Je.props.arrowColor||null},customRadius:{tooltip:Mt.getAttribute("data-tooltip-radius")||Je.props.tooltipRadius||"3",arrow:Mt.getAttribute("data-arrow-radius")||Je.props.arrowRadius||"0"},effect:gt,offset:qt,padding:Mt.getAttribute("data-padding")||Je.props.padding,html:(Mt.getAttribute("data-html")?Mt.getAttribute("data-html")==="true":Je.props.html)||!1,delayShow:Mt.getAttribute("data-delay-show")||Je.props.delayShow||0,delayHide:Mt.getAttribute("data-delay-hide")||Je.props.delayHide||0,delayUpdate:Mt.getAttribute("data-delay-update")||Je.props.delayUpdate||0,border:(Mt.getAttribute("data-border")?Mt.getAttribute("data-border")==="true":Je.props.border)||!1,borderClass:Mt.getAttribute("data-border-class")||Je.props.borderClass||"border",extraClass:Mt.getAttribute("data-class")||Je.props.class||Je.props.className||"",disable:(Mt.getAttribute("data-tip-disable")?Mt.getAttribute("data-tip-disable")==="true":Je.props.disable)||!1,currentTarget:Mt},function(){Ge&&Je.addScrollListener(Je.state.currentTarget),Je.updateTooltip(W),qe&&Array.isArray(qe)&&(Je.intervalUpdateContent=setInterval(function(){if(Je.mount){var Ct=Je.props.getContent,rr=Ng(Ve,"",Ct[0](),ze),sr=Je.isEmptyTip(rr);Je.setState({isEmptyTip:sr}),Je.updatePosition()}},qe[1]))})};cr?this.delayReshow=setTimeout(pt,cr):pt()}}},{key:"updateTooltip",value:function(W){var ne=this,M=this.state,h=M.delayShow,Me=M.disable,Ze=this.props,qe=Ze.afterShow,Ve=Ze.disable,ze=this.getTooltipContent(),ce=W.currentTarget||W.target;if(!this.mouseOnToolTip()&&!(this.isEmptyTip(ze)||Me||Ve)){var Ge=this.state.show?0:parseInt(h,10),nt=function(){if(Array.isArray(ze)&&ze.length>0||ze){var qt=!ne.state.show;ne.setState({currentEvent:W,currentTarget:ce,show:!0},function(){ne.updatePosition(function(){qt&&qe&&qe(W)})})}};this.delayShowLoop&&clearTimeout(this.delayShowLoop),Ge?this.delayShowLoop=setTimeout(nt,Ge):(this.delayShowLoop=null,nt())}}},{key:"listenForTooltipExit",value:function(){var W=this.state.show;W&&this.tooltipRef&&this.tooltipRef.addEventListener("mouseleave",this.hideTooltip)}},{key:"removeListenerForTooltipExit",value:function(){var W=this.state.show;W&&this.tooltipRef&&this.tooltipRef.removeEventListener("mouseleave",this.hideTooltip)}},{key:"hideTooltip",value:function(W,ne){var M=this,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isScroll:!1},Me=this.state.disable,Ze=h.isScroll,qe=Ze?0:this.state.delayHide,Ve=this.props,ze=Ve.afterHide,ce=Ve.disable,Ge=this.getTooltipContent();if(this.mount&&!(this.isEmptyTip(Ge)||Me||ce)){if(ne){var nt=this.getTargetArray(this.props.id),gt=nt.some(function(Ft){return Ft===W.currentTarget});if(!gt||!this.state.show)return}W&&W.currentTarget&&W.currentTarget.removeAttribute&&W.currentTarget.removeAttribute("aria-describedby");var qt=function(){var Jt=M.state.show;if(M.mouseOnToolTip()){M.listenForTooltipExit();return}M.removeListenerForTooltipExit(),M.setState({show:!1},function(){M.removeScrollListener(M.state.currentTarget),Jt&&ze&&ze(W)})};this.clearTimer(),qe?this.delayHideLoop=setTimeout(qt,parseInt(qe,10)):qt()}}},{key:"hideTooltipOnScroll",value:function(W,ne){this.hideTooltip(W,ne,{isScroll:!0})}},{key:"addScrollListener",value:function(W){var ne=this.isCapture(W);window.addEventListener("scroll",this.hideTooltipOnScroll,ne)}},{key:"removeScrollListener",value:function(W){var ne=this.isCapture(W);window.removeEventListener("scroll",this.hideTooltipOnScroll,ne)}},{key:"updatePosition",value:function(W){var ne=this,M=this.state,h=M.currentEvent,Me=M.currentTarget,Ze=M.place,qe=M.desiredPlace,Ve=M.effect,ze=M.offset,ce=this.tooltipRef,Ge=jg(h,Me,ce,Ze,qe,Ve,ze);if(Ge.position&&this.props.overridePosition&&(Ge.position=this.props.overridePosition(Ge.position,h,Me,ce,Ze,qe,Ve,ze)),Ge.isNewState)return this.setState(Ge.newState,function(){ne.updatePosition(W)});W&&typeof W=="function"&&W(),ce.style.left=Ge.position.left+"px",ce.style.top=Ge.position.top+"px"}},{key:"clearTimer",value:function(){this.delayShowLoop&&(clearTimeout(this.delayShowLoop),this.delayShowLoop=null),this.delayHideLoop&&(clearTimeout(this.delayHideLoop),this.delayHideLoop=null),this.delayReshow&&(clearTimeout(this.delayReshow),this.delayReshow=null),this.intervalUpdateContent&&(clearInterval(this.intervalUpdateContent),this.intervalUpdateContent=null)}},{key:"hasCustomColors",value:function(){var W=this;return!!(Object.keys(this.state.customColors).find(function(ne){return ne!=="border"&&W.state.customColors[ne]})||this.state.border&&this.state.customColors.border)}},{key:"render",value:function(){var W=this,ne=this.state,M=ne.extraClass,h=ne.html,Me=ne.ariaProps,Ze=ne.disable,qe=ne.uuid,Ve=this.getTooltipContent(),ze=this.isEmptyTip(Ve),ce=this.props.disableInternalStyle?"":hw(this.state.uuid,this.state.customColors,this.state.type,this.state.border,this.state.padding,this.state.customRadius),Ge="__react_component_tooltip"+" ".concat(this.state.uuid)+(this.state.show&&!Ze&&!ze?" show":"")+(this.state.border?" "+this.state.borderClass:"")+" place-".concat(this.state.place)+" type-".concat(this.hasCustomColors()?"custom":this.state.type)+(this.props.delayUpdate?" allow_hover":"")+(this.props.clickable?" allow_click":""),nt=this.props.wrapper;z.supportedWrappers.indexOf(nt)<0&&(nt=z.defaultProps.wrapper);var gt=[Ge,M].filter(Boolean).join(" ");if(h){var qt="".concat(Ve).concat(ce?`
<style aria-hidden="true">`.concat(ce,"</style>"):"");return ti.createElement(nt,Cp({className:"".concat(gt),id:this.props.id||qe,ref:function(Jt){return W.tooltipRef=Jt}},Me,{"data-id":"tooltip",dangerouslySetInnerHTML:{__html:qt}}))}else return ti.createElement(nt,Cp({className:"".concat(gt),id:this.props.id||qe},Me,{ref:function(Jt){return W.tooltipRef=Jt},"data-id":"tooltip"}),ce&&ti.createElement("style",{dangerouslySetInnerHTML:{__html:ce},"aria-hidden":"true"}),Ve)}}],[{key:"propTypes",get:function(){return{uuid:gr.string,children:gr.any,place:gr.string,type:gr.string,effect:gr.string,offset:gr.object,padding:gr.string,multiline:gr.bool,border:gr.bool,borderClass:gr.string,textColor:gr.string,backgroundColor:gr.string,borderColor:gr.string,arrowColor:gr.string,arrowRadius:gr.string,tooltipRadius:gr.string,insecure:gr.bool,class:gr.string,className:gr.string,id:gr.string,html:gr.bool,delayHide:gr.number,delayUpdate:gr.number,delayShow:gr.number,event:gr.string,eventOff:gr.string,isCapture:gr.bool,globalEventOff:gr.string,getContent:gr.any,afterShow:gr.func,afterHide:gr.func,overridePosition:gr.func,disable:gr.bool,scrollHide:gr.bool,resizeHide:gr.bool,wrapper:gr.string,bodyMode:gr.bool,possibleCustomEvents:gr.string,possibleCustomEventsOff:gr.string,clickable:gr.bool,disableInternalStyle:gr.bool}}},{key:"getDerivedStateFromProps",value:function(W,ne){var M=ne.ariaProps,h=Vg(W),Me=Object.keys(h).some(function(Ze){return h[Ze]!==M[Ze]});return Me?Rf(Rf({},ne),{},{ariaProps:h}):null}}]),z}(ti.Component),kd(Md,"defaultProps",{insecure:!0,resizeHide:!0,wrapper:"div",clickable:!1}),kd(Md,"supportedWrappers",["div","span"]),kd(Md,"displayName","ReactTooltip"),Md))||Fo)||Fo)||Fo)||Fo)||Fo)||Fo)||Fo,Pp={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.2.0/LICENSE.txt
 */var mw=Pp.exports,Ug;function gw(){return Ug||(Ug=1,function(E,L){(function(z,V){E.exports=V()})(mw,function(){var z={},V={};function W(M,h,Me){if(V[M]=Me,M==="index"){var Ze="var sharedModule = {}; ("+V.shared+")(sharedModule); ("+V.worker+")(sharedModule);",qe={};return V.shared(qe),V.index(z,qe),typeof window<"u"&&z.setWorkerUrl(window.URL.createObjectURL(new Blob([Ze],{type:"text/javascript"}))),z}}W("shared",["exports"],function(M){function h(n,t,i,a){return new(i||(i=Promise))(function(c,f){function g(T){try{b(a.next(T))}catch(C){f(C)}}function y(T){try{b(a.throw(T))}catch(C){f(C)}}function b(T){var C;T.done?c(T.value):(C=T.value,C instanceof i?C:new i(function(k){k(C)})).then(g,y)}b((a=a.apply(n,t||[])).next())})}function Me(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ze,qe;function Ve(){if(qe)return Ze;function n(t,i){this.x=t,this.y=i}return qe=1,Ze=n,n.prototype={clone:function(){return new n(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,i){return this.clone()._rotateAround(t,i)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var i=t.x-this.x,a=t.y-this.y;return i*i+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,i){return Math.atan2(this.x*i-this.y*t,this.x*t+this.y*i)},_matMult:function(t){var i=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=i,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var i=Math.cos(t),a=Math.sin(t),c=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=c,this},_rotateAround:function(t,i){var a=Math.cos(t),c=Math.sin(t),f=i.y+c*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-c*(this.y-i.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(t){return t instanceof n?t:Array.isArray(t)?new n(t[0],t[1]):t},Ze}typeof SuppressedError=="function"&&SuppressedError;var ze,ce,Ge=Me(Ve()),nt=function(){if(ce)return ze;function n(t,i,a,c){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(c-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=c}return ce=1,ze=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,c=0;c<8;c++){var f=this.sampleCurveX(a)-t;if(Math.abs(f)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=f/g}var y=0,b=1;for(a=t,c=0;c<20&&(f=this.sampleCurveX(a),!(Math.abs(f-t)<i));c++)t>f?y=a:b=a,a=.5*(b-y)+y;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},ze}(),gt=Me(nt);let qt,Ft;function Jt(){return qt==null&&(qt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),qt}function Mt(){if(Ft==null&&(Ft=!1,Jt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let a=0;a<5*5;a++){const c=4*a;t.fillStyle=`rgb(${c},${c+1},${c+2})`,t.fillRect(a%5,Math.floor(a/5),1,1)}const i=t.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&i[a]!==a){Ft=!0;break}}}return Ft||!1}var cr,Je=1e-6,pt=typeof Float32Array<"u"?Float32Array:Array;function Lt(){var n=new pt(9);return pt!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function Ct(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function rr(){var n=new pt(3);return pt!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function sr(n,t,i){var a=new pt(3);return a[0]=n,a[1]=t,a[2]=i,a}function Er(n,t,i){var a=t[0],c=t[1],f=t[2],g=t[3];return n[0]=i[0]*a+i[4]*c+i[8]*f+i[12]*g,n[1]=i[1]*a+i[5]*c+i[9]*f+i[13]*g,n[2]=i[2]*a+i[6]*c+i[10]*f+i[14]*g,n[3]=i[3]*a+i[7]*c+i[11]*f+i[15]*g,n}function _r(){var n=new pt(4);return pt!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function Tt(){var n=new pt(2);return pt!=Float32Array&&(n[0]=0,n[1]=0),n}function Nt(n,t){var i=new pt(2);return i[0]=n,i[1]=t,i}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)}),rr(),cr=new pt(4),pt!=Float32Array&&(cr[0]=0,cr[1]=0,cr[2]=0,cr[3]=0),rr(),sr(1,0,0),sr(0,1,0),_r(),_r(),Lt(),Tt();const bt=8192;function _t(n,t,i){return t*(bt/(n.tileSize*Math.pow(2,i-n.tileID.overscaledZ)))}function Re(n,t){return(n%t+t)%t}function et(n,t,i){return n*(1-i)+t*i}function rt(n){if(n<=0)return 0;if(n>=1)return 1;const t=n*n,i=t*n;return 4*(n<.5?i:3*(n-t)+i-.75)}function me(n,t,i,a){const c=new gt(n,t,i,a);return f=>c.solve(f)}const Ae=me(.25,.1,.25,1);function kt(n,t,i){return Math.min(i,Math.max(t,n))}function ut(n,t,i){const a=i-t,c=((n-t)%a+a)%a+t;return c===t?i:c}function Xe(n,...t){for(const i of t)for(const a in i)n[a]=i[a];return n}let st=1;function xt(n,t,i){const a={};for(const c in n)a[c]=t.call(this,n[c],c,n);return a}function mt(n,t,i){const a={};for(const c in n)t.call(this,n[c],c,n)&&(a[c]=n[c]);return a}function St(n){return Array.isArray(n)?n.map(St):typeof n=="object"&&n?xt(n,St):n}const lr={};function or(n){lr[n]||(typeof console<"u"&&console.warn(n),lr[n]=!0)}function Mr(n,t,i){return(i.y-n.y)*(t.x-n.x)>(t.y-n.y)*(i.x-n.x)}function kr(n){return typeof WorkerGlobalScope<"u"&&n!==void 0&&n instanceof WorkerGlobalScope}let Ar=null;function di(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const $i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Tn(n,t,i,a,c){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const f=new VideoFrame(n,{timestamp:0});try{const g=f==null?void 0:f.format;if(!g||!g.startsWith("BGR")&&!g.startsWith("RGB"))throw new Error(`Unrecognized format ${g}`);const y=g.startsWith("BGR"),b=new Uint8ClampedArray(a*c*4);if(yield f.copyTo(b,function(T,C,k,F,j){const N=4*Math.max(1,0),Z=(Math.max(0,k)-k)*F*4+N,K=4*F,te=Math.max(0,C),fe=Math.max(0,k);return{rect:{x:te,y:fe,width:Math.min(T.width,C+F)-te,height:Math.min(T.height,k+j)-fe},layout:[{offset:Z,stride:K}]}}(n,t,i,a,c)),y)for(let T=0;T<b.length;T+=4){const C=b[T];b[T]=b[T+2],b[T+2]=C}return b}finally{f.close()}})}let tn,ri;function zn(n,t,i,a){return n.addEventListener(t,i,a),{unsubscribe:()=>{n.removeEventListener(t,i,a)}}}function rn(n){return n/Math.PI*180}const Nn="AbortError";function Ui(){return new Error(Nn)}const ao={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function wo(n){return ao.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))]}const Zi="global-dispatcher";class pi extends Error{constructor(t,i,a,c){super(`AJAXError: ${i} (${t}): ${a}`),this.status=t,this.statusText=i,this.url=a,this.body=c}}const ni=()=>kr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,fi=function(n,t){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){const a=wo(n.url);if(a)return a(n,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,targetMapId:Zi},t)}if(!(/^file:/.test(i=n.url)||/^file:/.test(ni())&&!/^\w+:/.test(i))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(a,c){return h(this,void 0,void 0,function*(){const f=new Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,cache:a.cache,referrer:ni(),signal:c.signal});let g,y;a.type!=="json"||f.headers.has("Accept")||f.headers.set("Accept","application/json");try{g=yield fetch(f)}catch(T){throw new pi(0,T.message,a.url,new Blob)}if(!g.ok){const T=yield g.blob();throw new pi(g.status,g.statusText,a.url,T)}y=a.type==="arrayBuffer"||a.type==="image"?g.arrayBuffer():a.type==="json"?g.json():g.text();const b=yield y;if(c.signal.aborted)throw Ui();return{data:b,cacheControl:g.headers.get("Cache-Control"),expires:g.headers.get("Expires")}})}(n,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:n,mustQueue:!0,targetMapId:Zi},t)}var i;return function(a,c){return new Promise((f,g)=>{var y;const b=new XMLHttpRequest;b.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(b.responseType="arraybuffer");for(const T in a.headers)b.setRequestHeader(T,a.headers[T]);a.type==="json"&&(b.responseType="text",!((y=a.headers)===null||y===void 0)&&y.Accept||b.setRequestHeader("Accept","application/json")),b.withCredentials=a.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if(!c.signal.aborted)if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let T=b.response;if(a.type==="json")try{T=JSON.parse(b.response)}catch(C){return void g(C)}f({data:T,cacheControl:b.getResponseHeader("Cache-Control"),expires:b.getResponseHeader("Expires")})}else{const T=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});g(new pi(b.status,b.statusText,a.url,T))}},c.signal.addEventListener("abort",()=>{b.abort(),g(Ui())}),b.send(a.body)})}(n,t)};function mi(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const t=new URL(n),i=window.location;return t.protocol===i.protocol&&t.host===i.host}function Gi(n,t,i){i[n]&&i[n].indexOf(t)!==-1||(i[n]=i[n]||[],i[n].push(t))}function so(n,t,i){if(i&&i[n]){const a=i[n].indexOf(t);a!==-1&&i[n].splice(a,1)}}class na{constructor(t,i={}){Xe(this,i),this.type=t}}class Ai extends na{constructor(t,i={}){super("error",Xe({error:t},i))}}class xe{on(t,i){return this._listeners=this._listeners||{},Gi(t,i,this._listeners),{unsubscribe:()=>{this.off(t,i)}}}off(t,i){return so(t,i,this._listeners),so(t,i,this._oneTimeListeners),this}once(t,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Gi(t,i,this._oneTimeListeners),this):new Promise(a=>this.once(t,a))}fire(t,i){typeof t=="string"&&(t=new na(t,i||{}));const a=t.type;if(this.listens(a)){t.target=this;const c=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const y of c)y.call(this,t);const f=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const y of f)so(a,y,this._oneTimeListeners),y.call(this,t);const g=this._eventedParent;g&&(Xe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof Ai&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,i){return this._eventedParent=t,this._eventedParentData=i,this}}var R={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const q=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(n,t){const i={};for(const a in n)a!=="ref"&&(i[a]=n[a]);return q.forEach(a=>{a in t&&(i[a]=t[a])}),i}function ee(n,t){if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let i=0;i<n.length;i++)if(!ee(n[i],t[i]))return!1;return!0}if(typeof n=="object"&&n!==null&&t!==null){if(typeof t!="object"||Object.keys(n).length!==Object.keys(t).length)return!1;for(const i in n)if(!ee(n[i],t[i]))return!1;return!0}return n===t}function he(n,t){n.push(t)}function ye(n,t,i){he(i,{command:"addSource",args:[n,t[n]]})}function Pe(n,t,i){he(t,{command:"removeSource",args:[n]}),i[n]=!0}function _e(n,t,i,a){Pe(n,i,a),ye(n,t,i)}function Ne(n,t,i){let a;for(a in n[i])if(Object.prototype.hasOwnProperty.call(n[i],a)&&a!=="data"&&!ee(n[i][a],t[i][a]))return!1;for(a in t[i])if(Object.prototype.hasOwnProperty.call(t[i],a)&&a!=="data"&&!ee(n[i][a],t[i][a]))return!1;return!0}function De(n,t,i,a,c,f){n=n||{},t=t||{};for(const g in n)Object.prototype.hasOwnProperty.call(n,g)&&(ee(n[g],t[g])||i.push({command:f,args:[a,g,t[g],c]}));for(const g in t)Object.prototype.hasOwnProperty.call(t,g)&&!Object.prototype.hasOwnProperty.call(n,g)&&(ee(n[g],t[g])||i.push({command:f,args:[a,g,t[g],c]}))}function Te(n){return n.id}function We(n,t){return n[t.id]=t,n}class Se{constructor(t,i,a,c){this.message=(t?`${t}: `:"")+a,c&&(this.identifier=c),i!=null&&i.__line__&&(this.line=i.__line__)}}function dt(n,...t){for(const i of t)for(const a in i)n[a]=i[a];return n}class Et extends Error{constructor(t,i){super(i),this.message=i,this.key=t}}class Kt{constructor(t,i=[]){this.parent=t,this.bindings={};for(const[a,c]of i)this.bindings[a]=c}concat(t){return new Kt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Vt={kind:"null"},$e={kind:"number"},vt={kind:"string"},yt={kind:"boolean"},er={kind:"color"},Wt={kind:"projectionDefinition"},ir={kind:"object"},Bt={kind:"value"},Da={kind:"collator"},Zr={kind:"formatted"},on={kind:"padding"},jr={kind:"resolvedImage"},Ol={kind:"variableAnchorOffsetCollection"};function ii(n,t){return{kind:"array",itemType:n,N:t}}function Dr(n){if(n.kind==="array"){const t=Dr(n.itemType);return typeof n.N=="number"?`array<${t}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${t}>`}return n.kind}const Fu=[Vt,$e,vt,yt,er,Wt,Zr,ir,ii(Bt),on,jr,Ol];function cs(n,t){if(t.kind==="error")return null;if(n.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!cs(n.itemType,t.itemType))&&(typeof n.N!="number"||n.N===t.N))return null}else{if(n.kind===t.kind)return null;if(n.kind==="value"){for(const i of Fu)if(!cs(i,t))return null}}return`Expected ${Dr(n)} but found ${Dr(t)} instead.`}function Bu(n,t){return t.some(i=>i.kind===n.kind)}function ia(n,t){return t.some(i=>i==="null"?n===null:i==="array"?Array.isArray(n):i==="object"?n&&!Array.isArray(n)&&typeof n=="object":i===typeof n)}function Gr(n,t){return n.kind==="array"&&t.kind==="array"?n.itemType.kind===t.itemType.kind&&typeof n.N=="number":n.kind===t.kind}const ju=.96422,Fl=.82521,Nu=4/29,Bo=6/29,Vc=3*Bo*Bo,$c=Bo*Bo*Bo,Bl=Math.PI/180,To=180/Math.PI;function Vu(n){return(n%=360)<0&&(n+=360),n}function Vn([n,t,i,a]){let c,f;const g=Uu((.2225045*(n=$u(n))+.7168786*(t=$u(t))+.0606169*(i=$u(i)))/1);n===t&&t===i?c=f=g:(c=Uu((.4360747*n+.3850649*t+.1430804*i)/ju),f=Uu((.0139322*n+.0971045*t+.7141733*i)/Fl));const y=116*g-16;return[y<0?0:y,500*(c-g),200*(g-f),a]}function $u(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function Uu(n){return n>$c?Math.pow(n,1/3):n/Vc+Nu}function hs([n,t,i,a]){let c=(n+16)/116,f=isNaN(t)?c:c+t/500,g=isNaN(i)?c:c-i/200;return c=1*ps(c),f=ju*ps(f),g=Fl*ps(g),[ds(3.1338561*f-1.6168667*c-.4906146*g),ds(-.9787684*f+1.9161415*c+.033454*g),ds(.0719453*f-.2289914*c+1.4052427*g),a]}function ds(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function ps(n){return n>Bo?n*n*n:Vc*(n-Nu)}function oa(n){return parseInt(n.padEnd(2,n),16)/255}function fs(n,t){return La(t?n/100:n,0,1)}function La(n,t,i){return Math.min(Math.max(t,n),i)}function lo(n){return!n.some(Number.isNaN)}const fr={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function gi(n,t,i){return n+i*(t-n)}function _i(n,t,i){return n.map((a,c)=>gi(a,t[c],i))}class ur{constructor(t,i,a,c=1,f=!0){this.r=t,this.g=i,this.b=a,this.a=c,f||(this.r*=c,this.g*=c,this.b*=c,c||this.overwriteGetter("rgb",[t,i,a,c]))}static parse(t){if(t instanceof ur)return t;if(typeof t!="string")return;const i=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const c=fr[a];if(c){const[g,y,b]=c;return[g/255,y/255,b/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const g=a.length<6?1:2;let y=1;return[oa(a.slice(y,y+=g)),oa(a.slice(y,y+=g)),oa(a.slice(y,y+=g)),oa(a.slice(y,y+g)||"ff")]}if(a.startsWith("rgb")){const g=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[y,b,T,C,k,F,j,N,Z,K,te,fe]=g,ie=[C||" ",j||" ",K].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const B=[T,F,Z].join(""),H=B==="%%%"?100:B===""?255:0;if(H){const ae=[La(+b/H,0,1),La(+k/H,0,1),La(+N/H,0,1),te?fs(+te,fe):1];if(lo(ae))return ae}}return}}const f=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(f){const[g,y,b,T,C,k,F,j,N]=f,Z=[b||" ",C||" ",F].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const K=[+y,La(+T,0,100),La(+k,0,100),j?fs(+j,N):1];if(lo(K))return function([te,fe,ie,B]){function H(ae){const Ce=(ae+te/30)%12,Ke=fe*Math.min(ie,1-ie);return ie-Ke*Math.max(-1,Math.min(Ce-3,9-Ce,1))}return te=Vu(te),fe/=100,ie/=100,[H(0),H(8),H(4),B]}(K)}}}(t);return i?new ur(...i,!1):void 0}get rgb(){const{r:t,g:i,b:a,a:c}=this,f=c||1/0;return this.overwriteGetter("rgb",[t/f,i/f,a/f,c])}get hcl(){return this.overwriteGetter("hcl",function(t){const[i,a,c,f]=Vn(t),g=Math.sqrt(a*a+c*c);return[Math.round(1e4*g)?Vu(Math.atan2(c,a)*To):NaN,g,i,f]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Vn(this.rgb))}overwriteGetter(t,i){return Object.defineProperty(this,t,{value:i}),i}toString(){const[t,i,a,c]=this.rgb;return`rgba(${[t,i,a].map(f=>Math.round(255*f)).join(",")},${c})`}static interpolate(t,i,a,c="rgb"){switch(c){case"rgb":{const[f,g,y,b]=_i(t.rgb,i.rgb,a);return new ur(f,g,y,b,!1)}case"hcl":{const[f,g,y,b]=t.hcl,[T,C,k,F]=i.hcl;let j,N;if(isNaN(f)||isNaN(T))isNaN(f)?isNaN(T)?j=NaN:(j=T,y!==1&&y!==0||(N=C)):(j=f,k!==1&&k!==0||(N=g));else{let ie=T-f;T>f&&ie>180?ie-=360:T<f&&f-T>180&&(ie+=360),j=f+a*ie}const[Z,K,te,fe]=function([ie,B,H,ae]){return ie=isNaN(ie)?0:ie*Bl,hs([H,Math.cos(ie)*B,Math.sin(ie)*B,ae])}([j,N??gi(g,C,a),gi(y,k,a),gi(b,F,a)]);return new ur(Z,K,te,fe,!1)}case"lab":{const[f,g,y,b]=hs(_i(t.lab,i.lab,a));return new ur(f,g,y,b,!1)}}}}ur.black=new ur(0,0,0,1),ur.white=new ur(1,1,1,1),ur.transparent=new ur(0,0,0,0),ur.red=new ur(1,0,0,1);class jl{constructor(t,i,a){this.sensitivity=t?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,i){return this.collator.compare(t,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const qs=["bottom","center","top"];class ar{constructor(t,i,a,c,f,g){this.text=t,this.image=i,this.scale=a,this.fontStack=c,this.textColor=f,this.verticalAlign=g}}class Sn{constructor(t){this.sections=t}static fromString(t){return new Sn([new ar(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Sn?t:Sn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class cn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof cn)return t;if(typeof t=="number")return new cn([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const i of t)if(typeof i!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new cn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){return new cn(_i(t.values,i.values,a))}}class Wr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Nl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class hn{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof hn)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let i=0;i<t.length;i+=2){const a=t[i],c=t[i+1];if(typeof a!="string"||!Nl.has(a)||!Array.isArray(c)||c.length!==2||typeof c[0]!="number"||typeof c[1]!="number")return}return new hn(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,i,a){const c=t.values,f=i.values;if(c.length!==f.length)throw new Wr(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${i.toString()}`);const g=[];for(let y=0;y<c.length;y+=2){if(c[y]!==f[y])throw new Wr(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${c[y]}, to[${y}]: ${f[y]}`);g.push(c[y]);const[b,T]=c[y+1],[C,k]=f[y+1];g.push([gi(b,C,a),gi(T,k,a)])}return new hn(g)}}class $n{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new $n({name:t,available:!1}):null}}class Un{constructor(t,i,a){this.from=t,this.to=i,this.transition=a}static interpolate(t,i,a){return new Un(t,i,a)}static parse(t){return t instanceof Un?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Un(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Un(t.from,t.to,t.transition):typeof t=="string"?new Un(t,t,1):void 0}}function Oa(n,t,i,a){return typeof n=="number"&&n>=0&&n<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof i=="number"&&i>=0&&i<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[n,t,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[n,t,i,a]:[n,t,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Pn(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Un||n instanceof ur||n instanceof jl||n instanceof Sn||n instanceof cn||n instanceof hn||n instanceof $n)return!0;if(Array.isArray(n)){for(const t of n)if(!Pn(t))return!1;return!0}if(typeof n=="object"){for(const t in n)if(!Pn(n[t]))return!1;return!0}return!1}function Nr(n){if(n===null)return Vt;if(typeof n=="string")return vt;if(typeof n=="boolean")return yt;if(typeof n=="number")return $e;if(n instanceof ur)return er;if(n instanceof Un)return Wt;if(n instanceof jl)return Da;if(n instanceof Sn)return Zr;if(n instanceof cn)return on;if(n instanceof hn)return Ol;if(n instanceof $n)return jr;if(Array.isArray(n)){const t=n.length;let i;for(const a of n){const c=Nr(a);if(i){if(i===c)continue;i=Bt;break}i=c}return ii(i||Bt,t)}return ir}function oi(n){const t=typeof n;return n===null?"":t==="string"||t==="number"||t==="boolean"?String(n):n instanceof ur||n instanceof Un||n instanceof Sn||n instanceof cn||n instanceof hn||n instanceof $n?n.toString():JSON.stringify(n)}class Zn{constructor(t,i){this.type=t,this.value=i}static parse(t,i){if(t.length!==2)return i.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Pn(t[1]))return i.error("invalid value");const a=t[1];let c=Nr(a);const f=i.expectedType;return c.kind!=="array"||c.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(c=f),new Zn(c,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const jo={string:vt,number:$e,boolean:yt,object:ir};class dn{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a,c=1;const f=t[0];if(f==="array"){let y,b;if(t.length>2){const T=t[1];if(typeof T!="string"||!(T in jo)||T==="object")return i.error('The item type argument of "array" must be one of string, number, boolean',1);y=jo[T],c++}else y=Bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return i.error('The length argument to "array" must be a positive integer literal',2);b=t[2],c++}a=ii(y,b)}else{if(!jo[f])throw new Error(`Types doesn't contain name = ${f}`);a=jo[f]}const g=[];for(;c<t.length;c++){const y=i.parse(t[c],c,Bt);if(!y)return null;g.push(y)}return new dn(a,g)}evaluate(t){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(t);if(!cs(this.type,Nr(a)))return a;if(i===this.args.length-1)throw new Wr(`Expected value to be of type ${Dr(this.type)}, but found ${Dr(Nr(a))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Zu={"to-boolean":yt,"to-color":er,"to-number":$e,"to-string":vt};class qi{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[0];if(!Zu[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&t.length!==2)return i.error("Expected one argument.");const c=Zu[a],f=[];for(let g=1;g<t.length;g++){const y=i.parse(t[g],g,Bt);if(!y)return null;f.push(y)}return new qi(c,f)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let i,a;for(const c of this.args){if(i=c.evaluate(t),a=null,i instanceof ur)return i;if(typeof i=="string"){const f=t.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rgba value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Oa(i[0],i[1],i[2],i[3]),!a))return new ur(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Wr(a||`Could not parse color from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"padding":{let i;for(const a of this.args){i=a.evaluate(t);const c=cn.parse(i);if(c)return c}throw new Wr(`Could not parse padding from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"variableAnchorOffsetCollection":{let i;for(const a of this.args){i=a.evaluate(t);const c=hn.parse(i);if(c)return c}throw new Wr(`Could not parse variableAnchorOffsetCollection from value '${typeof i=="string"?i:JSON.stringify(i)}'`)}case"number":{let i=null;for(const a of this.args){if(i=a.evaluate(t),i===null)return 0;const c=Number(i);if(!isNaN(c))return c}throw new Wr(`Could not convert ${JSON.stringify(i)} to number.`)}case"formatted":return Sn.fromString(oi(this.args[0].evaluate(t)));case"resolvedImage":return $n.fromString(oi(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return oi(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const Lr=["Unknown","Point","LineString","Polygon"];class Vl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let i=this._parseColorCache[t];return i||(i=this._parseColorCache[t]=ur.parse(t)),i}}class hr{constructor(t,i,a=[],c,f=new Kt,g=[]){this.registry=t,this.path=a,this.key=a.map(y=>`[${y}]`).join(""),this.scope=f,this.errors=g,this.expectedType=c,this._isConstant=i}parse(t,i,a,c,f={}){return i?this.concat(i,a,c)._parse(t,f):this._parse(t,f)}_parse(t,i){function a(c,f,g){return g==="assert"?new dn(f,[c]):g==="coerce"?new qi(f,[c]):c}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const c=t[0];if(typeof c!="string")return this.error(`Expression name must be a string, but found ${typeof c} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[c];if(f){let g=f.parse(t,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,b=g.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||b.kind!=="value")if(y.kind!=="projectionDefinition"||b.kind!=="string"&&b.kind!=="array")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(y.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array")if(y.kind!=="variableAnchorOffsetCollection"||b.kind!=="value"&&b.kind!=="array"){if(this.checkSubtype(y,b))return null}else g=a(g,y,i.typeAnnotation||"coerce");else g=a(g,y,i.typeAnnotation||"coerce");else g=a(g,y,i.typeAnnotation||"coerce");else g=a(g,y,i.typeAnnotation||"coerce");else g=a(g,y,i.typeAnnotation||"assert")}if(!(g instanceof Zn)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const y=new Vl;try{g=new Zn(g.type,g.evaluate(y))}catch(b){return this.error(b.message),null}}return g}return this.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,i,a){const c=typeof t=="number"?this.path.concat(t):this.path,f=a?this.scope.concat(a):this.scope;return new hr(this.registry,this._isConstant,c,i||null,f,this.errors)}error(t,...i){const a=`${this.key}${i.map(c=>`[${c}]`).join("")}`;this.errors.push(new Et(a,t))}checkSubtype(t,i){const a=cs(t,i);return a&&this.error(a),a}}class Qt{constructor(t,i){this.type=i.type,this.bindings=[].concat(t),this.result=i}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const i of this.bindings)t(i[1]);t(this.result)}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const a=[];for(let f=1;f<t.length-1;f+=2){const g=t[f];if(typeof g!="string")return i.error(`Expected string, but found ${typeof g} instead.`,f);if(/[^a-zA-Z0-9_]/.test(g))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const y=i.parse(t[f+1],f+1);if(!y)return null;a.push([g,y])}const c=i.parse(t[t.length-1],t.length-1,i.expectedType,a);return c?new Qt(a,c):null}outputDefined(){return this.result.outputDefined()}}class Fa{constructor(t,i){this.type=i.type,this.name=t,this.boundExpression=i}static parse(t,i){if(t.length!==2||typeof t[1]!="string")return i.error("'var' expression requires exactly one string literal argument.");const a=t[1];return i.scope.has(a)?new Fa(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class yr{constructor(t,i,a){this.type=t,this.index=i,this.input=a}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,$e),c=i.parse(t[2],2,ii(i.expectedType||Bt));return a&&c?new yr(c.type.itemType,a,c):null}evaluate(t){const i=this.index.evaluate(t),a=this.input.evaluate(t);if(i<0)throw new Wr(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Wr(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Wr(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class No{constructor(t,i){this.type=yt,this.needle=t,this.haystack=i}static parse(t,i){if(t.length!==3)return i.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Bt),c=i.parse(t[2],2,Bt);return a&&c?Bu(a.type,[yt,vt,$e,Vt,Bt])?new No(a,c):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(a.type)} instead`):null}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!a)return!1;if(!ia(i,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(Nr(i))} instead.`);if(!ia(a,["string","array"]))throw new Wr(`Expected second argument to be of type array or string, but found ${Dr(Nr(a))} instead.`);return a.indexOf(i)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Gn{constructor(t,i,a){this.type=$e,this.needle=t,this.haystack=i,this.fromIndex=a}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Bt),c=i.parse(t[2],2,Bt);if(!a||!c)return null;if(!Bu(a.type,[yt,vt,$e,Vt,Bt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(a.type)} instead`);if(t.length===4){const f=i.parse(t[3],3,$e);return f?new Gn(a,c,f):null}return new Gn(a,c)}evaluate(t){const i=this.needle.evaluate(t),a=this.haystack.evaluate(t);if(!ia(i,["boolean","string","number","null"]))throw new Wr(`Expected first argument to be of type boolean, string, number or null, but found ${Dr(Nr(i))} instead.`);let c;if(this.fromIndex&&(c=this.fromIndex.evaluate(t)),ia(a,["string"])){const f=a.indexOf(i,c);return f===-1?-1:[...a.slice(0,f)].length}if(ia(a,["array"]))return a.indexOf(i,c);throw new Wr(`Expected second argument to be of type array or string, but found ${Dr(Nr(a))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class So{constructor(t,i,a,c,f,g){this.inputType=t,this.type=i,this.input=a,this.cases=c,this.outputs=f,this.otherwise=g}static parse(t,i){if(t.length<5)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return i.error("Expected an even number of arguments.");let a,c;i.expectedType&&i.expectedType.kind!=="value"&&(c=i.expectedType);const f={},g=[];for(let T=2;T<t.length-1;T+=2){let C=t[T];const k=t[T+1];Array.isArray(C)||(C=[C]);const F=i.concat(T);if(C.length===0)return F.error("Expected at least one branch label.");for(const N of C){if(typeof N!="number"&&typeof N!="string")return F.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return F.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return F.error("Numeric branch labels must be integer values.");if(a){if(F.checkSubtype(a,Nr(N)))return null}else a=Nr(N);if(f[String(N)]!==void 0)return F.error("Branch labels must be unique.");f[String(N)]=g.length}const j=i.parse(k,T,c);if(!j)return null;c=c||j.type,g.push(j)}const y=i.parse(t[1],1,Bt);if(!y)return null;const b=i.parse(t[t.length-1],t.length-1,c);return b?y.type.kind!=="value"&&i.concat(1).checkSubtype(a,y.type)?null:new So(a,c,y,f,g,b):null}evaluate(t){const i=this.input.evaluate(t);return(Nr(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ba{constructor(t,i,a){this.type=t,this.branches=i,this.otherwise=a}static parse(t,i){if(t.length<4)return i.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&i.expectedType.kind!=="value"&&(a=i.expectedType);const c=[];for(let g=1;g<t.length-1;g+=2){const y=i.parse(t[g],g,yt);if(!y)return null;const b=i.parse(t[g+1],g+1,a);if(!b)return null;c.push([y,b]),a=a||b.type}const f=i.parse(t[t.length-1],t.length-1,a);if(!f)return null;if(!a)throw new Error("Can't infer output type");return new Ba(a,c,f)}evaluate(t){for(const[i,a]of this.branches)if(i.evaluate(t))return a.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[i,a]of this.branches)t(i),t(a);t(this.otherwise)}outputDefined(){return this.branches.every(([t,i])=>i.outputDefined())&&this.otherwise.outputDefined()}}class Ws{constructor(t,i,a,c){this.type=t,this.input=i,this.beginIndex=a,this.endIndex=c}static parse(t,i){if(t.length<=2||t.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const a=i.parse(t[1],1,Bt),c=i.parse(t[2],2,$e);if(!a||!c)return null;if(!Bu(a.type,[ii(Bt),vt,Bt]))return i.error(`Expected first argument to be of type array or string, but found ${Dr(a.type)} instead`);if(t.length===4){const f=i.parse(t[3],3,$e);return f?new Ws(a.type,a,c,f):null}return new Ws(a.type,a,c)}evaluate(t){const i=this.input.evaluate(t),a=this.beginIndex.evaluate(t);let c;if(this.endIndex&&(c=this.endIndex.evaluate(t)),ia(i,["string"]))return[...i].slice(a,c).join("");if(ia(i,["array"]))return i.slice(a,c);throw new Wr(`Expected first argument to be of type array or string, but found ${Dr(Nr(i))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ms(n,t){const i=n.length-1;let a,c,f=0,g=i,y=0;for(;f<=g;)if(y=Math.floor((f+g)/2),a=n[y],c=n[y+1],a<=t){if(y===i||t<c)return y;f=y+1}else{if(!(a>t))throw new Wr("Input is not a number.");g=y-1}return 0}class aa{constructor(t,i,a){this.type=t,this.input=i,this.labels=[],this.outputs=[];for(const[c,f]of a)this.labels.push(c),this.outputs.push(f)}static parse(t,i){if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(t[1],1,$e);if(!a)return null;const c=[];let f=null;i.expectedType&&i.expectedType.kind!=="value"&&(f=i.expectedType);for(let g=1;g<t.length;g+=2){const y=g===1?-1/0:t[g],b=t[g+1],T=g,C=g+1;if(typeof y!="number")return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(c.length&&c[c.length-1][0]>=y)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const k=i.parse(b,C,f);if(!k)return null;f=f||k.type,c.push([y,k])}return new aa(f,a,c)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return a[0].evaluate(t);const f=i.length;return c>=i[f-1]?a[f-1].evaluate(t):a[ms(i,c)].evaluate(t)}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function $l(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gs,Ul,Wi=function(){if(Ul)return gs;function n(t,i,a,c){this.cx=3*t,this.bx=3*(a-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(c-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=a,this.p2y=c}return Ul=1,gs=n,n.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,i){if(i===void 0&&(i=1e-6),t<0)return 0;if(t>1)return 1;for(var a=t,c=0;c<8;c++){var f=this.sampleCurveX(a)-t;if(Math.abs(f)<i)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=f/g}var y=0,b=1;for(a=t,c=0;c<20&&(f=this.sampleCurveX(a),!(Math.abs(f-t)<i));c++)t>f?y=a:b=a,a=.5*(b-y)+y;return a},solve:function(t,i){return this.sampleCurveY(this.solveCurveX(t,i))}},gs}(),Cn=$l(Wi);class pn{constructor(t,i,a,c,f){this.type=t,this.operator=i,this.interpolation=a,this.input=c,this.labels=[],this.outputs=[];for(const[g,y]of f)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(t,i,a,c){let f=0;if(t.name==="exponential")f=Hs(i,t.base,a,c);else if(t.name==="linear")f=Hs(i,1,a,c);else if(t.name==="cubic-bezier"){const g=t.controlPoints;f=new Cn(g[0],g[1],g[2],g[3]).solve(Hs(i,1,a,c))}return f}static parse(t,i){let[a,c,f,...g]=t;if(!Array.isArray(c)||c.length===0)return i.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){const T=c[1];if(typeof T!="number")return i.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:T}}else{if(c[0]!=="cubic-bezier")return i.error(`Unknown interpolation type ${String(c[0])}`,1,0);{const T=c.slice(1);if(T.length!==4||T.some(C=>typeof C!="number"||C<0||C>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:T}}}if(t.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,$e),!f)return null;const y=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=er:i.expectedType&&i.expectedType.kind!=="value"&&(b=i.expectedType);for(let T=0;T<g.length;T+=2){const C=g[T],k=g[T+1],F=T+3,j=T+4;if(typeof C!="number")return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(y.length&&y[y.length-1][0]>=C)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);const N=i.parse(k,j,b);if(!N)return null;b=b||N.type,y.push([C,N])}return Gr(b,$e)||Gr(b,Wt)||Gr(b,er)||Gr(b,on)||Gr(b,Ol)||Gr(b,ii($e))?new pn(b,a,c,f,y):i.error(`Type ${Dr(b)} is not interpolatable.`)}evaluate(t){const i=this.labels,a=this.outputs;if(i.length===1)return a[0].evaluate(t);const c=this.input.evaluate(t);if(c<=i[0])return a[0].evaluate(t);const f=i.length;if(c>=i[f-1])return a[f-1].evaluate(t);const g=ms(i,c),y=pn.interpolationFactor(this.interpolation,c,i[g],i[g+1]),b=a[g].evaluate(t),T=a[g+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return gi(b,T,y);case"color":return ur.interpolate(b,T,y);case"padding":return cn.interpolate(b,T,y);case"variableAnchorOffsetCollection":return hn.interpolate(b,T,y);case"array":return _i(b,T,y);case"projectionDefinition":return Un.interpolate(b,T,y)}case"interpolate-hcl":return ur.interpolate(b,T,y,"hcl");case"interpolate-lab":return ur.interpolate(b,T,y,"lab")}}eachChild(t){t(this.input);for(const i of this.outputs)t(i)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Hs(n,t,i,a){const c=a-i,f=n-i;return c===0?0:t===1?f/c:(Math.pow(t,f)-1)/(Math.pow(t,c)-1)}const qn={color:ur.interpolate,number:gi,padding:cn.interpolate,variableAnchorOffsetCollection:hn.interpolate,array:_i};class Xr{constructor(t,i){this.type=t,this.args=i}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");let a=null;const c=i.expectedType;c&&c.kind!=="value"&&(a=c);const f=[];for(const y of t.slice(1)){const b=i.parse(y,1+f.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,f.push(b)}if(!a)throw new Error("No output type");const g=c&&f.some(y=>cs(c,y.type));return new Xr(g?Bt:a,f)}evaluate(t){let i,a=null,c=0;for(const f of this.args)if(c++,a=f.evaluate(t),a&&a instanceof $n&&!a.available&&(i||(i=a.name),a=null,c===this.args.length&&(a=i)),a!==null)break;return a}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function Zl(n,t){return n==="=="||n==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Wn(n,t,i,a){return a.compare(t,i)===0}function Hi(n,t,i){const a=n!=="=="&&n!=="!=";return class H_{constructor(f,g,y){this.type=yt,this.lhs=f,this.rhs=g,this.collator=y,this.hasUntypedArgument=f.type.kind==="value"||g.type.kind==="value"}static parse(f,g){if(f.length!==3&&f.length!==4)return g.error("Expected two or three arguments.");const y=f[0];let b=g.parse(f[1],1,Bt);if(!b)return null;if(!Zl(y,b.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${Dr(b.type)}'.`);let T=g.parse(f[2],2,Bt);if(!T)return null;if(!Zl(y,T.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${Dr(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return g.error(`Cannot compare types '${Dr(b.type)}' and '${Dr(T.type)}'.`);a&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new dn(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new dn(b.type,[T])));let C=null;if(f.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(C=g.parse(f[3],3,Da),!C)return null}return new H_(b,T,C)}evaluate(f){const g=this.lhs.evaluate(f),y=this.rhs.evaluate(f);if(a&&this.hasUntypedArgument){const b=Nr(g),T=Nr(y);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new Wr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=Nr(g),T=Nr(y);if(b.kind!=="string"||T.kind!=="string")return t(f,g,y)}return this.collator?i(f,g,y,this.collator.evaluate(f)):t(f,g,y)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}}}const Gu=Hi("==",function(n,t,i){return t===i},Wn),sa=Hi("!=",function(n,t,i){return t!==i},function(n,t,i,a){return!Wn(0,t,i,a)}),qu=Hi("<",function(n,t,i){return t<i},function(n,t,i,a){return a.compare(t,i)<0}),Wu=Hi(">",function(n,t,i){return t>i},function(n,t,i,a){return a.compare(t,i)>0}),_s=Hi("<=",function(n,t,i){return t<=i},function(n,t,i,a){return a.compare(t,i)<=0}),la=Hi(">=",function(n,t,i){return t>=i},function(n,t,i,a){return a.compare(t,i)>=0});class Rn{constructor(t,i,a){this.type=Da,this.locale=a,this.caseSensitive=t,this.diacriticSensitive=i}static parse(t,i){if(t.length!==2)return i.error("Expected one argument.");const a=t[1];if(typeof a!="object"||Array.isArray(a))return i.error("Collator options argument must be an object.");const c=i.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,yt);if(!c)return null;const f=i.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,yt);if(!f)return null;let g=null;return a.locale&&(g=i.parse(a.locale,1,vt),!g)?null:new Rn(c,f,g)}evaluate(t){return new jl(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Xs{constructor(t,i,a,c,f){this.type=vt,this.number=t,this.locale=i,this.currency=a,this.minFractionDigits=c,this.maxFractionDigits=f}static parse(t,i){if(t.length!==3)return i.error("Expected two arguments.");const a=i.parse(t[1],1,$e);if(!a)return null;const c=t[2];if(typeof c!="object"||Array.isArray(c))return i.error("NumberFormat options argument must be an object.");let f=null;if(c.locale&&(f=i.parse(c.locale,1,vt),!f))return null;let g=null;if(c.currency&&(g=i.parse(c.currency,1,vt),!g))return null;let y=null;if(c["min-fraction-digits"]&&(y=i.parse(c["min-fraction-digits"],1,$e),!y))return null;let b=null;return c["max-fraction-digits"]&&(b=i.parse(c["max-fraction-digits"],1,$e),!b)?null:new Xs(a,f,g,y,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class ja{constructor(t){this.type=Zr,this.sections=t}static parse(t,i){if(t.length<2)return i.error("Expected at least one argument.");const a=t[1];if(!Array.isArray(a)&&typeof a=="object")return i.error("First argument must be an image or text section.");const c=[];let f=!1;for(let g=1;g<=t.length-1;++g){const y=t[g];if(f&&typeof y=="object"&&!Array.isArray(y)){f=!1;let b=null;if(y["font-scale"]&&(b=i.parse(y["font-scale"],1,$e),!b))return null;let T=null;if(y["text-font"]&&(T=i.parse(y["text-font"],1,ii(vt)),!T))return null;let C=null;if(y["text-color"]&&(C=i.parse(y["text-color"],1,er),!C))return null;let k=null;if(y["vertical-align"]){if(typeof y["vertical-align"]=="string"&&!qs.includes(y["vertical-align"]))return i.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${y["vertical-align"]}' instead.`);if(k=i.parse(y["vertical-align"],1,vt),!k)return null}const F=c[c.length-1];F.scale=b,F.font=T,F.textColor=C,F.verticalAlign=k}else{const b=i.parse(t[g],1,Bt);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,c.push({content:b,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ja(c)}evaluate(t){return new Sn(this.sections.map(i=>{const a=i.content.evaluate(t);return Nr(a)===jr?new ar("",a,null,null,null,i.verticalAlign?i.verticalAlign.evaluate(t):null):new ar(oi(a),null,i.scale?i.scale.evaluate(t):null,i.font?i.font.evaluate(t).join(","):null,i.textColor?i.textColor.evaluate(t):null,i.verticalAlign?i.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const i of this.sections)t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor),i.verticalAlign&&t(i.verticalAlign)}outputDefined(){return!1}}class Hu{constructor(t){this.type=jr,this.input=t}static parse(t,i){if(t.length!==2)return i.error("Expected two arguments.");const a=i.parse(t[1],1,vt);return a?new Hu(a):i.error("No image name provided.")}evaluate(t){const i=this.input.evaluate(t),a=$n.fromString(i);return a&&t.availableImages&&(a.available=t.availableImages.indexOf(i)>-1),a}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ks{constructor(t){this.type=$e,this.input=t}static parse(t,i){if(t.length!==2)return i.error(`Expected 1 argument, but found ${t.length-1} instead.`);const a=i.parse(t[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?i.error(`Expected argument of type string or array, but found ${Dr(a.type)} instead.`):new Ks(a):null}evaluate(t){const i=this.input.evaluate(t);if(typeof i=="string")return[...i].length;if(Array.isArray(i))return i.length;throw new Wr(`Expected value to be of type string or array, but found ${Dr(Nr(i))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Xi=8192;function Uh(n,t){const i=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,c=Math.pow(2,t.z);return[Math.round(i*c*Xi),Math.round(a*c*Xi)]}function Xu(n,t){const i=Math.pow(2,t.z);return[(c=(n[0]/Xi+t.x)/i,360*c-180),(a=(n[1]/Xi+t.y)/i,360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90)];var a,c}function Ys(n,t){n[0]=Math.min(n[0],t[0]),n[1]=Math.min(n[1],t[1]),n[2]=Math.max(n[2],t[0]),n[3]=Math.max(n[3],t[1])}function ua(n,t){return!(n[0]<=t[0]||n[2]>=t[2]||n[1]<=t[1]||n[3]>=t[3])}function Zh(n,t,i){const a=n[0]-t[0],c=n[1]-t[1],f=n[0]-i[0],g=n[1]-i[1];return a*g-f*c==0&&a*f<=0&&c*g<=0}function ys(n,t,i,a){return(c=[a[0]-i[0],a[1]-i[1]])[0]*(f=[t[0]-n[0],t[1]-n[1]])[1]-c[1]*f[0]!=0&&!(!qc(n,t,i,a)||!qc(i,a,n,t));var c,f}function Uc(n,t,i){for(const a of i)for(let c=0;c<a.length-1;++c)if(ys(n,t,a[c],a[c+1]))return!0;return!1}function vs(n,t,i=!1){let a=!1;for(const y of t)for(let b=0;b<y.length-1;b++){if(Zh(n,y[b],y[b+1]))return i;(f=y[b])[1]>(c=n)[1]!=(g=y[b+1])[1]>c[1]&&c[0]<(g[0]-f[0])*(c[1]-f[1])/(g[1]-f[1])+f[0]&&(a=!a)}var c,f,g;return a}function Zc(n,t){for(const i of t)if(vs(n,i))return!0;return!1}function Gc(n,t){for(const i of n)if(!vs(i,t))return!1;for(let i=0;i<n.length-1;++i)if(Uc(n[i],n[i+1],t))return!1;return!0}function Ku(n,t){for(const i of t)if(Gc(n,i))return!0;return!1}function qc(n,t,i,a){const c=a[0]-i[0],f=a[1]-i[1],g=(n[0]-i[0])*f-c*(n[1]-i[1]),y=(t[0]-i[0])*f-c*(t[1]-i[1]);return g>0&&y<0||g<0&&y>0}function Yu(n,t,i){const a=[];for(let c=0;c<n.length;c++){const f=[];for(let g=0;g<n[c].length;g++){const y=Uh(n[c][g],i);Ys(t,y),f.push(y)}a.push(f)}return a}function Wc(n,t,i){const a=[];for(let c=0;c<n.length;c++){const f=Yu(n[c],t,i);a.push(f)}return a}function Gl(n,t,i,a){if(n[0]<i[0]||n[0]>i[2]){const c=.5*a;let f=n[0]-i[0]>c?-a:i[0]-n[0]>c?a:0;f===0&&(f=n[0]-i[2]>c?-a:i[2]-n[0]>c?a:0),n[0]+=f}Ys(t,n)}function Qu(n,t,i,a){const c=Math.pow(2,a.z)*Xi,f=[a.x*Xi,a.y*Xi],g=[];for(const y of n)for(const b of y){const T=[b.x+f[0],b.y+f[1]];Gl(T,t,i,c),g.push(T)}return g}function Ju(n,t,i,a){const c=Math.pow(2,a.z)*Xi,f=[a.x*Xi,a.y*Xi],g=[];for(const b of n){const T=[];for(const C of b){const k=[C.x+f[0],C.y+f[1]];Ys(t,k),T.push(k)}g.push(T)}if(t[2]-t[0]<=c/2){(y=t)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const b of g)for(const T of b)Gl(T,t,i,c)}var y;return g}class Na{constructor(t,i){this.type=yt,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Pn(t[1])){const a=t[1];if(a.type==="FeatureCollection"){const c=[];for(const f of a.features){const{type:g,coordinates:y}=f.geometry;g==="Polygon"&&c.push(y),g==="MultiPolygon"&&c.push(...y)}if(c.length)return new Na(a,{type:"MultiPolygon",coordinates:c})}else if(a.type==="Feature"){const c=a.geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Na(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Na(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const c=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const y=Yu(a.coordinates,f,g),b=Qu(i.geometry(),c,f,g);if(!ua(c,f))return!1;for(const T of b)if(!vs(T,y))return!1}if(a.type==="MultiPolygon"){const y=Wc(a.coordinates,f,g),b=Qu(i.geometry(),c,f,g);if(!ua(c,f))return!1;for(const T of b)if(!Zc(T,y))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const c=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=i.canonicalID();if(a.type==="Polygon"){const y=Yu(a.coordinates,f,g),b=Ju(i.geometry(),c,f,g);if(!ua(c,f))return!1;for(const T of b)if(!Gc(T,y))return!1}if(a.type==="MultiPolygon"){const y=Wc(a.coordinates,f,g),b=Ju(i.geometry(),c,f,g);if(!ua(c,f))return!1;for(const T of b)if(!Ku(T,y))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Hc=class{constructor(n=[],t=(i,a)=>i<a?-1:i>a?1:0){if(this.data=n,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:t,compare:i}=this,a=t[n];for(;n>0;){const c=n-1>>1,f=t[c];if(i(a,f)>=0)break;t[n]=f,n=c}t[n]=a}_down(n){const{data:t,compare:i}=this,a=this.length>>1,c=t[n];for(;n<a;){let f=1+(n<<1);const g=f+1;if(g<this.length&&i(t[g],t[f])<0&&(f=g),i(t[f],c)>=0)break;t[n]=t[f],n=f}t[n]=c}};function Xc(n,t,i=0,a=n.length-1,c=Gh){for(;a>i;){if(a-i>600){const b=a-i+1,T=t-i+1,C=Math.log(b),k=.5*Math.exp(2*C/3),F=.5*Math.sqrt(C*k*(b-k)/b)*(T-b/2<0?-1:1);Xc(n,t,Math.max(i,Math.floor(t-T*k/b+F)),Math.min(a,Math.floor(t+(b-T)*k/b+F)),c)}const f=n[t];let g=i,y=a;for(Va(n,i,t),c(n[a],f)>0&&Va(n,i,a);g<y;){for(Va(n,g,y),g++,y--;c(n[g],f)<0;)g++;for(;c(n[y],f)>0;)y--}c(n[i],f)===0?Va(n,i,y):(y++,Va(n,y,a)),y<=t&&(i=y+1),t<=y&&(a=y-1)}}function Va(n,t,i){const a=n[t];n[t]=n[i],n[i]=a}function Gh(n,t){return n<t?-1:n>t?1:0}function xs(n,t){if(n.length<=1)return[n];const i=[];let a,c;for(const f of n){const g=Kc(f);g!==0&&(f.area=Math.abs(g),c===void 0&&(c=g<0),c===g<0?(a&&i.push(a),a=[f]):a.push(f))}if(a&&i.push(a),t>1)for(let f=0;f<i.length;f++)i[f].length<=t||(Xc(i[f],t,1,i[f].length-1,Qs),i[f]=i[f].slice(0,t));return i}function Qs(n,t){return t.area-n.area}function Kc(n){let t=0;for(let i,a,c=0,f=n.length,g=f-1;c<f;g=c++)i=n[c],a=n[g],t+=(a.x-i.x)*(i.y+a.y);return t}const ql=1/298.257223563,ec=ql*(2-ql),tc=Math.PI/180;class Js{constructor(t){const i=6378.137*tc*1e3,a=Math.cos(t*tc),c=1/(1-ec*(1-a*a)),f=Math.sqrt(c);this.kx=i*f*a,this.ky=i*f*c*(1-ec)}distance(t,i){const a=this.wrap(t[0]-i[0])*this.kx,c=(t[1]-i[1])*this.ky;return Math.sqrt(a*a+c*c)}pointOnLine(t,i){let a,c,f,g,y=1/0;for(let b=0;b<t.length-1;b++){let T=t[b][0],C=t[b][1],k=this.wrap(t[b+1][0]-T)*this.kx,F=(t[b+1][1]-C)*this.ky,j=0;k===0&&F===0||(j=(this.wrap(i[0]-T)*this.kx*k+(i[1]-C)*this.ky*F)/(k*k+F*F),j>1?(T=t[b+1][0],C=t[b+1][1]):j>0&&(T+=k/this.kx*j,C+=F/this.ky*j)),k=this.wrap(i[0]-T)*this.kx,F=(i[1]-C)*this.ky;const N=k*k+F*F;N<y&&(y=N,a=T,c=C,f=b,g=j)}return{point:[a,c],index:f,t:Math.max(0,Math.min(1,g))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Wl(n,t){return t[0]-n[0]}function Vo(n){return n[1]-n[0]+1}function $o(n,t){return n[1]>=n[0]&&n[1]<t}function rc(n,t){if(n[0]>n[1])return[null,null];const i=Vo(n);if(t){if(i===2)return[n,null];const c=Math.floor(i/2);return[[n[0],n[0]+c],[n[0]+c,n[1]]]}if(i===1)return[n,null];const a=Math.floor(i/2)-1;return[[n[0],n[0]+a],[n[0]+a+1,n[1]]]}function Hl(n,t){if(!$o(t,n.length))return[1/0,1/0,-1/0,-1/0];const i=[1/0,1/0,-1/0,-1/0];for(let a=t[0];a<=t[1];++a)Ys(i,n[a]);return i}function Xl(n){const t=[1/0,1/0,-1/0,-1/0];for(const i of n)for(const a of i)Ys(t,a);return t}function nc(n){return n[0]!==-1/0&&n[1]!==-1/0&&n[2]!==1/0&&n[3]!==1/0}function $a(n,t,i){if(!nc(n)||!nc(t))return NaN;let a=0,c=0;return n[2]<t[0]&&(a=t[0]-n[2]),n[0]>t[2]&&(a=n[0]-t[2]),n[1]>t[3]&&(c=n[1]-t[3]),n[3]<t[1]&&(c=t[1]-n[3]),i.distance([0,0],[a,c])}function uo(n,t,i){const a=i.pointOnLine(t,n);return i.distance(n,a.point)}function br(n,t,i,a,c){const f=Math.min(uo(n,[i,a],c),uo(t,[i,a],c)),g=Math.min(uo(i,[n,t],c),uo(a,[n,t],c));return Math.min(f,g)}function Kl(n,t,i,a,c){if(!$o(t,n.length)||!$o(a,i.length))return 1/0;let f=1/0;for(let g=t[0];g<t[1];++g){const y=n[g],b=n[g+1];for(let T=a[0];T<a[1];++T){const C=i[T],k=i[T+1];if(ys(y,b,C,k))return 0;f=Math.min(f,br(y,b,C,k,c))}}return f}function qh(n,t,i,a,c){if(!$o(t,n.length)||!$o(a,i.length))return NaN;let f=1/0;for(let g=t[0];g<=t[1];++g)for(let y=a[0];y<=a[1];++y)if(f=Math.min(f,c.distance(n[g],i[y])),f===0)return f;return f}function Yc(n,t,i){if(vs(n,t,!0))return 0;let a=1/0;for(const c of t){const f=c[0],g=c[c.length-1];if(f!==g&&(a=Math.min(a,uo(n,[g,f],i)),a===0))return a;const y=i.pointOnLine(c,n);if(a=Math.min(a,i.distance(n,y.point)),a===0)return a}return a}function ic(n,t,i,a){if(!$o(t,n.length))return NaN;for(let f=t[0];f<=t[1];++f)if(vs(n[f],i,!0))return 0;let c=1/0;for(let f=t[0];f<t[1];++f){const g=n[f],y=n[f+1];for(const b of i)for(let T=0,C=b.length,k=C-1;T<C;k=T++){const F=b[k],j=b[T];if(ys(g,y,F,j))return 0;c=Math.min(c,br(g,y,F,j,a))}}return c}function Yl(n,t){for(const i of n)for(const a of i)if(vs(a,t,!0))return!0;return!1}function Qc(n,t,i,a=1/0){const c=Xl(n),f=Xl(t);if(a!==1/0&&$a(c,f,i)>=a)return a;if(ua(c,f)){if(Yl(n,t))return 0}else if(Yl(t,n))return 0;let g=1/0;for(const y of n)for(let b=0,T=y.length,C=T-1;b<T;C=b++){const k=y[C],F=y[b];for(const j of t)for(let N=0,Z=j.length,K=Z-1;N<Z;K=N++){const te=j[K],fe=j[N];if(ys(k,F,te,fe))return 0;g=Math.min(g,br(k,F,te,fe,i))}}return g}function oc(n,t,i,a,c,f){if(!f)return;const g=$a(Hl(a,f),c,i);g<t&&n.push([g,f,[0,0]])}function el(n,t,i,a,c,f,g){if(!f||!g)return;const y=$a(Hl(a,f),Hl(c,g),i);y<t&&n.push([y,f,g])}function Ql(n,t,i,a,c=1/0){let f=Math.min(a.distance(n[0],i[0][0]),c);if(f===0)return f;const g=new Hc([[0,[0,n.length-1],[0,0]]],Wl),y=Xl(i);for(;g.length>0;){const b=g.pop();if(b[0]>=f)continue;const T=b[1],C=t?50:100;if(Vo(T)<=C){if(!$o(T,n.length))return NaN;if(t){const k=ic(n,T,i,a);if(isNaN(k)||k===0)return k;f=Math.min(f,k)}else for(let k=T[0];k<=T[1];++k){const F=Yc(n[k],i,a);if(f=Math.min(f,F),f===0)return 0}}else{const k=rc(T,t);oc(g,f,a,n,y,k[0]),oc(g,f,a,n,y,k[1])}}return f}function Jl(n,t,i,a,c,f=1/0){let g=Math.min(f,c.distance(n[0],i[0]));if(g===0)return g;const y=new Hc([[0,[0,n.length-1],[0,i.length-1]]],Wl);for(;y.length>0;){const b=y.pop();if(b[0]>=g)continue;const T=b[1],C=b[2],k=t?50:100,F=a?50:100;if(Vo(T)<=k&&Vo(C)<=F){if(!$o(T,n.length)&&$o(C,i.length))return NaN;let j;if(t&&a)j=Kl(n,T,i,C,c),g=Math.min(g,j);else if(t&&!a){const N=n.slice(T[0],T[1]+1);for(let Z=C[0];Z<=C[1];++Z)if(j=uo(i[Z],N,c),g=Math.min(g,j),g===0)return g}else if(!t&&a){const N=i.slice(C[0],C[1]+1);for(let Z=T[0];Z<=T[1];++Z)if(j=uo(n[Z],N,c),g=Math.min(g,j),g===0)return g}else j=qh(n,T,i,C,c),g=Math.min(g,j)}else{const j=rc(T,t),N=rc(C,a);el(y,g,c,n,i,j[0],N[0]),el(y,g,c,n,i,j[0],N[1]),el(y,g,c,n,i,j[1],N[0]),el(y,g,c,n,i,j[1],N[1])}}return g}function ac(n){return n.type==="MultiPolygon"?n.coordinates.map(t=>({type:"Polygon",coordinates:t})):n.type==="MultiLineString"?n.coordinates.map(t=>({type:"LineString",coordinates:t})):n.type==="MultiPoint"?n.coordinates.map(t=>({type:"Point",coordinates:t})):[n]}class Ua{constructor(t,i){this.type=$e,this.geojson=t,this.geometries=i}static parse(t,i){if(t.length!==2)return i.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Pn(t[1])){const a=t[1];if(a.type==="FeatureCollection")return new Ua(a,a.features.map(c=>ac(c.geometry)).flat());if(a.type==="Feature")return new Ua(a,ac(a.geometry));if("type"in a&&"coordinates"in a)return new Ua(a,ac(a))}return i.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(i,a){const c=i.geometry(),f=c.flat().map(b=>Xu([b.x,b.y],i.canonical));if(c.length===0)return NaN;const g=new Js(f[0][1]);let y=1/0;for(const b of a){switch(b.type){case"Point":y=Math.min(y,Jl(f,!1,[b.coordinates],!1,g,y));break;case"LineString":y=Math.min(y,Jl(f,!1,b.coordinates,!0,g,y));break;case"Polygon":y=Math.min(y,Ql(f,!1,b.coordinates,g,y))}if(y===0)return y}return y}(t,this.geometries);if(t.geometryType()==="LineString")return function(i,a){const c=i.geometry(),f=c.flat().map(b=>Xu([b.x,b.y],i.canonical));if(c.length===0)return NaN;const g=new Js(f[0][1]);let y=1/0;for(const b of a){switch(b.type){case"Point":y=Math.min(y,Jl(f,!0,[b.coordinates],!1,g,y));break;case"LineString":y=Math.min(y,Jl(f,!0,b.coordinates,!0,g,y));break;case"Polygon":y=Math.min(y,Ql(f,!0,b.coordinates,g,y))}if(y===0)return y}return y}(t,this.geometries);if(t.geometryType()==="Polygon")return function(i,a){const c=i.geometry();if(c.length===0||c[0].length===0)return NaN;const f=xs(c,0).map(b=>b.map(T=>T.map(C=>Xu([C.x,C.y],i.canonical)))),g=new Js(f[0][0][0][1]);let y=1/0;for(const b of a)for(const T of f){switch(b.type){case"Point":y=Math.min(y,Ql([b.coordinates],!1,T,g,y));break;case"LineString":y=Math.min(y,Ql(b.coordinates,!0,T,g,y));break;case"Polygon":y=Math.min(y,Qc(T,b.coordinates,g,y))}if(y===0)return y}return y}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const bs={"==":Gu,"!=":sa,">":Wu,"<":qu,">=":la,"<=":_s,array:dn,at:yr,boolean:dn,case:Ba,coalesce:Xr,collator:Rn,format:ja,image:Hu,in:No,"index-of":Gn,interpolate:pn,"interpolate-hcl":pn,"interpolate-lab":pn,length:Ks,let:Qt,literal:Zn,match:So,number:dn,"number-format":Xs,object:dn,slice:Ws,step:aa,string:dn,"to-boolean":qi,"to-color":qi,"to-number":qi,"to-string":qi,var:Fa,within:Na,distance:Ua};class Qr{constructor(t,i,a,c){this.name=t,this.type=i,this._evaluate=a,this.args=c}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,i){const a=t[0],c=Qr.definitions[a];if(!c)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(c)?c[0]:c.type,g=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,y=g.filter(([T])=>!Array.isArray(T)||T.length===t.length-1);let b=null;for(const[T,C]of y){b=new hr(i.registry,tl,i.path,null,i.scope);const k=[];let F=!1;for(let j=1;j<t.length;j++){const N=t[j],Z=Array.isArray(T)?T[j-1]:T.type,K=b.parse(N,1+k.length,Z);if(!K){F=!0;break}k.push(K)}if(!F)if(Array.isArray(T)&&T.length!==k.length)b.error(`Expected ${T.length} arguments, but found ${k.length} instead.`);else{for(let j=0;j<k.length;j++){const N=Array.isArray(T)?T[j]:T.type,Z=k[j];b.concat(j+1).checkSubtype(N,Z.type)}if(b.errors.length===0)return new Qr(a,f,C,k)}}if(y.length===1)i.errors.push(...b.errors);else{const T=(y.length?y:g).map(([k])=>{return F=k,Array.isArray(F)?`(${F.map(Dr).join(", ")})`:`(${Dr(F.type)}...)`;var F}).join(" | "),C=[];for(let k=1;k<t.length;k++){const F=i.parse(t[k],1+C.length);if(!F)return null;C.push(Dr(F.type))}i.error(`Expected arguments of type ${T}, but found (${C.join(", ")}) instead.`)}return null}static register(t,i){Qr.definitions=i;for(const a in i)t[a]=Qr}}function ws(n,[t,i,a,c]){t=t.evaluate(n),i=i.evaluate(n),a=a.evaluate(n);const f=c?c.evaluate(n):1,g=Oa(t,i,a,f);if(g)throw new Wr(g);return new ur(t/255,i/255,a/255,f,!1)}function sc(n,t){return n in t}function eu(n,t){const i=t[n];return i===void 0?null:i}function ca(n){return{type:n}}function tl(n){if(n instanceof Fa)return tl(n.boundExpression);if(n instanceof Qr&&n.name==="error"||n instanceof Rn||n instanceof Na||n instanceof Ua)return!1;const t=n instanceof qi||n instanceof dn;let i=!0;return n.eachChild(a=>{i=t?i&&tl(a):i&&a instanceof Zn}),!!i&&Ts(n)&&tu(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ts(n){if(n instanceof Qr&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Na||n instanceof Ua)return!1;let t=!0;return n.eachChild(i=>{t&&!Ts(i)&&(t=!1)}),t}function rl(n){if(n instanceof Qr&&n.name==="feature-state")return!1;let t=!0;return n.eachChild(i=>{t&&!rl(i)&&(t=!1)}),t}function tu(n,t){if(n instanceof Qr&&t.indexOf(n.name)>=0)return!1;let i=!0;return n.eachChild(a=>{i&&!tu(a,t)&&(i=!1)}),i}function Za(n){return{result:"success",value:n}}function ha(n){return{result:"error",value:n}}function Po(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function ru(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function nu(n){return!!n.expression&&n.expression.interpolated}function dr(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Uo(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function lc(n){return n}function uc(n,t){const i=t.type==="color",a=n.stops&&typeof n.stops[0][0]=="object",c=a||!(a||n.property!==void 0),f=n.type||(nu(t)?"exponential":"interval");if(i||t.type==="padding"){const C=i?ur.parse:cn.parse;(n=dt({},n)).stops&&(n.stops=n.stops.map(k=>[k[0],C(k[1])])),n.default=C(n.default?n.default:t.default)}if(n.colorSpace&&(g=n.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var g;let y,b,T;if(f==="exponential")y=cc;else if(f==="interval")y=eh;else if(f==="categorical"){y=Jc,b=Object.create(null);for(const C of n.stops)b[C[0]]=C[1];T=typeof n.stops[0][0]}else{if(f!=="identity")throw new Error(`Unknown function type "${f}"`);y=hc}if(a){const C={},k=[];for(let N=0;N<n.stops.length;N++){const Z=n.stops[N],K=Z[0].zoom;C[K]===void 0&&(C[K]={zoom:K,type:n.type,property:n.property,default:n.default,stops:[]},k.push(K)),C[K].stops.push([Z[0].value,Z[1]])}const F=[];for(const N of k)F.push([C[N].zoom,uc(C[N],t)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:pn.interpolationFactor.bind(void 0,j),zoomStops:F.map(N=>N[0]),evaluate:({zoom:N},Z)=>cc({stops:F,base:n.base},t,N).evaluate(N,Z)}}if(c){const C=f==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:pn.interpolationFactor.bind(void 0,C),zoomStops:n.stops.map(k=>k[0]),evaluate:({zoom:k})=>y(n,t,k,b,T)}}return{kind:"source",evaluate(C,k){const F=k&&k.properties?k.properties[n.property]:void 0;return F===void 0?Co(n.default,t.default):y(n,t,F,b,T)}}}function Co(n,t,i){return n!==void 0?n:t!==void 0?t:i!==void 0?i:void 0}function Jc(n,t,i,a,c){return Co(typeof i===c?a[i]:void 0,n.default,t.default)}function eh(n,t,i){if(dr(i)!=="number")return Co(n.default,t.default);const a=n.stops.length;if(a===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[a-1][0])return n.stops[a-1][1];const c=ms(n.stops.map(f=>f[0]),i);return n.stops[c][1]}function cc(n,t,i){const a=n.base!==void 0?n.base:1;if(dr(i)!=="number")return Co(n.default,t.default);const c=n.stops.length;if(c===1||i<=n.stops[0][0])return n.stops[0][1];if(i>=n.stops[c-1][0])return n.stops[c-1][1];const f=ms(n.stops.map(C=>C[0]),i),g=function(C,k,F,j){const N=j-F,Z=C-F;return N===0?0:k===1?Z/N:(Math.pow(k,Z)-1)/(Math.pow(k,N)-1)}(i,a,n.stops[f][0],n.stops[f+1][0]),y=n.stops[f][1],b=n.stops[f+1][1],T=qn[t.type]||lc;return typeof y.evaluate=="function"?{evaluate(...C){const k=y.evaluate.apply(void 0,C),F=b.evaluate.apply(void 0,C);if(k!==void 0&&F!==void 0)return T(k,F,g,n.colorSpace)}}:T(y,b,g,n.colorSpace)}function hc(n,t,i){switch(t.type){case"color":i=ur.parse(i);break;case"formatted":i=Sn.fromString(i.toString());break;case"resolvedImage":i=$n.fromString(i.toString());break;case"padding":i=cn.parse(i);break;default:dr(i)===t.type||t.type==="enum"&&t.values[i]||(i=void 0)}return Co(i,n.default,t.default)}Qr.register(bs,{error:[{kind:"error"},[vt],(n,[t])=>{throw new Wr(t.evaluate(n))}],typeof:[vt,[Bt],(n,[t])=>Dr(Nr(t.evaluate(n)))],"to-rgba":[ii($e,4),[er],(n,[t])=>{const[i,a,c,f]=t.evaluate(n).rgb;return[255*i,255*a,255*c,f]}],rgb:[er,[$e,$e,$e],ws],rgba:[er,[$e,$e,$e,$e],ws],has:{type:yt,overloads:[[[vt],(n,[t])=>sc(t.evaluate(n),n.properties())],[[vt,ir],(n,[t,i])=>sc(t.evaluate(n),i.evaluate(n))]]},get:{type:Bt,overloads:[[[vt],(n,[t])=>eu(t.evaluate(n),n.properties())],[[vt,ir],(n,[t,i])=>eu(t.evaluate(n),i.evaluate(n))]]},"feature-state":[Bt,[vt],(n,[t])=>eu(t.evaluate(n),n.featureState||{})],properties:[ir,[],n=>n.properties()],"geometry-type":[vt,[],n=>n.geometryType()],id:[Bt,[],n=>n.id()],zoom:[$e,[],n=>n.globals.zoom],"heatmap-density":[$e,[],n=>n.globals.heatmapDensity||0],"line-progress":[$e,[],n=>n.globals.lineProgress||0],accumulated:[Bt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[$e,ca($e),(n,t)=>{let i=0;for(const a of t)i+=a.evaluate(n);return i}],"*":[$e,ca($e),(n,t)=>{let i=1;for(const a of t)i*=a.evaluate(n);return i}],"-":{type:$e,overloads:[[[$e,$e],(n,[t,i])=>t.evaluate(n)-i.evaluate(n)],[[$e],(n,[t])=>-t.evaluate(n)]]},"/":[$e,[$e,$e],(n,[t,i])=>t.evaluate(n)/i.evaluate(n)],"%":[$e,[$e,$e],(n,[t,i])=>t.evaluate(n)%i.evaluate(n)],ln2:[$e,[],()=>Math.LN2],pi:[$e,[],()=>Math.PI],e:[$e,[],()=>Math.E],"^":[$e,[$e,$e],(n,[t,i])=>Math.pow(t.evaluate(n),i.evaluate(n))],sqrt:[$e,[$e],(n,[t])=>Math.sqrt(t.evaluate(n))],log10:[$e,[$e],(n,[t])=>Math.log(t.evaluate(n))/Math.LN10],ln:[$e,[$e],(n,[t])=>Math.log(t.evaluate(n))],log2:[$e,[$e],(n,[t])=>Math.log(t.evaluate(n))/Math.LN2],sin:[$e,[$e],(n,[t])=>Math.sin(t.evaluate(n))],cos:[$e,[$e],(n,[t])=>Math.cos(t.evaluate(n))],tan:[$e,[$e],(n,[t])=>Math.tan(t.evaluate(n))],asin:[$e,[$e],(n,[t])=>Math.asin(t.evaluate(n))],acos:[$e,[$e],(n,[t])=>Math.acos(t.evaluate(n))],atan:[$e,[$e],(n,[t])=>Math.atan(t.evaluate(n))],min:[$e,ca($e),(n,t)=>Math.min(...t.map(i=>i.evaluate(n)))],max:[$e,ca($e),(n,t)=>Math.max(...t.map(i=>i.evaluate(n)))],abs:[$e,[$e],(n,[t])=>Math.abs(t.evaluate(n))],round:[$e,[$e],(n,[t])=>{const i=t.evaluate(n);return i<0?-Math.round(-i):Math.round(i)}],floor:[$e,[$e],(n,[t])=>Math.floor(t.evaluate(n))],ceil:[$e,[$e],(n,[t])=>Math.ceil(t.evaluate(n))],"filter-==":[yt,[vt,Bt],(n,[t,i])=>n.properties()[t.value]===i.value],"filter-id-==":[yt,[Bt],(n,[t])=>n.id()===t.value],"filter-type-==":[yt,[vt],(n,[t])=>n.geometryType()===t.value],"filter-<":[yt,[vt,Bt],(n,[t,i])=>{const a=n.properties()[t.value],c=i.value;return typeof a==typeof c&&a<c}],"filter-id-<":[yt,[Bt],(n,[t])=>{const i=n.id(),a=t.value;return typeof i==typeof a&&i<a}],"filter->":[yt,[vt,Bt],(n,[t,i])=>{const a=n.properties()[t.value],c=i.value;return typeof a==typeof c&&a>c}],"filter-id->":[yt,[Bt],(n,[t])=>{const i=n.id(),a=t.value;return typeof i==typeof a&&i>a}],"filter-<=":[yt,[vt,Bt],(n,[t,i])=>{const a=n.properties()[t.value],c=i.value;return typeof a==typeof c&&a<=c}],"filter-id-<=":[yt,[Bt],(n,[t])=>{const i=n.id(),a=t.value;return typeof i==typeof a&&i<=a}],"filter->=":[yt,[vt,Bt],(n,[t,i])=>{const a=n.properties()[t.value],c=i.value;return typeof a==typeof c&&a>=c}],"filter-id->=":[yt,[Bt],(n,[t])=>{const i=n.id(),a=t.value;return typeof i==typeof a&&i>=a}],"filter-has":[yt,[Bt],(n,[t])=>t.value in n.properties()],"filter-has-id":[yt,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[yt,[ii(vt)],(n,[t])=>t.value.indexOf(n.geometryType())>=0],"filter-id-in":[yt,[ii(Bt)],(n,[t])=>t.value.indexOf(n.id())>=0],"filter-in-small":[yt,[vt,ii(Bt)],(n,[t,i])=>i.value.indexOf(n.properties()[t.value])>=0],"filter-in-large":[yt,[vt,ii(Bt)],(n,[t,i])=>function(a,c,f,g){for(;f<=g;){const y=f+g>>1;if(c[y]===a)return!0;c[y]>a?g=y-1:f=y+1}return!1}(n.properties()[t.value],i.value,0,i.value.length-1)],all:{type:yt,overloads:[[[yt,yt],(n,[t,i])=>t.evaluate(n)&&i.evaluate(n)],[ca(yt),(n,t)=>{for(const i of t)if(!i.evaluate(n))return!1;return!0}]]},any:{type:yt,overloads:[[[yt,yt],(n,[t,i])=>t.evaluate(n)||i.evaluate(n)],[ca(yt),(n,t)=>{for(const i of t)if(i.evaluate(n))return!0;return!1}]]},"!":[yt,[yt],(n,[t])=>!t.evaluate(n)],"is-supported-script":[yt,[vt],(n,[t])=>{const i=n.globals&&n.globals.isSupportedScript;return!i||i(t.evaluate(n))}],upcase:[vt,[vt],(n,[t])=>t.evaluate(n).toUpperCase()],downcase:[vt,[vt],(n,[t])=>t.evaluate(n).toLowerCase()],concat:[vt,ca(Bt),(n,t)=>t.map(i=>oi(i.evaluate(n))).join("")],"resolved-locale":[vt,[Da],(n,[t])=>t.evaluate(n).resolvedLocale()]});class iu{constructor(t,i){var a;this.expression=t,this._warningHistory={},this._evaluator=new Vl,this._defaultValue=i?(a=i).type==="color"&&Uo(a.default)?new ur(0,0,0,0):a.type==="color"?ur.parse(a.default)||null:a.type==="padding"?cn.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?hn.parse(a.default)||null:a.type==="projectionDefinition"?Un.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=i&&i.type==="enum"?i.values:null}evaluateWithoutErrorHandling(t,i,a,c,f,g){return this._evaluator.globals=t,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=c,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(t,i,a,c,f,g){this._evaluator.globals=t,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=c,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null;try{const y=this.expression.evaluate(this._evaluator);if(y==null||typeof y=="number"&&y!=y)return this._defaultValue;if(this._enumValues&&!(y in this._enumValues))throw new Wr(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(y)} instead.`);return y}catch(y){return this._warningHistory[y.message]||(this._warningHistory[y.message]=!0,typeof console<"u"&&console.warn(y.message)),this._defaultValue}}}function nl(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in bs}function yi(n,t){const i=new hr(bs,tl,[],t?function(c){const f={color:er,string:vt,number:$e,enum:vt,boolean:yt,formatted:Zr,padding:on,projectionDefinition:Wt,resolvedImage:jr,variableAnchorOffsetCollection:Ol};return c.type==="array"?ii(f[c.value]||Bt,c.length):f[c.type]}(t):void 0),a=i.parse(n,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?Za(new iu(a,t)):ha(i.errors)}class Ss{constructor(t,i){this.kind=t,this._styleExpression=i,this.isStateDependent=t!=="constant"&&!rl(i.expression)}evaluateWithoutErrorHandling(t,i,a,c,f,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,c,f,g)}evaluate(t,i,a,c,f,g){return this._styleExpression.evaluate(t,i,a,c,f,g)}}class il{constructor(t,i,a,c){this.kind=t,this.zoomStops=a,this._styleExpression=i,this.isStateDependent=t!=="camera"&&!rl(i.expression),this.interpolationType=c}evaluateWithoutErrorHandling(t,i,a,c,f,g){return this._styleExpression.evaluateWithoutErrorHandling(t,i,a,c,f,g)}evaluate(t,i,a,c,f,g){return this._styleExpression.evaluate(t,i,a,c,f,g)}interpolationFactor(t,i,a){return this.interpolationType?pn.interpolationFactor(this.interpolationType,t,i,a):0}}function th(n,t){const i=yi(n,t);if(i.result==="error")return i;const a=i.value.expression,c=Ts(a);if(!c&&!Po(t))return ha([new Et("","data expressions not supported")]);const f=tu(a,["zoom"]);if(!f&&!ru(t))return ha([new Et("","zoom expressions not supported")]);const g=da(a);return g||f?g instanceof Et?ha([g]):g instanceof pn&&!nu(t)?ha([new Et("",'"interpolate" expressions cannot be used with this property')]):Za(g?new il(c?"camera":"composite",i.value,g.labels,g instanceof pn?g.interpolation:void 0):new Ss(c?"constant":"source",i.value)):ha([new Et("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ou{constructor(t,i){this._parameters=t,this._specification=i,dt(this,uc(this._parameters,this._specification))}static deserialize(t){return new ou(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function da(n){let t=null;if(n instanceof Qt)t=da(n.result);else if(n instanceof Xr){for(const i of n.args)if(t=da(i),t)break}else(n instanceof aa||n instanceof pn)&&n.input instanceof Qr&&n.input.name==="zoom"&&(t=n);return t instanceof Et||n.eachChild(i=>{const a=da(i);a instanceof Et?t=a:!t&&a?t=new Et("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&a&&t!==a&&(t=new Et("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function dc(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const t of n.slice(1))if(!dc(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const pc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function ol(n){if(n==null)return{filter:()=>!0,needGeometry:!1};dc(n)||(n=pa(n));const t=yi(n,pc);if(t.result==="error")throw new Error(t.value.map(i=>`${i.key}: ${i.message}`).join(", "));return{filter:(i,a,c)=>t.value.evaluate(i,a,{},c),needGeometry:au(n)}}function Hr(n,t){return n<t?-1:n>t?1:0}function au(n){if(!Array.isArray(n))return!1;if(n[0]==="within"||n[0]==="distance")return!0;for(let t=1;t<n.length;t++)if(au(n[t]))return!0;return!1}function pa(n){if(!n)return!0;const t=n[0];return n.length<=1?t!=="any":t==="=="?fa(n[1],n[2],"=="):t==="!="?Eo(fa(n[1],n[2],"==")):t==="<"||t===">"||t==="<="||t===">="?fa(n[1],n[2],t):t==="any"?(i=n.slice(1),["any"].concat(i.map(pa))):t==="all"?["all"].concat(n.slice(1).map(pa)):t==="none"?["all"].concat(n.slice(1).map(pa).map(Eo)):t==="in"?su(n[1],n.slice(2)):t==="!in"?Eo(su(n[1],n.slice(2))):t==="has"?al(n[1]):t!=="!has"||Eo(al(n[1]));var i}function fa(n,t,i){switch(n){case"$type":return[`filter-type-${i}`,t];case"$id":return[`filter-id-${i}`,t];default:return[`filter-${i}`,n,t]}}function su(n,t){if(t.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(i=>typeof i!=typeof t[0])?["filter-in-large",n,["literal",t.sort(Hr)]]:["filter-in-small",n,["literal",t]]}}function al(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function Eo(n){return["!",n]}function ma(n){const t=typeof n;if(t==="number"||t==="boolean"||t==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let c="[";for(const f of n)c+=`${ma(f)},`;return`${c}]`}const i=Object.keys(n).sort();let a="{";for(let c=0;c<i.length;c++)a+=`${JSON.stringify(i[c])}:${ma(n[i[c]])},`;return`${a}}`}function ga(n){let t="";for(const i of q)t+=`/${ma(n[i])}`;return t}function Ps(n){const t=n.value;return t?[new Se(n.key,t,"constants have been deprecated as of v8")]:[]}function Jr(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Ga(n){if(Array.isArray(n))return n.map(Ga);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const t={};for(const i in n)t[i]=Ga(n[i]);return t}return Jr(n)}function zi(n){const t=n.key,i=n.value,a=n.valueSpec||{},c=n.objectElementValidators||{},f=n.style,g=n.styleSpec,y=n.validateSpec;let b=[];const T=dr(i);if(T!=="object")return[new Se(t,i,`object expected, ${T} found`)];for(const C in i){const k=C.split(".")[0],F=a[k]||a["*"];let j;if(c[k])j=c[k];else if(a[k])j=y;else if(c["*"])j=c["*"];else{if(!a["*"]){b.push(new Se(t,i[C],`unknown property "${C}"`));continue}j=y}b=b.concat(j({key:(t&&`${t}.`)+C,value:i[C],valueSpec:F,style:f,styleSpec:g,object:i,objectKey:C,validateSpec:y},i))}for(const C in a)c[C]||a[C].required&&a[C].default===void 0&&i[C]===void 0&&b.push(new Se(t,i,`missing required property "${C}"`));return b}function Cs(n){const t=n.value,i=n.valueSpec,a=n.style,c=n.styleSpec,f=n.key,g=n.arrayElementValidator||n.validateSpec;if(dr(t)!=="array")return[new Se(f,t,`array expected, ${dr(t)} found`)];if(i.length&&t.length!==i.length)return[new Se(f,t,`array length ${i.length} expected, length ${t.length} found`)];if(i["min-length"]&&t.length<i["min-length"])return[new Se(f,t,`array length at least ${i["min-length"]} expected, length ${t.length} found`)];let y={type:i.value,values:i.values};c.$version<7&&(y.function=i.function),dr(i.value)==="object"&&(y=i.value);let b=[];for(let T=0;T<t.length;T++)b=b.concat(g({array:t,arrayIndex:T,value:t[T],valueSpec:y,validateSpec:n.validateSpec,style:a,styleSpec:c,key:`${f}[${T}]`}));return b}function Es(n){const t=n.key,i=n.value,a=n.valueSpec;let c=dr(i);return c==="number"&&i!=i&&(c="NaN"),c!=="number"?[new Se(t,i,`number expected, ${c} found`)]:"minimum"in a&&i<a.minimum?[new Se(t,i,`${i} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&i>a.maximum?[new Se(t,i,`${i} is greater than the maximum value ${a.maximum}`)]:[]}function lu(n){const t=n.valueSpec,i=Jr(n.value.type);let a,c,f,g={};const y=i!=="categorical"&&n.value.property===void 0,b=!y,T=dr(n.value.stops)==="array"&&dr(n.value.stops[0])==="array"&&dr(n.value.stops[0][0])==="object",C=zi({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(j){if(i==="identity")return[new Se(j.key,j.value,'identity function may not have a "stops" property')];let N=[];const Z=j.value;return N=N.concat(Cs({key:j.key,value:Z,valueSpec:j.valueSpec,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,arrayElementValidator:k})),dr(Z)==="array"&&Z.length===0&&N.push(new Se(j.key,Z,"array must have at least one stop")),N},default:function(j){return j.validateSpec({key:j.key,value:j.value,valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec})}}});return i==="identity"&&y&&C.push(new Se(n.key,n.value,'missing required property "property"')),i==="identity"||n.value.stops||C.push(new Se(n.key,n.value,'missing required property "stops"')),i==="exponential"&&n.valueSpec.expression&&!nu(n.valueSpec)&&C.push(new Se(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(b&&!Po(n.valueSpec)?C.push(new Se(n.key,n.value,"property functions not supported")):y&&!ru(n.valueSpec)&&C.push(new Se(n.key,n.value,"zoom functions not supported"))),i!=="categorical"&&!T||n.value.property!==void 0||C.push(new Se(n.key,n.value,'"property" property is required')),C;function k(j){let N=[];const Z=j.value,K=j.key;if(dr(Z)!=="array")return[new Se(K,Z,`array expected, ${dr(Z)} found`)];if(Z.length!==2)return[new Se(K,Z,`array length 2 expected, length ${Z.length} found`)];if(T){if(dr(Z[0])!=="object")return[new Se(K,Z,`object expected, ${dr(Z[0])} found`)];if(Z[0].zoom===void 0)return[new Se(K,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new Se(K,Z,"object stop key must have value")];if(f&&f>Jr(Z[0].zoom))return[new Se(K,Z[0].zoom,"stop zoom values must appear in ascending order")];Jr(Z[0].zoom)!==f&&(f=Jr(Z[0].zoom),c=void 0,g={}),N=N.concat(zi({key:`${K}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec,objectElementValidators:{zoom:Es,value:F}}))}else N=N.concat(F({key:`${K}[0]`,value:Z[0],validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec},Z));return nl(Ga(Z[1]))?N.concat([new Se(`${K}[1]`,Z[1],"expressions are not allowed in function stops.")]):N.concat(j.validateSpec({key:`${K}[1]`,value:Z[1],valueSpec:t,validateSpec:j.validateSpec,style:j.style,styleSpec:j.styleSpec}))}function F(j,N){const Z=dr(j.value),K=Jr(j.value),te=j.value!==null?j.value:N;if(a){if(Z!==a)return[new Se(j.key,te,`${Z} stop domain type must match previous stop domain type ${a}`)]}else a=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new Se(j.key,te,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&i!=="categorical"){let fe=`number expected, ${Z} found`;return Po(t)&&i===void 0&&(fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Se(j.key,te,fe)]}return i!=="categorical"||Z!=="number"||isFinite(K)&&Math.floor(K)===K?i!=="categorical"&&Z==="number"&&c!==void 0&&K<c?[new Se(j.key,te,"stop domain values must appear in ascending order")]:(c=K,i==="categorical"&&K in g?[new Se(j.key,te,"stop domain values must be unique")]:(g[K]=!0,[])):[new Se(j.key,te,`integer expected, found ${K}`)]}}function Zo(n){const t=(n.expressionContext==="property"?th:yi)(Ga(n.value),n.valueSpec);if(t.result==="error")return t.value.map(a=>new Se(`${n.key}${a.key}`,n.value,a.message));const i=t.value.expression||t.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!i.outputDefined())return[new Se(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!rl(i))return[new Se(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!rl(i))return[new Se(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!tu(i,["zoom","feature-state"]))return[new Se(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!Ts(i))return[new Se(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function _a(n){const t=n.key,i=n.value,a=n.valueSpec,c=[];return Array.isArray(a.values)?a.values.indexOf(Jr(i))===-1&&c.push(new Se(t,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):Object.keys(a.values).indexOf(Jr(i))===-1&&c.push(new Se(t,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),c}function ya(n){return dc(Ga(n.value))?Zo(dt({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):rh(n)}function rh(n){const t=n.value,i=n.key;if(dr(t)!=="array")return[new Se(i,t,`array expected, ${dr(t)} found`)];const a=n.styleSpec;let c,f=[];if(t.length<1)return[new Se(i,t,"filter array must have at least 1 element")];switch(f=f.concat(_a({key:`${i}[0]`,value:t[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),Jr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Jr(t[1])==="$type"&&f.push(new Se(i,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&f.push(new Se(i,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(c=dr(t[1]),c!=="string"&&f.push(new Se(`${i}[1]`,t[1],`string expected, ${c} found`)));for(let g=2;g<t.length;g++)c=dr(t[g]),Jr(t[1])==="$type"?f=f.concat(_a({key:`${i}[${g}]`,value:t[g],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):c!=="string"&&c!=="number"&&c!=="boolean"&&f.push(new Se(`${i}[${g}]`,t[g],`string, number, or boolean expected, ${c} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)f=f.concat(rh({key:`${i}[${g}]`,value:t[g],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":c=dr(t[1]),t.length!==2?f.push(new Se(i,t,`filter array for "${t[0]}" operator must have 2 elements`)):c!=="string"&&f.push(new Se(`${i}[1]`,t[1],`string expected, ${c} found`))}return f}function uu(n,t){const i=n.key,a=n.validateSpec,c=n.style,f=n.styleSpec,g=n.value,y=n.objectKey,b=f[`${t}_${n.layerType}`];if(!b)return[];const T=y.match(/^(.*)-transition$/);if(t==="paint"&&T&&b[T[1]]&&b[T[1]].transition)return a({key:i,value:g,valueSpec:f.transition,style:c,styleSpec:f});const C=n.valueSpec||b[y];if(!C)return[new Se(i,g,`unknown property "${y}"`)];let k;if(dr(g)==="string"&&Po(C)&&!C.tokens&&(k=/^{([^}]+)}$/.exec(g)))return[new Se(i,g,`"${y}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(k[1])} }\`.`)];const F=[];return n.layerType==="symbol"&&(y==="text-field"&&c&&!c.glyphs&&F.push(new Se(i,g,'use of "text-field" requires a style "glyphs" property')),y==="text-font"&&Uo(Ga(g))&&Jr(g.type)==="identity"&&F.push(new Se(i,g,'"text-font" does not support identity functions'))),F.concat(a({key:n.key,value:g,valueSpec:C,style:c,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:y}))}function fc(n){return uu(n,"paint")}function nh(n){return uu(n,"layout")}function sl(n){let t=[];const i=n.value,a=n.key,c=n.style,f=n.styleSpec;i.type||i.ref||t.push(new Se(a,i,'either "type" or "ref" is required'));let g=Jr(i.type);const y=Jr(i.ref);if(i.id){const b=Jr(i.id);for(let T=0;T<n.arrayIndex;T++){const C=c.layers[T];Jr(C.id)===b&&t.push(new Se(a,i.id,`duplicate layer id "${i.id}", previously used at line ${C.id.__line__}`))}}if("ref"in i){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in i&&t.push(new Se(a,i[T],`"${T}" is prohibited for ref layers`))}),c.layers.forEach(T=>{Jr(T.id)===y&&(b=T)}),b?b.ref?t.push(new Se(a,i.ref,"ref cannot reference another ref layer")):g=Jr(b.type):t.push(new Se(a,i.ref,`ref layer "${y}" not found`))}else if(g!=="background")if(i.source){const b=c.sources&&c.sources[i.source],T=b&&Jr(b.type);b?T==="vector"&&g==="raster"?t.push(new Se(a,i.source,`layer "${i.id}" requires a raster source`)):T!=="raster-dem"&&g==="hillshade"?t.push(new Se(a,i.source,`layer "${i.id}" requires a raster-dem source`)):T==="raster"&&g!=="raster"?t.push(new Se(a,i.source,`layer "${i.id}" requires a vector source`)):T!=="vector"||i["source-layer"]?T==="raster-dem"&&g!=="hillshade"?t.push(new Se(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!i.paint||!i.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||t.push(new Se(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Se(a,i,`layer "${i.id}" must specify a "source-layer"`)):t.push(new Se(a,i.source,`source "${i.source}" not found`))}else t.push(new Se(a,i,'missing required property "source"'));return t=t.concat(zi({key:a,value:i,valueSpec:f.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${a}.type`,value:i.type,valueSpec:f.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:i,objectKey:"type"}),filter:ya,layout:b=>zi({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":T=>nh(dt({layerType:g},T))}}),paint:b=>zi({layer:i,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":T=>fc(dt({layerType:g},T))}})}})),t}function ai(n){const t=n.value,i=n.key,a=dr(t);return a!=="string"?[new Se(i,t,`string expected, ${a} found`)]:[]}const qa={promoteId:function({key:n,value:t}){if(dr(t)==="string")return ai({key:n,value:t});{const i=[];for(const a in t)i.push(...ai({key:`${n}.${a}`,value:t[a]}));return i}}};function Wa(n){const t=n.value,i=n.key,a=n.styleSpec,c=n.style,f=n.validateSpec;if(!t.type)return[new Se(i,t,'"type" is required')];const g=Jr(t.type);let y;switch(g){case"vector":case"raster":return y=zi({key:i,value:t,valueSpec:a[`source_${g.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:qa,validateSpec:f}),y;case"raster-dem":return y=function(b){var T;const C=(T=b.sourceName)!==null&&T!==void 0?T:"",k=b.value,F=b.styleSpec,j=F.source_raster_dem,N=b.style;let Z=[];const K=dr(k);if(k===void 0)return Z;if(K!=="object")return Z.push(new Se("source_raster_dem",k,`object expected, ${K} found`)),Z;const te=Jr(k.encoding)==="custom",fe=["redFactor","greenFactor","blueFactor","baseShift"],ie=b.value.encoding?`"${b.value.encoding}"`:"Default";for(const B in k)!te&&fe.includes(B)?Z.push(new Se(B,k[B],`In "${C}": "${B}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):j[B]?Z=Z.concat(b.validateSpec({key:B,value:k[B],valueSpec:j[B],validateSpec:b.validateSpec,style:N,styleSpec:F})):Z.push(new Se(B,k[B],`unknown property "${B}"`));return Z}({sourceName:i,value:t,style:n.style,styleSpec:a,validateSpec:f}),y;case"geojson":if(y=zi({key:i,value:t,valueSpec:a.source_geojson,style:c,styleSpec:a,validateSpec:f,objectElementValidators:qa}),t.cluster)for(const b in t.clusterProperties){const[T,C]=t.clusterProperties[b],k=typeof T=="string"?[T,["accumulated"],["get",b]]:T;y.push(...Zo({key:`${i}.${b}.map`,value:C,expressionContext:"cluster-map"})),y.push(...Zo({key:`${i}.${b}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return y;case"video":return zi({key:i,value:t,valueSpec:a.source_video,style:c,validateSpec:f,styleSpec:a});case"image":return zi({key:i,value:t,valueSpec:a.source_image,style:c,validateSpec:f,styleSpec:a});case"canvas":return[new Se(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return _a({key:`${i}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function co(n){const t=n.value,i=n.styleSpec,a=i.light,c=n.style;let f=[];const g=dr(t);if(t===void 0)return f;if(g!=="object")return f=f.concat([new Se("light",t,`object expected, ${g} found`)]),f;for(const y in t){const b=y.match(/^(.*)-transition$/);f=f.concat(b&&a[b[1]]&&a[b[1]].transition?n.validateSpec({key:y,value:t[y],valueSpec:i.transition,validateSpec:n.validateSpec,style:c,styleSpec:i}):a[y]?n.validateSpec({key:y,value:t[y],valueSpec:a[y],validateSpec:n.validateSpec,style:c,styleSpec:i}):[new Se(y,t[y],`unknown property "${y}"`)])}return f}function Is(n){const t=n.value,i=n.styleSpec,a=i.sky,c=n.style,f=dr(t);if(t===void 0)return[];if(f!=="object")return[new Se("sky",t,`object expected, ${f} found`)];let g=[];for(const y in t)g=g.concat(a[y]?n.validateSpec({key:y,value:t[y],valueSpec:a[y],style:c,styleSpec:i}):[new Se(y,t[y],`unknown property "${y}"`)]);return g}function Io(n){const t=n.value,i=n.styleSpec,a=i.terrain,c=n.style;let f=[];const g=dr(t);if(t===void 0)return f;if(g!=="object")return f=f.concat([new Se("terrain",t,`object expected, ${g} found`)]),f;for(const y in t)f=f.concat(a[y]?n.validateSpec({key:y,value:t[y],valueSpec:a[y],validateSpec:n.validateSpec,style:c,styleSpec:i}):[new Se(y,t[y],`unknown property "${y}"`)]);return f}function cu(n){let t=[];const i=n.value,a=n.key;if(Array.isArray(i)){const c=[],f=[];for(const g in i)i[g].id&&c.includes(i[g].id)&&t.push(new Se(a,i,`all the sprites' ids must be unique, but ${i[g].id} is duplicated`)),c.push(i[g].id),i[g].url&&f.includes(i[g].url)&&t.push(new Se(a,i,`all the sprites' URLs must be unique, but ${i[g].url} is duplicated`)),f.push(i[g].url),t=t.concat(zi({key:`${a}[${g}]`,value:i[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return t}return ai({key:a,value:i})}const ih={"*":()=>[],array:Cs,boolean:function(n){const t=n.value,i=n.key,a=dr(t);return a!=="boolean"?[new Se(i,t,`boolean expected, ${a} found`)]:[]},number:Es,color:function(n){const t=n.key,i=n.value,a=dr(i);return a!=="string"?[new Se(t,i,`color expected, ${a} found`)]:ur.parse(String(i))?[]:[new Se(t,i,`color expected, "${i}" found`)]},constants:Ps,enum:_a,filter:ya,function:lu,layer:sl,object:zi,source:Wa,light:co,sky:Is,terrain:Io,projection:function(n){const t=n.value,i=n.styleSpec,a=i.projection,c=n.style,f=dr(t);if(t===void 0)return[];if(f!=="object")return[new Se("projection",t,`object expected, ${f} found`)];let g=[];for(const y in t)g=g.concat(a[y]?n.validateSpec({key:y,value:t[y],valueSpec:a[y],style:c,styleSpec:i}):[new Se(y,t[y],`unknown property "${y}"`)]);return g},projectionDefinition:function(n){const t=n.key;let i=n.value;i=i instanceof String?i.valueOf():i;const a=dr(i);return a!=="array"||function(c){return Array.isArray(c)&&c.length===3&&typeof c[0]=="string"&&typeof c[1]=="string"&&typeof c[2]=="number"}(i)||function(c){return!!["interpolate","step","literal"].includes(c[0])}(i)?["array","string"].includes(a)?[]:[new Se(t,i,`projection expected, invalid type "${a}" found`)]:[new Se(t,i,`projection expected, invalid array ${JSON.stringify(i)} found`)]},string:ai,formatted:function(n){return ai(n).length===0?[]:Zo(n)},resolvedImage:function(n){return ai(n).length===0?[]:Zo(n)},padding:function(n){const t=n.key,i=n.value;if(dr(i)==="array"){if(i.length<1||i.length>4)return[new Se(t,i,`padding requires 1 to 4 values; ${i.length} values found`)];const a={type:"number"};let c=[];for(let f=0;f<i.length;f++)c=c.concat(n.validateSpec({key:`${t}[${f}]`,value:i[f],validateSpec:n.validateSpec,valueSpec:a}));return c}return Es({key:t,value:i,valueSpec:{}})},variableAnchorOffsetCollection:function(n){const t=n.key,i=n.value,a=dr(i),c=n.styleSpec;if(a!=="array"||i.length<1||i.length%2!=0)return[new Se(t,i,"variableAnchorOffsetCollection requires a non-empty array of even length")];let f=[];for(let g=0;g<i.length;g+=2)f=f.concat(_a({key:`${t}[${g}]`,value:i[g],valueSpec:c.layout_symbol["text-anchor"]})),f=f.concat(Cs({key:`${t}[${g+1}]`,value:i[g+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:c}));return f},sprite:cu};function va(n){const t=n.value,i=n.valueSpec,a=n.styleSpec;return n.validateSpec=va,i.expression&&Uo(Jr(t))?lu(n):i.expression&&nl(Ga(t))?Zo(n):i.type&&ih[i.type]?ih[i.type](n):zi(dt({},n,{valueSpec:i.type?a[i.type]:i}))}function Ki(n){const t=n.value,i=n.key,a=ai(n);return a.length||(t.indexOf("{fontstack}")===-1&&a.push(new Se(i,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&a.push(new Se(i,t,'"glyphs" url must include a "{range}" token'))),a}function Vr(n,t=R){let i=[];return i=i.concat(va({key:"",value:n,valueSpec:t.$root,styleSpec:t,style:n,validateSpec:va,objectElementValidators:{glyphs:Ki,"*":()=>[]}})),n.constants&&(i=i.concat(Ps({key:"constants",value:n.constants}))),Ms(i)}function fn(n){return function(t){return n({...t,validateSpec:va})}}function Ms(n){return[].concat(n).sort((t,i)=>t.line-i.line)}function Yi(n){return function(...t){return Ms(n.apply(this,t))}}Vr.source=Yi(fn(Wa)),Vr.sprite=Yi(fn(cu)),Vr.glyphs=Yi(fn(Ki)),Vr.light=Yi(fn(co)),Vr.sky=Yi(fn(Is)),Vr.terrain=Yi(fn(Io)),Vr.layer=Yi(fn(sl)),Vr.filter=Yi(fn(ya)),Vr.paintProperty=Yi(fn(fc)),Vr.layoutProperty=Yi(fn(nh));const ho=Vr,Qi=ho.light,qr=ho.sky,Or=ho.paintProperty,xa=ho.layoutProperty;function mn(n,t){let i=!1;if(t&&t.length)for(const a of t)n.fire(new Ai(new Error(a.message))),i=!0;return i}class En{constructor(t,i,a){const c=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const g=new Int32Array(this.arrayBuffer);t=g[0],this.d=(i=g[1])+2*(a=g[2]);for(let b=0;b<this.d*this.d;b++){const T=g[3+b],C=g[3+b+1];c.push(T===C?null:g.subarray(T,C))}const y=g[3+c.length+1];this.keys=g.subarray(g[3+c.length],y),this.bboxes=g.subarray(y),this.insert=this._insertReadonly}else{this.d=i+2*a;for(let g=0;g<this.d*this.d;g++)c.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=t,this.padding=a,this.scale=i/t,this.uid=0;const f=a/i*t;this.min=-f,this.max=t+f}insert(t,i,a,c,f){this._forEachCell(i,a,c,f,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(f)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,i,a,c,f,g){this.cells[f].push(g)}query(t,i,a,c,f){const g=this.min,y=this.max;if(t<=g&&i<=g&&y<=a&&y<=c&&!f)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(t,i,a,c,this._queryCell,b,{},f),b}}_queryCell(t,i,a,c,f,g,y,b){const T=this.cells[f];if(T!==null){const C=this.keys,k=this.bboxes;for(let F=0;F<T.length;F++){const j=T[F];if(y[j]===void 0){const N=4*j;(b?b(k[N+0],k[N+1],k[N+2],k[N+3]):t<=k[N+2]&&i<=k[N+3]&&a>=k[N+0]&&c>=k[N+1])?(y[j]=!0,g.push(C[j])):y[j]=!1}}}}_forEachCell(t,i,a,c,f,g,y,b){const T=this._convertToCellCoord(t),C=this._convertToCellCoord(i),k=this._convertToCellCoord(a),F=this._convertToCellCoord(c);for(let j=T;j<=k;j++)for(let N=C;N<=F;N++){const Z=this.d*N+j;if((!b||b(this._convertFromCellCoord(j),this._convertFromCellCoord(N),this._convertFromCellCoord(j+1),this._convertFromCellCoord(N+1)))&&f.call(this,t,i,a,c,Z,g,y,b))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,i=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const c=new Int32Array(i+a+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;let f=i;for(let g=0;g<t.length;g++){const y=t[g];c[3+g]=f,c.set(y,f),f+=y.length}return c[3+t.length]=f,c.set(this.keys,f),f+=this.keys.length,c[3+t.length+1]=f,c.set(this.bboxes,f),f+=this.bboxes.length,c.buffer}static serialize(t,i){const a=t.toArrayBuffer();return i&&i.push(a),{buffer:a}}static deserialize(t){return new En(t.buffer)}}const gn={};function ft(n,t,i={}){if(gn[n])throw new Error(`${n} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:n,writeable:!1}),gn[n]={klass:t,omit:i.omit||[],shallow:i.shallow||[]}}ft("Object",Object),ft("TransferableGridIndex",En),ft("Color",ur),ft("Error",Error),ft("AJAXError",pi),ft("ResolvedImage",$n),ft("StylePropertyFunction",ou),ft("StyleExpression",iu,{omit:["_evaluator"]}),ft("ZoomDependentExpression",il),ft("ZoomConstantExpression",Ss),ft("CompoundExpression",Qr,{omit:["_evaluate"]});for(const n in bs)bs[n]._classRegistryKey||ft(`Expression_${n}`,bs[n]);function _n(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function ks(n){return n.$name||n.constructor._classRegistryKey}function mc(n){return!function(t){if(t===null||typeof t!="object")return!1;const i=ks(t);return!(!i||i==="Object")}(n)&&(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||n instanceof Error||_n(n)||di(n)||ArrayBuffer.isView(n)||n instanceof ImageData)}function Go(n,t){if(mc(n))return(_n(n)||di(n))&&t&&t.push(n),ArrayBuffer.isView(n)&&t&&t.push(n.buffer),n instanceof ImageData&&t&&t.push(n.data.buffer),n;if(Array.isArray(n)){const f=[];for(const g of n)f.push(Go(g,t));return f}if(typeof n!="object")throw new Error("can't serialize object of type "+typeof n);const i=ks(n);if(!i)throw new Error(`can't serialize object of unregistered class ${n.constructor.name}`);if(!gn[i])throw new Error(`${i} is not registered.`);const{klass:a}=gn[i],c=a.serialize?a.serialize(n,t):{};if(a.serialize){if(t&&c===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const f in n){if(!n.hasOwnProperty(f)||gn[i].omit.indexOf(f)>=0)continue;const g=n[f];c[f]=gn[i].shallow.indexOf(f)>=0?g:Go(g,t)}n instanceof Error&&(c.message=n.message)}if(c.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(c.$name=i),c}function ba(n){if(mc(n))return n;if(Array.isArray(n))return n.map(ba);if(typeof n!="object")throw new Error("can't deserialize object of type "+typeof n);const t=ks(n)||"Object";if(!gn[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:i}=gn[t];if(!i)throw new Error(`can't deserialize unregistered class ${t}`);if(i.deserialize)return i.deserialize(n);const a=Object.create(i.prototype);for(const c of Object.keys(n)){if(c==="$name")continue;const f=n[c];a[c]=gn[t].shallow.indexOf(c)>=0?f:ba(f)}return a}class ll{constructor(){this.first=!0}update(t,i){const a=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=i),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=a,!0))}}const Yt={"Latin-1 Supplement":n=>n>=128&&n<=255,"Hangul Jamo":n=>n>=4352&&n<=4607,Khmer:n=>n>=6016&&n<=6143,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Kanbun:n=>n>=12688&&n<=12703,"CJK Strokes":n=>n>=12736&&n<=12783,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Hangul Syllables":n=>n>=44032&&n<=55215,"Private Use Area":n=>n>=57344&&n<=63743,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function Ha(n){for(const t of n)if(Ta(t.charCodeAt(0)))return!0;return!1}function hu(n){for(const t of n)if(!Mo(t.charCodeAt(0)))return!1;return!0}function ul(n){const t=n.map(i=>{try{return new RegExp(`\\p{sc=${i}}`,"u").source}catch{return null}}).filter(i=>i);return new RegExp(t.join("|"),"u")}const oh=ul(["Arab","Dupl","Mong","Ougr","Syrc"]);function Mo(n){return!oh.test(String.fromCodePoint(n))}const wa=ul(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ta(n){return!(n!==746&&n!==747&&(n<4352||!(Yt["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||Yt["CJK Compatibility"](n)||Yt["CJK Strokes"](n)||!(!Yt["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||Yt["Enclosed CJK Letters and Months"](n)||Yt["Ideographic Description Characters"](n)||Yt.Kanbun(n)||Yt.Katakana(n)&&n!==12540||!(!Yt["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!Yt["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||Yt["Vertical Forms"](n)||Yt["Yijing Hexagram Symbols"](n)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(n))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(n))||wa.test(String.fromCodePoint(n)))))}function As(n){return!(Ta(n)||function(t){return!!(Yt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Yt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Yt["Letterlike Symbols"](t)||Yt["Number Forms"](t)||Yt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Yt["Control Pictures"](t)&&t!==9251||Yt["Optical Character Recognition"](t)||Yt["Enclosed Alphanumerics"](t)||Yt["Geometric Shapes"](t)||Yt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Yt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Yt["CJK Symbols and Punctuation"](t)||Yt.Katakana(t)||Yt["Private Use Area"](t)||Yt["CJK Compatibility Forms"](t)||Yt["Small Form Variants"](t)||Yt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(n))}const du=ul(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function vi(n){return du.test(String.fromCodePoint(n))}function Ri(n,t){return!(!t&&vi(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||Yt.Khmer(n))}function Sa(n){for(const t of n)if(vi(t.charCodeAt(0)))return!0;return!1}const Hn=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(n){this.pluginStatus=n.pluginStatus,this.pluginURL=n.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(n){if(Hn.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=n.applyArabicShaping,this.processBidirectionalText=n.processBidirectionalText,this.processStyledBidirectionalText=n.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(n,t){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(n.pluginStatus!=="loading")return this.setState(n),n;const i=n.pluginURL,a=new Promise(f=>{this.loadScriptResolve=f});t(i);const c=new Promise(f=>setTimeout(()=>f(),this.TIMEOUT));if(yield Promise.race([a,c]),this.isParsed()){const f={pluginStatus:"loaded",pluginURL:i};return this.setState(f),f}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${i}`)})}};class Sr{constructor(t,i){this.zoom=t,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ll,this.transition={})}isSupportedScript(t){return function(i,a){for(const c of i)if(!Ri(c.charCodeAt(0),a))return!1;return!0}(t,Hn.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,i=t-Math.floor(t),a=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*i}}}class po{constructor(t,i){this.property=t,this.value=i,this.expression=function(a,c){if(Uo(a))return new ou(a,c);if(nl(a)){const f=th(a,c);if(f.result==="error")throw new Error(f.value.map(g=>`${g.key}: ${g.message}`).join(", "));return f.value}{let f=a;return c.type==="color"&&typeof a=="string"?f=ur.parse(a):c.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?c.type==="variableAnchorOffsetCollection"&&Array.isArray(a)?f=hn.parse(a):c.type==="projectionDefinition"&&typeof a=="string"&&(f=Un.parse(a)):f=cn.parse(a),{kind:"constant",evaluate:()=>f}}}(i===void 0?t.specification.default:i,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,i,a){return this.property.possiblyEvaluate(this,t,i,a)}}class cl{constructor(t){this.property=t,this.value=new po(t,void 0)}transitioned(t,i){return new dl(this.property,this.value,i,Xe({},t.transition,this.transition),t.now)}untransitioned(){return new dl(this.property,this.value,null,{},0)}}class hl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return St(this._values[t].value.value)}setValue(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new cl(this._values[t].property)),this._values[t].value=new po(this._values[t].property,i===null?void 0:St(i))}getTransition(t){return St(this._values[t].transition)}setTransition(t,i){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new cl(this._values[t].property)),this._values[t].transition=St(i)||void 0}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a);const c=this.getTransition(i);c!==void 0&&(t[`${i}-transition`]=c)}return t}transitioned(t,i){const a=new Dn(this._properties);for(const c of Object.keys(this._values))a._values[c]=this._values[c].transitioned(t,i._values[c]);return a}untransitioned(){const t=new Dn(this._properties);for(const i of Object.keys(this._values))t._values[i]=this._values[i].untransitioned();return t}}class dl{constructor(t,i,a,c,f){this.property=t,this.value=i,this.begin=f+c.delay||0,this.end=this.begin+c.duration||0,t.specification.transition&&(c.delay||c.duration)&&(this.prior=a)}possiblyEvaluate(t,i,a){const c=t.now||0,f=this.value.possiblyEvaluate(t,i,a),g=this.prior;if(g){if(c>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(c<this.begin)return g.possiblyEvaluate(t,i,a);{const y=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,i,a),f,rt(y))}}return f}}class Dn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,i,a){const c=new xi(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].possiblyEvaluate(t,i,a);return c}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Di{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return St(this._values[t].value)}setValue(t,i){this._values[t]=new po(this._values[t].property,i===null?void 0:St(i))}serialize(){const t={};for(const i of Object.keys(this._values)){const a=this.getValue(i);a!==void 0&&(t[i]=a)}return t}possiblyEvaluate(t,i,a){const c=new xi(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].possiblyEvaluate(t,i,a);return c}}class xr{constructor(t,i,a){this.property=t,this.value=i,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,i,a,c){return this.property.evaluate(this.value,this.parameters,t,i,a,c)}}class xi{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,i){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(i)}interpolate(t,i,a){const c=qn[this.specification.type];return c?c(t,i,a):t}}class $t{constructor(t,i){this.specification=t,this.overrides=i}possiblyEvaluate(t,i,a,c){return new xr(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(i,null,{},a,c)}:t.expression,i)}interpolate(t,i,a){if(t.value.kind!=="constant"||i.value.kind!=="constant")return t;if(t.value.value===void 0||i.value.value===void 0)return new xr(this,{kind:"constant",value:void 0},t.parameters);const c=qn[this.specification.type];if(c){const f=c(t.value.value,i.value.value,a);return new xr(this,{kind:"constant",value:f},t.parameters)}return t}evaluate(t,i,a,c,f,g){return t.kind==="constant"?t.value:t.evaluate(i,a,c,f,g)}}class Xa extends $t{possiblyEvaluate(t,i,a,c){if(t.value===void 0)return new xr(this,{kind:"constant",value:void 0},i);if(t.expression.kind==="constant"){const f=t.expression.evaluate(i,null,{},a,c),g=t.property.specification.type==="resolvedImage"&&typeof f!="string"?f.name:f,y=this._calculate(g,g,g,i);return new xr(this,{kind:"constant",value:y},i)}if(t.expression.kind==="camera"){const f=this._calculate(t.expression.evaluate({zoom:i.zoom-1}),t.expression.evaluate({zoom:i.zoom}),t.expression.evaluate({zoom:i.zoom+1}),i);return new xr(this,{kind:"constant",value:f},i)}return new xr(this,t.expression,i)}evaluate(t,i,a,c,f,g){if(t.kind==="source"){const y=t.evaluate(i,a,c,f,g);return this._calculate(y,y,y,i)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(i.zoom)-1},a,c),t.evaluate({zoom:Math.floor(i.zoom)},a,c),t.evaluate({zoom:Math.floor(i.zoom)+1},a,c),i):t.value}_calculate(t,i,a,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class zs{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,c){if(t.value!==void 0){if(t.expression.kind==="constant"){const f=t.expression.evaluate(i,null,{},a,c);return this._calculate(f,f,f,i)}return this._calculate(t.expression.evaluate(new Sr(Math.floor(i.zoom-1),i)),t.expression.evaluate(new Sr(Math.floor(i.zoom),i)),t.expression.evaluate(new Sr(Math.floor(i.zoom+1),i)),i)}}_calculate(t,i,a,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:t,to:i}:{from:a,to:i}}interpolate(t){return t}}class pu{constructor(t){this.specification=t}possiblyEvaluate(t,i,a,c){return!!t.expression.evaluate(i,null,{},a,c)}interpolate(){return!1}}class Ln{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in t){const a=t[i];a.specification.overridable&&this.overridableProperties.push(i);const c=this.defaultPropertyValues[i]=new po(a,void 0),f=this.defaultTransitionablePropertyValues[i]=new cl(a);this.defaultTransitioningPropertyValues[i]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=c.possiblyEvaluate({})}}}ft("DataDrivenProperty",$t),ft("DataConstantProperty",zt),ft("CrossFadedDataDrivenProperty",Xa),ft("CrossFadedProperty",zs),ft("ColorRampProperty",pu);const gc="-transition";class si extends xe{constructor(t,i){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),i.layout&&(this._unevaluatedLayout=new Di(i.layout)),i.paint)){this._transitionablePaint=new hl(i.paint);for(const a in t.paint)this.setPaintProperty(a,t.paint[a],{validate:!1});for(const a in t.layout)this.setLayoutProperty(a,t.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new xi(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,i,a={}){i!=null&&this._validate(xa,`layers.${this.id}.layout.${t}`,t,i,a)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,i):this.visibility=i)}getPaintProperty(t){return t.endsWith(gc)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,i,a={}){if(i!=null&&this._validate(Or,`layers.${this.id}.paint.${t}`,t,i,a))return!1;if(t.endsWith(gc))return this._transitionablePaint.setTransition(t.slice(0,-11),i||void 0),!1;{const c=this._transitionablePaint._values[t],f=c.property.specification["property-type"]==="cross-faded-data-driven",g=c.value.isDataDriven(),y=c.value;this._transitionablePaint.setValue(t,i),this._handleSpecialPaintPropertyUpdate(t);const b=this._transitionablePaint._values[t].value;return b.isDataDriven()||g||f||this._handleOverridablePaintPropertyUpdate(t,y,b)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,i,a){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,i){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,i)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),mt(t,(i,a)=>!(i===void 0||a==="layout"&&!Object.keys(i).length||a==="paint"&&!Object.keys(i).length))}_validate(t,i,a,c,f={}){return(!f||f.validate!==!1)&&mn(this,t.call(ho,{key:i,layerType:this.type,objectKey:a,value:c,styleSpec:R,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const i=this.paint.get(t);if(i instanceof xr&&Po(i.property.specification)&&(i.value.kind==="source"||i.value.kind==="composite")&&i.value.isStateDependent)return!0}return!1}}const _c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ko{constructor(t,i){this._structArray=t,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $r{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,i){return t._trim(),i&&(t.isTransferred=!0,i.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const i=Object.create(this.prototype);return i.arrayBuffer=t.arrayBuffer,i.length=t.length,i.capacity=t.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Kr(n,t=1){let i=0,a=0;return{members:n.map(c=>{const f=_c[c.type].BYTES_PER_ELEMENT,g=i=yc(i,Math.max(t,f)),y=c.components||1;return a=Math.max(a,f),i+=f*y,{name:c.name,type:c.type,components:y,offset:g}}),size:yc(i,Math.max(a,t)),alignment:t}}function yc(n,t){return Math.ceil(n/t)*t}class Ka extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const c=2*t;return this.int16[c+0]=i,this.int16[c+1]=a,t}}Ka.prototype.bytesPerElement=4,ft("StructArrayLayout2i4",Ka);class qo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,a)}emplace(t,i,a,c){const f=3*t;return this.int16[f+0]=i,this.int16[f+1]=a,this.int16[f+2]=c,t}}qo.prototype.bytesPerElement=6,ft("StructArrayLayout3i6",qo);class fu extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,a,c)}emplace(t,i,a,c,f){const g=4*t;return this.int16[g+0]=i,this.int16[g+1]=a,this.int16[g+2]=c,this.int16[g+3]=f,t}}fu.prototype.bytesPerElement=8,ft("StructArrayLayout4i8",fu);class Ji extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,a,c,f,g)}emplace(t,i,a,c,f,g,y){const b=6*t;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=c,this.int16[b+3]=f,this.int16[b+4]=g,this.int16[b+5]=y,t}}Ji.prototype.bytesPerElement=12,ft("StructArrayLayout2i4i12",Ji);class Ya extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,a,c,f,g)}emplace(t,i,a,c,f,g,y){const b=4*t,T=8*t;return this.int16[b+0]=i,this.int16[b+1]=a,this.uint8[T+4]=c,this.uint8[T+5]=f,this.uint8[T+6]=g,this.uint8[T+7]=y,t}}Ya.prototype.bytesPerElement=8,ft("StructArrayLayout2i4ub8",Ya);class eo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const c=2*t;return this.float32[c+0]=i,this.float32[c+1]=a,t}}eo.prototype.bytesPerElement=8,ft("StructArrayLayout2f8",eo);class Rs extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g,y,b,T,C){const k=this.length;return this.resize(k+1),this.emplace(k,t,i,a,c,f,g,y,b,T,C)}emplace(t,i,a,c,f,g,y,b,T,C,k){const F=10*t;return this.uint16[F+0]=i,this.uint16[F+1]=a,this.uint16[F+2]=c,this.uint16[F+3]=f,this.uint16[F+4]=g,this.uint16[F+5]=y,this.uint16[F+6]=b,this.uint16[F+7]=T,this.uint16[F+8]=C,this.uint16[F+9]=k,t}}Rs.prototype.bytesPerElement=20,ft("StructArrayLayout10ui20",Rs);class Qa extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g,y,b,T,C,k,F){const j=this.length;return this.resize(j+1),this.emplace(j,t,i,a,c,f,g,y,b,T,C,k,F)}emplace(t,i,a,c,f,g,y,b,T,C,k,F,j){const N=12*t;return this.int16[N+0]=i,this.int16[N+1]=a,this.int16[N+2]=c,this.int16[N+3]=f,this.uint16[N+4]=g,this.uint16[N+5]=y,this.uint16[N+6]=b,this.uint16[N+7]=T,this.int16[N+8]=C,this.int16[N+9]=k,this.int16[N+10]=F,this.int16[N+11]=j,t}}Qa.prototype.bytesPerElement=24,ft("StructArrayLayout4i4ui4i24",Qa);class pl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,a)}emplace(t,i,a,c){const f=3*t;return this.float32[f+0]=i,this.float32[f+1]=a,this.float32[f+2]=c,t}}pl.prototype.bytesPerElement=12,ft("StructArrayLayout3f12",pl);class Pa extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint32[1*t+0]=i,t}}Pa.prototype.bytesPerElement=4,ft("StructArrayLayout1ul4",Pa);class to extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g,y,b,T){const C=this.length;return this.resize(C+1),this.emplace(C,t,i,a,c,f,g,y,b,T)}emplace(t,i,a,c,f,g,y,b,T,C){const k=10*t,F=5*t;return this.int16[k+0]=i,this.int16[k+1]=a,this.int16[k+2]=c,this.int16[k+3]=f,this.int16[k+4]=g,this.int16[k+5]=y,this.uint32[F+3]=b,this.uint16[k+8]=T,this.uint16[k+9]=C,t}}to.prototype.bytesPerElement=20,ft("StructArrayLayout6i1ul2ui20",to);class bi extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,a,c,f,g)}emplace(t,i,a,c,f,g,y){const b=6*t;return this.int16[b+0]=i,this.int16[b+1]=a,this.int16[b+2]=c,this.int16[b+3]=f,this.int16[b+4]=g,this.int16[b+5]=y,t}}bi.prototype.bytesPerElement=12,ft("StructArrayLayout2i2i2i12",bi);class Ao extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f){const g=this.length;return this.resize(g+1),this.emplace(g,t,i,a,c,f)}emplace(t,i,a,c,f,g){const y=4*t,b=8*t;return this.float32[y+0]=i,this.float32[y+1]=a,this.float32[y+2]=c,this.int16[b+6]=f,this.int16[b+7]=g,t}}Ao.prototype.bytesPerElement=16,ft("StructArrayLayout2f1f2i16",Ao);class Wo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,i,a,c,f,g)}emplace(t,i,a,c,f,g,y){const b=16*t,T=4*t,C=8*t;return this.uint8[b+0]=i,this.uint8[b+1]=a,this.float32[T+1]=c,this.float32[T+2]=f,this.int16[C+6]=g,this.int16[C+7]=y,t}}Wo.prototype.bytesPerElement=16,ft("StructArrayLayout2ub2f2i16",Wo);class fl extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,a)}emplace(t,i,a,c){const f=3*t;return this.uint16[f+0]=i,this.uint16[f+1]=a,this.uint16[f+2]=c,t}}fl.prototype.bytesPerElement=6,ft("StructArrayLayout3ui6",fl);class fo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te){const fe=this.length;return this.resize(fe+1),this.emplace(fe,t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te)}emplace(t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te,fe){const ie=24*t,B=12*t,H=48*t;return this.int16[ie+0]=i,this.int16[ie+1]=a,this.uint16[ie+2]=c,this.uint16[ie+3]=f,this.uint32[B+2]=g,this.uint32[B+3]=y,this.uint32[B+4]=b,this.uint16[ie+10]=T,this.uint16[ie+11]=C,this.uint16[ie+12]=k,this.float32[B+7]=F,this.float32[B+8]=j,this.uint8[H+36]=N,this.uint8[H+37]=Z,this.uint8[H+38]=K,this.uint32[B+10]=te,this.int16[ie+22]=fe,t}}fo.prototype.bytesPerElement=48,ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",fo);class mo extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te,fe,ie,B,H,ae,Ce,Ke,ke,Be,tt,Ye){const at=this.length;return this.resize(at+1),this.emplace(at,t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te,fe,ie,B,H,ae,Ce,Ke,ke,Be,tt,Ye)}emplace(t,i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te,fe,ie,B,H,ae,Ce,Ke,ke,Be,tt,Ye,at){const Ue=32*t,wt=16*t;return this.int16[Ue+0]=i,this.int16[Ue+1]=a,this.int16[Ue+2]=c,this.int16[Ue+3]=f,this.int16[Ue+4]=g,this.int16[Ue+5]=y,this.int16[Ue+6]=b,this.int16[Ue+7]=T,this.uint16[Ue+8]=C,this.uint16[Ue+9]=k,this.uint16[Ue+10]=F,this.uint16[Ue+11]=j,this.uint16[Ue+12]=N,this.uint16[Ue+13]=Z,this.uint16[Ue+14]=K,this.uint16[Ue+15]=te,this.uint16[Ue+16]=fe,this.uint16[Ue+17]=ie,this.uint16[Ue+18]=B,this.uint16[Ue+19]=H,this.uint16[Ue+20]=ae,this.uint16[Ue+21]=Ce,this.uint16[Ue+22]=Ke,this.uint32[wt+12]=ke,this.float32[wt+13]=Be,this.float32[wt+14]=tt,this.uint16[Ue+30]=Ye,this.uint16[Ue+31]=at,t}}mo.prototype.bytesPerElement=64,ft("StructArrayLayout8i15ui1ul2f2ui64",mo);class Ds extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.float32[1*t+0]=i,t}}Ds.prototype.bytesPerElement=4,ft("StructArrayLayout1f4",Ds);class d extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,a)}emplace(t,i,a,c){const f=3*t;return this.uint16[6*t+0]=i,this.float32[f+1]=a,this.float32[f+2]=c,t}}d.prototype.bytesPerElement=12,ft("StructArrayLayout1ui2f12",d);class e extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i,a){const c=this.length;return this.resize(c+1),this.emplace(c,t,i,a)}emplace(t,i,a,c){const f=4*t;return this.uint32[2*t+0]=i,this.uint16[f+2]=a,this.uint16[f+3]=c,t}}e.prototype.bytesPerElement=8,ft("StructArrayLayout1ul2ui8",e);class r extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,i){const a=this.length;return this.resize(a+1),this.emplace(a,t,i)}emplace(t,i,a){const c=2*t;return this.uint16[c+0]=i,this.uint16[c+1]=a,t}}r.prototype.bytesPerElement=4,ft("StructArrayLayout2ui4",r);class l extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const i=this.length;return this.resize(i+1),this.emplace(i,t)}emplace(t,i){return this.uint16[1*t+0]=i,t}}l.prototype.bytesPerElement=2,ft("StructArrayLayout1ui2",l);class u extends $r{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,i,a,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,i,a,c)}emplace(t,i,a,c,f){const g=4*t;return this.float32[g+0]=i,this.float32[g+1]=a,this.float32[g+2]=c,this.float32[g+3]=f,t}}u.prototype.bytesPerElement=16,ft("StructArrayLayout4f16",u);class p extends ko{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ge(this.anchorPointX,this.anchorPointY)}}p.prototype.size=20;class _ extends to{get(t){return new p(this,t)}}ft("CollisionBoxArray",_);class x extends ko{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class w extends fo{get(t){return new x(this,t)}}ft("PlacedSymbolArray",w);class P extends ko{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class A extends mo{get(t){return new P(this,t)}}ft("SymbolInstanceArray",A);class D extends Ds{getoffsetX(t){return this.float32[1*t+0]}}ft("GlyphOffsetArray",D);class O extends qo{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}ft("SymbolLineVertexArray",O);class $ extends ko{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}$.prototype.size=12;class U extends d{get(t){return new $(this,t)}}ft("TextAnchorOffsetArray",U);class Q extends ko{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Q.prototype.size=8;class Y extends e{get(t){return new Q(this,t)}}ft("FeatureIndexArray",Y);class J extends Ka{}class re extends Ka{}class le extends Ka{}class ue extends Ji{}class de extends Ya{}class pe extends eo{}class se extends Rs{}class be extends Qa{}class we extends pl{}class Fe extends Pa{}class je extends bi{}class Oe extends Wo{}class lt extends fl{}class Qe extends r{}const He=Kr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Pt}=He;class Rt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,i,a,c){const f=this.segments[this.segments.length-1];return t>Rt.MAX_VERTEX_ARRAY_LENGTH&&or(`Max vertices per segment is ${Rt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${Rt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!f||f.vertexLength+t>Rt.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==c?this.createNewSegment(i,a,c):f}createNewSegment(t,i,a){const c={vertexOffset:t.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0,vaos:{}};return a!==void 0&&(c.sortKey=a),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(c),c}getOrCreateLatestSegment(t,i,a){return this.prepareSegment(0,t,i,a)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const i in t.vaos)t.vaos[i].destroy()}static simpleSegment(t,i,a,c){return new Rt([{vertexOffset:t,primitiveOffset:i,vertexLength:a,primitiveLength:c,vaos:{},sortKey:0}])}}function nr(n,t){return 256*(n=kt(Math.floor(n),0,255))+kt(Math.floor(t),0,255)}Rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ft("SegmentVector",Rt);const pr=Kr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Pr,Ur,Fr,wr={exports:{}},zr={exports:{}},yn={exports:{}},vn=function(){if(Fr)return wr.exports;Fr=1;var n=(Pr||(Pr=1,zr.exports=function(i,a){var c,f,g,y,b,T,C,k;for(f=i.length-(c=3&i.length),g=a,b=3432918353,T=461845907,k=0;k<f;)C=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,g=27492+(65535&(y=5*(65535&(g=(g^=C=(65535&(C=(C=(65535&C)*b+(((C>>>16)*b&65535)<<16)&4294967295)<<15|C>>>17))*T+(((C>>>16)*T&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(C=0,c){case 3:C^=(255&i.charCodeAt(k+2))<<16;case 2:C^=(255&i.charCodeAt(k+1))<<8;case 1:g^=C=(65535&(C=(C=(65535&(C^=255&i.charCodeAt(k)))*b+(((C>>>16)*b&65535)<<16)&4294967295)<<15|C>>>17))*T+(((C>>>16)*T&65535)<<16)&4294967295}return g^=i.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),zr.exports),t=(Ur||(Ur=1,yn.exports=function(i,a){for(var c,f=i.length,g=a^f,y=0;f>=4;)c=1540483477*(65535&(c=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++y;switch(f){case 3:g^=(255&i.charCodeAt(y+2))<<16;case 2:g^=(255&i.charCodeAt(y+1))<<8;case 1:g=1540483477*(65535&(g^=255&i.charCodeAt(y)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),yn.exports);return wr.exports=n,wr.exports.murmur3=n,wr.exports.murmur2=t,wr.exports}(),an=Me(vn);class In{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,i,a,c){this.ids.push(Ho(t)),this.positions.push(i,a,c)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const i=Ho(t);let a=0,c=this.ids.length-1;for(;a<c;){const g=a+c>>1;this.ids[g]>=i?c=g:a=g+1}const f=[];for(;this.ids[a]===i;)f.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return f}static serialize(t,i){const a=new Float64Array(t.ids),c=new Uint32Array(t.positions);return zo(a,c,0,a.length-1),i&&i.push(a.buffer,c.buffer),{ids:a,positions:c}}static deserialize(t){const i=new In;return i.ids=t.ids,i.positions=t.positions,i.indexed=!0,i}}function Ho(n){const t=+n;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:an(String(n))}function zo(n,t,i,a){for(;i<a;){const c=n[i+a>>1];let f=i-1,g=a+1;for(;;){do f++;while(n[f]<c);do g--;while(n[g]>c);if(f>=g)break;wi(n,f,g),wi(t,3*f,3*g),wi(t,3*f+1,3*g+1),wi(t,3*f+2,3*g+2)}g-i<a-g?(zo(n,t,i,g),i=g+1):(zo(n,t,g+1,a),a=g)}}function wi(n,t,i){const a=n[t];n[t]=n[i],n[i]=a}ft("FeaturePositionMap",In);class Li{constructor(t,i){this.gl=t.gl,this.location=i}}class Ro extends Li{constructor(t,i){super(t,i),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Ca extends Li{constructor(t,i){super(t,i),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Ea extends Li{constructor(t,i){super(t,i),this.current=ur.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Ti=new Float32Array(16);function go(n){return[nr(255*n.r,255*n.g),nr(255*n.b,255*n.a)]}class ro{constructor(t,i,a){this.value=t,this.uniformNames=i.map(c=>`u_${c}`),this.type=a}setUniform(t,i,a){t.set(a.constantOr(this.value))}getBinding(t,i,a){return this.type==="color"?new Ea(t,i):new Ro(t,i)}}class _o{constructor(t,i){this.uniformNames=i.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=i.tlbr,this.patternTo=t.tlbr}setUniform(t,i,a,c){const f=c==="u_pattern_to"?this.patternTo:c==="u_pattern_from"?this.patternFrom:c==="u_pixel_ratio_to"?this.pixelRatioTo:c==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&t.set(f)}getBinding(t,i,a){return a.substr(0,9)==="u_pattern"?new Ca(t,i):new Ro(t,i)}}class Br{constructor(t,i,a,c){this.expression=t,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new c}populatePaintArray(t,i,a,c,f){const g=this.paintVertexArray.length,y=this.expression.evaluate(new Sr(0),i,{},c,[],f);this.paintVertexArray.resize(t),this._setPaintValue(g,t,y)}updatePaintArray(t,i,a,c){const f=this.expression.evaluate({zoom:0},a,c);this._setPaintValue(t,i,f)}_setPaintValue(t,i,a){if(this.type==="color"){const c=go(a);for(let f=t;f<i;f++)this.paintVertexArray.emplace(f,c[0],c[1])}else{for(let c=t;c<i;c++)this.paintVertexArray.emplace(c,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Rr{constructor(t,i,a,c,f,g){this.expression=t,this.uniformNames=i.map(y=>`u_${y}_t`),this.type=a,this.useIntegerZoom=c,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(y=>({name:`a_${y}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,i,a,c,f){const g=this.expression.evaluate(new Sr(this.zoom),i,{},c,[],f),y=this.expression.evaluate(new Sr(this.zoom+1),i,{},c,[],f),b=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(b,t,g,y)}updatePaintArray(t,i,a,c){const f=this.expression.evaluate({zoom:this.zoom},a,c),g=this.expression.evaluate({zoom:this.zoom+1},a,c);this._setPaintValue(t,i,f,g)}_setPaintValue(t,i,a,c){if(this.type==="color"){const f=go(a),g=go(c);for(let y=t;y<i;y++)this.paintVertexArray.emplace(y,f[0],f[1],g[0],g[1])}else{for(let f=t;f<i;f++)this.paintVertexArray.emplace(f,a,c);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,i){const a=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,c=kt(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);t.set(c)}getBinding(t,i,a){return new Ro(t,i)}}class sn{constructor(t,i,a,c,f,g){this.expression=t,this.type=i,this.useIntegerZoom=a,this.zoom=c,this.layerId=g,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f}populatePaintArray(t,i,a){const c=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(c,t,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(t,i,a,c,f){this._setPaintValues(t,i,a.patterns&&a.patterns[this.layerId],f)}_setPaintValues(t,i,a,c){if(!c||!a)return;const{min:f,mid:g,max:y}=a,b=c[f],T=c[g],C=c[y];if(b&&T&&C)for(let k=t;k<i;k++)this.zoomInPaintVertexArray.emplace(k,T.tl[0],T.tl[1],T.br[0],T.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],T.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(k,T.tl[0],T.tl[1],T.br[0],T.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],T.pixelRatio,C.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,pr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,pr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class ln{constructor(t,i,a){this.binders={},this._buffers=[];const c=[];for(const f in t.paint._values){if(!a(f))continue;const g=t.paint.get(f);if(!(g instanceof xr&&Po(g.property.specification)))continue;const y=Wh(f,t.type),b=g.value,T=g.property.specification.type,C=g.property.useIntegerZoom,k=g.property.specification["property-type"],F=k==="cross-faded"||k==="cross-faded-data-driven";if(b.kind==="constant")this.binders[f]=F?new _o(b.value,y):new ro(b.value,y,T),c.push(`/u_${f}`);else if(b.kind==="source"||F){const j=vc(f,T,"source");this.binders[f]=F?new sn(b,T,C,i,j,t.id):new Br(b,y,T,j),c.push(`/a_${f}`)}else{const j=vc(f,T,"composite");this.binders[f]=new Rr(b,y,T,C,i,j),c.push(`/z_${f}`)}}this.cacheKey=c.sort().join("")}getMaxValue(t){const i=this.binders[t];return i instanceof Br||i instanceof Rr?i.maxValue:0}populatePaintArrays(t,i,a,c,f){for(const g in this.binders){const y=this.binders[g];(y instanceof Br||y instanceof Rr||y instanceof sn)&&y.populatePaintArray(t,i,a,c,f)}}setConstantPatternPositions(t,i){for(const a in this.binders){const c=this.binders[a];c instanceof _o&&c.setConstantPatternPositions(t,i)}}updatePaintArrays(t,i,a,c,f){let g=!1;for(const y in t){const b=i.getPositions(y);for(const T of b){const C=a.feature(T.index);for(const k in this.binders){const F=this.binders[k];if((F instanceof Br||F instanceof Rr||F instanceof sn)&&F.expression.isStateDependent===!0){const j=c.paint.get(k);F.expression=j.value,F.updatePaintArray(T.start,T.end,C,t[y],f),g=!0}}}}return g}defines(){const t=[];for(const i in this.binders){const a=this.binders[i];(a instanceof ro||a instanceof _o)&&t.push(...a.uniformNames.map(c=>`#define HAS_UNIFORM_${c}`))}return t}getBinderAttributes(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Br||a instanceof Rr)for(let c=0;c<a.paintVertexAttributes.length;c++)t.push(a.paintVertexAttributes[c].name);else if(a instanceof sn)for(let c=0;c<pr.members.length;c++)t.push(pr.members[c].name)}return t}getBinderUniforms(){const t=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof ro||a instanceof _o||a instanceof Rr)for(const c of a.uniformNames)t.push(c)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,i){const a=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof ro||f instanceof _o||f instanceof Rr){for(const g of f.uniformNames)if(i[g]){const y=f.getBinding(t,i[g],g);a.push({name:g,property:c,binding:y})}}}return a}setUniforms(t,i,a,c){for(const{name:f,property:g,binding:y}of i)this.binders[g].setUniform(y,c,a.get(g),f)}updatePaintBuffers(t){this._buffers=[];for(const i in this.binders){const a=this.binders[i];if(t&&a instanceof sn){const c=t.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(a instanceof Br||a instanceof Rr)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(t){for(const i in this.binders){const a=this.binders[i];(a instanceof Br||a instanceof Rr||a instanceof sn)&&a.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const i=this.binders[t];(i instanceof Br||i instanceof Rr||i instanceof sn)&&i.destroy()}}}class Ia{constructor(t,i,a=()=>!0){this.programConfigurations={};for(const c of t)this.programConfigurations[c.id]=new ln(c,i,a);this.needsUpload=!1,this._featureMap=new In,this._bufferOffset=0}populatePaintArrays(t,i,a,c,f,g){for(const y in this.programConfigurations)this.programConfigurations[y].populatePaintArrays(t,i,c,f,g);i.id!==void 0&&this._featureMap.add(i.id,a,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,i,a,c){for(const f of a)this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(t,this._featureMap,i,f,c)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Wh(n,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${t}-`,"").replace(/-/g,"_")]}function vc(n,t,i){const a={color:{source:eo,composite:u},number:{source:Ds,composite:eo}},c=function(f){return{"line-pattern":{source:se,composite:se},"fill-pattern":{source:se,composite:se},"fill-extrusion-pattern":{source:se,composite:se}}[f]}(n);return c&&c[i]||a[t][i]}ft("ConstantBinder",ro),ft("CrossFadedConstantBinder",_o),ft("SourceExpressionBinder",Br),ft("CrossFadedCompositeBinder",sn),ft("CompositeExpressionBinder",Rr),ft("ProgramConfiguration",ln,{omit:["_buffers"]}),ft("ProgramConfigurationSet",Ia);const xc=Math.pow(2,14)-1,ah=-xc-1;function Ma(n){const t=bt/n.extent,i=n.loadGeometry();for(let a=0;a<i.length;a++){const c=i[a];for(let f=0;f<c.length;f++){const g=c[f],y=Math.round(g.x*t),b=Math.round(g.y*t);g.x=kt(y,ah,xc),g.y=kt(b,ah,xc),(y<g.x||y>g.x+1||b<g.y||b>g.y+1)&&or("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return i}function Si(n,t){return{type:n.type,id:n.id,properties:n.properties,geometry:t?Ma(n):[]}}const mu=-32768;function ml(n,t,i,a,c){n.emplaceBack(mu+8*t+a,mu+8*i+c)}class gu{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new re,this.indexArray=new lt,this.segments=new Rt,this.programConfigurations=new Ia(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){const c=this.layers[0],f=[];let g=null,y=!1,b=c.type==="heatmap";if(c.type==="circle"){const C=c;g=C.layout.get("circle-sort-key"),y=!g.isConstant(),b=b||C.paint.get("circle-pitch-alignment")==="map"}const T=b?i.subdivisionGranularity.circle:1;for(const{feature:C,id:k,index:F,sourceLayerIndex:j}of t){const N=this.layers[0]._featureFilter.needGeometry,Z=Si(C,N);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),Z,a))continue;const K=y?g.evaluate(Z,{},a):void 0,te={id:k,properties:C.properties,type:C.type,sourceLayerIndex:j,index:F,geometry:N?Z.geometry:Ma(C),patterns:{},sortKey:K};f.push(te)}y&&f.sort((C,k)=>C.sortKey-k.sortKey);for(const C of f){const{geometry:k,index:F,sourceLayerIndex:j}=C,N=t[F].feature;this.addFeature(C,k,F,a,T),i.featureIndex.insert(N,k,F,j,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,i,a,c,f=1){let g;switch(f){case 1:g=[0,7];break;case 3:g=[0,2,5,7];break;case 5:g=[0,1,3,4,6,7];break;case 7:g=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${f}; valid values are 1, 3, 5, 7.`)}const y=g.length;for(const b of i)for(const T of b){const C=T.x,k=T.y;if(C<0||C>=bt||k<0||k>=bt)continue;const F=this.segments.prepareSegment(y*y,this.layoutVertexArray,this.indexArray,t.sortKey),j=F.vertexLength;for(let N=0;N<y;N++)for(let Z=0;Z<y;Z++)ml(this.layoutVertexArray,C,k,g[Z],g[N]);for(let N=0;N<y-1;N++)for(let Z=0;Z<y-1;Z++){const K=j+N*y+Z,te=j+(N+1)*y+Z;this.indexArray.emplaceBack(K,te+1,K+1),this.indexArray.emplaceBack(K,te,te+1)}F.vertexLength+=y*y,F.primitiveLength+=(y-1)*(y-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,{},c)}}function _u(n,t){for(let i=0;i<n.length;i++)if(Xo(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(Xo(n,t[i]))return!0;return!!yu(n,t)}function sh(n,t,i){return!!Xo(n,t)||!!lh(t,n,i)}function Pi(n,t){if(n.length===1)return uh(t,n[0]);for(let i=0;i<t.length;i++){const a=t[i];for(let c=0;c<a.length;c++)if(Xo(n,a[c]))return!0}for(let i=0;i<n.length;i++)if(uh(t,n[i]))return!0;for(let i=0;i<t.length;i++)if(yu(n,t[i]))return!0;return!1}function Hh(n,t,i){if(n.length>1){if(yu(n,t))return!0;for(let a=0;a<t.length;a++)if(lh(t[a],n,i))return!0}for(let a=0;a<n.length;a++)if(lh(n[a],t,i))return!0;return!1}function yu(n,t){if(n.length===0||t.length===0)return!1;for(let i=0;i<n.length-1;i++){const a=n[i],c=n[i+1];for(let f=0;f<t.length-1;f++)if(Od(a,c,t[f],t[f+1]))return!0}return!1}function Od(n,t,i,a){return Mr(n,i,a)!==Mr(t,i,a)&&Mr(n,t,i)!==Mr(n,t,a)}function lh(n,t,i){const a=i*i;if(t.length===1)return n.distSqr(t[0])<a;for(let c=1;c<t.length;c++)if(Xh(n,t[c-1],t[c])<a)return!0;return!1}function Xh(n,t,i){const a=t.distSqr(i);if(a===0)return n.distSqr(t);const c=((n.x-t.x)*(i.x-t.x)+(n.y-t.y)*(i.y-t.y))/a;return n.distSqr(c<0?t:c>1?i:i.sub(t)._mult(c)._add(t))}function uh(n,t){let i,a,c,f=!1;for(let g=0;g<n.length;g++){i=n[g];for(let y=0,b=i.length-1;y<i.length;b=y++)a=i[y],c=i[b],a.y>t.y!=c.y>t.y&&t.x<(c.x-a.x)*(t.y-a.y)/(c.y-a.y)+a.x&&(f=!f)}return f}function Xo(n,t){let i=!1;for(let a=0,c=n.length-1;a<n.length;c=a++){const f=n[a],g=n[c];f.y>t.y!=g.y>t.y&&t.x<(g.x-f.x)*(t.y-f.y)/(g.y-f.y)+f.x&&(i=!i)}return i}function Kh(n,t,i){const a=i[0],c=i[2];if(n.x<a.x&&t.x<a.x||n.x>c.x&&t.x>c.x||n.y<a.y&&t.y<a.y||n.y>c.y&&t.y>c.y)return!1;const f=Mr(n,t,i[0]);return f!==Mr(n,t,i[1])||f!==Mr(n,t,i[2])||f!==Mr(n,t,i[3])}function gl(n,t,i){const a=t.paint.get(n).value;return a.kind==="constant"?a.value:i.programConfigurations.get(t.id).getMaxValue(n)}function ch(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function bc(n,t,i,a,c){if(!t[0]&&!t[1])return n;const f=Ge.convert(t)._mult(c);i==="viewport"&&f._rotate(-a);const g=[];for(let y=0;y<n.length;y++)g.push(n[y].sub(f));return g}let Yh,Qh;ft("CircleBucket",gu,{omit:["layers"]});var Fd={get paint(){return Qh=Qh||new Ln({"circle-radius":new $t(R.paint_circle["circle-radius"]),"circle-color":new $t(R.paint_circle["circle-color"]),"circle-blur":new $t(R.paint_circle["circle-blur"]),"circle-opacity":new $t(R.paint_circle["circle-opacity"]),"circle-translate":new zt(R.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(R.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(R.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(R.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $t(R.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $t(R.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $t(R.paint_circle["circle-stroke-opacity"])})},get layout(){return Yh=Yh||new Ln({"circle-sort-key":new $t(R.layout_circle["circle-sort-key"])})}};class Bd extends si{constructor(t){super(t,Fd)}createBucket(t){return new gu(t)}queryRadius(t){const i=t;return gl("circle-radius",this,i)+gl("circle-stroke-width",this,i)+ch(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:c,transform:f,pixelsToTileUnits:g,pixelPosMatrix:y}){const b=bc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-f.bearingInRadians,g),T=this.paint.get("circle-radius").evaluate(i,a)+this.paint.get("circle-stroke-width").evaluate(i,a),C=this.paint.get("circle-pitch-alignment")==="map",k=C?b:function(j,N){return j.map(Z=>jd(Z,N))}(b,y),F=C?T*g:T;for(const j of c)for(const N of j){const Z=C?N:jd(N,y);let K=F;const te=Er([],[N.x,N.y,0,1],y);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?K*=te[3]/f.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(K*=f.cameraToCenterDistance/te[3]),sh(k,Z,K))return!0}return!1}}function jd(n,t){const i=Er([],[n.x,n.y,0,1],t);return new Ge(i[0]/i[3],i[1]/i[3])}class Oi extends gu{}let Ci;ft("HeatmapBucket",Oi,{omit:["layers"]});var Nd={get paint(){return Ci=Ci||new Ln({"heatmap-radius":new $t(R.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $t(R.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(R.paint_heatmap["heatmap-intensity"]),"heatmap-color":new pu(R.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(R.paint_heatmap["heatmap-opacity"])})}};function hh(n,{width:t,height:i},a,c){if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==t*i*a)throw new RangeError(`mismatched image size. expected: ${c.length} but got: ${t*i*a}`)}else c=new Uint8Array(t*i*a);return n.width=t,n.height=i,n.data=c,n}function Jh(n,{width:t,height:i},a){if(t===n.width&&i===n.height)return;const c=hh({},{width:t,height:i},a);dh(n,c,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,t),height:Math.min(n.height,i)},a),n.width=t,n.height=i,n.data=c.data}function dh(n,t,i,a,c,f){if(c.width===0||c.height===0)return t;if(c.width>n.width||c.height>n.height||i.x>n.width-c.width||i.y>n.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>t.width||c.height>t.height||a.x>t.width-c.width||a.y>t.height-c.height)throw new RangeError("out of range destination coordinates for image copy");const g=n.data,y=t.data;if(g===y)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<c.height;b++){const T=((i.y+b)*n.width+i.x)*f,C=((a.y+b)*t.width+a.x)*f;for(let k=0;k<c.width*f;k++)y[C+k]=g[T+k]}return t}class vu{constructor(t,i){hh(this,t,1,i)}resize(t){Jh(this,t,1)}clone(){return new vu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,c,f){dh(t,i,a,c,f,1)}}class Fi{constructor(t,i){hh(this,t,4,i)}resize(t){Jh(this,t,4)}replace(t,i){i?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Fi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,i,a,c,f){dh(t,i,a,c,f,4)}}function ed(n){const t={},i=n.resolution||256,a=n.clips?n.clips.length:1,c=n.image||new Fi({width:i,height:a});if(Math.log(i)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${i}`);const f=(g,y,b)=>{t[n.evaluationKey]=b;const T=n.expression.evaluate(t);c.data[g+y+0]=Math.floor(255*T.r/T.a),c.data[g+y+1]=Math.floor(255*T.g/T.a),c.data[g+y+2]=Math.floor(255*T.b/T.a),c.data[g+y+3]=Math.floor(255*T.a)};if(n.clips)for(let g=0,y=0;g<a;++g,y+=4*i)for(let b=0,T=0;b<i;b++,T+=4){const C=b/(i-1),{start:k,end:F}=n.clips[g];f(y,T,k*(1-C)+F*C)}else for(let g=0,y=0;g<i;g++,y+=4)f(0,y,g/(i-1));return c}ft("AlphaImage",vu),ft("RGBAImage",Fi);const wc="big-fb";class Vd extends si{createBucket(t){return new Oi(t)}constructor(t){super(t,Nd),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ed({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(wc)&&this.heatmapFbos.delete(wc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let td;var rd={get paint(){return td=td||new Ln({"hillshade-illumination-direction":new zt(R.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(R.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(R.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(R.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(R.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(R.paint_hillshade["hillshade-accent-color"])})}};class nd extends si{constructor(t){super(t,rd)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const $d=Kr([{name:"a_pos",components:2,type:"Int16"}],4),{members:id}=$d;function xu(n,t,i){const a=i.patternDependencies;let c=!1;for(const f of t){const g=f.paint.get(`${n}-pattern`);g.isConstant()||(c=!0);const y=g.constantOr(null);y&&(c=!0,a[y.to]=!0,a[y.from]=!0)}return c}function od(n,t,i,a,c){const f=c.patternDependencies;for(const g of t){const y=g.paint.get(`${n}-pattern`).value;if(y.kind!=="constant"){let b=y.evaluate({zoom:a-1},i,{},c.availableImages),T=y.evaluate({zoom:a},i,{},c.availableImages),C=y.evaluate({zoom:a+1},i,{},c.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,C=C&&C.name?C.name:C,f[b]=!0,f[T]=!0,f[C]=!0,i.patterns[g.id]={min:b,mid:T,max:C}}}return i}function ad(n,t,i,a,c){let f;if(c===function(g,y,b,T){let C=0;for(let k=y,F=b-T;k<b;k+=T)C+=(g[F]-g[k])*(g[k+1]+g[F+1]),F=k;return C}(n,t,i,a)>0)for(let g=t;g<i;g+=a)f=Pu(g/a|0,n[g],n[g+1],f);else for(let g=i-a;g>=t;g-=a)f=Pu(g/a|0,n[g],n[g+1],f);return f&&wu(f,f.next)&&(Ls(f),f=f.next),f}function Ja(n,t){if(!n)return n;t||(t=n);let i,a=n;do if(i=!1,a.steiner||!wu(a,a.next)&&vr(a.prev,a,a.next)!==0)a=a.next;else{if(Ls(a),a=t=a.prev,a===a.next)break;i=!0}while(i||a!==t);return t}function bu(n,t,i,a,c,f,g){if(!n)return;!g&&f&&function(b,T,C,k){let F=b;do F.z===0&&(F.z=_l(F.x,F.y,T,C,k)),F.prevZ=F.prev,F.nextZ=F.next,F=F.next;while(F!==b);F.prevZ.nextZ=null,F.prevZ=null,function(j){let N,Z=1;do{let K,te=j;j=null;let fe=null;for(N=0;te;){N++;let ie=te,B=0;for(let ae=0;ae<Z&&(B++,ie=ie.nextZ,ie);ae++);let H=Z;for(;B>0||H>0&&ie;)B!==0&&(H===0||!ie||te.z<=ie.z)?(K=te,te=te.nextZ,B--):(K=ie,ie=ie.nextZ,H--),fe?fe.nextZ=K:j=K,K.prevZ=fe,fe=K;te=ie}fe.nextZ=null,Z*=2}while(N>1)}(F)}(n,a,c,f);let y=n;for(;n.prev!==n.next;){const b=n.prev,T=n.next;if(f?es(n,a,c,f):ph(n))t.push(b.i,n.i,T.i),Ls(n),n=T.next,y=T.next;else if((n=T)===y){g?g===1?bu(n=Dp(Ja(n),t),t,i,a,c,f,2):g===2&&Ud(n,t,i,a,c,f):bu(Ja(n),t,i,a,c,f,1);break}}}function ph(n){const t=n.prev,i=n,a=n.next;if(vr(t,i,a)>=0)return!1;const c=t.x,f=i.x,g=a.x,y=t.y,b=i.y,T=a.y,C=Math.min(c,f,g),k=Math.min(y,b,T),F=Math.max(c,f,g),j=Math.max(y,b,T);let N=a.next;for(;N!==t;){if(N.x>=C&&N.x<=F&&N.y>=k&&N.y<=j&&Tc(c,y,f,b,g,T,N.x,N.y)&&vr(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function es(n,t,i,a){const c=n.prev,f=n,g=n.next;if(vr(c,f,g)>=0)return!1;const y=c.x,b=f.x,T=g.x,C=c.y,k=f.y,F=g.y,j=Math.min(y,b,T),N=Math.min(C,k,F),Z=Math.max(y,b,T),K=Math.max(C,k,F),te=_l(j,N,t,i,a),fe=_l(Z,K,t,i,a);let ie=n.prevZ,B=n.nextZ;for(;ie&&ie.z>=te&&B&&B.z<=fe;){if(ie.x>=j&&ie.x<=Z&&ie.y>=N&&ie.y<=K&&ie!==c&&ie!==g&&Tc(y,C,b,k,T,F,ie.x,ie.y)&&vr(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,B.x>=j&&B.x<=Z&&B.y>=N&&B.y<=K&&B!==c&&B!==g&&Tc(y,C,b,k,T,F,B.x,B.y)&&vr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;ie&&ie.z>=te;){if(ie.x>=j&&ie.x<=Z&&ie.y>=N&&ie.y<=K&&ie!==c&&ie!==g&&Tc(y,C,b,k,T,F,ie.x,ie.y)&&vr(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;B&&B.z<=fe;){if(B.x>=j&&B.x<=Z&&B.y>=N&&B.y<=K&&B!==c&&B!==g&&Tc(y,C,b,k,T,F,B.x,B.y)&&vr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function Dp(n,t){let i=n;do{const a=i.prev,c=i.next.next;!wu(a,c)&&Dt(a,i,i.next,c)&&Su(a,c)&&Su(c,a)&&(t.push(a.i,i.i,c.i),Ls(i),Ls(i.next),i=n=c),i=i.next}while(i!==n);return Ja(i)}function Ud(n,t,i,a,c,f){let g=n;do{let y=g.next.next;for(;y!==g.prev;){if(g.i!==y.i&&fh(g,y)){let b=Wd(g,y);return g=Ja(g,g.next),b=Ja(b,b.next),bu(g,t,i,a,c,f,0),void bu(b,t,i,a,c,f,0)}y=y.next}g=g.next}while(g!==n)}function sd(n,t){let i=n.x-t.x;return i===0&&(i=n.y-t.y,i===0)&&(i=(n.next.y-n.y)/(n.next.x-n.x)-(t.next.y-t.y)/(t.next.x-t.x)),i}function Zd(n,t){const i=function(c,f){let g=f;const y=c.x,b=c.y;let T,C=-1/0;if(wu(c,g))return g;do{if(wu(c,g.next))return g.next;if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){const Z=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(Z<=y&&Z>C&&(C=Z,T=g.x<g.next.x?g:g.next,Z===y))return T}g=g.next}while(g!==f);if(!T)return null;const k=T,F=T.x,j=T.y;let N=1/0;g=T;do{if(y>=g.x&&g.x>=F&&y!==g.x&&qd(b<j?y:C,b,F,j,b<j?C:y,b,g.x,g.y)){const Z=Math.abs(b-g.y)/(y-g.x);Su(g,c)&&(Z<N||Z===N&&(g.x>T.x||g.x===T.x&&Gd(T,g)))&&(T=g,N=Z)}g=g.next}while(g!==k);return T}(n,t);if(!i)return t;const a=Wd(i,n);return Ja(a,a.next),Ja(i,i.next)}function Gd(n,t){return vr(n.prev,n,t.prev)<0&&vr(t.next,n,n.next)<0}function _l(n,t,i,a,c){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-i)*c|0)|n<<8))|n<<4))|n<<2))|n<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-a)*c|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ei(n){let t=n,i=n;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==n);return i}function qd(n,t,i,a,c,f,g,y){return(c-g)*(t-y)>=(n-g)*(f-y)&&(n-g)*(a-y)>=(i-g)*(t-y)&&(i-g)*(f-y)>=(c-g)*(a-y)}function Tc(n,t,i,a,c,f,g,y){return!(n===g&&t===y)&&qd(n,t,i,a,c,f,g,y)}function fh(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!function(i,a){let c=i;do{if(c.i!==i.i&&c.next.i!==i.i&&c.i!==a.i&&c.next.i!==a.i&&Dt(c,c.next,i,a))return!0;c=c.next}while(c!==i);return!1}(n,t)&&(Su(n,t)&&Su(t,n)&&function(i,a){let c=i,f=!1;const g=(i.x+a.x)/2,y=(i.y+a.y)/2;do c.y>y!=c.next.y>y&&c.next.y!==c.y&&g<(c.next.x-c.x)*(y-c.y)/(c.next.y-c.y)+c.x&&(f=!f),c=c.next;while(c!==i);return f}(n,t)&&(vr(n.prev,n,t.prev)||vr(n,t.prev,t))||wu(n,t)&&vr(n.prev,n,n.next)>0&&vr(t.prev,t,t.next)>0)}function vr(n,t,i){return(t.y-n.y)*(i.x-t.x)-(t.x-n.x)*(i.y-t.y)}function wu(n,t){return n.x===t.x&&n.y===t.y}function Dt(n,t,i,a){const c=Tu(vr(n,t,i)),f=Tu(vr(n,t,a)),g=Tu(vr(i,a,n)),y=Tu(vr(i,a,t));return c!==f&&g!==y||!(c!==0||!ts(n,i,t))||!(f!==0||!ts(n,a,t))||!(g!==0||!ts(i,n,a))||!(y!==0||!ts(i,t,a))}function ts(n,t,i){return t.x<=Math.max(n.x,i.x)&&t.x>=Math.min(n.x,i.x)&&t.y<=Math.max(n.y,i.y)&&t.y>=Math.min(n.y,i.y)}function Tu(n){return n>0?1:n<0?-1:0}function Su(n,t){return vr(n.prev,n,n.next)<0?vr(n,t,n.next)>=0&&vr(n,n.prev,t)>=0:vr(n,t,n.prev)<0||vr(n,n.next,t)<0}function Wd(n,t){const i=Sc(n.i,n.x,n.y),a=Sc(t.i,t.x,t.y),c=n.next,f=t.prev;return n.next=t,t.prev=n,i.next=c,c.prev=i,a.next=i,i.prev=a,f.next=a,a.prev=f,a}function Pu(n,t,i,a){const c=Sc(n,t,i);return a?(c.next=a.next,c.prev=a,a.next.prev=c,a.next=c):(c.prev=c,c.next=c),c}function Ls(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Sc(n,t,i){return{i:n,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class yl{constructor(t,i){if(i>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=i}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Pc{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Pc.noSubdivision=new Pc({fill:new yl(0,0),line:new yl(0,0),tile:new yl(0,0),stencil:new yl(0,0),circle:1}),ft("SubdivisionGranularityExpression",yl),ft("SubdivisionGranularitySetting",Pc);const vl=-32768,xl=32767;class ld{constructor(t,i){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=bt/t,this._canonical=i}_getKey(t,i){return(t+=32768)<<16|(i+=32768)<<0}_vertexToIndex(t,i){if(t<-32768||i<-32768||t>32767||i>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const a=0|Math.round(t),c=0|Math.round(i),f=this._getKey(a,c);if(this._vertexDictionary.has(f))return this._vertexDictionary.get(f);const g=this._vertexBuffer.length/2;return this._vertexDictionary.set(f,g),this._vertexBuffer.push(a,c),g}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(c,f){const g=[];for(let y=0;y<f.length;y+=3){const b=f[y],T=f[y+1],C=f[y+2],k=c[2*b],F=c[2*b+1];(c[2*T]-k)*(c[2*C+1]-F)-(c[2*T+1]-F)*(c[2*C]-k)>0?(g.push(b),g.push(C),g.push(T)):(g.push(b),g.push(T),g.push(C))}return g}(this._vertexBuffer,t);const i=[],a=t.length;for(let c=0;c<a;c+=3){const f=[t[c+0],t[c+1],t[c+2]],g=[this._vertexBuffer[2*t[c+0]+0],this._vertexBuffer[2*t[c+0]+1],this._vertexBuffer[2*t[c+1]+0],this._vertexBuffer[2*t[c+1]+1],this._vertexBuffer[2*t[c+2]+0],this._vertexBuffer[2*t[c+2]+1]];let y=1/0,b=1/0,T=-1/0,C=-1/0;for(let Z=0;Z<3;Z++){const K=g[2*Z],te=g[2*Z+1];y=Math.min(y,K),T=Math.max(T,K),b=Math.min(b,te),C=Math.max(C,te)}if(y===T||b===C)continue;const k=Math.floor(y/this._granularityCellSize),F=Math.ceil(T/this._granularityCellSize),j=Math.floor(b/this._granularityCellSize),N=Math.ceil(C/this._granularityCellSize);if(k!==F||j!==N)for(let Z=j;Z<N;Z++){const K=this._scanlineGenerateVertexRingForCellRow(Z,g,f);Os(this._vertexBuffer,K,i)}else i.push(...f)}return i}_scanlineGenerateVertexRingForCellRow(t,i,a){const c=t*this._granularityCellSize,f=c+this._granularityCellSize,g=[];for(let y=0;y<3;y++){const b=i[2*y],T=i[2*y+1],C=i[2*(y+1)%6],k=i[(2*(y+1)+1)%6],F=i[2*(y+2)%6],j=i[(2*(y+2)+1)%6],N=C-b,Z=k-T,K=N===0,te=Z===0,fe=(c-T)/Z,ie=(f-T)/Z,B=Math.min(fe,ie),H=Math.max(fe,ie);if(!te&&(B>=1||H<=0)||te&&(T<c||T>f)){k>=c&&k<=f&&g.push(a[(y+1)%3]);continue}!te&&B>0&&g.push(this._vertexToIndex(b+N*B,T+Z*B));const ae=b+N*Math.max(B,0),Ce=b+N*Math.min(H,1);K||this._generateIntraEdgeVertices(g,b,T,C,k,ae,Ce),!te&&H<1&&g.push(this._vertexToIndex(b+N*H,T+Z*H)),(te||k>=c&&k<=f)&&g.push(a[(y+1)%3]),!te&&(k<=c||k>=f)&&this._generateInterEdgeVertices(g,b,T,C,k,F,j,Ce,c,f)}return g}_generateIntraEdgeVertices(t,i,a,c,f,g,y){const b=c-i,T=f-a,C=T===0,k=C?Math.min(i,c):Math.min(g,y),F=C?Math.max(i,c):Math.max(g,y),j=Math.floor(k/this._granularityCellSize)+1,N=Math.ceil(F/this._granularityCellSize)-1;if(C?i<c:g<y)for(let Z=j;Z<=N;Z++){const K=Z*this._granularityCellSize;t.push(this._vertexToIndex(K,a+T*(K-i)/b))}else for(let Z=N;Z>=j;Z--){const K=Z*this._granularityCellSize;t.push(this._vertexToIndex(K,a+T*(K-i)/b))}}_generateInterEdgeVertices(t,i,a,c,f,g,y,b,T,C){const k=f-a,F=g-c,j=y-f,N=(T-f)/j,Z=(C-f)/j,K=Math.min(N,Z),te=Math.max(N,Z),fe=c+F*K;let ie=Math.floor(Math.min(fe,b)/this._granularityCellSize)+1,B=Math.ceil(Math.max(fe,b)/this._granularityCellSize)-1,H=b<fe;const ae=j===0;if(ae&&(y===T||y===C))return;if(ae||K>=1||te<=0){const Ke=a-y,ke=g+(i-g)*Math.min((T-y)/Ke,(C-y)/Ke);ie=Math.floor(Math.min(ke,b)/this._granularityCellSize)+1,B=Math.ceil(Math.max(ke,b)/this._granularityCellSize)-1,H=b<ke}const Ce=k>0?C:T;if(H)for(let Ke=ie;Ke<=B;Ke++)t.push(this._vertexToIndex(Ke*this._granularityCellSize,Ce));else for(let Ke=B;Ke>=ie;Ke--)t.push(this._vertexToIndex(Ke*this._granularityCellSize,Ce))}_generateOutline(t){const i=[];for(const a of t){const c=li(a,this._granularity,!0),f=this._pointArrayToIndices(c),g=[];for(let y=1;y<f.length;y++)g.push(f[y-1]),g.push(f[y]);i.push(g)}return i}_handlePoles(t){let i=!1,a=!1;this._canonical&&(this._canonical.y===0&&(i=!0),this._canonical.y===(1<<this._canonical.z)-1&&(a=!0)),(i||a)&&this._fillPoles(t,i,a)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let i=0;i<t.length;i+=2){const a=t[i+1];a===vl&&(t[i+1]=-32767),a===xl&&(t[i+1]=32766)}}_generatePoleQuad(t,i,a,c,f,g){c>f!=(g===vl)?(t.push(i),t.push(a),t.push(this._vertexToIndex(c,g)),t.push(a),t.push(this._vertexToIndex(f,g)),t.push(this._vertexToIndex(c,g))):(t.push(a),t.push(i),t.push(this._vertexToIndex(c,g)),t.push(this._vertexToIndex(f,g)),t.push(a),t.push(this._vertexToIndex(c,g)))}_fillPoles(t,i,a){const c=this._vertexBuffer,f=bt,g=t.length;for(let y=2;y<g;y+=3){const b=t[y-2],T=t[y-1],C=t[y],k=c[2*b],F=c[2*b+1],j=c[2*T],N=c[2*T+1],Z=c[2*C],K=c[2*C+1];i&&(F===0&&N===0&&this._generatePoleQuad(t,b,T,k,j,vl),N===0&&K===0&&this._generatePoleQuad(t,T,C,j,Z,vl),K===0&&F===0&&this._generatePoleQuad(t,C,b,Z,k,vl)),a&&(F===f&&N===f&&this._generatePoleQuad(t,b,T,k,j,xl),N===f&&K===f&&this._generatePoleQuad(t,T,C,j,Z,xl),K===f&&F===f&&this._generatePoleQuad(t,C,b,Z,k,xl))}}_initializeVertices(t){for(let i=0;i<t.length;i+=2)this._vertexToIndex(t[i],t[i+1])}subdividePolygonInternal(t,i){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:a,holeIndices:c}=function(y){const b=[],T=[];for(const C of y)if(C.length!==0){C!==y[0]&&b.push(T.length/2);for(let k=0;k<C.length;k++)T.push(C[k].x),T.push(C[k].y)}return{flattened:T,holeIndices:b}}(t);let f;this._initializeVertices(a);try{const y=function(T,C,k=2){const F=C&&C.length,j=F?C[0]*k:T.length;let N=ad(T,0,j,k,!0);const Z=[];if(!N||N.next===N.prev)return Z;let K,te,fe;if(F&&(N=function(ie,B,H,ae){const Ce=[];for(let Ke=0,ke=B.length;Ke<ke;Ke++){const Be=ad(ie,B[Ke]*ae,Ke<ke-1?B[Ke+1]*ae:ie.length,ae,!1);Be===Be.next&&(Be.steiner=!0),Ce.push(Ei(Be))}Ce.sort(sd);for(let Ke=0;Ke<Ce.length;Ke++)H=Zd(Ce[Ke],H);return H}(T,C,N,k)),T.length>80*k){K=1/0,te=1/0;let ie=-1/0,B=-1/0;for(let H=k;H<j;H+=k){const ae=T[H],Ce=T[H+1];ae<K&&(K=ae),Ce<te&&(te=Ce),ae>ie&&(ie=ae),Ce>B&&(B=Ce)}fe=Math.max(ie-K,B-te),fe=fe!==0?32767/fe:0}return bu(N,Z,k,K,te,fe,0),Z}(a,c),b=this._convertIndices(a,y);f=this._subdivideTrianglesScanline(b)}catch(y){console.error(y)}let g=[];return i&&(g=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(f),{verticesFlattened:this._vertexBuffer,indicesTriangles:f,indicesLineList:g}}_convertIndices(t,i){const a=[];for(let c=0;c<i.length;c++)a.push(this._vertexToIndex(t[2*i[c]],t[2*i[c]+1]));return a}_pointArrayToIndices(t){const i=[];for(let a=0;a<t.length;a++){const c=t[a];i.push(this._vertexToIndex(c.x,c.y))}return i}}function Xn(n,t,i,a=!0){return new ld(i,t).subdividePolygonInternal(n,a)}function li(n,t,i=!1){if(!n||n.length<1)return[];if(n.length<2)return[];const a=n[0],c=n[n.length-1],f=i&&(a.x!==c.x||a.y!==c.y);if(t<2)return f?[...n,n[0]]:[...n];const g=Math.floor(bt/t),y=[];y.push(new Ge(n[0].x,n[0].y));const b=n.length,T=f?b:b-1;for(let C=0;C<T;C++){const k=n[C],F=C<b-1?n[C+1]:n[0],j=k.x,N=k.y,Z=F.x,K=F.y,te=j!==Z,fe=N!==K;if(!te&&!fe)continue;const ie=Z-j,B=K-N,H=Math.abs(ie),ae=Math.abs(B);let Ce=j,Ke=N;for(;;){const Be=ie>0?(Math.floor(Ce/g)+1)*g:(Math.ceil(Ce/g)-1)*g,tt=B>0?(Math.floor(Ke/g)+1)*g:(Math.ceil(Ke/g)-1)*g,Ye=Math.abs(Ce-Be),at=Math.abs(Ke-tt),Ue=Math.abs(Ce-Z),wt=Math.abs(Ke-K),Gt=te?Ye/H:Number.POSITIVE_INFINITY,Zt=fe?at/ae:Number.POSITIVE_INFINITY;if((Ue<=Ye||!te)&&(wt<=at||!fe))break;if(Gt<Zt&&te||!fe){Ce=Be,Ke+=B*Gt;const At=new Ge(Ce,Math.round(Ke));y[y.length-1].x===At.x&&y[y.length-1].y===At.y||y.push(At)}else{Ce+=ie*Zt,Ke=tt;const At=new Ge(Math.round(Ce),Ke);y[y.length-1].x===At.x&&y[y.length-1].y===At.y||y.push(At)}}const ke=new Ge(Z,K);y[y.length-1].x===ke.x&&y[y.length-1].y===ke.y||y.push(ke)}return y}function Os(n,t,i){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let a=0,c=n[2*t[0]];for(let b=1;b<t.length;b++){const T=n[2*t[b]];T<c&&(c=T,a=b)}const f=t.length;let g=a,y=(g+1)%f;for(;;){const b=g-1>=0?g-1:f-1,T=(y+1)%f,C=n[2*t[b]],k=n[2*t[T]],F=n[2*t[g]],j=n[2*t[g]+1],N=n[2*t[y]+1];let Z=!1;if(C<k)Z=!0;else if(C>k)Z=!1;else{const K=N-j,te=-(n[2*t[y]]-F),fe=j<N?1:-1;((C-F)*K+(n[2*t[b]+1]-j)*te)*fe>((k-F)*K+(n[2*t[T]+1]-j)*te)*fe&&(Z=!0)}if(Z){const K=t[b],te=t[g],fe=t[y];K!==te&&K!==fe&&te!==fe&&i.push(fe,te,K),g--,g<0&&(g=f-1)}else{const K=t[T],te=t[g],fe=t[y];K!==te&&K!==fe&&te!==fe&&i.push(fe,te,K),y++,y>=f&&(y=0)}if(b===T)break}}function ud(n,t,i,a,c,f,g,y,b){const T=c.length/2,C=g&&y&&b;if(T<Rt.MAX_VERTEX_ARRAY_LENGTH){const k=t.prepareSegment(T,i,a),F=k.vertexLength;for(let Z=0;Z<f.length;Z+=3)a.emplaceBack(F+f[Z],F+f[Z+1],F+f[Z+2]);let j,N;k.vertexLength+=T,k.primitiveLength+=f.length/3,C&&(N=g.prepareSegment(T,i,y),j=N.vertexLength,N.vertexLength+=T);for(let Z=0;Z<c.length;Z+=2)n(c[Z],c[Z+1]);if(C)for(let Z=0;Z<b.length;Z++){const K=b[Z];for(let te=1;te<K.length;te+=2)y.emplaceBack(j+K[te-1],j+K[te]);N.primitiveLength+=K.length/2}}else(function(k,F,j,N,Z,K){const te=[];for(let ae=0;ae<N.length/2;ae++)te.push(-1);const fe={count:0};let ie=0,B=k.getOrCreateLatestSegment(F,j),H=B.vertexLength;for(let ae=2;ae<Z.length;ae+=3){const Ce=Z[ae-2],Ke=Z[ae-1],ke=Z[ae];let Be=te[Ce]<ie,tt=te[Ke]<ie,Ye=te[ke]<ie;B.vertexLength+((Be?1:0)+(tt?1:0)+(Ye?1:0))>Rt.MAX_VERTEX_ARRAY_LENGTH&&(B=k.createNewSegment(F,j),ie=fe.count,Be=!0,tt=!0,Ye=!0,H=0);const at=Cu(te,N,K,fe,Ce,Be,B),Ue=Cu(te,N,K,fe,Ke,tt,B),wt=Cu(te,N,K,fe,ke,Ye,B);j.emplaceBack(H+at-ie,H+Ue-ie,H+wt-ie),B.primitiveLength++}})(t,i,a,c,f,n),C&&function(k,F,j,N,Z,K){const te=[];for(let ae=0;ae<N.length/2;ae++)te.push(-1);const fe={count:0};let ie=0,B=k.getOrCreateLatestSegment(F,j),H=B.vertexLength;for(let ae=0;ae<Z.length;ae++){const Ce=Z[ae];for(let Ke=1;Ke<Z[ae].length;Ke+=2){const ke=Ce[Ke-1],Be=Ce[Ke];let tt=te[ke]<ie,Ye=te[Be]<ie;B.vertexLength+((tt?1:0)+(Ye?1:0))>Rt.MAX_VERTEX_ARRAY_LENGTH&&(B=k.createNewSegment(F,j),ie=fe.count,tt=!0,Ye=!0,H=0);const at=Cu(te,N,K,fe,ke,tt,B),Ue=Cu(te,N,K,fe,Be,Ye,B);j.emplaceBack(H+at-ie,H+Ue-ie),B.primitiveLength++}}}(g,i,y,c,b,n),t.forceNewSegmentOnNextPrepare(),g==null||g.forceNewSegmentOnNextPrepare()}function Cu(n,t,i,a,c,f,g){if(f){const y=a.count;return i(t[2*c],t[2*c+1]),n[c]=a.count,a.count++,g.vertexLength++,y}return n[c]}class yo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new le,this.indexArray=new lt,this.indexArray2=new Qe,this.programConfigurations=new Ia(t.layers,t.zoom),this.segments=new Rt,this.segments2=new Rt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=xu("fill",this.layers,i);const c=this.layers[0].layout.get("fill-sort-key"),f=!c.isConstant(),g=[];for(const{feature:y,id:b,index:T,sourceLayerIndex:C}of t){const k=this.layers[0]._featureFilter.needGeometry,F=Si(y,k);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),F,a))continue;const j=f?c.evaluate(F,{},a,i.availableImages):void 0,N={id:b,properties:y.properties,type:y.type,sourceLayerIndex:C,index:T,geometry:k?F.geometry:Ma(y),patterns:{},sortKey:j};g.push(N)}f&&g.sort((y,b)=>y.sortKey-b.sortKey);for(const y of g){const{geometry:b,index:T,sourceLayerIndex:C}=y;if(this.hasPattern){const k=od("fill",this.layers,y,this.zoom,i);this.patternFeatures.push(k)}else this.addFeature(y,b,T,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[T].feature,b,T,C,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const c of this.patternFeatures)this.addFeature(c,c.geometry,c.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,id),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,i,a,c,f,g){for(const y of xs(i,500)){const b=Xn(y,c,g.fill.getGranularityForZoomLevel(c.z)),T=this.layoutVertexArray;ud((C,k)=>{T.emplaceBack(C,k)},this.segments,this.layoutVertexArray,this.indexArray,b.verticesFlattened,b.indicesTriangles,this.segments2,this.indexArray2,b.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,f,c)}}let cd,Ko;ft("FillBucket",yo,{omit:["layers","patternFeatures"]});var Lp={get paint(){return Ko=Ko||new Ln({"fill-antialias":new zt(R.paint_fill["fill-antialias"]),"fill-opacity":new $t(R.paint_fill["fill-opacity"]),"fill-color":new $t(R.paint_fill["fill-color"]),"fill-outline-color":new $t(R.paint_fill["fill-outline-color"]),"fill-translate":new zt(R.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(R.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xa(R.paint_fill["fill-pattern"])})},get layout(){return cd=cd||new Ln({"fill-sort-key":new $t(R.layout_fill["fill-sort-key"])})}};class Hd extends si{constructor(t){super(t,Lp)}recalculate(t,i){super.recalculate(t,i);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new yo(t)}queryRadius(){return ch(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:i,transform:a,pixelsToTileUnits:c}){return Pi(bc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-a.bearingInRadians,c),i)}isTileClipped(){return!0}}const Xd=Kr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Kd=Kr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Yd}=Xd;var hd,Cc,Ec,vo,Cr,On,xn,Mn={};function no(){if(Cc)return hd;Cc=1;var n=Ve();function t(c,f,g,y,b){this.properties={},this.extent=g,this.type=0,this._pbf=c,this._geometry=-1,this._keys=y,this._values=b,c.readFields(i,this,f)}function i(c,f,g){c==1?f.id=g.readVarint():c==2?function(y,b){for(var T=y.readVarint()+y.pos;y.pos<T;){var C=b._keys[y.readVarint()],k=b._values[y.readVarint()];b.properties[C]=k}}(g,f):c==3?f.type=g.readVarint():c==4&&(f._geometry=g.pos)}function a(c){for(var f,g,y=0,b=0,T=c.length,C=T-1;b<T;C=b++)y+=((g=c[C]).x-(f=c[b]).x)*(f.y+g.y);return y}return hd=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var f,g=c.readVarint()+c.pos,y=1,b=0,T=0,C=0,k=[];c.pos<g;){if(b<=0){var F=c.readVarint();y=7&F,b=F>>3}if(b--,y===1||y===2)T+=c.readSVarint(),C+=c.readSVarint(),y===1&&(f&&k.push(f),f=[]),f.push(new n(T,C));else{if(y!==7)throw new Error("unknown command "+y);f&&f.push(f[0].clone())}}return f&&k.push(f),k},t.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var f=c.readVarint()+c.pos,g=1,y=0,b=0,T=0,C=1/0,k=-1/0,F=1/0,j=-1/0;c.pos<f;){if(y<=0){var N=c.readVarint();g=7&N,y=N>>3}if(y--,g===1||g===2)(b+=c.readSVarint())<C&&(C=b),b>k&&(k=b),(T+=c.readSVarint())<F&&(F=T),T>j&&(j=T);else if(g!==7)throw new Error("unknown command "+g)}return[C,F,k,j]},t.prototype.toGeoJSON=function(c,f,g){var y,b,T=this.extent*Math.pow(2,g),C=this.extent*c,k=this.extent*f,F=this.loadGeometry(),j=t.types[this.type];function N(te){for(var fe=0;fe<te.length;fe++){var ie=te[fe];te[fe]=[360*(ie.x+C)/T-180,360/Math.PI*Math.atan(Math.exp((180-360*(ie.y+k)/T)*Math.PI/180))-90]}}switch(this.type){case 1:var Z=[];for(y=0;y<F.length;y++)Z[y]=F[y][0];N(F=Z);break;case 2:for(y=0;y<F.length;y++)N(F[y]);break;case 3:for(F=function(te){var fe=te.length;if(fe<=1)return[te];for(var ie,B,H=[],ae=0;ae<fe;ae++){var Ce=a(te[ae]);Ce!==0&&(B===void 0&&(B=Ce<0),B===Ce<0?(ie&&H.push(ie),ie=[te[ae]]):ie.push(te[ae]))}return ie&&H.push(ie),H}(F),y=0;y<F.length;y++)for(b=0;b<F[y].length;b++)N(F[y][b])}F.length===1?F=F[0]:j="Multi"+j;var K={type:"Feature",geometry:{type:j,coordinates:F},properties:this.properties};return"id"in this&&(K.id=this.id),K},hd}function bl(){if(vo)return Ec;vo=1;var n=no();function t(a,c){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(i,this,c),this.length=this._features.length}function i(a,c,f){a===15?c.version=f.readVarint():a===1?c.name=f.readString():a===5?c.extent=f.readVarint():a===2?c._features.push(f.pos):a===3?c._keys.push(f.readString()):a===4&&c._values.push(function(g){for(var y=null,b=g.readVarint()+g.pos;g.pos<b;){var T=g.readVarint()>>3;y=T===1?g.readString():T===2?g.readFloat():T===3?g.readDouble():T===4?g.readVarint64():T===5?g.readVarint():T===6?g.readSVarint():T===7?g.readBoolean():null}return y}(f))}return Ec=t,t.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var c=this._pbf.readVarint()+this._pbf.pos;return new n(this._pbf,c,this.extent,this._keys,this._values)},Ec}function kn(){return xn||(xn=1,Mn.VectorTile=function(){if(On)return Cr;On=1;var n=bl();function t(i,a,c){if(i===3){var f=new n(c,c.readVarint()+c.pos);f.length&&(a[f.name]=f)}}return Cr=function(i,a){this.layers=i.readFields(t,{},a)},Cr}(),Mn.VectorTileFeature=no(),Mn.VectorTileLayer=bl()),Mn}var rs=Me(kn());const wl=rs.VectorTileFeature.types,Eu=Math.pow(2,13);function Tl(n,t,i,a,c,f,g,y){n.emplaceBack(t,i,2*Math.floor(a*Eu)+g,c*Eu*2,f*Eu*2,Math.round(y))}class Sl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ue,this.centroidVertexArray=new J,this.indexArray=new lt,this.programConfigurations=new Ia(t.layers,t.zoom),this.segments=new Rt,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.features=[],this.hasPattern=xu("fill-extrusion",this.layers,i);for(const{feature:c,id:f,index:g,sourceLayerIndex:y}of t){const b=this.layers[0]._featureFilter.needGeometry,T=Si(c,b);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),T,a))continue;const C={id:f,sourceLayerIndex:y,index:g,geometry:b?T.geometry:Ma(c),properties:c.properties,type:c.type,patterns:{}};this.hasPattern?this.features.push(od("fill-extrusion",this.layers,C,this.zoom,i)):this.addFeature(C,C.geometry,g,a,{},i.subdivisionGranularity),i.featureIndex.insert(c,C.geometry,g,y,this.index,!0)}}addFeatures(t,i,a){for(const c of this.features){const{geometry:f}=c;this.addFeature(c,f,c.index,i,a,t.subdivisionGranularity)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Yd),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Kd.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,i,a,c,f,g){for(const y of xs(i,500)){const b={x:0,y:0,sampleCount:0},T=this.layoutVertexArray.length;this.processPolygon(b,c,t,y,g);const C=this.layoutVertexArray.length-T,k=Math.floor(b.x/b.sampleCount),F=Math.floor(b.y/b.sampleCount);for(let j=0;j<C;j++)this.centroidVertexArray.emplaceBack(k,F)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,f,c)}processPolygon(t,i,a,c,f){if(c.length<1||Pl(c[0]))return;for(const k of c)k.length!==0&&io(t,k);const g={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},y=f.fill.getGranularityForZoomLevel(i.z),b=wl[a.type]==="Polygon";for(const k of c){if(k.length===0||Pl(k))continue;const F=li(k,y,b);this._generateSideFaces(F,g)}if(!b)return;const T=Xn(c,i,y,!1),C=this.layoutVertexArray;ud((k,F)=>{Tl(C,k,F,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles)}_generateSideFaces(t,i){let a=0;for(let c=1;c<t.length;c++){const f=t[c],g=t[c-1];if(dd(f,g))continue;i.segment.vertexLength+4>Rt.MAX_VERTEX_ARRAY_LENGTH&&(i.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const y=f.sub(g)._perp()._unit(),b=g.dist(f);a+b>32768&&(a=0),Tl(this.layoutVertexArray,f.x,f.y,y.x,y.y,0,0,a),Tl(this.layoutVertexArray,f.x,f.y,y.x,y.y,0,1,a),a+=b,Tl(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,0,a),Tl(this.layoutVertexArray,g.x,g.y,y.x,y.y,0,1,a);const T=i.segment.vertexLength;this.indexArray.emplaceBack(T,T+2,T+1),this.indexArray.emplaceBack(T+1,T+2,T+3),i.segment.vertexLength+=4,i.segment.primitiveLength+=2}}}function io(n,t){for(let i=0;i<t.length;i++){const a=t[i];i===t.length-1&&t[0].x===a.x&&t[0].y===a.y||(n.x+=a.x,n.y+=a.y,n.sampleCount++)}}function dd(n,t){return n.x===t.x&&(n.x<0||n.x>bt)||n.y===t.y&&(n.y<0||n.y>bt)}function Pl(n){return n.every(t=>t.x<0)||n.every(t=>t.x>bt)||n.every(t=>t.y<0)||n.every(t=>t.y>bt)}let ka;ft("FillExtrusionBucket",Sl,{omit:["layers","features"]});var mh={get paint(){return ka=ka||new Ln({"fill-extrusion-opacity":new zt(R["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $t(R["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(R["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(R["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xa(R["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new $t(R["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $t(R["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new zt(R["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class pd extends si{constructor(t){super(t,mh)}createBucket(t){return new Sl(t)}queryRadius(){return ch(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:c,transform:f,pixelsToTileUnits:g,pixelPosMatrix:y}){const b=bc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-f.bearingInRadians,g),T=this.paint.get("fill-extrusion-height").evaluate(i,a),C=this.paint.get("fill-extrusion-base").evaluate(i,a),k=function(j,N,Z){const K=[];for(const te of j){const fe=[te.x,te.y,0,1];Er(fe,fe,N),K.push(new Ge(fe[0]/fe[3],fe[1]/fe[3]))}return K}(b,y),F=function(j,N,Z,K){const te=[],fe=[],ie=K[8]*N,B=K[9]*N,H=K[10]*N,ae=K[11]*N,Ce=K[8]*Z,Ke=K[9]*Z,ke=K[10]*Z,Be=K[11]*Z;for(const tt of j){const Ye=[],at=[];for(const Ue of tt){const wt=Ue.x,Gt=Ue.y,Zt=K[0]*wt+K[4]*Gt+K[12],At=K[1]*wt+K[5]*Gt+K[13],mr=K[2]*wt+K[6]*Gt+K[14],nn=K[3]*wt+K[7]*Gt+K[15],Bn=mr+H,ki=nn+ae,ea=Zt+Ce,xo=At+Ke,ui=mr+ke,en=nn+Be,Kn=new Ge((Zt+ie)/ki,(At+B)/ki);Kn.z=Bn/ki,Ye.push(Kn);const ci=new Ge(ea/en,xo/en);ci.z=ui/en,at.push(ci)}te.push(Ye),fe.push(at)}return[te,fe]}(c,C,T,y);return function(j,N,Z){let K=1/0;Pi(Z,N)&&(K=Ic(Z,N[0]));for(let te=0;te<N.length;te++){const fe=N[te],ie=j[te];for(let B=0;B<fe.length-1;B++){const H=fe[B],ae=[H,fe[B+1],ie[B+1],ie[B],H];_u(Z,ae)&&(K=Math.min(K,Ic(Z,ae)))}}return K!==1/0&&K}(F[0],F[1],k)}}function Do(n,t){return n.x*t.x+n.y*t.y}function Ic(n,t){if(n.length===1){let i=0;const a=t[i++];let c;for(;!c||a.equals(c);)if(c=t[i++],!c)return 1/0;for(;i<t.length;i++){const f=t[i],g=n[0],y=c.sub(a),b=f.sub(a),T=g.sub(a),C=Do(y,y),k=Do(y,b),F=Do(b,b),j=Do(T,y),N=Do(T,b),Z=C*F-k*k,K=(F*j-k*N)/Z,te=(C*N-k*j)/Z,fe=a.z*(1-K-te)+c.z*K+f.z*te;if(isFinite(fe))return fe}return 1/0}{let i=1/0;for(const a of t)i=Math.min(i,a.z);return i}}const Fs=Kr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:gh}=Fs,Mc=Kr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:fd}=Mc,_h=rs.VectorTileFeature.types,yh=Math.cos(Math.PI/180*37.5),Ii=Math.pow(2,14)/.5;class Aa{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(i=>i.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new de,this.layoutVertexArray2=new pe,this.indexArray=new lt,this.programConfigurations=new Ia(t.layers,t.zoom),this.segments=new Rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(t,i,a){this.hasPattern=xu("line",this.layers,i);const c=this.layers[0].layout.get("line-sort-key"),f=!c.isConstant(),g=[];for(const{feature:y,id:b,index:T,sourceLayerIndex:C}of t){const k=this.layers[0]._featureFilter.needGeometry,F=Si(y,k);if(!this.layers[0]._featureFilter.filter(new Sr(this.zoom),F,a))continue;const j=f?c.evaluate(F,{},a):void 0,N={id:b,properties:y.properties,type:y.type,sourceLayerIndex:C,index:T,geometry:k?F.geometry:Ma(y),patterns:{},sortKey:j};g.push(N)}f&&g.sort((y,b)=>y.sortKey-b.sortKey);for(const y of g){const{geometry:b,index:T,sourceLayerIndex:C}=y;if(this.hasPattern){const k=od("line",this.layers,y,this.zoom,i);this.patternFeatures.push(k)}else this.addFeature(y,b,T,a,{},i.subdivisionGranularity);i.featureIndex.insert(t[T].feature,b,T,C,this.index)}}update(t,i,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,i,this.stateDependentLayers,a)}addFeatures(t,i,a){for(const c of this.patternFeatures)this.addFeature(c,c.geometry,c.index,i,a,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,fd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,i,a,c,f,g){const y=this.layers[0].layout,b=y.get("line-join").evaluate(t,{}),T=y.get("line-cap"),C=y.get("line-miter-limit"),k=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const F of i)this.addLine(F,t,b,T,C,k,c,g);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,a,f,c)}addLine(t,i,a,c,f,g,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=li(t,y?b.line.getGranularityForZoomLevel(y.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<t.length-1;ie++)this.totalDistance+=t[ie].dist(t[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=_h[i.type]==="Polygon";let C=t.length;for(;C>=2&&t[C-1].equals(t[C-2]);)C--;let k=0;for(;k<C-1&&t[k].equals(t[k+1]);)k++;if(C<(T?3:2))return;a==="bevel"&&(f=1.05);const F=this.overscaling<=16?15*bt/(512*this.overscaling):0,j=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let N,Z,K,te,fe;this.e1=this.e2=-1,T&&(N=t[C-2],fe=t[k].sub(N)._unit()._perp());for(let ie=k;ie<C;ie++){if(K=ie===C-1?T?t[k+1]:void 0:t[ie+1],K&&t[ie].equals(K))continue;fe&&(te=fe),N&&(Z=N),N=t[ie],fe=K?K.sub(N)._unit()._perp():te,te=te||fe;let B=te.add(fe);B.x===0&&B.y===0||B._unit();const H=te.x*fe.x+te.y*fe.y,ae=B.x*fe.x+B.y*fe.y,Ce=ae!==0?1/ae:1/0,Ke=2*Math.sqrt(2-2*ae),ke=ae<yh&&Z&&K,Be=te.x*fe.y-te.y*fe.x>0;if(ke&&ie>k){const at=N.dist(Z);if(at>2*F){const Ue=N.sub(N.sub(Z)._mult(F/at)._round());this.updateDistance(Z,Ue),this.addCurrentVertex(Ue,te,0,0,j),Z=Ue}}const tt=Z&&K;let Ye=tt?a:T?"butt":c;if(tt&&Ye==="round"&&(Ce<g?Ye="miter":Ce<=2&&(Ye="fakeround")),Ye==="miter"&&Ce>f&&(Ye="bevel"),Ye==="bevel"&&(Ce>2&&(Ye="flipbevel"),Ce<f&&(Ye="miter")),Z&&this.updateDistance(Z,N),Ye==="miter")B._mult(Ce),this.addCurrentVertex(N,B,0,0,j);else if(Ye==="flipbevel"){if(Ce>100)B=fe.mult(-1);else{const at=Ce*te.add(fe).mag()/te.sub(fe).mag();B._perp()._mult(at*(Be?-1:1))}this.addCurrentVertex(N,B,0,0,j),this.addCurrentVertex(N,B.mult(-1),0,0,j)}else if(Ye==="bevel"||Ye==="fakeround"){const at=-Math.sqrt(Ce*Ce-1),Ue=Be?at:0,wt=Be?0:at;if(Z&&this.addCurrentVertex(N,te,Ue,wt,j),Ye==="fakeround"){const Gt=Math.round(180*Ke/Math.PI/20);for(let Zt=1;Zt<Gt;Zt++){let At=Zt/Gt;if(At!==.5){const nn=At-.5;At+=At*nn*(At-1)*((1.0904+H*(H*(3.55645-1.43519*H)-3.2452))*nn*nn+(.848013+H*(.215638*H-1.06021)))}const mr=fe.sub(te)._mult(At)._add(te)._unit()._mult(Be?-1:1);this.addHalfVertex(N,mr.x,mr.y,!1,Be,0,j)}}K&&this.addCurrentVertex(N,fe,-Ue,-wt,j)}else if(Ye==="butt")this.addCurrentVertex(N,B,0,0,j);else if(Ye==="square"){const at=Z?1:-1;this.addCurrentVertex(N,B,at,at,j)}else Ye==="round"&&(Z&&(this.addCurrentVertex(N,te,0,0,j),this.addCurrentVertex(N,te,1,1,j,!0)),K&&(this.addCurrentVertex(N,fe,-1,-1,j,!0),this.addCurrentVertex(N,fe,0,0,j)));if(ke&&ie<C-1){const at=N.dist(K);if(at>2*F){const Ue=N.add(K.sub(N)._mult(F/at)._round());this.updateDistance(N,Ue),this.addCurrentVertex(Ue,fe,0,0,j),N=Ue}}}}addCurrentVertex(t,i,a,c,f,g=!1){const y=i.y*c-i.x,b=-i.y-i.x*c;this.addHalfVertex(t,i.x+i.y*a,i.y-i.x*a,g,!1,a,f),this.addHalfVertex(t,y,b,g,!0,-c,f),this.distance>Ii/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,i,a,c,f,g))}addHalfVertex({x:t,y:i},a,c,f,g,y,b){const T=.5*(this.lineClips?this.scaledDistance*(Ii-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(f?1:0),(i<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*c)+128,1+(y===0?0:y<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const C=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,C,this.e2),b.primitiveLength++),g?this.e2=C:this.e1=C}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,i){this.distance+=t.dist(i),this.updateScaledDistance()}}let Lo,Bi;ft("LineBucket",Aa,{omit:["layers","patternFeatures"]});var md={get paint(){return Bi=Bi||new Ln({"line-opacity":new $t(R.paint_line["line-opacity"]),"line-color":new $t(R.paint_line["line-color"]),"line-translate":new zt(R.paint_line["line-translate"]),"line-translate-anchor":new zt(R.paint_line["line-translate-anchor"]),"line-width":new $t(R.paint_line["line-width"]),"line-gap-width":new $t(R.paint_line["line-gap-width"]),"line-offset":new $t(R.paint_line["line-offset"]),"line-blur":new $t(R.paint_line["line-blur"]),"line-dasharray":new zs(R.paint_line["line-dasharray"]),"line-pattern":new Xa(R.paint_line["line-pattern"]),"line-gradient":new pu(R.paint_line["line-gradient"])})},get layout(){return Lo=Lo||new Ln({"line-cap":new zt(R.layout_line["line-cap"]),"line-join":new $t(R.layout_line["line-join"]),"line-miter-limit":new zt(R.layout_line["line-miter-limit"]),"line-round-limit":new zt(R.layout_line["line-round-limit"]),"line-sort-key":new $t(R.layout_line["line-sort-key"])})}};class gd extends $t{possiblyEvaluate(t,i){return i=new Sr(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,zoomHistory:i.zoomHistory,transition:i.transition}),super.possiblyEvaluate(t,i)}evaluate(t,i,a,c){return i=Xe({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(t,i,a,c)}}let Iu;class Op extends si{constructor(t){super(t,md),this.gradientVersion=0,Iu||(Iu=new gd(md.paint.properties["line-width"].specification),Iu.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const i=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(i)&&i._styleExpression.expression instanceof aa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,i){super.recalculate(t,i),this.paint._values["line-floorwidth"]=Iu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Aa(t)}queryRadius(t){const i=t,a=ns(gl("line-width",this,i),gl("line-gap-width",this,i)),c=gl("line-offset",this,i);return a/2+Math.abs(c)+ch(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:i,featureState:a,geometry:c,transform:f,pixelsToTileUnits:g}){const y=bc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-f.bearingInRadians,g),b=g/2*ns(this.paint.get("line-width").evaluate(i,a),this.paint.get("line-gap-width").evaluate(i,a)),T=this.paint.get("line-offset").evaluate(i,a);return T&&(c=function(C,k){const F=[];for(let j=0;j<C.length;j++){const N=C[j],Z=[];for(let K=0;K<N.length;K++){const te=N[K-1],fe=N[K],ie=N[K+1],B=K===0?new Ge(0,0):fe.sub(te)._unit()._perp(),H=K===N.length-1?new Ge(0,0):ie.sub(fe)._unit()._perp(),ae=B._add(H)._unit(),Ce=ae.x*H.x+ae.y*H.y;Ce!==0&&ae._mult(1/Ce),Z.push(ae._mult(k)._add(fe))}F.push(Z)}return F}(c,T*g)),function(C,k,F){for(let j=0;j<k.length;j++){const N=k[j];if(C.length>=3){for(let Z=0;Z<N.length;Z++)if(Xo(C,N[Z]))return!0}if(Hh(C,N,F))return!0}return!1}(y,c,b)}isTileClipped(){return!0}}function ns(n,t){return t>0?t+2*n:n}const Qd=Kr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),_d=Kr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Kr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Cl=Kr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Kr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const vh=Kr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),El=Kr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Jd(n,t,i){return n.sections.forEach(a=>{a.text=function(c,f,g){const y=f.layout.get("text-transform").evaluate(g,{});return y==="uppercase"?c=c.toLocaleUpperCase():y==="lowercase"&&(c=c.toLocaleLowerCase()),Hn.applyArabicShaping&&(c=Hn.applyArabicShaping(c)),c}(a.text,t,i)}),n}Kr([{name:"triangle",components:3,type:"Uint16"}]),Kr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Kr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Kr([{type:"Float32",name:"offsetX"}]),Kr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Kr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Mu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var xh,ku,ep,bn=24,bh={};function tp(){return xh||(xh=1,bh.read=function(n,t,i,a,c){var f,g,y=8*c-a-1,b=(1<<y)-1,T=b>>1,C=-7,k=i?c-1:0,F=i?-1:1,j=n[t+k];for(k+=F,f=j&(1<<-C)-1,j>>=-C,C+=y;C>0;f=256*f+n[t+k],k+=F,C-=8);for(g=f&(1<<-C)-1,f>>=-C,C+=a;C>0;g=256*g+n[t+k],k+=F,C-=8);if(f===0)f=1-T;else{if(f===b)return g?NaN:1/0*(j?-1:1);g+=Math.pow(2,a),f-=T}return(j?-1:1)*g*Math.pow(2,f-a)},bh.write=function(n,t,i,a,c,f){var g,y,b,T=8*f-c-1,C=(1<<T)-1,k=C>>1,F=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=a?0:f-1,N=a?1:-1,Z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(y=isNaN(t)?1:0,g=C):(g=Math.floor(Math.log(t)/Math.LN2),t*(b=Math.pow(2,-g))<1&&(g--,b*=2),(t+=g+k>=1?F/b:F*Math.pow(2,1-k))*b>=2&&(g++,b/=2),g+k>=C?(y=0,g=C):g+k>=1?(y=(t*b-1)*Math.pow(2,c),g+=k):(y=t*Math.pow(2,k-1)*Math.pow(2,c),g=0));c>=8;n[i+j]=255&y,j+=N,y/=256,c-=8);for(g=g<<c|y,T+=c;T>0;n[i+j]=255&g,j+=N,g/=256,T-=8);n[i+j-N]|=128*Z}),bh}function Bs(){if(ep)return ku;ep=1,ku=t;var n=tp();function t(B){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(B)?B:new Uint8Array(B||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var i=4294967296,a=1/i,c=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function f(B){return B.type===t.Bytes?B.readVarint()+B.pos:B.pos+1}function g(B,H,ae){return ae?4294967296*H+(B>>>0):4294967296*(H>>>0)+(B>>>0)}function y(B,H,ae){var Ce=H<=16383?1:H<=2097151?2:H<=268435455?3:Math.floor(Math.log(H)/(7*Math.LN2));ae.realloc(Ce);for(var Ke=ae.pos-1;Ke>=B;Ke--)ae.buf[Ke+Ce]=ae.buf[Ke]}function b(B,H){for(var ae=0;ae<B.length;ae++)H.writeVarint(B[ae])}function T(B,H){for(var ae=0;ae<B.length;ae++)H.writeSVarint(B[ae])}function C(B,H){for(var ae=0;ae<B.length;ae++)H.writeFloat(B[ae])}function k(B,H){for(var ae=0;ae<B.length;ae++)H.writeDouble(B[ae])}function F(B,H){for(var ae=0;ae<B.length;ae++)H.writeBoolean(B[ae])}function j(B,H){for(var ae=0;ae<B.length;ae++)H.writeFixed32(B[ae])}function N(B,H){for(var ae=0;ae<B.length;ae++)H.writeSFixed32(B[ae])}function Z(B,H){for(var ae=0;ae<B.length;ae++)H.writeFixed64(B[ae])}function K(B,H){for(var ae=0;ae<B.length;ae++)H.writeSFixed64(B[ae])}function te(B,H){return(B[H]|B[H+1]<<8|B[H+2]<<16)+16777216*B[H+3]}function fe(B,H,ae){B[ae]=H,B[ae+1]=H>>>8,B[ae+2]=H>>>16,B[ae+3]=H>>>24}function ie(B,H){return(B[H]|B[H+1]<<8|B[H+2]<<16)+(B[H+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(B,H,ae){for(ae=ae||this.length;this.pos<ae;){var Ce=this.readVarint(),Ke=Ce>>3,ke=this.pos;this.type=7&Ce,B(Ke,H,this),this.pos===ke&&this.skip(Ce)}return H},readMessage:function(B,H){return this.readFields(B,H,this.readVarint()+this.pos)},readFixed32:function(){var B=te(this.buf,this.pos);return this.pos+=4,B},readSFixed32:function(){var B=ie(this.buf,this.pos);return this.pos+=4,B},readFixed64:function(){var B=te(this.buf,this.pos)+te(this.buf,this.pos+4)*i;return this.pos+=8,B},readSFixed64:function(){var B=te(this.buf,this.pos)+ie(this.buf,this.pos+4)*i;return this.pos+=8,B},readFloat:function(){var B=n.read(this.buf,this.pos,!0,23,4);return this.pos+=4,B},readDouble:function(){var B=n.read(this.buf,this.pos,!0,52,8);return this.pos+=8,B},readVarint:function(B){var H,ae,Ce=this.buf;return H=127&(ae=Ce[this.pos++]),ae<128?H:(H|=(127&(ae=Ce[this.pos++]))<<7,ae<128?H:(H|=(127&(ae=Ce[this.pos++]))<<14,ae<128?H:(H|=(127&(ae=Ce[this.pos++]))<<21,ae<128?H:function(Ke,ke,Be){var tt,Ye,at=Be.buf;if(tt=(112&(Ye=at[Be.pos++]))>>4,Ye<128||(tt|=(127&(Ye=at[Be.pos++]))<<3,Ye<128)||(tt|=(127&(Ye=at[Be.pos++]))<<10,Ye<128)||(tt|=(127&(Ye=at[Be.pos++]))<<17,Ye<128)||(tt|=(127&(Ye=at[Be.pos++]))<<24,Ye<128)||(tt|=(1&(Ye=at[Be.pos++]))<<31,Ye<128))return g(Ke,tt,ke);throw new Error("Expected varint not more than 10 bytes")}(H|=(15&(ae=Ce[this.pos]))<<28,B,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var B=this.readVarint();return B%2==1?(B+1)/-2:B/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var B=this.readVarint()+this.pos,H=this.pos;return this.pos=B,B-H>=12&&c?function(ae,Ce,Ke){return c.decode(ae.subarray(Ce,Ke))}(this.buf,H,B):function(ae,Ce,Ke){for(var ke="",Be=Ce;Be<Ke;){var tt,Ye,at,Ue=ae[Be],wt=null,Gt=Ue>239?4:Ue>223?3:Ue>191?2:1;if(Be+Gt>Ke)break;Gt===1?Ue<128&&(wt=Ue):Gt===2?(192&(tt=ae[Be+1]))==128&&(wt=(31&Ue)<<6|63&tt)<=127&&(wt=null):Gt===3?(Ye=ae[Be+2],(192&(tt=ae[Be+1]))==128&&(192&Ye)==128&&((wt=(15&Ue)<<12|(63&tt)<<6|63&Ye)<=2047||wt>=55296&&wt<=57343)&&(wt=null)):Gt===4&&(Ye=ae[Be+2],at=ae[Be+3],(192&(tt=ae[Be+1]))==128&&(192&Ye)==128&&(192&at)==128&&((wt=(15&Ue)<<18|(63&tt)<<12|(63&Ye)<<6|63&at)<=65535||wt>=1114112)&&(wt=null)),wt===null?(wt=65533,Gt=1):wt>65535&&(wt-=65536,ke+=String.fromCharCode(wt>>>10&1023|55296),wt=56320|1023&wt),ke+=String.fromCharCode(wt),Be+=Gt}return ke}(this.buf,H,B)},readBytes:function(){var B=this.readVarint()+this.pos,H=this.buf.subarray(this.pos,B);return this.pos=B,H},readPackedVarint:function(B,H){if(this.type!==t.Bytes)return B.push(this.readVarint(H));var ae=f(this);for(B=B||[];this.pos<ae;)B.push(this.readVarint(H));return B},readPackedSVarint:function(B){if(this.type!==t.Bytes)return B.push(this.readSVarint());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readSVarint());return B},readPackedBoolean:function(B){if(this.type!==t.Bytes)return B.push(this.readBoolean());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readBoolean());return B},readPackedFloat:function(B){if(this.type!==t.Bytes)return B.push(this.readFloat());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readFloat());return B},readPackedDouble:function(B){if(this.type!==t.Bytes)return B.push(this.readDouble());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readDouble());return B},readPackedFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed32());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readFixed32());return B},readPackedSFixed32:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed32());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readSFixed32());return B},readPackedFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readFixed64());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readFixed64());return B},readPackedSFixed64:function(B){if(this.type!==t.Bytes)return B.push(this.readSFixed64());var H=f(this);for(B=B||[];this.pos<H;)B.push(this.readSFixed64());return B},skip:function(B){var H=7&B;if(H===t.Varint)for(;this.buf[this.pos++]>127;);else if(H===t.Bytes)this.pos=this.readVarint()+this.pos;else if(H===t.Fixed32)this.pos+=4;else{if(H!==t.Fixed64)throw new Error("Unimplemented type: "+H);this.pos+=8}},writeTag:function(B,H){this.writeVarint(B<<3|H)},realloc:function(B){for(var H=this.length||16;H<this.pos+B;)H*=2;if(H!==this.length){var ae=new Uint8Array(H);ae.set(this.buf),this.buf=ae,this.length=H}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(B){this.realloc(4),fe(this.buf,B,this.pos),this.pos+=4},writeSFixed32:function(B){this.realloc(4),fe(this.buf,B,this.pos),this.pos+=4},writeFixed64:function(B){this.realloc(8),fe(this.buf,-1&B,this.pos),fe(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeSFixed64:function(B){this.realloc(8),fe(this.buf,-1&B,this.pos),fe(this.buf,Math.floor(B*a),this.pos+4),this.pos+=8},writeVarint:function(B){(B=+B||0)>268435455||B<0?function(H,ae){var Ce,Ke;if(H>=0?(Ce=H%4294967296|0,Ke=H/4294967296|0):(Ke=~(-H/4294967296),4294967295^(Ce=~(-H%4294967296))?Ce=Ce+1|0:(Ce=0,Ke=Ke+1|0)),H>=18446744073709552e3||H<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ae.realloc(10),function(ke,Be,tt){tt.buf[tt.pos++]=127&ke|128,ke>>>=7,tt.buf[tt.pos++]=127&ke|128,ke>>>=7,tt.buf[tt.pos++]=127&ke|128,ke>>>=7,tt.buf[tt.pos++]=127&ke|128,tt.buf[tt.pos]=127&(ke>>>=7)}(Ce,0,ae),function(ke,Be){var tt=(7&ke)<<4;Be.buf[Be.pos++]|=tt|((ke>>>=3)?128:0),ke&&(Be.buf[Be.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Be.buf[Be.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Be.buf[Be.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Be.buf[Be.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Be.buf[Be.pos++]=127&ke)))))}(Ke,ae)}(B,this):(this.realloc(4),this.buf[this.pos++]=127&B|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=127&(B>>>=7)|(B>127?128:0),B<=127||(this.buf[this.pos++]=B>>>7&127))))},writeSVarint:function(B){this.writeVarint(B<0?2*-B-1:2*B)},writeBoolean:function(B){this.writeVarint(!!B)},writeString:function(B){B=String(B),this.realloc(4*B.length),this.pos++;var H=this.pos;this.pos=function(Ce,Ke,ke){for(var Be,tt,Ye=0;Ye<Ke.length;Ye++){if((Be=Ke.charCodeAt(Ye))>55295&&Be<57344){if(!tt){Be>56319||Ye+1===Ke.length?(Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189):tt=Be;continue}if(Be<56320){Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189,tt=Be;continue}Be=tt-55296<<10|Be-56320|65536,tt=null}else tt&&(Ce[ke++]=239,Ce[ke++]=191,Ce[ke++]=189,tt=null);Be<128?Ce[ke++]=Be:(Be<2048?Ce[ke++]=Be>>6|192:(Be<65536?Ce[ke++]=Be>>12|224:(Ce[ke++]=Be>>18|240,Ce[ke++]=Be>>12&63|128),Ce[ke++]=Be>>6&63|128),Ce[ke++]=63&Be|128)}return ke}(this.buf,B,this.pos);var ae=this.pos-H;ae>=128&&y(H,ae,this),this.pos=H-1,this.writeVarint(ae),this.pos+=ae},writeFloat:function(B){this.realloc(4),n.write(this.buf,B,this.pos,!0,23,4),this.pos+=4},writeDouble:function(B){this.realloc(8),n.write(this.buf,B,this.pos,!0,52,8),this.pos+=8},writeBytes:function(B){var H=B.length;this.writeVarint(H),this.realloc(H);for(var ae=0;ae<H;ae++)this.buf[this.pos++]=B[ae]},writeRawMessage:function(B,H){this.pos++;var ae=this.pos;B(H,this);var Ce=this.pos-ae;Ce>=128&&y(ae,Ce,this),this.pos=ae-1,this.writeVarint(Ce),this.pos+=Ce},writeMessage:function(B,H,ae){this.writeTag(B,t.Bytes),this.writeRawMessage(H,ae)},writePackedVarint:function(B,H){H.length&&this.writeMessage(B,b,H)},writePackedSVarint:function(B,H){H.length&&this.writeMessage(B,T,H)},writePackedBoolean:function(B,H){H.length&&this.writeMessage(B,F,H)},writePackedFloat:function(B,H){H.length&&this.writeMessage(B,C,H)},writePackedDouble:function(B,H){H.length&&this.writeMessage(B,k,H)},writePackedFixed32:function(B,H){H.length&&this.writeMessage(B,j,H)},writePackedSFixed32:function(B,H){H.length&&this.writeMessage(B,N,H)},writePackedFixed64:function(B,H){H.length&&this.writeMessage(B,Z,H)},writePackedSFixed64:function(B,H){H.length&&this.writeMessage(B,K,H)},writeBytesField:function(B,H){this.writeTag(B,t.Bytes),this.writeBytes(H)},writeFixed32Field:function(B,H){this.writeTag(B,t.Fixed32),this.writeFixed32(H)},writeSFixed32Field:function(B,H){this.writeTag(B,t.Fixed32),this.writeSFixed32(H)},writeFixed64Field:function(B,H){this.writeTag(B,t.Fixed64),this.writeFixed64(H)},writeSFixed64Field:function(B,H){this.writeTag(B,t.Fixed64),this.writeSFixed64(H)},writeVarintField:function(B,H){this.writeTag(B,t.Varint),this.writeVarint(H)},writeSVarintField:function(B,H){this.writeTag(B,t.Varint),this.writeSVarint(H)},writeStringField:function(B,H){this.writeTag(B,t.Bytes),this.writeString(H)},writeFloatField:function(B,H){this.writeTag(B,t.Fixed32),this.writeFloat(H)},writeDoubleField:function(B,H){this.writeTag(B,t.Fixed64),this.writeDouble(H)},writeBooleanField:function(B,H){this.writeVarintField(B,!!H)}},ku}var yd=Me(Bs());const js=3;function rp(n,t,i){n===1&&i.readMessage(un,t)}function un(n,t,i){if(n===3){const{id:a,bitmap:c,width:f,height:g,left:y,top:b,advance:T}=i.readMessage(Fp,{});t.push({id:a,bitmap:new vu({width:f+2*js,height:g+2*js},c),metrics:{width:f,height:g,left:y,top:b,advance:T}})}}function Fp(n,t,i){n===1?t.id=i.readVarint():n===2?t.bitmap=i.readBytes():n===3?t.width=i.readVarint():n===4?t.height=i.readVarint():n===5?t.left=i.readSVarint():n===6?t.top=i.readSVarint():n===7&&(t.advance=i.readVarint())}const np=js;function ip(n){let t=0,i=0;for(const g of n)t+=g.w*g.h,i=Math.max(i,g.w);n.sort((g,y)=>y.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),i),h:1/0}];let c=0,f=0;for(const g of n)for(let y=a.length-1;y>=0;y--){const b=a[y];if(!(g.w>b.w||g.h>b.h)){if(g.x=b.x,g.y=b.y,f=Math.max(f,g.y+g.h),c=Math.max(c,g.x+g.w),g.w===b.w&&g.h===b.h){const T=a.pop();y<a.length&&(a[y]=T)}else g.h===b.h?(b.x+=g.w,b.w-=g.w):g.w===b.w?(b.y+=g.h,b.h-=g.h):(a.push({x:b.x+g.w,y:b.y,w:b.w-g.w,h:g.h}),b.y+=g.h,b.h-=g.h);break}}return{w:c,h:f,fill:t/(c*f)||0}}const ji=1;class wh{constructor(t,{pixelRatio:i,version:a,stretchX:c,stretchY:f,content:g,textFitWidth:y,textFitHeight:b}){this.paddedRect=t,this.pixelRatio=i,this.stretchX=c,this.stretchY=f,this.content=g,this.version=a,this.textFitWidth=y,this.textFitHeight=b}get tl(){return[this.paddedRect.x+ji,this.paddedRect.y+ji]}get br(){return[this.paddedRect.x+this.paddedRect.w-ji,this.paddedRect.y+this.paddedRect.h-ji]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ji)/this.pixelRatio,(this.paddedRect.h-2*ji)/this.pixelRatio]}}class vd{constructor(t,i){const a={},c={};this.haveRenderCallbacks=[];const f=[];this.addImages(t,a,f),this.addImages(i,c,f);const{w:g,h:y}=ip(f),b=new Fi({width:g||1,height:y||1});for(const T in t){const C=t[T],k=a[T].paddedRect;Fi.copy(C.data,b,{x:0,y:0},{x:k.x+ji,y:k.y+ji},C.data)}for(const T in i){const C=i[T],k=c[T].paddedRect,F=k.x+ji,j=k.y+ji,N=C.data.width,Z=C.data.height;Fi.copy(C.data,b,{x:0,y:0},{x:F,y:j},C.data),Fi.copy(C.data,b,{x:0,y:Z-1},{x:F,y:j-1},{width:N,height:1}),Fi.copy(C.data,b,{x:0,y:0},{x:F,y:j+Z},{width:N,height:1}),Fi.copy(C.data,b,{x:N-1,y:0},{x:F-1,y:j},{width:1,height:Z}),Fi.copy(C.data,b,{x:0,y:0},{x:F+N,y:j},{width:1,height:Z})}this.image=b,this.iconPositions=a,this.patternPositions=c}addImages(t,i,a){for(const c in t){const f=t[c],g={x:0,y:0,w:f.data.width+2*ji,h:f.data.height+2*ji};a.push(g),i[c]=new wh(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(c)}}patchUpdatedImages(t,i){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in t.updatedImages)this.patchUpdatedImage(this.iconPositions[a],t.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],t.getImage(a),i)}patchUpdatedImage(t,i,a){if(!t||!i||t.version===i.version)return;t.version=i.version;const[c,f]=t.tl;a.update(i.data,void 0,{x:c,y:f})}}var Ns;ft("ImagePosition",wh),ft("ImageAtlas",vd),M.ag=void 0,(Ns=M.ag||(M.ag={}))[Ns.none=0]="none",Ns[Ns.horizontal=1]="horizontal",Ns[Ns.vertical=2]="vertical",Ns[Ns.horizontalOnly=3]="horizontalOnly";const Ni=-17;class Il{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,i,a){const c=new Il;return c.scale=t||1,c.fontStack=i,c.verticalAlign=a||"bottom",c}static forImage(t,i){const a=new Il;return a.imageName=t,a.verticalAlign=i||"bottom",a}}class Au{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,i){const a=new Au;for(let c=0;c<t.sections.length;c++){const f=t.sections[c];f.image?a.addImageSection(f):a.addTextSection(f,i)}return a}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let i="";for(let a=0;a<t.length;a++){const c=t.charCodeAt(a+1)||null,f=t.charCodeAt(a-1)||null;i+=c&&As(c)&&!Mu[t[a+1]]||f&&As(f)&&!Mu[t[a-1]]||!Mu[t[a]]?t[a]:Mu[t[a]]}return i}(this.text)}trim(){let t=0;for(let a=0;a<this.text.length&&Ml[this.text.charCodeAt(a)];a++)t++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=t&&Ml[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)}substring(t,i){const a=new Au;return a.text=this.text.substring(t,i),a.sectionIndex=this.sectionIndex.slice(t,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,i)=>Math.max(t,this.sections[i].scale),0)}getMaxImageSize(t){let i=0,a=0;for(let c=0;c<this.length();c++){const f=this.getSection(c);if(f.imageName){const g=t[f.imageName];if(!g)continue;const y=g.displaySize;i=Math.max(i,y[0]),a=Math.max(a,y[1])}}return{maxImageWidth:i,maxImageHeight:a}}addTextSection(t,i){this.text+=t.text,this.sections.push(Il.forText(t.scale,t.fontStack||i,t.verticalAlign));const a=this.sections.length-1;for(let c=0;c<t.text.length;++c)this.sectionIndex.push(a)}addImageSection(t){const i=t.image?t.image.name:"";if(i.length===0)return void or("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Il.forImage(i,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):or("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Yo(n,t,i,a,c,f,g,y,b,T,C,k,F,j,N){const Z=Au.fromFeature(n,c);let K;k===M.ag.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:te,processStyledBidirectionalText:fe}=Hn;if(te&&Z.sections.length===1){K=[];const H=te(Z.toString(),Eh(Z,T,f,t,a,j));for(const ae of H){const Ce=new Au;Ce.text=ae,Ce.sections=Z.sections;for(let Ke=0;Ke<ae.length;Ke++)Ce.sectionIndex.push(0);K.push(Ce)}}else if(fe){K=[];const H=fe(Z.text,Z.sectionIndex,Eh(Z,T,f,t,a,j));for(const ae of H){const Ce=new Au;Ce.text=ae[0],Ce.sectionIndex=ae[1],Ce.sections=Z.sections,K.push(Ce)}}else K=function(H,ae){const Ce=[],Ke=H.text;let ke=0;for(const Be of ae)Ce.push(H.substring(ke,Be)),ke=Be;return ke<Ke.length&&Ce.push(H.substring(ke,Ke.length)),Ce}(Z,Eh(Z,T,f,t,a,j));const ie=[],B={positionedLines:ie,text:Z.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:k,iconsInText:!1,verticalizable:!1};return function(H,ae,Ce,Ke,ke,Be,tt,Ye,at,Ue,wt,Gt){let Zt=0,At=0,mr=0,nn=0;const Bn=Ye==="right"?1:Ye==="left"?0:.5,ki=bn/Gt;let ea=0;for(const en of ke){en.trim();const Kn=en.getMaxScale(),ci={positionedGlyphs:[],lineOffset:0};H.positionedLines[ea]=ci;const hi=ci.positionedGlyphs;let oo=0;if(!en.length()){At+=Be,++ea;continue}const ta=Mh(Ke,en,ki);for(let bo=0;bo<en.length();bo++){const jn=en.getSection(bo),Qn=en.getSectionIndex(bo),Jn=en.getCharCode(bo),An=ap(at,wt,Jn);let Yr;if(jn.imageName){if(H.iconsInText=!0,jn.scale=jn.scale*ki,Yr=jp(jn,An,Kn,ta,Ke),!Yr)continue;oo=Math.max(oo,Yr.imageOffset)}else if(Yr=xd(jn,Jn,An,ta,ae,Ce),!Yr)continue;const{rect:os,metrics:Rh,baselineOffset:as}=Yr;hi.push({glyph:Jn,imageName:jn.imageName,x:Zt,y:At+as+Ni,vertical:An,scale:jn.scale,fontStack:jn.fontStack,sectionIndex:Qn,metrics:Rh,rect:os}),An?(H.verticalizable=!0,Zt+=(jn.imageName?Rh.advance:bn)*jn.scale+Ue):Zt+=Rh.advance*jn.scale+Ue}hi.length!==0&&(mr=Math.max(Zt-Ue,mr),sp(hi,0,hi.length-1,Bn)),Zt=0,ci.lineOffset=Math.max(oo,(Kn-1)*bn);const Yn=Be*Kn+oo;At+=Yn,nn=Math.max(Yn,nn),++ea}const{horizontalAlign:xo,verticalAlign:ui}=Ih(tt);(function(en,Kn,ci,hi,oo,ta,Yn,bo,jn){const Qn=(Kn-ci)*oo;let Jn=0;Jn=ta!==Yn?-bo*hi-Ni:-hi*jn*Yn+.5*Yn;for(const An of en)for(const Yr of An.positionedGlyphs)Yr.x+=Qn,Yr.y+=Jn})(H.positionedLines,Bn,xo,ui,mr,nn,Be,At,ke.length),H.top+=-ui*At,H.bottom=H.top+At,H.left+=-xo*mr,H.right=H.left+mr}(B,t,i,a,K,g,y,b,k,T,F,N),!function(H){for(const ae of H)if(ae.positionedGlyphs.length!==0)return!1;return!0}(ie)&&B}const Ml={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kl={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Th={40:!0};function Sh(n,t,i,a,c,f){if(t.imageName){const g=a[t.imageName];return g?g.displaySize[0]*t.scale*bn/f+c:0}{const g=i[t.fontStack],y=g&&g[n];return y?y.metrics.advance*t.scale+c:0}}function Ph(n,t,i,a){const c=Math.pow(n-t,2);return a?n<t?c/2:2*c:c+Math.abs(i)*i}function Bp(n,t,i){let a=0;return n===10&&(a-=1e4),i&&(a+=150),n!==40&&n!==65288||(a+=50),t!==41&&t!==65289||(a+=50),a}function Ch(n,t,i,a,c,f){let g=null,y=Ph(t,i,c,f);for(const b of a){const T=Ph(t-b.x,i,c,f)+b.badness;T<=y&&(g=b,y=T)}return{index:n,x:t,priorBreak:g,badness:y}}function op(n){return n?op(n.priorBreak).concat(n.index):[]}function Eh(n,t,i,a,c,f){if(!n)return[];const g=[],y=function(k,F,j,N,Z,K){let te=0;for(let fe=0;fe<k.length();fe++){const ie=k.getSection(fe);te+=Sh(k.getCharCode(fe),ie,N,Z,F,K)}return te/Math.max(1,Math.ceil(te/j))}(n,t,i,a,c,f),b=n.text.indexOf("")>=0;let T=0;for(let k=0;k<n.length();k++){const F=n.getSection(k),j=n.getCharCode(k);if(Ml[j]||(T+=Sh(j,F,a,c,t,f)),k<n.length()-1){const N=!((C=j)<11904)&&(!!Yt["CJK Compatibility Forms"](C)||!!Yt["CJK Compatibility"](C)||!!Yt["CJK Strokes"](C)||!!Yt["CJK Symbols and Punctuation"](C)||!!Yt["Enclosed CJK Letters and Months"](C)||!!Yt["Halfwidth and Fullwidth Forms"](C)||!!Yt["Ideographic Description Characters"](C)||!!Yt["Vertical Forms"](C)||wa.test(String.fromCodePoint(C)));(kl[j]||N||F.imageName||k!==n.length()-2&&Th[n.getCharCode(k+1)])&&g.push(Ch(k+1,T,y,g,Bp(j,n.getCharCode(k+1),N&&b),!1))}}var C;return op(Ch(n.length(),T,y,g,0,!0))}function Ih(n){let t=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:t,verticalAlign:i}}function Mh(n,t,i){const a=t.getMaxScale()*bn,{maxImageWidth:c,maxImageHeight:f}=t.getMaxImageSize(n),g=Math.max(a,f*i);return{verticalLineContentWidth:Math.max(a,c*i),horizontalLineContentHeight:g}}function kc(n){switch(n){case"top":return 0;case"center":return .5;default:return 1}}function ap(n,t,i){return!(n===M.ag.horizontal||!t&&!Ta(i)||t&&(Ml[i]||(a=i,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(a)))));var a}function xd(n,t,i,a,c,f){const g=f[n.fontStack],y=function(T,C,k,F){if(T&&T.rect)return T;const j=C[k.fontStack],N=j&&j[F];return N?{rect:null,metrics:N.metrics}:null}(g&&g[t],c,n,t);if(y===null)return null;let b;if(i)b=a.verticalLineContentWidth-n.scale*bn;else{const T=kc(n.verticalAlign);b=(a.horizontalLineContentHeight-n.scale*bn)*T}return{rect:y.rect,metrics:y.metrics,baselineOffset:b}}function jp(n,t,i,a,c){const f=c[n.imageName];if(!f)return null;const g=f.paddedRect,y=f.displaySize,b={width:y[0],height:y[1],left:ji,top:-3,advance:t?y[1]:y[0]};let T;if(t)T=a.verticalLineContentWidth-y[1]*n.scale;else{const C=kc(n.verticalAlign);T=(a.horizontalLineContentHeight-y[1]*n.scale)*C}return{rect:g,metrics:b,baselineOffset:T,imageOffset:(t?y[0]:y[1])*n.scale-bn*i}}function sp(n,t,i,a){if(a===0)return;const c=n[i],f=(n[i].x+c.metrics.advance*c.scale)*a;for(let g=t;g<=i;g++)n[g].x-=f}function bd(n,t,i){const{horizontalAlign:a,verticalAlign:c}=Ih(i),f=t[0]-n.displaySize[0]*a,g=t[1]-n.displaySize[1]*c;return{image:n,top:g,bottom:g+n.displaySize[1],left:f,right:f+n.displaySize[0]}}function Ac(n){var t,i;let a=n.left,c=n.top,f=n.right-a,g=n.bottom-c;const y=(t=n.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",b=(i=n.image.textFitHeight)!==null&&i!==void 0?i:"stretchOrShrink",T=(n.image.content[2]-n.image.content[0])/(n.image.content[3]-n.image.content[1]);if(b==="proportional"){if(y==="stretchOnly"&&f/g<T||y==="proportional"){const C=Math.ceil(g*T);a*=C/f,f=C}}else if(y==="proportional"&&b==="stretchOnly"&&T!==0&&f/g>T){const C=Math.ceil(f/T);c*=C/g,g=C}return{x1:a,y1:c,x2:a+f,y2:c+g}}function kh(n,t,i,a,c,f){const g=n.image;let y;if(g.content){const K=g.content,te=g.pixelRatio||1;y=[K[0]/te,K[1]/te,g.displaySize[0]-K[2]/te,g.displaySize[1]-K[3]/te]}const b=t.left*f,T=t.right*f;let C,k,F,j;i==="width"||i==="both"?(j=c[0]+b-a[3],k=c[0]+T+a[1]):(j=c[0]+(b+T-g.displaySize[0])/2,k=j+g.displaySize[0]);const N=t.top*f,Z=t.bottom*f;return i==="height"||i==="both"?(C=c[1]+N-a[0],F=c[1]+Z+a[2]):(C=c[1]+(N+Z-g.displaySize[1])/2,F=C+g.displaySize[1]),{image:g,top:C,right:k,bottom:F,left:j,collisionPadding:y}}const Vs=255,Qo=128,$s=Vs*Qo;function zc(n,t){const{expression:i}=t;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new Sr(n+1))};if(i.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:c}=i;let f=0;for(;f<a.length&&a[f]<=n;)f++;f=Math.max(0,f-1);let g=f;for(;g<a.length&&a[g]<n+1;)g++;g=Math.min(a.length-1,g);const y=a[f],b=a[g];return i.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:b,interpolationType:c}:{kind:"camera",minZoom:y,maxZoom:b,minSize:i.evaluate(new Sr(y)),maxSize:i.evaluate(new Sr(b)),interpolationType:c}}}function wd(n,t,i){let a="never";const c=n.get(t);return c?a=c:n.get(i)&&(a="always"),a}const Rc=rs.VectorTileFeature.types,Np=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Al(n,t,i,a,c,f,g,y,b,T,C,k,F){const j=y?Math.min($s,Math.round(y[0])):0,N=y?Math.min($s,Math.round(y[1])):0;n.emplaceBack(t,i,Math.round(32*a),Math.round(32*c),f,g,(j<<1)+(b?1:0),N,16*T,16*C,256*k,256*F)}function o(n,t,i){n.emplaceBack(t.x,t.y,i),n.emplaceBack(t.x,t.y,i),n.emplaceBack(t.x,t.y,i),n.emplaceBack(t.x,t.y,i)}function s(n){for(const t of n.sections)if(Sa(t.text))return!0;return!1}class m{constructor(t){this.layoutVertexArray=new be,this.indexArray=new lt,this.programConfigurations=t,this.segments=new Rt,this.dynamicLayoutVertexArray=new we,this.opacityVertexArray=new Fe,this.hasVisibleVertices=!1,this.placedSymbolArray=new w}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,i,a,c){this.isEmpty()||(a&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qd.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,_d.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Np,!0),this.opacityVertexBuffer.itemSize=1),(a||c)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ft("SymbolBuffers",m);class v{constructor(t,i,a){this.layoutVertexArray=new t,this.layoutAttributes=i,this.indexArray=new a,this.segments=new Rt,this.collisionVertexArray=new Oe}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Cl.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ft("CollisionBuffers",v);class S{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zc(this.zoom,i["text-size"]),this.iconSizeData=zc(this.zoom,i["icon-size"]);const a=this.layers[0].layout,c=a.get("symbol-sort-key"),f=a.get("symbol-z-order");this.canOverlap=wd(a,"text-overlap","text-allow-overlap")!=="never"||wd(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=f!=="viewport-y"&&!c.isConstant(),this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>M.ag[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID}createArrays(){this.text=new m(new Ia(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new m(new Ia(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new D,this.lineVertexArray=new O,this.symbolInstances=new A,this.textAnchorOffsets=new U}calculateGlyphDependencies(t,i,a,c,f){for(let g=0;g<t.length;g++)if(i[t.charCodeAt(g)]=!0,(a||c)&&f){const y=Mu[t.charAt(g)];y&&(i[y.charCodeAt(0)]=!0)}}populate(t,i,a){const c=this.layers[0],f=c.layout,g=f.get("text-font"),y=f.get("text-field"),b=f.get("icon-image"),T=(y.value.kind!=="constant"||y.value.value instanceof Sn&&!y.value.value.isEmpty()||y.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),C=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,k=f.get("symbol-sort-key");if(this.features=[],!T&&!C)return;const F=i.iconDependencies,j=i.glyphDependencies,N=i.availableImages,Z=new Sr(this.zoom);for(const{feature:K,id:te,index:fe,sourceLayerIndex:ie}of t){const B=c._featureFilter.needGeometry,H=Si(K,B);if(!c._featureFilter.filter(Z,H,a))continue;let ae,Ce;if(B||(H.geometry=Ma(K)),T){const ke=c.getValueAndResolveTokens("text-field",H,a,N),Be=Sn.factory(ke),tt=this.hasRTLText=this.hasRTLText||s(Be);(!tt||Hn.getRTLTextPluginStatus()==="unavailable"||tt&&Hn.isParsed())&&(ae=Jd(Be,c,H))}if(C){const ke=c.getValueAndResolveTokens("icon-image",H,a,N);Ce=ke instanceof $n?ke:$n.fromString(ke)}if(!ae&&!Ce)continue;const Ke=this.sortFeaturesByKey?k.evaluate(H,{},a):void 0;if(this.features.push({id:te,text:ae,icon:Ce,index:fe,sourceLayerIndex:ie,geometry:H.geometry,properties:K.properties,type:Rc[K.type],sortKey:Ke}),Ce&&(F[Ce.name]=!0),ae){const ke=g.evaluate(H,{},a).join(","),Be=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(M.ag.vertical)>=0;for(const tt of ae.sections)if(tt.image)F[tt.image.name]=!0;else{const Ye=Ha(ae.toString()),at=tt.fontStack||ke,Ue=j[at]=j[at]||{};this.calculateGlyphDependencies(tt.text,Ue,Be,this.allowVerticalPlacement,Ye)}}}f.get("symbol-placement")==="line"&&(this.features=function(K){const te={},fe={},ie=[];let B=0;function H(ke){ie.push(K[ke]),B++}function ae(ke,Be,tt){const Ye=fe[ke];return delete fe[ke],fe[Be]=Ye,ie[Ye].geometry[0].pop(),ie[Ye].geometry[0]=ie[Ye].geometry[0].concat(tt[0]),Ye}function Ce(ke,Be,tt){const Ye=te[Be];return delete te[Be],te[ke]=Ye,ie[Ye].geometry[0].shift(),ie[Ye].geometry[0]=tt[0].concat(ie[Ye].geometry[0]),Ye}function Ke(ke,Be,tt){const Ye=tt?Be[0][Be[0].length-1]:Be[0][0];return`${ke}:${Ye.x}:${Ye.y}`}for(let ke=0;ke<K.length;ke++){const Be=K[ke],tt=Be.geometry,Ye=Be.text?Be.text.toString():null;if(!Ye){H(ke);continue}const at=Ke(Ye,tt),Ue=Ke(Ye,tt,!0);if(at in fe&&Ue in te&&fe[at]!==te[Ue]){const wt=Ce(at,Ue,tt),Gt=ae(at,Ue,ie[wt].geometry);delete te[at],delete fe[Ue],fe[Ke(Ye,ie[Gt].geometry,!0)]=Gt,ie[wt].geometry=null}else at in fe?ae(at,Ue,tt):Ue in te?Ce(at,Ue,tt):(H(ke),te[at]=B-1,fe[Ue]=B-1)}return ie.filter(ke=>ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((K,te)=>K.sortKey-te.sortKey)}update(t,i,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,i,this.layers,a),this.icon.programConfigurations.updatePaintArrays(t,i,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,i){const a=this.lineVertexArray.length;if(t.segment!==void 0){let c=t.dist(i[t.segment+1]),f=t.dist(i[t.segment]);const g={};for(let y=t.segment+1;y<i.length;y++)g[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:c},y<i.length-1&&(c+=i[y+1].dist(i[y]));for(let y=t.segment||0;y>=0;y--)g[y]={x:i[y].x,y:i[y].y,tileUnitDistanceFromAnchor:f},y>0&&(f+=i[y-1].dist(i[y]));for(let y=0;y<i.length;y++){const b=g[y];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(t,i,a,c,f,g,y,b,T,C,k,F){const j=t.indexArray,N=t.layoutVertexArray,Z=t.segments.prepareSegment(4*i.length,N,j,this.canOverlap?g.sortKey:void 0),K=this.glyphOffsetArray.length,te=Z.vertexLength,fe=this.allowVerticalPlacement&&y===M.ag.vertical?Math.PI/2:0,ie=g.text&&g.text.sections;for(let B=0;B<i.length;B++){const{tl:H,tr:ae,bl:Ce,br:Ke,tex:ke,pixelOffsetTL:Be,pixelOffsetBR:tt,minFontScaleX:Ye,minFontScaleY:at,glyphOffset:Ue,isSDF:wt,sectionIndex:Gt}=i[B],Zt=Z.vertexLength,At=Ue[1];Al(N,b.x,b.y,H.x,At+H.y,ke.x,ke.y,a,wt,Be.x,Be.y,Ye,at),Al(N,b.x,b.y,ae.x,At+ae.y,ke.x+ke.w,ke.y,a,wt,tt.x,Be.y,Ye,at),Al(N,b.x,b.y,Ce.x,At+Ce.y,ke.x,ke.y+ke.h,a,wt,Be.x,tt.y,Ye,at),Al(N,b.x,b.y,Ke.x,At+Ke.y,ke.x+ke.w,ke.y+ke.h,a,wt,tt.x,tt.y,Ye,at),o(t.dynamicLayoutVertexArray,b,fe),j.emplaceBack(Zt,Zt+2,Zt+1),j.emplaceBack(Zt+1,Zt+2,Zt+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ue[0]),B!==i.length-1&&Gt===i[B+1].sectionIndex||t.programConfigurations.populatePaintArrays(N.length,g,g.index,{},F,ie&&ie[Gt])}t.placedSymbolArray.emplaceBack(b.x,b.y,K,this.glyphOffsetArray.length-K,te,T,C,b.segment,a?a[0]:0,a?a[1]:0,c[0],c[1],y,0,!1,0,k)}_addCollisionDebugVertex(t,i,a,c,f,g){return i.emplaceBack(0,0),t.emplaceBack(a.x,a.y,c,f,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(t,i,a,c,f,g,y){const b=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),T=b.vertexLength,C=f.layoutVertexArray,k=f.collisionVertexArray,F=y.anchorX,j=y.anchorY;this._addCollisionDebugVertex(C,k,g,F,j,new Ge(t,i)),this._addCollisionDebugVertex(C,k,g,F,j,new Ge(a,i)),this._addCollisionDebugVertex(C,k,g,F,j,new Ge(a,c)),this._addCollisionDebugVertex(C,k,g,F,j,new Ge(t,c)),b.vertexLength+=4;const N=f.indexArray;N.emplaceBack(T,T+1),N.emplaceBack(T+1,T+2),N.emplaceBack(T+2,T+3),N.emplaceBack(T+3,T),b.primitiveLength+=4}addDebugCollisionBoxes(t,i,a,c){for(let f=t;f<i;f++){const g=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,c?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new v(je,vh.members,Qe),this.iconCollisionBox=new v(je,vh.members,Qe);for(let t=0;t<this.symbolInstances.length;t++){const i=this.symbolInstances.get(t);this.addDebugCollisionBoxes(i.textBoxStartIndex,i.textBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i,!0),this.addDebugCollisionBoxes(i.iconBoxStartIndex,i.iconBoxEndIndex,i,!1),this.addDebugCollisionBoxes(i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex,i,!1)}}_deserializeCollisionBoxesForSymbol(t,i,a,c,f,g,y,b,T){const C={};for(let k=i;k<a;k++){const F=t.get(k);C.textBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},C.textFeatureIndex=F.featureIndex;break}for(let k=c;k<f;k++){const F=t.get(k);C.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},C.verticalTextFeatureIndex=F.featureIndex;break}for(let k=g;k<y;k++){const F=t.get(k);C.iconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},C.iconFeatureIndex=F.featureIndex;break}for(let k=b;k<T;k++){const F=t.get(k);C.verticalIconBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},C.verticalIconFeatureIndex=F.featureIndex;break}return C}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,i){const a=t.placedSymbolArray.get(i),c=a.vertexStartIndex+4*a.numGlyphs;for(let f=a.vertexStartIndex;f<c;f+=4)t.indexArray.emplaceBack(f,f+2,f+1),t.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const i=Math.sin(t),a=Math.cos(t),c=[],f=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const b=this.symbolInstances.get(y);c.push(0|Math.round(i*b.anchorX+a*b.anchorY)),f.push(b.featureIndex)}return g.sort((y,b)=>c[y]-c[b]||f[b]-f[y]),g}addToSortKeyRanges(t,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((c,f,g)=>{c>=0&&g.indexOf(c)===f&&this.addIndicesForPlacedSymbol(this.text,c)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let I,G;ft("SymbolBucket",S,{omit:["layers","collisionBoxArray","features","compareText"]}),S.MAX_GLYPHS=65535,S.addDynamicAttributes=o;var oe={get paint(){return G=G||new Ln({"icon-opacity":new $t(R.paint_symbol["icon-opacity"]),"icon-color":new $t(R.paint_symbol["icon-color"]),"icon-halo-color":new $t(R.paint_symbol["icon-halo-color"]),"icon-halo-width":new $t(R.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $t(R.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(R.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(R.paint_symbol["icon-translate-anchor"]),"text-opacity":new $t(R.paint_symbol["text-opacity"]),"text-color":new $t(R.paint_symbol["text-color"],{runtimeType:er,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new $t(R.paint_symbol["text-halo-color"]),"text-halo-width":new $t(R.paint_symbol["text-halo-width"]),"text-halo-blur":new $t(R.paint_symbol["text-halo-blur"]),"text-translate":new zt(R.paint_symbol["text-translate"]),"text-translate-anchor":new zt(R.paint_symbol["text-translate-anchor"])})},get layout(){return I=I||new Ln({"symbol-placement":new zt(R.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(R.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(R.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $t(R.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(R.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new zt(R.layout_symbol["icon-allow-overlap"]),"icon-overlap":new zt(R.layout_symbol["icon-overlap"]),"icon-ignore-placement":new zt(R.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(R.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(R.layout_symbol["icon-rotation-alignment"]),"icon-size":new $t(R.layout_symbol["icon-size"]),"icon-text-fit":new zt(R.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new zt(R.layout_symbol["icon-text-fit-padding"]),"icon-image":new $t(R.layout_symbol["icon-image"]),"icon-rotate":new $t(R.layout_symbol["icon-rotate"]),"icon-padding":new $t(R.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(R.layout_symbol["icon-keep-upright"]),"icon-offset":new $t(R.layout_symbol["icon-offset"]),"icon-anchor":new $t(R.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(R.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(R.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(R.layout_symbol["text-rotation-alignment"]),"text-field":new $t(R.layout_symbol["text-field"]),"text-font":new $t(R.layout_symbol["text-font"]),"text-size":new $t(R.layout_symbol["text-size"]),"text-max-width":new $t(R.layout_symbol["text-max-width"]),"text-line-height":new zt(R.layout_symbol["text-line-height"]),"text-letter-spacing":new $t(R.layout_symbol["text-letter-spacing"]),"text-justify":new $t(R.layout_symbol["text-justify"]),"text-radial-offset":new $t(R.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(R.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new $t(R.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new $t(R.layout_symbol["text-anchor"]),"text-max-angle":new zt(R.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(R.layout_symbol["text-writing-mode"]),"text-rotate":new $t(R.layout_symbol["text-rotate"]),"text-padding":new zt(R.layout_symbol["text-padding"]),"text-keep-upright":new zt(R.layout_symbol["text-keep-upright"]),"text-transform":new $t(R.layout_symbol["text-transform"]),"text-offset":new $t(R.layout_symbol["text-offset"]),"text-allow-overlap":new zt(R.layout_symbol["text-allow-overlap"]),"text-overlap":new zt(R.layout_symbol["text-overlap"]),"text-ignore-placement":new zt(R.layout_symbol["text-ignore-placement"]),"text-optional":new zt(R.layout_symbol["text-optional"])})}};class ge{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Vt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(t.formattedSection))return i.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ft("FormatSectionOverride",ge,{omit:["defaultValue"]});class Le extends si{constructor(t){super(t,oe)}recalculate(t,i){if(super.recalculate(t,i),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const c=[];for(const f of a)c.indexOf(f)<0&&c.push(f);this.layout._values["text-writing-mode"]=c}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,i,a,c){const f=this.layout.get(t).evaluate(i,{},a,c),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||nl(g.value)||!f?f:function(y,b){return b.replace(/{([^{}]+)}/g,(T,C)=>y&&C in y?String(y[C]):"")}(i.properties,f)}createBucket(t){return new S(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of oe.paint.overridableProperties){if(!Le.hasPaintOverride(this.layout,t))continue;const i=this.paint.get(t),a=new ge(i),c=new iu(a,i.property.specification);let f=null;f=i.value.kind==="constant"||i.value.kind==="source"?new Ss("source",c):new il("composite",c,i.value.zoomStops),this.paint._values[t]=new xr(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(t,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&Le.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,i){const a=t.get("text-field"),c=oe.paint.properties[i];let f=!1;const g=y=>{for(const b of y)if(c.overrides&&c.overrides.hasOverride(b))return void(f=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Sn)g(a.value.value.sections);else if(a.value.kind==="source"){const y=T=>{f||(T instanceof Zn&&Nr(T.value)===Zr?g(T.value.sections):T instanceof ja?g(T.sections):T.eachChild(y))},b=a.value;b._styleExpression&&y(b._styleExpression.expression)}return f}}let ot;var ct={get paint(){return ot=ot||new Ln({"background-color":new zt(R.paint_background["background-color"]),"background-pattern":new zs(R.paint_background["background-pattern"]),"background-opacity":new zt(R.paint_background["background-opacity"])})}};class it extends si{constructor(t){super(t,ct)}}let It;var Ot={get paint(){return It=It||new Ln({"raster-opacity":new zt(R.paint_raster["raster-opacity"]),"raster-hue-rotate":new zt(R.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(R.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(R.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(R.paint_raster["raster-saturation"]),"raster-contrast":new zt(R.paint_raster["raster-contrast"]),"raster-resampling":new zt(R.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(R.paint_raster["raster-fade-duration"])})}};class jt extends si{constructor(t){super(t,Ot)}}class wn extends si{constructor(t){super(t,{}),this.onAdd=i=>{this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},this.onRemove=i=>{this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Ee{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const ve={once:!0},Ie=63710088e-1;class ht{constructor(t,i){if(isNaN(t)||isNaN(i))throw new Error(`Invalid LngLat object: (${t}, ${i})`);if(this.lng=+t,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ht(ut(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const i=Math.PI/180,a=this.lat*i,c=t.lat*i,f=Math.sin(a)*Math.sin(c)+Math.cos(a)*Math.cos(c)*Math.cos((t.lng-this.lng)*i);return Ie*Math.acos(Math.min(f,1))}static convert(t){if(t instanceof ht)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new ht(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new ht(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ut=2*Math.PI*Ie;function Ht(n){return Ut*Math.cos(n*Math.PI/180)}function Xt(n){return(180+n)/360}function tr(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function Fn(n,t){return n/Ht(t)}function Ir(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}function is(n,t){return n*Ht(Ir(t))}class Dc{constructor(t,i,a=0){this.x=+t,this.y=+i,this.z=+a}static fromLngLat(t,i=0){const a=ht.convert(t);return new Dc(Xt(a.lng),tr(a.lat),Fn(i,a.lat))}toLngLat(){return new ht(360*this.x-180,Ir(this.y))}toAltitude(){return is(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ut*(t=Ir(this.y),1/Math.cos(t*Math.PI/180));var t}}function im(n,t,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[n*a-2*Math.PI*6378137/2,t*a-2*Math.PI*6378137/2]}class Vp{constructor(t,i,a){if(!function(c,f,g){return!(c<0||c>25||g<0||g>=Math.pow(2,c)||f<0||f>=Math.pow(2,c))}(t,i,a))throw new Error(`x=${i}, y=${a}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=i,this.y=a,this.key=Ah(0,t,t,i,a)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,i,a){const c=(g=this.y,y=this.z,b=im(256*(f=this.x),256*(g=Math.pow(2,y)-g-1),y),T=im(256*(f+1),256*(g+1),y),b[0]+","+b[1]+","+T[0]+","+T[1]);var f,g,y,b,T;const C=function(k,F,j){let N,Z="";for(let K=k;K>0;K--)N=1<<K-1,Z+=(F&N?1:0)+(j&N?2:0);return Z}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,i>1?"@2x":"").replace(/{quadkey}/g,C).replace(/{bbox-epsg-3857}/g,c)}isChildOf(t){const i=this.z-t.z;return i>0&&t.x===this.x>>i&&t.y===this.y>>i}getTilePoint(t){const i=Math.pow(2,this.z);return new Ge((t.x*i-this.x)*bt,(t.y*i-this.y)*bt)}toString(){return`${this.z}/${this.x}/${this.y}`}}class om{constructor(t,i){this.wrap=t,this.canonical=i,this.key=Ah(t,i.z,i.z,i.x,i.y)}}class Jo{constructor(t,i,a,c,f){if(this.terrainRttPosMatrix32f=null,t<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${a}`);this.overscaledZ=t,this.wrap=i,this.canonical=new Vp(a,+c,+f),this.key=Ah(i,t,a,c,f)}clone(){return new Jo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const i=this.canonical.z-t;return t>this.canonical.z?new Jo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Jo(t,this.wrap,t,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(t,i){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-t;return t>this.canonical.z?Ah(this.wrap*+i,t,this.canonical.z,this.canonical.x,this.canonical.y):Ah(this.wrap*+i,t,t,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const i=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>i&&t.canonical.y===this.canonical.y>>i}children(t){if(this.overscaledZ>=t)return[new Jo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,c=2*this.canonical.y;return[new Jo(i,this.wrap,i,a,c),new Jo(i,this.wrap,i,a+1,c),new Jo(i,this.wrap,i,a,c+1),new Jo(i,this.wrap,i,a+1,c+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Jo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Jo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new om(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Dc(t.x-this.wrap,t.y))}}function Ah(n,t,i,a,c){(n*=2)<0&&(n=-1*n-1);const f=1<<i;return(f*f*n+f*c+a).toString(36)+i.toString(36)+t.toString(36)}ft("CanonicalTileID",Vp),ft("OverscaledTileID",Jo,{omit:["terrainRttPosMatrix32f"]});class am{constructor(t,i,a,c=1,f=1,g=1,y=0){if(this.uid=t,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void or(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=i.height;const b=this.dim=i.height-2;switch(this.data=new Uint32Array(i.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=c,this.greenFactor=f,this.blueFactor=g,this.baseShift=y;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let T=0;T<b;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(b,T)]=this.data[this._idx(b-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,b)]=this.data[this._idx(T,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let T=0;T<b;T++)for(let C=0;C<b;C++){const k=this.get(T,C);k>this.max&&(this.max=k),k<this.min&&(this.min=k)}}get(t,i){const a=new Uint8Array(this.data.buffer),c=4*this._idx(t,i);return this.unpack(a[c],a[c+1],a[c+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,i){if(t<-1||t>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(t+1)}unpack(t,i,a){return t*this.redFactor+i*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new Fi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,i,a){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let c=i*this.dim,f=i*this.dim+this.dim,g=a*this.dim,y=a*this.dim+this.dim;switch(i){case-1:c=f-1;break;case 1:f=c+1}switch(a){case-1:g=y-1;break;case 1:y=g+1}const b=-i*this.dim,T=-a*this.dim;for(let C=g;C<y;C++)for(let k=c;k<f;k++)this.data[this._idx(k,C)]=t.data[this._idx(k+b,C+T)]}}ft("DEMData",am);class sm{constructor(t){this._stringToNumber={},this._numberToString=[];for(let i=0;i<t.length;i++){const a=t[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class lm{constructor(t,i,a,c,f){this.type="Feature",this._vectorTileFeature=t,t._z=i,t._x=a,t._y=c,this.properties=t.properties,this.id=f}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const i in this)i!=="_geometry"&&i!=="_vectorTileFeature"&&(t[i]=this[i]);return t}}class um{constructor(t,i){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new En(bt,16,0),this.grid3D=new En(bt,16,0),this.featureIndexArray=new Y,this.promoteId=i}insert(t,i,a,c,f,g){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,c,f);const b=g?this.grid3D:this.grid;for(let T=0;T<i.length;T++){const C=i[T],k=[1/0,1/0,-1/0,-1/0];for(let F=0;F<C.length;F++){const j=C[F];k[0]=Math.min(k[0],j.x),k[1]=Math.min(k[1],j.y),k[2]=Math.max(k[2],j.x),k[3]=Math.max(k[3],j.y)}k[0]<bt&&k[1]<bt&&k[2]>=0&&k[3]>=0&&b.insert(y,k[0],k[1],k[2],k[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rs.VectorTile(new yd(this.rawTileData)).layers,this.sourceLayerCoder=new sm(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,i,a,c){this.loadVTLayers();const f=t.params,g=bt/t.tileSize/t.scale,y=ol(f.filter),b=t.queryGeometry,T=t.queryPadding*g,C=hm(b),k=this.grid.query(C.minX-T,C.minY-T,C.maxX+T,C.maxY+T),F=hm(t.cameraQueryGeometry),j=this.grid3D.query(F.minX-T,F.minY-T,F.maxX+T,F.maxY+T,(K,te,fe,ie)=>function(B,H,ae,Ce,Ke){for(const Be of B)if(H<=Be.x&&ae<=Be.y&&Ce>=Be.x&&Ke>=Be.y)return!0;const ke=[new Ge(H,ae),new Ge(H,Ke),new Ge(Ce,Ke),new Ge(Ce,ae)];if(B.length>2){for(const Be of ke)if(Xo(B,Be))return!0}for(let Be=0;Be<B.length-1;Be++)if(Kh(B[Be],B[Be+1],ke))return!0;return!1}(t.cameraQueryGeometry,K-T,te-T,fe+T,ie+T));for(const K of j)k.push(K);k.sort(X_);const N={};let Z;for(let K=0;K<k.length;K++){const te=k[K];if(te===Z)continue;Z=te;const fe=this.featureIndexArray.get(te);let ie=null;this.loadMatchingFeature(N,fe.bucketIndex,fe.sourceLayerIndex,fe.featureIndex,y,f.layers,f.availableImages,i,a,c,(B,H,ae)=>(ie||(ie=Ma(B)),H.queryIntersectsFeature({queryGeometry:b,feature:B,featureState:ae,geometry:ie,zoom:this.z,transform:t.transform,pixelsToTileUnits:g,pixelPosMatrix:t.pixelPosMatrix})))}return N}loadMatchingFeature(t,i,a,c,f,g,y,b,T,C,k){const F=this.bucketLayerIDs[i];if(g&&!F.some(K=>g.has(K)))return;const j=this.sourceLayerCoder.decode(a),N=this.vtLayers[j].feature(c);if(f.needGeometry){const K=Si(N,!0);if(!f.filter(new Sr(this.tileID.overscaledZ),K,this.tileID.canonical))return}else if(!f.filter(new Sr(this.tileID.overscaledZ),N))return;const Z=this.getId(N,j);for(let K=0;K<F.length;K++){const te=F[K];if(g&&!g.has(te))continue;const fe=b[te];if(!fe)continue;let ie={};Z&&C&&(ie=C.getState(fe.sourceLayer||"_geojsonTileLayer",Z));const B=Xe({},T[te]);B.paint=cm(B.paint,fe.paint,N,ie,y),B.layout=cm(B.layout,fe.layout,N,ie,y);const H=!k||k(N,fe,ie);if(!H)continue;const ae=new lm(N,this.z,this.x,this.y,Z);ae.layer=B;let Ce=t[te];Ce===void 0&&(Ce=t[te]=[]),Ce.push({featureIndex:c,feature:ae,intersectionZ:H})}}lookupSymbolFeatures(t,i,a,c,f,g,y,b){const T={};this.loadVTLayers();const C=ol(f);for(const k of t)this.loadMatchingFeature(T,a,c,k,C,g,y,b,i);return T}hasLayer(t){for(const i of this.bucketLayerIDs)for(const a of i)if(t===a)return!0;return!1}getId(t,i){var a;let c=t.id;return this.promoteId&&(c=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[i]],typeof c=="boolean"&&(c=Number(c)),c===void 0&&(!((a=t.properties)===null||a===void 0)&&a.cluster)&&this.promoteId&&(c=Number(t.properties.cluster_id))),c}}function cm(n,t,i,a,c){return xt(n,(f,g)=>{const y=t instanceof xi?t.get(g):null;return y&&y.evaluate?y.evaluate(i,a,c):y})}function hm(n){let t=1/0,i=1/0,a=-1/0,c=-1/0;for(const f of n)t=Math.min(t,f.x),i=Math.min(i,f.y),a=Math.max(a,f.x),c=Math.max(c,f.y);return{minX:t,minY:i,maxX:a,maxY:c}}function X_(n,t){return t-n}function dm(n,t,i,a,c){const f=[];for(let g=0;g<n.length;g++){const y=n[g];let b;for(let T=0;T<y.length-1;T++){let C=y[T],k=y[T+1];C.x<t&&k.x<t||(C.x<t?C=new Ge(t,C.y+(t-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x<t&&(k=new Ge(t,C.y+(t-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y<i&&k.y<i||(C.y<i?C=new Ge(C.x+(i-C.y)/(k.y-C.y)*(k.x-C.x),i)._round():k.y<i&&(k=new Ge(C.x+(i-C.y)/(k.y-C.y)*(k.x-C.x),i)._round()),C.x>=a&&k.x>=a||(C.x>=a?C=new Ge(a,C.y+(a-C.x)/(k.x-C.x)*(k.y-C.y))._round():k.x>=a&&(k=new Ge(a,C.y+(a-C.x)/(k.x-C.x)*(k.y-C.y))._round()),C.y>=c&&k.y>=c||(C.y>=c?C=new Ge(C.x+(c-C.y)/(k.y-C.y)*(k.x-C.x),c)._round():k.y>=c&&(k=new Ge(C.x+(c-C.y)/(k.y-C.y)*(k.x-C.x),c)._round()),b&&C.equals(b[b.length-1])||(b=[C],f.push(b)),b.push(k)))))}}return f}ft("FeatureIndex",um,{omit:["rawTileData","sourceLayerCoder"]});class zu extends Ge{constructor(t,i,a,c){super(t,i),this.angle=a,c!==void 0&&(this.segment=c)}clone(){return new zu(this.x,this.y,this.angle,this.segment)}}function pm(n,t,i,a,c){if(t.segment===void 0||i===0)return!0;let f=t,g=t.segment+1,y=0;for(;y>-i/2;){if(g--,g<0)return!1;y-=n[g].dist(f),f=n[g]}y+=n[g].dist(n[g+1]),g++;const b=[];let T=0;for(;y<i/2;){const C=n[g],k=n[g+1];if(!k)return!1;let F=n[g-1].angleTo(C)-C.angleTo(k);for(F=Math.abs((F+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:y,angleDelta:F}),T+=F;y-b[0].distance>a;)T-=b.shift().angleDelta;if(T>c)return!1;g++,y+=C.dist(k)}return!0}function fm(n){let t=0;for(let i=0;i<n.length-1;i++)t+=n[i].dist(n[i+1]);return t}function mm(n,t,i){return n?.6*t*i:0}function gm(n,t){return Math.max(n?n.right-n.left:0,t?t.right-t.left:0)}function K_(n,t,i,a,c,f){const g=mm(i,c,f),y=gm(i,a)*f;let b=0;const T=fm(n)/2;for(let C=0;C<n.length-1;C++){const k=n[C],F=n[C+1],j=k.dist(F);if(b+j>T){const N=(T-b)/j,Z=qn.number(k.x,F.x,N),K=qn.number(k.y,F.y,N),te=new zu(Z,K,F.angleTo(k),C);return te._round(),!g||pm(n,te,y,g,t)?te:void 0}b+=j}}function Y_(n,t,i,a,c,f,g,y,b){const T=mm(a,f,g),C=gm(a,c),k=C*g,F=n[0].x===0||n[0].x===b||n[0].y===0||n[0].y===b;return t-k<t/4&&(t=k+t/4),_m(n,F?t/2*y%t:(C/2+2*f)*g*y%t,t,T,i,k,F,!1,b)}function _m(n,t,i,a,c,f,g,y,b){const T=f/2,C=fm(n);let k=0,F=t-i,j=[];for(let N=0;N<n.length-1;N++){const Z=n[N],K=n[N+1],te=Z.dist(K),fe=K.angleTo(Z);for(;F+i<k+te;){F+=i;const ie=(F-k)/te,B=qn.number(Z.x,K.x,ie),H=qn.number(Z.y,K.y,ie);if(B>=0&&B<b&&H>=0&&H<b&&F-T>=0&&F+T<=C){const ae=new zu(B,H,fe,N);ae._round(),a&&!pm(n,ae,f,a,c)||j.push(ae)}}k+=te}return y||j.length||g||(j=_m(n,k/2,i,a,c,f,g,!0,b)),j}ft("Anchor",zu);const Td=ji;function ym(n,t,i,a){const c=[],f=n.image,g=f.pixelRatio,y=f.paddedRect.w-2*Td,b=f.paddedRect.h-2*Td;let T={x1:n.left,y1:n.top,x2:n.right,y2:n.bottom};const C=f.stretchX||[[0,y]],k=f.stretchY||[[0,b]],F=(Ue,wt)=>Ue+wt[1]-wt[0],j=C.reduce(F,0),N=k.reduce(F,0),Z=y-j,K=b-N;let te=0,fe=j,ie=0,B=N,H=0,ae=Z,Ce=0,Ke=K;if(f.content&&a){const Ue=f.content,wt=Ue[2]-Ue[0],Gt=Ue[3]-Ue[1];(f.textFitWidth||f.textFitHeight)&&(T=Ac(n)),te=lp(C,0,Ue[0]),ie=lp(k,0,Ue[1]),fe=lp(C,Ue[0],Ue[2]),B=lp(k,Ue[1],Ue[3]),H=Ue[0]-te,Ce=Ue[1]-ie,ae=wt-fe,Ke=Gt-B}const ke=T.x1,Be=T.y1,tt=T.x2-ke,Ye=T.y2-Be,at=(Ue,wt,Gt,Zt)=>{const At=up(Ue.stretch-te,fe,tt,ke),mr=cp(Ue.fixed-H,ae,Ue.stretch,j),nn=up(wt.stretch-ie,B,Ye,Be),Bn=cp(wt.fixed-Ce,Ke,wt.stretch,N),ki=up(Gt.stretch-te,fe,tt,ke),ea=cp(Gt.fixed-H,ae,Gt.stretch,j),xo=up(Zt.stretch-ie,B,Ye,Be),ui=cp(Zt.fixed-Ce,Ke,Zt.stretch,N),en=new Ge(At,nn),Kn=new Ge(ki,nn),ci=new Ge(ki,xo),hi=new Ge(At,xo),oo=new Ge(mr/g,Bn/g),ta=new Ge(ea/g,ui/g),Yn=t*Math.PI/180;if(Yn){const Qn=Math.sin(Yn),Jn=Math.cos(Yn),An=[Jn,-Qn,Qn,Jn];en._matMult(An),Kn._matMult(An),hi._matMult(An),ci._matMult(An)}const bo=Ue.stretch+Ue.fixed,jn=wt.stretch+wt.fixed;return{tl:en,tr:Kn,bl:hi,br:ci,tex:{x:f.paddedRect.x+Td+bo,y:f.paddedRect.y+Td+jn,w:Gt.stretch+Gt.fixed-bo,h:Zt.stretch+Zt.fixed-jn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:oo,pixelOffsetBR:ta,minFontScaleX:ae/g/tt,minFontScaleY:Ke/g/Ye,isSDF:i}};if(a&&(f.stretchX||f.stretchY)){const Ue=vm(C,Z,j),wt=vm(k,K,N);for(let Gt=0;Gt<Ue.length-1;Gt++){const Zt=Ue[Gt],At=Ue[Gt+1];for(let mr=0;mr<wt.length-1;mr++)c.push(at(Zt,wt[mr],At,wt[mr+1]))}}else c.push(at({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:b+1}));return c}function lp(n,t,i){let a=0;for(const c of n)a+=Math.max(t,Math.min(i,c[1]))-Math.max(t,Math.min(i,c[0]));return a}function vm(n,t,i){const a=[{fixed:-1,stretch:0}];for(const[c,f]of n){const g=a[a.length-1];a.push({fixed:c-g.stretch,stretch:g.stretch}),a.push({fixed:c-g.stretch,stretch:g.stretch+(f-c)})}return a.push({fixed:t+Td,stretch:i}),a}function up(n,t,i,a){return n/t*i+a}function cp(n,t,i,a){return n-t*i/a}class hp{constructor(t,i,a,c,f,g,y,b,T,C){var k;if(this.boxStartIndex=t.length,T){let F=g.top,j=g.bottom;const N=g.collisionPadding;N&&(F-=N[1],j+=N[3]);let Z=j-F;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const F=!((k=g.image)===null||k===void 0)&&k.content&&(g.image.textFitWidth||g.image.textFitHeight)?Ac(g):{x1:g.left,y1:g.top,x2:g.right,y2:g.bottom};F.y1=F.y1*y-b[0],F.y2=F.y2*y+b[2],F.x1=F.x1*y-b[3],F.x2=F.x2*y+b[1];const j=g.collisionPadding;if(j&&(F.x1-=j[0]*y,F.y1-=j[1]*y,F.x2+=j[2]*y,F.y2+=j[3]*y),C){const N=new Ge(F.x1,F.y1),Z=new Ge(F.x2,F.y1),K=new Ge(F.x1,F.y2),te=new Ge(F.x2,F.y2),fe=C*Math.PI/180;N._rotate(fe),Z._rotate(fe),K._rotate(fe),te._rotate(fe),F.x1=Math.min(N.x,Z.x,K.x,te.x),F.x2=Math.max(N.x,Z.x,K.x,te.x),F.y1=Math.min(N.y,Z.y,K.y,te.y),F.y2=Math.max(N.y,Z.y,K.y,te.y)}t.emplaceBack(i.x,i.y,F.x1,F.y1,F.x2,F.y2,a,c,f)}this.boxEndIndex=t.length}}class Q_{constructor(t=[],i=(a,c)=>a<c?-1:a>c?1:0){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:a}=this,c=i[t];for(;t>0;){const f=t-1>>1,g=i[f];if(a(c,g)>=0)break;i[t]=g,t=f}i[t]=c}_down(t){const{data:i,compare:a}=this,c=this.length>>1,f=i[t];for(;t<c;){let g=1+(t<<1);const y=g+1;if(y<this.length&&a(i[y],i[g])<0&&(g=y),a(i[g],f)>=0)break;i[t]=i[g],t=g}i[t]=f}}function J_(n,t=1,i=!1){let a=1/0,c=1/0,f=-1/0,g=-1/0;const y=n[0];for(let j=0;j<y.length;j++){const N=y[j];(!j||N.x<a)&&(a=N.x),(!j||N.y<c)&&(c=N.y),(!j||N.x>f)&&(f=N.x),(!j||N.y>g)&&(g=N.y)}const b=Math.min(f-a,g-c);let T=b/2;const C=new Q_([],ey);if(b===0)return new Ge(a,c);for(let j=a;j<f;j+=b)for(let N=c;N<g;N+=b)C.push(new zh(j+T,N+T,T,n));let k=function(j){let N=0,Z=0,K=0;const te=j[0];for(let fe=0,ie=te.length,B=ie-1;fe<ie;B=fe++){const H=te[fe],ae=te[B],Ce=H.x*ae.y-ae.x*H.y;Z+=(H.x+ae.x)*Ce,K+=(H.y+ae.y)*Ce,N+=3*Ce}return new zh(Z/N,K/N,0,j)}(n),F=C.length;for(;C.length;){const j=C.pop();(j.d>k.d||!k.d)&&(k=j,i&&console.log("found best %d after %d probes",Math.round(1e4*j.d)/1e4,F)),j.max-k.d<=t||(T=j.h/2,C.push(new zh(j.p.x-T,j.p.y-T,T,n)),C.push(new zh(j.p.x+T,j.p.y-T,T,n)),C.push(new zh(j.p.x-T,j.p.y+T,T,n)),C.push(new zh(j.p.x+T,j.p.y+T,T,n)),F+=4)}return i&&(console.log(`num probes: ${F}`),console.log(`best distance: ${k.d}`)),k.p}function ey(n,t){return t.max-n.max}function zh(n,t,i,a){this.p=new Ge(n,t),this.h=i,this.d=function(c,f){let g=!1,y=1/0;for(let b=0;b<f.length;b++){const T=f[b];for(let C=0,k=T.length,F=k-1;C<k;F=C++){const j=T[C],N=T[F];j.y>c.y!=N.y>c.y&&c.x<(N.x-j.x)*(c.y-j.y)/(N.y-j.y)+j.x&&(g=!g),y=Math.min(y,Xh(c,j,N))}}return(g?1:-1)*Math.sqrt(y)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var Mi;M.ax=void 0,(Mi=M.ax||(M.ax={}))[Mi.center=1]="center",Mi[Mi.left=2]="left",Mi[Mi.right=3]="right",Mi[Mi.top=4]="top",Mi[Mi.bottom=5]="bottom",Mi[Mi["top-left"]=6]="top-left",Mi[Mi["top-right"]=7]="top-right",Mi[Mi["bottom-left"]=8]="bottom-left",Mi[Mi["bottom-right"]=9]="bottom-right";const Ru=7,$p=Number.POSITIVE_INFINITY;function xm(n,t){return t[1]!==$p?function(i,a,c){let f=0,g=0;switch(a=Math.abs(a),c=Math.abs(c),i){case"top-right":case"top-left":case"top":g=c-Ru;break;case"bottom-right":case"bottom-left":case"bottom":g=-c+Ru}switch(i){case"top-right":case"bottom-right":case"right":f=-a;break;case"top-left":case"bottom-left":case"left":f=a}return[f,g]}(n,t[0],t[1]):function(i,a){let c=0,f=0;a<0&&(a=0);const g=a/Math.SQRT2;switch(i){case"top-right":case"top-left":f=g-Ru;break;case"bottom-right":case"bottom-left":f=-g+Ru;break;case"bottom":f=-a+Ru;break;case"top":f=a-Ru}switch(i){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=a;break;case"right":c=-a}return[c,f]}(n,t[0])}function bm(n,t,i){var a;const c=n.layout,f=(a=c.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(t,{},i);if(f){const y=f.values,b=[];for(let T=0;T<y.length;T+=2){const C=b[T]=y[T],k=y[T+1].map(F=>F*bn);C.startsWith("top")?k[1]-=Ru:C.startsWith("bottom")&&(k[1]+=Ru),b[T+1]=k}return new hn(b)}const g=c.get("text-variable-anchor");if(g){let y;y=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[c.get("text-radial-offset").evaluate(t,{},i)*bn,$p]:c.get("text-offset").evaluate(t,{},i).map(T=>T*bn);const b=[];for(const T of g)b.push(T,xm(T,y));return new hn(b)}return null}function Up(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ty(n,t,i,a,c,f,g,y,b,T,C,k){let F=f.textMaxSize.evaluate(t,{});F===void 0&&(F=g);const j=n.layers[0].layout,N=j.get("icon-offset").evaluate(t,{},C),Z=Tm(i.horizontal),K=g/24,te=n.tilePixelRatio*K,fe=n.tilePixelRatio*F/24,ie=n.tilePixelRatio*y,B=n.tilePixelRatio*j.get("symbol-spacing"),H=j.get("text-padding")*n.tilePixelRatio,ae=function(Gt,Zt,At,mr=1){const nn=Gt.get("icon-padding").evaluate(Zt,{},At),Bn=nn&&nn.values;return[Bn[0]*mr,Bn[1]*mr,Bn[2]*mr,Bn[3]*mr]}(j,t,C,n.tilePixelRatio),Ce=j.get("text-max-angle")/180*Math.PI,Ke=j.get("text-rotation-alignment")!=="viewport"&&j.get("symbol-placement")!=="point",ke=j.get("icon-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",Be=j.get("symbol-placement"),tt=B/2,Ye=j.get("icon-text-fit");let at;a&&Ye!=="none"&&(n.allowVerticalPlacement&&i.vertical&&(at=kh(a,i.vertical,Ye,j.get("icon-text-fit-padding"),N,K)),Z&&(a=kh(a,Z,Ye,j.get("icon-text-fit-padding"),N,K)));const Ue=C?k.line.getGranularityForZoomLevel(C.z):1,wt=(Gt,Zt)=>{Zt.x<0||Zt.x>=bt||Zt.y<0||Zt.y>=bt||function(At,mr,nn,Bn,ki,ea,xo,ui,en,Kn,ci,hi,oo,ta,Yn,bo,jn,Qn,Jn,An,Yr,os,Rh,as,iy){const Dh=At.addToLineVertexArray(mr,nn);let Lc,Lh,Oh,Fh,Em=0,Im=0,Mm=0,km=0,Yp=-1,Qp=-1;const zl={};let Am=an("");if(At.allowVerticalPlacement&&Bn.vertical){const Vi=ui.layout.get("text-rotate").evaluate(Yr,{},as)+90;Oh=new hp(en,mr,Kn,ci,hi,Bn.vertical,oo,ta,Yn,Vi),xo&&(Fh=new hp(en,mr,Kn,ci,hi,xo,jn,Qn,Yn,Vi))}if(ki){const Vi=ui.layout.get("icon-rotate").evaluate(Yr,{}),ra=ui.layout.get("icon-text-fit")!=="none",Oc=ym(ki,Vi,Rh,ra),ls=xo?ym(xo,Vi,Rh,ra):void 0;Lh=new hp(en,mr,Kn,ci,hi,ki,jn,Qn,!1,Vi),Em=4*Oc.length;const Fc=At.iconSizeData;let Us=null;Fc.kind==="source"?(Us=[Qo*ui.layout.get("icon-size").evaluate(Yr,{})],Us[0]>$s&&or(`${At.layerIds[0]}: Value for "icon-size" is >= ${Vs}. Reduce your "icon-size".`)):Fc.kind==="composite"&&(Us=[Qo*os.compositeIconSizes[0].evaluate(Yr,{},as),Qo*os.compositeIconSizes[1].evaluate(Yr,{},as)],(Us[0]>$s||Us[1]>$s)&&or(`${At.layerIds[0]}: Value for "icon-size" is >= ${Vs}. Reduce your "icon-size".`)),At.addSymbols(At.icon,Oc,Us,An,Jn,Yr,M.ag.none,mr,Dh.lineStartIndex,Dh.lineLength,-1,as),Yp=At.icon.placedSymbolArray.length-1,ls&&(Im=4*ls.length,At.addSymbols(At.icon,ls,Us,An,Jn,Yr,M.ag.vertical,mr,Dh.lineStartIndex,Dh.lineLength,-1,as),Qp=At.icon.placedSymbolArray.length-1)}const zm=Object.keys(Bn.horizontal);for(const Vi of zm){const ra=Bn.horizontal[Vi];if(!Lc){Am=an(ra.text);const ls=ui.layout.get("text-rotate").evaluate(Yr,{},as);Lc=new hp(en,mr,Kn,ci,hi,ra,oo,ta,Yn,ls)}const Oc=ra.positionedLines.length===1;if(Mm+=wm(At,mr,ra,ea,ui,Yn,Yr,bo,Dh,Bn.vertical?M.ag.horizontal:M.ag.horizontalOnly,Oc?zm:[Vi],zl,Yp,os,as),Oc)break}Bn.vertical&&(km+=wm(At,mr,Bn.vertical,ea,ui,Yn,Yr,bo,Dh,M.ag.vertical,["vertical"],zl,Qp,os,as));const oy=Lc?Lc.boxStartIndex:At.collisionBoxArray.length,ay=Lc?Lc.boxEndIndex:At.collisionBoxArray.length,sy=Oh?Oh.boxStartIndex:At.collisionBoxArray.length,ly=Oh?Oh.boxEndIndex:At.collisionBoxArray.length,uy=Lh?Lh.boxStartIndex:At.collisionBoxArray.length,cy=Lh?Lh.boxEndIndex:At.collisionBoxArray.length,hy=Fh?Fh.boxStartIndex:At.collisionBoxArray.length,dy=Fh?Fh.boxEndIndex:At.collisionBoxArray.length;let ss=-1;const pp=(Vi,ra)=>Vi&&Vi.circleDiameter?Math.max(Vi.circleDiameter,ra):ra;ss=pp(Lc,ss),ss=pp(Oh,ss),ss=pp(Lh,ss),ss=pp(Fh,ss);const Rm=ss>-1?1:0;Rm&&(ss*=iy/bn),At.glyphOffsetArray.length>=S.MAX_GLYPHS&&or("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Yr.sortKey!==void 0&&At.addToSortKeyRanges(At.symbolInstances.length,Yr.sortKey);const py=bm(ui,Yr,as),[fy,my]=function(Vi,ra){const Oc=Vi.length,ls=ra==null?void 0:ra.values;if((ls==null?void 0:ls.length)>0)for(let Fc=0;Fc<ls.length;Fc+=2){const Us=ls[Fc+1];Vi.emplaceBack(M.ax[ls[Fc]],Us[0],Us[1])}return[Oc,Vi.length]}(At.textAnchorOffsets,py);At.symbolInstances.emplaceBack(mr.x,mr.y,zl.right>=0?zl.right:-1,zl.center>=0?zl.center:-1,zl.left>=0?zl.left:-1,zl.vertical||-1,Yp,Qp,Am,oy,ay,sy,ly,uy,cy,hy,dy,Kn,Mm,km,Em,Im,Rm,0,oo,ss,fy,my)}(n,Zt,Gt,i,a,c,at,n.layers[0],n.collisionBoxArray,t.index,t.sourceLayerIndex,n.index,te,[H,H,H,H],Ke,b,ie,ae,ke,N,t,f,T,C,g)};if(Be==="line")for(const Gt of dm(t.geometry,0,0,bt,bt)){const Zt=li(Gt,Ue),At=Y_(Zt,B,Ce,i.vertical||Z,a,24,fe,n.overscaling,bt);for(const mr of At)Z&&ry(n,Z.text,tt,mr)||wt(Zt,mr)}else if(Be==="line-center"){for(const Gt of t.geometry)if(Gt.length>1){const Zt=li(Gt,Ue),At=K_(Zt,Ce,i.vertical||Z,a,24,fe);At&&wt(Zt,At)}}else if(t.type==="Polygon")for(const Gt of xs(t.geometry,0)){const Zt=J_(Gt,16);wt(li(Gt[0],Ue,!0),new zu(Zt.x,Zt.y,0))}else if(t.type==="LineString")for(const Gt of t.geometry){const Zt=li(Gt,Ue);wt(Zt,new zu(Zt[0].x,Zt[0].y,0))}else if(t.type==="Point")for(const Gt of t.geometry)for(const Zt of Gt)wt([Zt],new zu(Zt.x,Zt.y,0))}function wm(n,t,i,a,c,f,g,y,b,T,C,k,F,j,N){const Z=function(fe,ie,B,H,ae,Ce,Ke,ke){const Be=H.layout.get("text-rotate").evaluate(Ce,{})*Math.PI/180,tt=[];for(const Ye of ie.positionedLines)for(const at of Ye.positionedGlyphs){if(!at.rect)continue;const Ue=at.rect||{};let wt=np+1,Gt=!0,Zt=1,At=0;const mr=(ae||ke)&&at.vertical,nn=at.metrics.advance*at.scale/2;if(ke&&ie.verticalizable&&(At=Ye.lineOffset/2-(at.imageName?-(bn-at.metrics.width*at.scale)/2:(at.scale-1)*bn)),at.imageName){const Qn=Ke[at.imageName];Gt=Qn.sdf,Zt=Qn.pixelRatio,wt=ji/Zt}const Bn=ae?[at.x+nn,at.y]:[0,0];let ki=ae?[0,0]:[at.x+nn+B[0],at.y+B[1]-At],ea=[0,0];mr&&(ea=ki,ki=[0,0]);const xo=at.metrics.isDoubleResolution?2:1,ui=(at.metrics.left-wt)*at.scale-nn+ki[0],en=(-at.metrics.top-wt)*at.scale+ki[1],Kn=ui+Ue.w/xo*at.scale/Zt,ci=en+Ue.h/xo*at.scale/Zt,hi=new Ge(ui,en),oo=new Ge(Kn,en),ta=new Ge(ui,ci),Yn=new Ge(Kn,ci);if(mr){const Qn=new Ge(-nn,nn-Ni),Jn=-Math.PI/2,An=bn/2-nn,Yr=new Ge(5-Ni-An,-(at.imageName?An:0)),os=new Ge(...ea);hi._rotateAround(Jn,Qn)._add(Yr)._add(os),oo._rotateAround(Jn,Qn)._add(Yr)._add(os),ta._rotateAround(Jn,Qn)._add(Yr)._add(os),Yn._rotateAround(Jn,Qn)._add(Yr)._add(os)}if(Be){const Qn=Math.sin(Be),Jn=Math.cos(Be),An=[Jn,-Qn,Qn,Jn];hi._matMult(An),oo._matMult(An),ta._matMult(An),Yn._matMult(An)}const bo=new Ge(0,0),jn=new Ge(0,0);tt.push({tl:hi,tr:oo,bl:ta,br:Yn,tex:Ue,writingMode:ie.writingMode,glyphOffset:Bn,sectionIndex:at.sectionIndex,isSDF:Gt,pixelOffsetTL:bo,pixelOffsetBR:jn,minFontScaleX:0,minFontScaleY:0})}return tt}(0,i,y,c,f,g,a,n.allowVerticalPlacement),K=n.textSizeData;let te=null;K.kind==="source"?(te=[Qo*c.layout.get("text-size").evaluate(g,{})],te[0]>$s&&or(`${n.layerIds[0]}: Value for "text-size" is >= ${Vs}. Reduce your "text-size".`)):K.kind==="composite"&&(te=[Qo*j.compositeTextSizes[0].evaluate(g,{},N),Qo*j.compositeTextSizes[1].evaluate(g,{},N)],(te[0]>$s||te[1]>$s)&&or(`${n.layerIds[0]}: Value for "text-size" is >= ${Vs}. Reduce your "text-size".`)),n.addSymbols(n.text,Z,te,y,f,g,T,t,b.lineStartIndex,b.lineLength,F,N);for(const fe of C)k[fe]=n.text.placedSymbolArray.length-1;return 4*Z.length}function Tm(n){for(const t in n)return n[t];return null}function ry(n,t,i,a){const c=n.compareText;if(t in c){const f=c[t];for(let g=f.length-1;g>=0;g--)if(a.dist(f[g])<i)return!0}else c[t]=[];return c[t].push(a),!1}const Sm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Zp{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(t,0,2);if(i!==219)throw new Error("Data does not appear to be in a KDBush format.");const c=a>>4;if(c!==1)throw new Error(`Got v${c} data when expected v1.`);const f=Sm[15&a];if(!f)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[y]=new Uint32Array(t,4,1);return new Zp(y,g,f,t)}constructor(t,i=64,a=Float64Array,c){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const f=Sm.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,y=t*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-y%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${a}.`);c&&c instanceof ArrayBuffer?(this.data=c,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+y+b,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+y+b),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+y+b,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=t)}add(t,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=t,this.coords[this._pos++]=i,a}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Gp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,i,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:g,nodeSize:y}=this,b=[0,f.length-1,0],T=[];for(;b.length;){const C=b.pop()||0,k=b.pop()||0,F=b.pop()||0;if(k-F<=y){for(let K=F;K<=k;K++){const te=g[2*K],fe=g[2*K+1];te>=t&&te<=a&&fe>=i&&fe<=c&&T.push(f[K])}continue}const j=F+k>>1,N=g[2*j],Z=g[2*j+1];N>=t&&N<=a&&Z>=i&&Z<=c&&T.push(f[j]),(C===0?t<=N:i<=Z)&&(b.push(F),b.push(j-1),b.push(1-C)),(C===0?a>=N:c>=Z)&&(b.push(j+1),b.push(k),b.push(1-C))}return T}within(t,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:c,coords:f,nodeSize:g}=this,y=[0,c.length-1,0],b=[],T=a*a;for(;y.length;){const C=y.pop()||0,k=y.pop()||0,F=y.pop()||0;if(k-F<=g){for(let K=F;K<=k;K++)Cm(f[2*K],f[2*K+1],t,i)<=T&&b.push(c[K]);continue}const j=F+k>>1,N=f[2*j],Z=f[2*j+1];Cm(N,Z,t,i)<=T&&b.push(c[j]),(C===0?t-a<=N:i-a<=Z)&&(y.push(F),y.push(j-1),y.push(1-C)),(C===0?t+a>=N:i+a>=Z)&&(y.push(j+1),y.push(k),y.push(1-C))}return b}}function Gp(n,t,i,a,c,f){if(c-a<=i)return;const g=a+c>>1;Pm(n,t,g,a,c,f),Gp(n,t,i,a,g-1,1-f),Gp(n,t,i,g+1,c,1-f)}function Pm(n,t,i,a,c,f){for(;c>a;){if(c-a>600){const T=c-a+1,C=i-a+1,k=Math.log(T),F=.5*Math.exp(2*k/3),j=.5*Math.sqrt(k*F*(T-F)/T)*(C-T/2<0?-1:1);Pm(n,t,i,Math.max(a,Math.floor(i-C*F/T+j)),Math.min(c,Math.floor(i+(T-C)*F/T+j)),f)}const g=t[2*i+f];let y=a,b=c;for(Sd(n,t,a,i),t[2*c+f]>g&&Sd(n,t,a,c);y<b;){for(Sd(n,t,y,b),y++,b--;t[2*y+f]<g;)y++;for(;t[2*b+f]>g;)b--}t[2*a+f]===g?Sd(n,t,a,b):(b++,Sd(n,t,b,c)),b<=i&&(a=b+1),i<=b&&(c=b-1)}}function Sd(n,t,i,a){qp(n,i,a),qp(t,2*i,2*a),qp(t,2*i+1,2*a+1)}function qp(n,t,i){const a=n[t];n[t]=n[i],n[i]=a}function Cm(n,t,i,a){const c=n-i,f=t-a;return c*c+f*f}var Wp;M.cg=void 0,(Wp=M.cg||(M.cg={})).create="create",Wp.load="load",Wp.fullLoad="fullLoad";let dp=null,Pd=[];const Hp=1e3/60,Xp="loadTime",Kp="fullLoadTime",ny={mark(n){performance.mark(n)},frame(n){const t=n;dp!=null&&Pd.push(t-dp),dp=t},clearMetrics(){dp=null,Pd=[],performance.clearMeasures(Xp),performance.clearMeasures(Kp);for(const n in M.cg)performance.clearMarks(M.cg[n])},getPerformanceMetrics(){performance.measure(Xp,M.cg.create,M.cg.load),performance.measure(Kp,M.cg.create,M.cg.fullLoad);const n=performance.getEntriesByName(Xp)[0].duration,t=performance.getEntriesByName(Kp)[0].duration,i=Pd.length,a=1/(Pd.reduce((f,g)=>f+g,0)/i/1e3),c=Pd.filter(f=>f>Hp).reduce((f,g)=>f+(g-Hp)/Hp,0);return{loadTime:n,fullLoadTime:t,fps:a,percentDroppedFrames:c/(i+c)*100,totalFrames:i}}};M.$=Dc,M.A=pt,M.B=qn,M.C=Sr,M.D=zt,M.E=xe,M.F=qr,M.G=function(n){if(Ar==null){const t=n.navigator?n.navigator.userAgent:null;Ar=!!n.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return Ar},M.H=class{constructor(n,t){this.target=n,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Ee(()=>this.process()),this.subscription=zn(this.target,"message",i=>this.receive(i),!1),this.globalScope=kr(self)?n:window}registerMessageHandler(n,t){this.messageHandlers[n]=t}sendAsync(n,t){return new Promise((i,a)=>{const c=Math.round(1e18*Math.random()).toString(36).substring(0,10),f=t?zn(t.signal,"abort",()=>{f==null||f.unsubscribe(),delete this.resolveRejects[c];const b={id:c,type:"<cancel>",origin:location.origin,targetMapId:n.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},ve):null;this.resolveRejects[c]={resolve:b=>{f==null||f.unsubscribe(),i(b)},reject:b=>{f==null||f.unsubscribe(),a(b)}};const g=[],y=Object.assign(Object.assign({},n),{id:c,sourceMapId:this.mapId,origin:location.origin,data:Go(n.data,g)});this.target.postMessage(y,{transfer:g})})}receive(n){const t=n.data,i=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[i];const a=this.abortControllers[i];return delete this.abortControllers[i],void(a&&a.abort())}if(kr(self)||t.mustQueue)return this.tasks[i]=t,this.taskQueue.push(i),void this.invoker.trigger();this.processTask(i,t)}}process(){if(this.taskQueue.length===0)return;const n=this.taskQueue.shift(),t=this.tasks[n];delete this.tasks[n],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(n,t)}processTask(n,t){return h(this,void 0,void 0,function*(){if(t.type==="<response>"){const c=this.resolveRejects[n];return delete this.resolveRejects[n],c?void(t.error?c.reject(ba(t.error)):c.resolve(ba(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(n,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const i=ba(t.data),a=new AbortController;this.abortControllers[n]=a;try{const c=yield this.messageHandlers[t.type](t.sourceMapId,i,a);this.completeTask(n,null,c)}catch(c){this.completeTask(n,c)}})}completeTask(n,t,i){const a=[];delete this.abortControllers[n];const c={id:n,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Go(t):null,data:Go(i,a)};this.target.postMessage(c,{transfer:a})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},M.I=wh,M.J=Zi,M.K=function(){var n=new pt(16);return pt!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},M.L=function(n,t,i){var a,c,f,g,y,b,T,C,k,F,j,N,Z=i[0],K=i[1],te=i[2];return t===n?(n[12]=t[0]*Z+t[4]*K+t[8]*te+t[12],n[13]=t[1]*Z+t[5]*K+t[9]*te+t[13],n[14]=t[2]*Z+t[6]*K+t[10]*te+t[14],n[15]=t[3]*Z+t[7]*K+t[11]*te+t[15]):(c=t[1],f=t[2],g=t[3],y=t[4],b=t[5],T=t[6],C=t[7],k=t[8],F=t[9],j=t[10],N=t[11],n[0]=a=t[0],n[1]=c,n[2]=f,n[3]=g,n[4]=y,n[5]=b,n[6]=T,n[7]=C,n[8]=k,n[9]=F,n[10]=j,n[11]=N,n[12]=a*Z+y*K+k*te+t[12],n[13]=c*Z+b*K+F*te+t[13],n[14]=f*Z+T*K+j*te+t[14],n[15]=g*Z+C*K+N*te+t[15]),n},M.M=function(n,t,i){var a=i[0],c=i[1],f=i[2];return n[0]=t[0]*a,n[1]=t[1]*a,n[2]=t[2]*a,n[3]=t[3]*a,n[4]=t[4]*c,n[5]=t[5]*c,n[6]=t[6]*c,n[7]=t[7]*c,n[8]=t[8]*f,n[9]=t[9]*f,n[10]=t[10]*f,n[11]=t[11]*f,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},M.N=function(n,t,i){var a=t[0],c=t[1],f=t[2],g=t[3],y=t[4],b=t[5],T=t[6],C=t[7],k=t[8],F=t[9],j=t[10],N=t[11],Z=t[12],K=t[13],te=t[14],fe=t[15],ie=i[0],B=i[1],H=i[2],ae=i[3];return n[0]=ie*a+B*y+H*k+ae*Z,n[1]=ie*c+B*b+H*F+ae*K,n[2]=ie*f+B*T+H*j+ae*te,n[3]=ie*g+B*C+H*N+ae*fe,n[4]=(ie=i[4])*a+(B=i[5])*y+(H=i[6])*k+(ae=i[7])*Z,n[5]=ie*c+B*b+H*F+ae*K,n[6]=ie*f+B*T+H*j+ae*te,n[7]=ie*g+B*C+H*N+ae*fe,n[8]=(ie=i[8])*a+(B=i[9])*y+(H=i[10])*k+(ae=i[11])*Z,n[9]=ie*c+B*b+H*F+ae*K,n[10]=ie*f+B*T+H*j+ae*te,n[11]=ie*g+B*C+H*N+ae*fe,n[12]=(ie=i[12])*a+(B=i[13])*y+(H=i[14])*k+(ae=i[15])*Z,n[13]=ie*c+B*b+H*F+ae*K,n[14]=ie*f+B*T+H*j+ae*te,n[15]=ie*g+B*C+H*N+ae*fe,n},M.O=function(n,t){const i={};for(let a=0;a<t.length;a++){const c=t[a];c in n&&(i[c]=n[c])}return i},M.P=Ge,M.Q=ht,M.R=Fi,M.S=tr,M.T=hl,M.U=Xt,M.V=Jt,M.W=Mt,M.X=Tn,M.Y=Jo,M.Z=bt,M._=h,M.a=ao,M.a$=function(){const n=new Float32Array(16);return Ct(n),n},M.a0=Vp,M.a1=n=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(i=>{t.onloadstart=()=>{i(t)};for(const a of n){const c=window.document.createElement("source");mi(a)||(t.crossOrigin="Anonymous"),c.src=a,t.appendChild(c)}})},M.a2=Se,M.a3=function(){return st++},M.a4=_,M.a5=S,M.a6=ol,M.a7=Si,M.a8=lm,M.a9=function(n){const t={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,c,f)=>{const g=c||f;return t[a]=!g||g.toLowerCase(),""}),t["max-age"]){const i=parseInt(t["max-age"],10);isNaN(i)?delete t["max-age"]:t["max-age"]=i}return t},M.aA=Ih,M.aB=Zp,M.aC=Kr,M.aD=Pc,M.aE=J,M.aF=Rt,M.aG=lt,M.aH=function(n){return Math.pow(2,n)},M.aI=85.051129,M.aJ=Fn,M.aK=ut,M.aL=rn,M.aM=is,M.aN=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n},M.aO=function(n,t,i){return n[0]=t[0]+i[0],n[1]=t[1]+i[1],n[2]=t[2]+i[2],n},M.aP=function(n){var t=new pt(3);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t},M.aQ=function(n,t,i){return n[0]=t[0]*i[0],n[1]=t[1]*i[1],n[2]=t[2]*i[2],n[3]=t[3]*i[3],n},M.aR=function(n,t,i){return n[0]=t[0]-i[0],n[1]=t[1]-i[1],n[2]=t[2]-i[2],n},M.aS=function(n,t){var i=t[0],a=t[1],c=t[2],f=i*i+a*a+c*c;return f>0&&(f=1/Math.sqrt(f)),n[0]=t[0]*f,n[1]=t[1]*f,n[2]=t[2]*f,n},M.aT=function(n,t,i){var a=t[0],c=t[1],f=t[2],g=i[0],y=i[1],b=i[2];return n[0]=c*b-f*y,n[1]=f*g-a*b,n[2]=a*y-c*g,n},M.aU=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]},M.aV=om,M.aW=Ah,M.aX=function(n,t,i,a,c){var f,g=1/Math.tan(t/2);return n[0]=g/i,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=g,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,c!=null&&c!==1/0?(n[10]=(c+a)*(f=1/(a-c)),n[14]=2*c*a*f):(n[10]=-1,n[14]=-2*a),n},M.aY=function(n){var t=new pt(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t},M.aZ=function(n,t,i){var a=Math.sin(i),c=Math.cos(i),f=t[0],g=t[1],y=t[2],b=t[3],T=t[4],C=t[5],k=t[6],F=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*c+T*a,n[1]=g*c+C*a,n[2]=y*c+k*a,n[3]=b*c+F*a,n[4]=T*c-f*a,n[5]=C*c-g*a,n[6]=k*c-y*a,n[7]=F*c-b*a,n},M.a_=function(n,t,i){var a=Math.sin(i),c=Math.cos(i),f=t[4],g=t[5],y=t[6],b=t[7],T=t[8],C=t[9],k=t[10],F=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=f*c+T*a,n[5]=g*c+C*a,n[6]=y*c+k*a,n[7]=b*c+F*a,n[8]=T*c-f*a,n[9]=C*c-g*a,n[10]=k*c-y*a,n[11]=F*c-b*a,n},M.aa=function(n){return Math.log(n)/Math.LN2},M.ab=function(n){var t=n[0],i=n[1];return t*t+i*i},M.ac=function(n){return n*Math.PI/180},M.ad=kt,M.ae=function(n,t){const i=[];for(const a in n)a in t||i.push(a);return i},M.af=function(n,t){let i=0,a=0;if(n.kind==="constant")a=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:c,minZoom:f,maxZoom:g}=n,y=c?kt(pn.interpolationFactor(c,t,f,g),0,1):0;n.kind==="camera"?a=qn.number(n.minSize,n.maxSize,y):i=y}return{uSizeT:i,uSize:a}},M.ah=function(n,{uSize:t,uSizeT:i},{lowerSize:a,upperSize:c}){return n.kind==="source"?a/Qo:n.kind==="composite"?qn.number(a/Qo,c/Qo,i):t},M.ai=function(n,t){var i=t[0],a=t[1],c=t[2],f=t[3],g=t[4],y=t[5],b=t[6],T=t[7],C=t[8],k=t[9],F=t[10],j=t[11],N=t[12],Z=t[13],K=t[14],te=t[15],fe=i*y-a*g,ie=i*b-c*g,B=i*T-f*g,H=a*b-c*y,ae=a*T-f*y,Ce=c*T-f*b,Ke=C*Z-k*N,ke=C*K-F*N,Be=C*te-j*N,tt=k*K-F*Z,Ye=k*te-j*Z,at=F*te-j*K,Ue=fe*at-ie*Ye+B*tt+H*Be-ae*ke+Ce*Ke;return Ue?(n[0]=(y*at-b*Ye+T*tt)*(Ue=1/Ue),n[1]=(c*Ye-a*at-f*tt)*Ue,n[2]=(Z*Ce-K*ae+te*H)*Ue,n[3]=(F*ae-k*Ce-j*H)*Ue,n[4]=(b*Be-g*at-T*ke)*Ue,n[5]=(i*at-c*Be+f*ke)*Ue,n[6]=(K*B-N*Ce-te*ie)*Ue,n[7]=(C*Ce-F*B+j*ie)*Ue,n[8]=(g*Ye-y*Be+T*Ke)*Ue,n[9]=(a*Be-i*Ye-f*Ke)*Ue,n[10]=(N*ae-Z*B+te*fe)*Ue,n[11]=(k*B-C*ae-j*fe)*Ue,n[12]=(y*ke-g*tt-b*Ke)*Ue,n[13]=(i*tt-a*ke+c*Ke)*Ue,n[14]=(Z*ie-N*H-K*fe)*Ue,n[15]=(C*H-k*ie+F*fe)*Ue,n):null},M.aj=Tt,M.ak=function(n){return Math.hypot(n[0],n[1])},M.al=function(n){return n[0]=0,n[1]=0,n},M.am=function(n,t,i){return n[0]=t[0]*i,n[1]=t[1]*i,n},M.an=o,M.ao=Er,M.ap=function(n,t,i,a){const c=t.y-n.y,f=t.x-n.x,g=a.y-i.y,y=a.x-i.x,b=g*f-y*c;if(b===0)return null;const T=(y*(n.y-i.y)-g*(n.x-i.x))/b;return new Ge(n.x+T*f,n.y+T*c)},M.aq=dm,M.ar=_u,M.as=Ct,M.at=function(n){let t=1/0,i=1/0,a=-1/0,c=-1/0;for(const f of n)t=Math.min(t,f.x),i=Math.min(i,f.y),a=Math.max(a,f.x),c=Math.max(c,f.y);return[t,i,a,c]},M.au=bn,M.av=_t,M.aw=function(n,t,i,a,c=!1){if(!i[0]&&!i[1])return[0,0];const f=c?a==="map"?-n.bearingInRadians:0:a==="viewport"?n.bearingInRadians:0;if(f){const g=Math.sin(f),y=Math.cos(f);i=[i[0]*y-i[1]*g,i[0]*g+i[1]*y]}return[c?i[0]:_t(t,i[0],n.zoom),c?i[1]:_t(t,i[1],n.zoom)]},M.ay=wd,M.az=Up,M.b=di,M.b$=n=>n.type==="circle",M.b0=function(){const n=new Float64Array(16);return Ct(n),n},M.b1=function(){return new Float64Array(16)},M.b2=function(n,t,i){const a=new Float64Array(4);return function(c,f,g,y){var b=.5*Math.PI/180;f*=b,g*=b,y*=b;var T=Math.sin(f),C=Math.cos(f),k=Math.sin(g),F=Math.cos(g),j=Math.sin(y),N=Math.cos(y);c[0]=T*F*N-C*k*j,c[1]=C*k*N+T*F*j,c[2]=C*F*j-T*k*N,c[3]=C*F*N+T*k*j}(a,n,t-90,i),a},M.b3=function(n,t,i,a){var c,f,g,y,b,T=t[0],C=t[1],k=t[2],F=t[3],j=i[0],N=i[1],Z=i[2],K=i[3];return(f=T*j+C*N+k*Z+F*K)<0&&(f=-f,j=-j,N=-N,Z=-Z,K=-K),1-f>Je?(c=Math.acos(f),g=Math.sin(c),y=Math.sin((1-a)*c)/g,b=Math.sin(a*c)/g):(y=1-a,b=a),n[0]=y*T+b*j,n[1]=y*C+b*N,n[2]=y*k+b*Z,n[3]=y*F+b*K,n},M.b4=function(n){const t=new Float64Array(9);var i,a,c,f,g,y,b,T,C,k,F,j,N,Z,K,te,fe,ie;k=(c=(a=n)[0])*(b=c+c),F=(f=a[1])*b,N=(g=a[2])*b,Z=g*(T=f+f),te=(y=a[3])*b,fe=y*T,ie=y*(C=g+g),(i=t)[0]=1-(j=f*T)-(K=g*C),i[3]=F-ie,i[6]=N+fe,i[1]=F+ie,i[4]=1-k-K,i[7]=Z-te,i[2]=N-fe,i[5]=Z+te,i[8]=1-k-j;const B=rn(-Math.asin(kt(t[2],-1,1)));let H,ae;return Math.hypot(t[5],t[8])<.001?(H=0,ae=-rn(Math.atan2(t[3],t[4]))):(H=rn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ae=rn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:H,pitch:B+90,bearing:ae}},M.b5=function(n,t){return n.roll==t.roll&&n.pitch==t.pitch&&n.bearing==t.bearing},M.b6=ur,M.b7=Ro,M.b8=vl,M.b9=xl,M.bA=function(n){const t=[],i=n.id;return i===void 0&&t.push({message:`layers.${i}: missing required property "id"`}),n.render===void 0&&t.push({message:`layers.${i}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&t.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),t},M.bB=function n(t,i){if(Array.isArray(t)){if(!Array.isArray(i)||t.length!==i.length)return!1;for(let a=0;a<t.length;a++)if(!n(t[a],i[a]))return!1;return!0}if(typeof t=="object"&&t!==null&&i!==null){if(typeof i!="object"||Object.keys(t).length!==Object.keys(i).length)return!1;for(const a in t)if(!n(t[a],i[a]))return!1;return!0}return t===i},M.bC=xt,M.bD=mt,M.bE=class extends Li{constructor(n,t){super(n,t),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},M.bF=Ea,M.bG=class extends Li{constructor(n,t){super(n,t),this.current=Ti}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let t=1;t<16;t++)if(n[t]!==this.current[t]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},M.bH=Ca,M.bI=class extends Li{constructor(n,t){super(n,t),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},M.bJ=class extends Li{constructor(n,t){super(n,t),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},M.bK=Lt,M.bL=function(n,t){var i=Math.sin(t),a=Math.cos(t);return n[0]=a,n[1]=i,n[2]=0,n[3]=-i,n[4]=a,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n},M.bM=function(n,t,i){var a=t[0],c=t[1],f=t[2];return n[0]=a*i[0]+c*i[3]+f*i[6],n[1]=a*i[1]+c*i[4]+f*i[7],n[2]=a*i[2]+c*i[5]+f*i[8],n},M.bN=function(n,t,i,a,c,f,g){var y=1/(t-i),b=1/(a-c),T=1/(f-g);return n[0]=-2*y,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*b,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*T,n[11]=0,n[12]=(t+i)*y,n[13]=(c+a)*b,n[14]=(g+f)*T,n[15]=1,n},M.bO=class extends Ao{},M.bP=El,M.bQ=class extends fl{},M.bR=wc,M.bS=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},M.bT=ed,M.bU=function(n,t,i){var a=t[0],c=t[1],f=t[2],g=i[3]*a+i[7]*c+i[11]*f+i[15];return n[0]=(i[0]*a+i[4]*c+i[8]*f+i[12])/(g=g||1),n[1]=(i[1]*a+i[5]*c+i[9]*f+i[13])/g,n[2]=(i[2]*a+i[6]*c+i[10]*f+i[14])/g,n},M.bV=class extends fu{},M.bW=class extends l{},M.bX=function(n,t){return n[0]===t[0]&&n[1]===t[1]&&n[2]===t[2]&&n[3]===t[3]&&n[4]===t[4]&&n[5]===t[5]&&n[6]===t[6]&&n[7]===t[7]&&n[8]===t[8]&&n[9]===t[9]&&n[10]===t[10]&&n[11]===t[11]&&n[12]===t[12]&&n[13]===t[13]&&n[14]===t[14]&&n[15]===t[15]},M.bY=function(n,t){var i=n[0],a=n[1],c=n[2],f=n[3],g=n[4],y=n[5],b=n[6],T=n[7],C=n[8],k=n[9],F=n[10],j=n[11],N=n[12],Z=n[13],K=n[14],te=n[15],fe=t[0],ie=t[1],B=t[2],H=t[3],ae=t[4],Ce=t[5],Ke=t[6],ke=t[7],Be=t[8],tt=t[9],Ye=t[10],at=t[11],Ue=t[12],wt=t[13],Gt=t[14],Zt=t[15];return Math.abs(i-fe)<=Je*Math.max(1,Math.abs(i),Math.abs(fe))&&Math.abs(a-ie)<=Je*Math.max(1,Math.abs(a),Math.abs(ie))&&Math.abs(c-B)<=Je*Math.max(1,Math.abs(c),Math.abs(B))&&Math.abs(f-H)<=Je*Math.max(1,Math.abs(f),Math.abs(H))&&Math.abs(g-ae)<=Je*Math.max(1,Math.abs(g),Math.abs(ae))&&Math.abs(y-Ce)<=Je*Math.max(1,Math.abs(y),Math.abs(Ce))&&Math.abs(b-Ke)<=Je*Math.max(1,Math.abs(b),Math.abs(Ke))&&Math.abs(T-ke)<=Je*Math.max(1,Math.abs(T),Math.abs(ke))&&Math.abs(C-Be)<=Je*Math.max(1,Math.abs(C),Math.abs(Be))&&Math.abs(k-tt)<=Je*Math.max(1,Math.abs(k),Math.abs(tt))&&Math.abs(F-Ye)<=Je*Math.max(1,Math.abs(F),Math.abs(Ye))&&Math.abs(j-at)<=Je*Math.max(1,Math.abs(j),Math.abs(at))&&Math.abs(N-Ue)<=Je*Math.max(1,Math.abs(N),Math.abs(Ue))&&Math.abs(Z-wt)<=Je*Math.max(1,Math.abs(Z),Math.abs(wt))&&Math.abs(K-Gt)<=Je*Math.max(1,Math.abs(K),Math.abs(Gt))&&Math.abs(te-Zt)<=Je*Math.max(1,Math.abs(te),Math.abs(Zt))},M.bZ=function(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},M.b_=n=>n.type==="symbol",M.ba=yl,M.bb=et,M.bc=rt,M.bd=Un,M.be=function(n,t,i,a,c){return et(a,c,kt((n-t)/(i-t),0,1))},M.bf=Re,M.bg=function(){return new Float64Array(4)},M.bh=function(){return new Float64Array(3)},M.bi=function(n,t,i,a){var c=[],f=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],f[0]=c[0]*Math.cos(a)-c[1]*Math.sin(a),f[1]=c[0]*Math.sin(a)+c[1]*Math.cos(a),f[2]=c[2],n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n},M.bj=function(n,t,i,a){var c=[],f=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],f[0]=c[0],f[1]=c[1]*Math.cos(a)-c[2]*Math.sin(a),f[2]=c[1]*Math.sin(a)+c[2]*Math.cos(a),n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n},M.bk=function(n,t,i,a){var c=[],f=[];return c[0]=t[0]-i[0],c[1]=t[1]-i[1],c[2]=t[2]-i[2],f[0]=c[2]*Math.sin(a)+c[0]*Math.cos(a),f[1]=c[1],f[2]=c[2]*Math.cos(a)-c[0]*Math.sin(a),n[0]=f[0]+i[0],n[1]=f[1]+i[1],n[2]=f[2]+i[2],n},M.bl=function(n,t,i){var a=Math.sin(i),c=Math.cos(i),f=t[0],g=t[1],y=t[2],b=t[3],T=t[8],C=t[9],k=t[10],F=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=f*c-T*a,n[1]=g*c-C*a,n[2]=y*c-k*a,n[3]=b*c-F*a,n[8]=f*a+T*c,n[9]=g*a+C*c,n[10]=y*a+k*c,n[11]=b*a+F*c,n},M.bm=function(n,t){const i=Re(n,360),a=Re(t,360),c=a-i,f=a>i?c-360:c+360;return Math.abs(c)<Math.abs(f)?c:f},M.bn=function(n){return n[0]=0,n[1]=0,n[2]=0,n},M.bo=function(n,t,i,a){const c=Math.sqrt(n*n+t*t),f=Math.sqrt(i*i+a*a);n/=c,t/=c,i/=f,a/=f;const g=Math.acos(n*i+t*a);return-t*i+n*a>0?g:-g},M.bp=function(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]},M.bq=Ie,M.br=function(n,t){const i=Re(n,2*Math.PI),a=Re(t,2*Math.PI);return Math.min(Math.abs(i-a),Math.abs(i-a+2*Math.PI),Math.abs(i-a-2*Math.PI))},M.bs=function(n){return Math.hypot(n[0],n[1],n[2])},M.bt=function(){const n={},t=R.$version;for(const i in R.$root){const a=R.$root[i];if(a.required){let c=null;c=i==="version"?t:a.type==="array"?[]:{},c!=null&&(n[i]=c)}}return n},M.bu=ll,M.bv=ni,M.bw=function(n){n=n.slice();const t=Object.create(null);for(let i=0;i<n.length;i++)t[n[i].id]=n[i];for(let i=0;i<n.length;i++)"ref"in n[i]&&(n[i]=X(n[i],t[n[i].ref]));return n},M.bx=function(n){if(n.type==="custom")return new wn(n);switch(n.type){case"background":return new it(n);case"circle":return new Bd(n);case"fill":return new Hd(n);case"fill-extrusion":return new pd(n);case"heatmap":return new Vd(n);case"hillshade":return new nd(n);case"line":return new Op(n);case"raster":return new jt(n);case"symbol":return new Le(n)}},M.by=St,M.bz=function(n,t){if(!n)return[{command:"setStyle",args:[t]}];let i=[];try{if(!ee(n.version,t.version))return[{command:"setStyle",args:[t]}];ee(n.center,t.center)||i.push({command:"setCenter",args:[t.center]}),ee(n.centerAltitude,t.centerAltitude)||i.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ee(n.zoom,t.zoom)||i.push({command:"setZoom",args:[t.zoom]}),ee(n.bearing,t.bearing)||i.push({command:"setBearing",args:[t.bearing]}),ee(n.pitch,t.pitch)||i.push({command:"setPitch",args:[t.pitch]}),ee(n.roll,t.roll)||i.push({command:"setRoll",args:[t.roll]}),ee(n.sprite,t.sprite)||i.push({command:"setSprite",args:[t.sprite]}),ee(n.glyphs,t.glyphs)||i.push({command:"setGlyphs",args:[t.glyphs]}),ee(n.transition,t.transition)||i.push({command:"setTransition",args:[t.transition]}),ee(n.light,t.light)||i.push({command:"setLight",args:[t.light]}),ee(n.terrain,t.terrain)||i.push({command:"setTerrain",args:[t.terrain]}),ee(n.sky,t.sky)||i.push({command:"setSky",args:[t.sky]}),ee(n.projection,t.projection)||i.push({command:"setProjection",args:[t.projection]});const a={},c=[];(function(g,y,b,T){let C;for(C in y=y||{},g=g||{})Object.prototype.hasOwnProperty.call(g,C)&&(Object.prototype.hasOwnProperty.call(y,C)||Pe(C,b,T));for(C in y)Object.prototype.hasOwnProperty.call(y,C)&&(Object.prototype.hasOwnProperty.call(g,C)?ee(g[C],y[C])||(g[C].type==="geojson"&&y[C].type==="geojson"&&Ne(g,y,C)?he(b,{command:"setGeoJSONSourceData",args:[C,y[C].data]}):_e(C,y,b,T)):ye(C,y,b))})(n.sources,t.sources,c,a);const f=[];n.layers&&n.layers.forEach(g=>{"source"in g&&a[g.source]?i.push({command:"removeLayer",args:[g.id]}):f.push(g)}),i=i.concat(c),function(g,y,b){y=y||[];const T=(g=g||[]).map(Te),C=y.map(Te),k=g.reduce(We,{}),F=y.reduce(We,{}),j=T.slice(),N=Object.create(null);let Z,K,te,fe,ie;for(let B=0,H=0;B<T.length;B++)Z=T[B],Object.prototype.hasOwnProperty.call(F,Z)?H++:(he(b,{command:"removeLayer",args:[Z]}),j.splice(j.indexOf(Z,H),1));for(let B=0,H=0;B<C.length;B++)Z=C[C.length-1-B],j[j.length-1-B]!==Z&&(Object.prototype.hasOwnProperty.call(k,Z)?(he(b,{command:"removeLayer",args:[Z]}),j.splice(j.lastIndexOf(Z,j.length-H),1)):H++,fe=j[j.length-B],he(b,{command:"addLayer",args:[F[Z],fe]}),j.splice(j.length-B,0,Z),N[Z]=!0);for(let B=0;B<C.length;B++)if(Z=C[B],K=k[Z],te=F[Z],!N[Z]&&!ee(K,te))if(ee(K.source,te.source)&&ee(K["source-layer"],te["source-layer"])&&ee(K.type,te.type)){for(ie in De(K.layout,te.layout,b,Z,null,"setLayoutProperty"),De(K.paint,te.paint,b,Z,null,"setPaintProperty"),ee(K.filter,te.filter)||he(b,{command:"setFilter",args:[Z,te.filter]}),ee(K.minzoom,te.minzoom)&&ee(K.maxzoom,te.maxzoom)||he(b,{command:"setLayerZoomRange",args:[Z,te.minzoom,te.maxzoom]}),K)Object.prototype.hasOwnProperty.call(K,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?De(K[ie],te[ie],b,Z,ie.slice(6),"setPaintProperty"):ee(K[ie],te[ie])||he(b,{command:"setLayerProperty",args:[Z,ie,te[ie]]}));for(ie in te)Object.prototype.hasOwnProperty.call(te,ie)&&!Object.prototype.hasOwnProperty.call(K,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?De(K[ie],te[ie],b,Z,ie.slice(6),"setPaintProperty"):ee(K[ie],te[ie])||he(b,{command:"setLayerProperty",args:[Z,ie,te[ie]]}))}else he(b,{command:"removeLayer",args:[Z]}),fe=j[j.lastIndexOf(Z)+1],he(b,{command:"addLayer",args:[te,fe]})}(f,t.layers,i)}catch(a){console.warn("Unable to compute style diff:",a),i=[{command:"setStyle",args:[t]}]}return i},M.c=Ui,M.c0=n=>n.type==="heatmap",M.c1=n=>n.type==="line",M.c2=n=>n.type==="fill",M.c3=n=>n.type==="fill-extrusion",M.c4=n=>n.type==="hillshade",M.c5=n=>n.type==="raster",M.c6=n=>n.type==="background",M.c7=n=>n.type==="custom",M.c8=me,M.c9=function(n,t,i){const a=Nt(t.x-i.x,t.y-i.y),c=Nt(n.x-i.x,n.y-i.y);var f,g;return rn(Math.atan2(a[0]*c[1]-a[1]*c[0],(f=a)[0]*(g=c)[0]+f[1]*g[1]))},M.cA=Ve,M.cB=kn,M.cC=Bs,M.cD=yi,M.cE=Hn,M.ca=Ae,M.cb=function(n,t,i){var a=t[0],c=t[1];return n[0]=i[0]*a+i[4]*c+i[12],n[1]=i[1]*a+i[5]*c+i[13],n},M.cc=function(n,t){const{x:i,y:a}=Dc.fromLngLat(t);return!(n<0||n>25||a<0||a>=1||i<0||i>=1)},M.cd=function(n,t){return n[0]=t[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=t[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},M.ce=class extends qo{},M.cf=ny,M.ch=function(n){return n.message===Nn},M.ci=pi,M.cj=function(n,t){ao.REGISTERED_PROTOCOLS[n]=t},M.ck=function(n){delete ao.REGISTERED_PROTOCOLS[n]},M.cl=function(n,t){const i={};for(let c=0;c<n.length;c++){const f=t&&t[n[c].id]||ga(n[c]);t&&(t[n[c].id]=f);let g=i[f];g||(g=i[f]=[]),g.push(n[c])}const a=[];for(const c in i)a.push(i[c]);return a},M.cm=ft,M.cn=sm,M.co=um,M.cp=vd,M.cq=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=bt/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const t=n.bucket.layers[0],i=t.layout,a=t._unevaluatedLayout._values,c={layoutIconSize:a["icon-size"].possiblyEvaluate(new Sr(n.bucket.zoom+1),n.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new Sr(n.bucket.zoom+1),n.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new Sr(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:T,maxZoom:C}=n.bucket.textSizeData;c.compositeTextSizes=[a["text-size"].possiblyEvaluate(new Sr(T),n.canonical),a["text-size"].possiblyEvaluate(new Sr(C),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:T,maxZoom:C}=n.bucket.iconSizeData;c.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new Sr(T),n.canonical),a["icon-size"].possiblyEvaluate(new Sr(C),n.canonical)]}const f=i.get("text-line-height")*bn,g=i.get("text-rotation-alignment")!=="viewport"&&i.get("symbol-placement")!=="point",y=i.get("text-keep-upright"),b=i.get("text-size");for(const T of n.bucket.features){const C=i.get("text-font").evaluate(T,{},n.canonical).join(","),k=b.evaluate(T,{},n.canonical),F=c.layoutTextSize.evaluate(T,{},n.canonical),j=c.layoutIconSize.evaluate(T,{},n.canonical),N={horizontal:{},vertical:void 0},Z=T.text;let K,te=[0,0];if(Z){const B=Z.toString(),H=i.get("text-letter-spacing").evaluate(T,{},n.canonical)*bn,ae=hu(B)?H:0,Ce=i.get("text-anchor").evaluate(T,{},n.canonical),Ke=bm(t,T,n.canonical);if(!Ke){const Ye=i.get("text-radial-offset").evaluate(T,{},n.canonical);te=Ye?xm(Ce,[Ye*bn,$p]):i.get("text-offset").evaluate(T,{},n.canonical).map(at=>at*bn)}let ke=g?"center":i.get("text-justify").evaluate(T,{},n.canonical);const Be=i.get("symbol-placement")==="point"?i.get("text-max-width").evaluate(T,{},n.canonical)*bn:1/0,tt=()=>{n.bucket.allowVerticalPlacement&&Ha(B)&&(N.vertical=Yo(Z,n.glyphMap,n.glyphPositions,n.imagePositions,C,Be,f,Ce,"left",ae,te,M.ag.vertical,!0,F,k))};if(!g&&Ke){const Ye=new Set;if(ke==="auto")for(let Ue=0;Ue<Ke.values.length;Ue+=2)Ye.add(Up(Ke.values[Ue]));else Ye.add(ke);let at=!1;for(const Ue of Ye)if(!N.horizontal[Ue])if(at)N.horizontal[Ue]=N.horizontal[0];else{const wt=Yo(Z,n.glyphMap,n.glyphPositions,n.imagePositions,C,Be,f,"center",Ue,ae,te,M.ag.horizontal,!1,F,k);wt&&(N.horizontal[Ue]=wt,at=wt.positionedLines.length===1)}tt()}else{ke==="auto"&&(ke=Up(Ce));const Ye=Yo(Z,n.glyphMap,n.glyphPositions,n.imagePositions,C,Be,f,Ce,ke,ae,te,M.ag.horizontal,!1,F,k);Ye&&(N.horizontal[ke]=Ye),tt(),Ha(B)&&g&&y&&(N.vertical=Yo(Z,n.glyphMap,n.glyphPositions,n.imagePositions,C,Be,f,Ce,ke,ae,te,M.ag.vertical,!1,F,k))}}let fe=!1;if(T.icon&&T.icon.name){const B=n.imageMap[T.icon.name];B&&(K=bd(n.imagePositions[T.icon.name],i.get("icon-offset").evaluate(T,{},n.canonical),i.get("icon-anchor").evaluate(T,{},n.canonical)),fe=!!B.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=fe:n.bucket.sdfIcons!==fe&&or("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(B.pixelRatio!==n.bucket.pixelRatio||i.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const ie=Tm(N.horizontal)||N.vertical;n.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||K)&&ty(n.bucket,T,N,K,n.imageMap,c,F,j,te,fe,n.canonical,n.subdivisionGranularity)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},M.cr=Aa,M.cs=yo,M.ct=Sl,M.cu=rs,M.cv=yd,M.cw=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},M.cx=function(n,t,i,a,c){return h(this,void 0,void 0,function*(){if(Mt())try{return yield Tn(n,t,i,a,c)}catch{}return function(f,g,y,b,T){const C=f.width,k=f.height;tn&&ri||(tn=new OffscreenCanvas(C,k),ri=tn.getContext("2d",{willReadFrequently:!0})),tn.width=C,tn.height=k,ri.drawImage(f,0,0,C,k);const F=ri.getImageData(g,y,b,T);return ri.clearRect(0,0,C,k),F.data}(n,t,i,a,c)})},M.cy=am,M.cz=Me,M.d=mi,M.e=Xe,M.f=n=>h(void 0,void 0,void 0,function*(){if(n.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(n)],{type:"image/png"});try{return createImageBitmap(t)}catch(i){throw new Error(`Could not load image because of ${i.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),M.g=wo,M.h=n=>new Promise((t,i)=>{const a=new Image;a.onload=()=>{t(a),URL.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(()=>{a.src=$i})},a.onerror=()=>i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const c=new Blob([new Uint8Array(n)],{type:"image/png"});a.src=n.byteLength?URL.createObjectURL(c):$i}),M.i=kr,M.j=(n,t)=>fi(Xe(n,{type:"json"}),t),M.k=Ai,M.l=na,M.m=fi,M.n=(n,t)=>fi(Xe(n,{type:"arrayBuffer"}),t),M.o=function(n){return new yd(n).readFields(rp,[])},M.p=ip,M.q=vu,M.r=Ln,M.s=zn,M.t=Qi,M.u=Yt,M.v=R,M.w=or,M.x=mn,M.y=ho,M.z=function([n,t,i]){return t+=90,t*=Math.PI/180,i*=Math.PI/180,{x:n*Math.cos(t)*Math.sin(i),y:n*Math.sin(t)*Math.sin(i),z:n*Math.cos(i)}}}),W("worker",["./shared"],function(M){class h{constructor(R){this.keyCache={},R&&this.replace(R)}replace(R){this._layerConfigs={},this._layers={},this.update(R,[])}update(R,q){for(const ee of R){this._layerConfigs[ee.id]=ee;const he=this._layers[ee.id]=M.bx(ee);he._featureFilter=M.a6(he.filter),this.keyCache[ee.id]&&delete this.keyCache[ee.id]}for(const ee of q)delete this.keyCache[ee],delete this._layerConfigs[ee],delete this._layers[ee];this.familiesBySource={};const X=M.cl(Object.values(this._layerConfigs),this.keyCache);for(const ee of X){const he=ee.map(Te=>this._layers[Te.id]),ye=he[0];if(ye.visibility==="none")continue;const Pe=ye.source||"";let _e=this.familiesBySource[Pe];_e||(_e=this.familiesBySource[Pe]={});const Ne=ye.sourceLayer||"_geojsonTileLayer";let De=_e[Ne];De||(De=_e[Ne]=[]),De.push(he)}}}class Me{constructor(R){const q={},X=[];for(const Pe in R){const _e=R[Pe],Ne=q[Pe]={};for(const De in _e){const Te=_e[+De];if(!Te||Te.bitmap.width===0||Te.bitmap.height===0)continue;const We={x:0,y:0,w:Te.bitmap.width+2,h:Te.bitmap.height+2};X.push(We),Ne[De]={rect:We,metrics:Te.metrics}}}const{w:ee,h:he}=M.p(X),ye=new M.q({width:ee||1,height:he||1});for(const Pe in R){const _e=R[Pe];for(const Ne in _e){const De=_e[+Ne];if(!De||De.bitmap.width===0||De.bitmap.height===0)continue;const Te=q[Pe][Ne].rect;M.q.copy(De.bitmap,ye,{x:0,y:0},{x:Te.x+1,y:Te.y+1},De.bitmap)}}this.image=ye,this.positions=q}}M.cm("GlyphAtlas",Me);class Ze{constructor(R){this.tileID=new M.Y(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId,this.inFlightDependencies=[]}parse(R,q,X,ee,he){return M._(this,void 0,void 0,function*(){this.status="parsing",this.data=R,this.collisionBoxArray=new M.a4;const ye=new M.cn(Object.keys(R.layers).sort()),Pe=new M.co(this.tileID,this.promoteId);Pe.bucketLayerIDs=[];const _e={},Ne={featureIndex:Pe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:X,subdivisionGranularity:he},De=q.familiesBySource[this.source];for(const Wt in De){const ir=R.layers[Wt];if(!ir)continue;ir.version===1&&M.w(`Vector tile source "${this.source}" layer "${Wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Bt=ye.encode(Wt),Da=[];for(let Zr=0;Zr<ir.length;Zr++){const on=ir.feature(Zr),jr=Pe.getId(on,Wt);Da.push({feature:on,id:jr,index:Zr,sourceLayerIndex:Bt})}for(const Zr of De[Wt]){const on=Zr[0];on.source!==this.source&&M.w(`layer.source = ${on.source} does not equal this.source = ${this.source}`),on.minzoom&&this.zoom<Math.floor(on.minzoom)||on.maxzoom&&this.zoom>=on.maxzoom||on.visibility!=="none"&&(qe(Zr,this.zoom,X),(_e[on.id]=on.createBucket({index:Pe.bucketLayerIDs.length,layers:Zr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Bt,sourceID:this.source})).populate(Da,Ne,this.tileID.canonical),Pe.bucketLayerIDs.push(Zr.map(jr=>jr.id)))}}const Te=M.bC(Ne.glyphDependencies,Wt=>Object.keys(Wt).map(Number));this.inFlightDependencies.forEach(Wt=>Wt==null?void 0:Wt.abort()),this.inFlightDependencies=[];let We=Promise.resolve({});if(Object.keys(Te).length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),We=ee.sendAsync({type:"GG",data:{stacks:Te,source:this.source,tileID:this.tileID,type:"glyphs"}},Wt)}const Se=Object.keys(Ne.iconDependencies);let dt=Promise.resolve({});if(Se.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),dt=ee.sendAsync({type:"GI",data:{icons:Se,source:this.source,tileID:this.tileID,type:"icons"}},Wt)}const Et=Object.keys(Ne.patternDependencies);let Kt=Promise.resolve({});if(Et.length){const Wt=new AbortController;this.inFlightDependencies.push(Wt),Kt=ee.sendAsync({type:"GI",data:{icons:Et,source:this.source,tileID:this.tileID,type:"patterns"}},Wt)}const[Vt,$e,vt]=yield Promise.all([We,dt,Kt]),yt=new Me(Vt),er=new M.cp($e,vt);for(const Wt in _e){const ir=_e[Wt];ir instanceof M.a5?(qe(ir.layers,this.zoom,X),M.cq({bucket:ir,glyphMap:Vt,glyphPositions:yt.positions,imageMap:$e,imagePositions:er.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ne.subdivisionGranularity})):ir.hasPattern&&(ir instanceof M.cr||ir instanceof M.cs||ir instanceof M.ct)&&(qe(ir.layers,this.zoom,X),ir.addFeatures(Ne,this.tileID.canonical,er.patternPositions))}return this.status="done",{buckets:Object.values(_e).filter(Wt=>!Wt.isEmpty()),featureIndex:Pe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:yt.image,imageAtlas:er,glyphMap:this.returnDependencies?Vt:null,iconMap:this.returnDependencies?$e:null,glyphPositions:this.returnDependencies?yt.positions:null}})}}function qe(xe,R,q){const X=new M.C(R);for(const ee of xe)ee.recalculate(X,q)}class Ve{constructor(R,q,X){this.actor=R,this.layerIndex=q,this.availableImages=X,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(R,q){return M._(this,void 0,void 0,function*(){const X=yield M.n(R.request,q);try{return{vectorTile:new M.cu.VectorTile(new M.cv(X.data)),rawData:X.data,cacheControl:X.cacheControl,expires:X.expires}}catch(ee){const he=new Uint8Array(X.data);let ye=`Unable to parse the tile at ${R.request.url}, `;throw ye+=he[0]===31&&he[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ee.message}`,new Error(ye)}})}loadTile(R){return M._(this,void 0,void 0,function*(){const q=R.uid,X=!!(R&&R.request&&R.request.collectResourceTiming)&&new M.cw(R.request),ee=new Ze(R);this.loading[q]=ee;const he=new AbortController;ee.abort=he;try{const ye=yield this.loadVectorTile(R,he);if(delete this.loading[q],!ye)return null;const Pe=ye.rawData,_e={};ye.expires&&(_e.expires=ye.expires),ye.cacheControl&&(_e.cacheControl=ye.cacheControl);const Ne={};if(X){const Te=X.finish();Te&&(Ne.resourceTiming=JSON.parse(JSON.stringify(Te)))}ee.vectorTile=ye.vectorTile;const De=ee.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,R.subdivisionGranularity);this.loaded[q]=ee,this.fetching[q]={rawTileData:Pe,cacheControl:_e,resourceTiming:Ne};try{const Te=yield De;return M.e({rawTileData:Pe.slice(0)},Te,_e,Ne)}finally{delete this.fetching[q]}}catch(ye){throw delete this.loading[q],ee.status="done",this.loaded[q]=ee,ye}})}reloadTile(R){return M._(this,void 0,void 0,function*(){const q=R.uid;if(!this.loaded||!this.loaded[q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const X=this.loaded[q];if(X.showCollisionBoxes=R.showCollisionBoxes,X.status==="parsing"){const ee=yield X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,R.subdivisionGranularity);let he;if(this.fetching[q]){const{rawTileData:ye,cacheControl:Pe,resourceTiming:_e}=this.fetching[q];delete this.fetching[q],he=M.e({rawTileData:ye.slice(0)},ee,Pe,_e)}else he=ee;return he}if(X.status==="done"&&X.vectorTile)return X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,R.subdivisionGranularity)})}abortTile(R){return M._(this,void 0,void 0,function*(){const q=this.loading,X=R.uid;q&&q[X]&&q[X].abort&&(q[X].abort.abort(),delete q[X])})}removeTile(R){return M._(this,void 0,void 0,function*(){this.loaded&&this.loaded[R.uid]&&delete this.loaded[R.uid]})}}class ze{constructor(){this.loaded={}}loadTile(R){return M._(this,void 0,void 0,function*(){const{uid:q,encoding:X,rawImageData:ee,redFactor:he,greenFactor:ye,blueFactor:Pe,baseShift:_e}=R,Ne=ee.width+2,De=ee.height+2,Te=M.b(ee)?new M.R({width:Ne,height:De},yield M.cx(ee,-1,-1,Ne,De)):ee,We=new M.cy(q,Te,X,he,ye,Pe,_e);return this.loaded=this.loaded||{},this.loaded[q]=We,We})}removeTile(R){const q=this.loaded,X=R.uid;q&&q[X]&&delete q[X]}}var ce,Ge,nt=function(){if(Ge)return ce;function xe(q,X){if(q.length!==0){R(q[0],X);for(var ee=1;ee<q.length;ee++)R(q[ee],!X)}}function R(q,X){for(var ee=0,he=0,ye=0,Pe=q.length,_e=Pe-1;ye<Pe;_e=ye++){var Ne=(q[ye][0]-q[_e][0])*(q[_e][1]+q[ye][1]),De=ee+Ne;he+=Math.abs(ee)>=Math.abs(Ne)?ee-De+Ne:Ne-De+ee,ee=De}ee+he>=0!=!!X&&q.reverse()}return Ge=1,ce=function q(X,ee){var he,ye=X&&X.type;if(ye==="FeatureCollection")for(he=0;he<X.features.length;he++)q(X.features[he],ee);else if(ye==="GeometryCollection")for(he=0;he<X.geometries.length;he++)q(X.geometries[he],ee);else if(ye==="Feature")q(X.geometry,ee);else if(ye==="Polygon")xe(X.coordinates,ee);else if(ye==="MultiPolygon")for(he=0;he<X.coordinates.length;he++)xe(X.coordinates[he],ee);return X}}(),gt=M.cz(nt);const qt=M.cu.VectorTileFeature.prototype.toGeoJSON;class Ft{constructor(R){this._feature=R,this.extent=M.Z,this.type=R.type,this.properties=R.tags,"id"in R&&!isNaN(R.id)&&(this.id=parseInt(R.id,10))}loadGeometry(){if(this._feature.type===1){const R=[];for(const q of this._feature.geometry)R.push([new M.P(q[0],q[1])]);return R}{const R=[];for(const q of this._feature.geometry){const X=[];for(const ee of q)X.push(new M.P(ee[0],ee[1]));R.push(X)}return R}}toGeoJSON(R,q,X){return qt.call(this,R,q,X)}}class Jt{constructor(R){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=M.Z,this.length=R.length,this._features=R}feature(R){return new Ft(this._features[R])}}var Mt,cr,Je,pt={exports:{}},Lt=function(){if(Je)return pt.exports;Je=1;var xe=M.cC(),R=function(){if(cr)return Mt;cr=1;var De=M.cA(),Te=M.cB().VectorTileFeature;function We(dt,Et){this.options=Et||{},this.features=dt,this.length=dt.length}function Se(dt,Et){this.id=typeof dt.id=="number"?dt.id:void 0,this.type=dt.type,this.rawGeometry=dt.type===1?[dt.geometry]:dt.geometry,this.properties=dt.tags,this.extent=Et||4096}return Mt=We,We.prototype.feature=function(dt){return new Se(this.features[dt],this.options.extent)},Se.prototype.loadGeometry=function(){var dt=this.rawGeometry;this.geometry=[];for(var Et=0;Et<dt.length;Et++){for(var Kt=dt[Et],Vt=[],$e=0;$e<Kt.length;$e++)Vt.push(new De(Kt[$e][0],Kt[$e][1]));this.geometry.push(Vt)}return this.geometry},Se.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var dt=this.geometry,Et=1/0,Kt=-1/0,Vt=1/0,$e=-1/0,vt=0;vt<dt.length;vt++)for(var yt=dt[vt],er=0;er<yt.length;er++){var Wt=yt[er];Et=Math.min(Et,Wt.x),Kt=Math.max(Kt,Wt.x),Vt=Math.min(Vt,Wt.y),$e=Math.max($e,Wt.y)}return[Et,Vt,Kt,$e]},Se.prototype.toGeoJSON=Te.prototype.toGeoJSON,Mt}();function q(De){var Te=new xe;return function(We,Se){for(var dt in We.layers)Se.writeMessage(3,X,We.layers[dt])}(De,Te),Te.finish()}function X(De,Te){var We;Te.writeVarintField(15,De.version||1),Te.writeStringField(1,De.name||""),Te.writeVarintField(5,De.extent||4096);var Se={keys:[],values:[],keycache:{},valuecache:{}};for(We=0;We<De.length;We++)Se.feature=De.feature(We),Te.writeMessage(2,ee,Se);var dt=Se.keys;for(We=0;We<dt.length;We++)Te.writeStringField(3,dt[We]);var Et=Se.values;for(We=0;We<Et.length;We++)Te.writeMessage(4,Ne,Et[We])}function ee(De,Te){var We=De.feature;We.id!==void 0&&Te.writeVarintField(1,We.id),Te.writeMessage(2,he,De),Te.writeVarintField(3,We.type),Te.writeMessage(4,_e,We)}function he(De,Te){var We=De.feature,Se=De.keys,dt=De.values,Et=De.keycache,Kt=De.valuecache;for(var Vt in We.properties){var $e=We.properties[Vt],vt=Et[Vt];if($e!==null){vt===void 0&&(Se.push(Vt),Et[Vt]=vt=Se.length-1),Te.writeVarint(vt);var yt=typeof $e;yt!=="string"&&yt!=="boolean"&&yt!=="number"&&($e=JSON.stringify($e));var er=yt+":"+$e,Wt=Kt[er];Wt===void 0&&(dt.push($e),Kt[er]=Wt=dt.length-1),Te.writeVarint(Wt)}}}function ye(De,Te){return(Te<<3)+(7&De)}function Pe(De){return De<<1^De>>31}function _e(De,Te){for(var We=De.loadGeometry(),Se=De.type,dt=0,Et=0,Kt=We.length,Vt=0;Vt<Kt;Vt++){var $e=We[Vt],vt=1;Se===1&&(vt=$e.length),Te.writeVarint(ye(1,vt));for(var yt=Se===3?$e.length-1:$e.length,er=0;er<yt;er++){er===1&&Se!==1&&Te.writeVarint(ye(2,yt-1));var Wt=$e[er].x-dt,ir=$e[er].y-Et;Te.writeVarint(Pe(Wt)),Te.writeVarint(Pe(ir)),dt+=Wt,Et+=ir}Se===3&&Te.writeVarint(ye(7,1))}}function Ne(De,Te){var We=typeof De;We==="string"?Te.writeStringField(1,De):We==="boolean"?Te.writeBooleanField(7,De):We==="number"&&(De%1!=0?Te.writeDoubleField(3,De):De<0?Te.writeSVarintField(6,De):Te.writeVarintField(5,De))}return pt.exports=q,pt.exports.fromVectorTileJs=q,pt.exports.fromGeojsonVt=function(De,Te){Te=Te||{};var We={};for(var Se in De)We[Se]=new R(De[Se].features,Te),We[Se].name=Se,We[Se].version=Te.version,We[Se].extent=Te.extent;return q({layers:We})},pt.exports.GeoJSONWrapper=R,pt.exports}(),Ct=M.cz(Lt);const rr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},sr=Math.fround||(Er=new Float32Array(1),xe=>(Er[0]=+xe,Er[0]));var Er;const _r=3,Tt=5,Nt=6;class bt{constructor(R){this.options=Object.assign(Object.create(rr),R),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(R){const{log:q,minZoom:X,maxZoom:ee}=this.options;q&&console.time("total time");const he=`prepare ${R.length} points`;q&&console.time(he),this.points=R;const ye=[];for(let _e=0;_e<R.length;_e++){const Ne=R[_e];if(!Ne.geometry)continue;const[De,Te]=Ne.geometry.coordinates,We=sr(et(De)),Se=sr(rt(Te));ye.push(We,Se,1/0,_e,-1,1),this.options.reduce&&ye.push(0)}let Pe=this.trees[ee+1]=this._createTree(ye);q&&console.timeEnd(he);for(let _e=ee;_e>=X;_e--){const Ne=+Date.now();Pe=this.trees[_e]=this._createTree(this._cluster(Pe,_e)),q&&console.log("z%d: %d clusters in %dms",_e,Pe.numItems,+Date.now()-Ne)}return q&&console.timeEnd("total time"),this}getClusters(R,q){let X=((R[0]+180)%360+360)%360-180;const ee=Math.max(-90,Math.min(90,R[1]));let he=R[2]===180?180:((R[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)X=-180,he=180;else if(X>he){const Te=this.getClusters([X,ee,180,ye],q),We=this.getClusters([-180,ee,he,ye],q);return Te.concat(We)}const Pe=this.trees[this._limitZoom(q)],_e=Pe.range(et(X),rt(ye),et(he),rt(ee)),Ne=Pe.data,De=[];for(const Te of _e){const We=this.stride*Te;De.push(Ne[We+Tt]>1?_t(Ne,We,this.clusterProps):this.points[Ne[We+_r]])}return De}getChildren(R){const q=this._getOriginId(R),X=this._getOriginZoom(R),ee="No cluster with the specified id.",he=this.trees[X];if(!he)throw new Error(ee);const ye=he.data;if(q*this.stride>=ye.length)throw new Error(ee);const Pe=this.options.radius/(this.options.extent*Math.pow(2,X-1)),_e=he.within(ye[q*this.stride],ye[q*this.stride+1],Pe),Ne=[];for(const De of _e){const Te=De*this.stride;ye[Te+4]===R&&Ne.push(ye[Te+Tt]>1?_t(ye,Te,this.clusterProps):this.points[ye[Te+_r]])}if(Ne.length===0)throw new Error(ee);return Ne}getLeaves(R,q,X){const ee=[];return this._appendLeaves(ee,R,q=q||10,X=X||0,0),ee}getTile(R,q,X){const ee=this.trees[this._limitZoom(R)],he=Math.pow(2,R),{extent:ye,radius:Pe}=this.options,_e=Pe/ye,Ne=(X-_e)/he,De=(X+1+_e)/he,Te={features:[]};return this._addTileFeatures(ee.range((q-_e)/he,Ne,(q+1+_e)/he,De),ee.data,q,X,he,Te),q===0&&this._addTileFeatures(ee.range(1-_e/he,Ne,1,De),ee.data,he,X,he,Te),q===he-1&&this._addTileFeatures(ee.range(0,Ne,_e/he,De),ee.data,-1,X,he,Te),Te.features.length?Te:null}getClusterExpansionZoom(R){let q=this._getOriginZoom(R)-1;for(;q<=this.options.maxZoom;){const X=this.getChildren(R);if(q++,X.length!==1)break;R=X[0].properties.cluster_id}return q}_appendLeaves(R,q,X,ee,he){const ye=this.getChildren(q);for(const Pe of ye){const _e=Pe.properties;if(_e&&_e.cluster?he+_e.point_count<=ee?he+=_e.point_count:he=this._appendLeaves(R,_e.cluster_id,X,ee,he):he<ee?he++:R.push(Pe),R.length===X)break}return he}_createTree(R){const q=new M.aB(R.length/this.stride|0,this.options.nodeSize,Float32Array);for(let X=0;X<R.length;X+=this.stride)q.add(R[X],R[X+1]);return q.finish(),q.data=R,q}_addTileFeatures(R,q,X,ee,he,ye){for(const Pe of R){const _e=Pe*this.stride,Ne=q[_e+Tt]>1;let De,Te,We;if(Ne)De=Re(q,_e,this.clusterProps),Te=q[_e],We=q[_e+1];else{const Et=this.points[q[_e+_r]];De=Et.properties;const[Kt,Vt]=Et.geometry.coordinates;Te=et(Kt),We=rt(Vt)}const Se={type:1,geometry:[[Math.round(this.options.extent*(Te*he-X)),Math.round(this.options.extent*(We*he-ee))]],tags:De};let dt;dt=Ne||this.options.generateId?q[_e+_r]:this.points[q[_e+_r]].id,dt!==void 0&&(Se.id=dt),ye.features.push(Se)}}_limitZoom(R){return Math.max(this.options.minZoom,Math.min(Math.floor(+R),this.options.maxZoom+1))}_cluster(R,q){const{radius:X,extent:ee,reduce:he,minPoints:ye}=this.options,Pe=X/(ee*Math.pow(2,q)),_e=R.data,Ne=[],De=this.stride;for(let Te=0;Te<_e.length;Te+=De){if(_e[Te+2]<=q)continue;_e[Te+2]=q;const We=_e[Te],Se=_e[Te+1],dt=R.within(_e[Te],_e[Te+1],Pe),Et=_e[Te+Tt];let Kt=Et;for(const Vt of dt){const $e=Vt*De;_e[$e+2]>q&&(Kt+=_e[$e+Tt])}if(Kt>Et&&Kt>=ye){let Vt,$e=We*Et,vt=Se*Et,yt=-1;const er=((Te/De|0)<<5)+(q+1)+this.points.length;for(const Wt of dt){const ir=Wt*De;if(_e[ir+2]<=q)continue;_e[ir+2]=q;const Bt=_e[ir+Tt];$e+=_e[ir]*Bt,vt+=_e[ir+1]*Bt,_e[ir+4]=er,he&&(Vt||(Vt=this._map(_e,Te,!0),yt=this.clusterProps.length,this.clusterProps.push(Vt)),he(Vt,this._map(_e,ir)))}_e[Te+4]=er,Ne.push($e/Kt,vt/Kt,1/0,er,-1,Kt),he&&Ne.push(yt)}else{for(let Vt=0;Vt<De;Vt++)Ne.push(_e[Te+Vt]);if(Kt>1)for(const Vt of dt){const $e=Vt*De;if(!(_e[$e+2]<=q)){_e[$e+2]=q;for(let vt=0;vt<De;vt++)Ne.push(_e[$e+vt])}}}}return Ne}_getOriginId(R){return R-this.points.length>>5}_getOriginZoom(R){return(R-this.points.length)%32}_map(R,q,X){if(R[q+Tt]>1){const ye=this.clusterProps[R[q+Nt]];return X?Object.assign({},ye):ye}const ee=this.points[R[q+_r]].properties,he=this.options.map(ee);return X&&he===ee?Object.assign({},he):he}}function _t(xe,R,q){return{type:"Feature",id:xe[R+_r],properties:Re(xe,R,q),geometry:{type:"Point",coordinates:[(X=xe[R],360*(X-.5)),me(xe[R+1])]}};var X}function Re(xe,R,q){const X=xe[R+Tt],ee=X>=1e4?`${Math.round(X/1e3)}k`:X>=1e3?Math.round(X/100)/10+"k":X,he=xe[R+Nt],ye=he===-1?{}:Object.assign({},q[he]);return Object.assign(ye,{cluster:!0,cluster_id:xe[R+_r],point_count:X,point_count_abbreviated:ee})}function et(xe){return xe/360+.5}function rt(xe){const R=Math.sin(xe*Math.PI/180),q=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return q<0?0:q>1?1:q}function me(xe){const R=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(R))/Math.PI-90}function Ae(xe,R,q,X){let ee=X;const he=R+(q-R>>1);let ye,Pe=q-R;const _e=xe[R],Ne=xe[R+1],De=xe[q],Te=xe[q+1];for(let We=R+3;We<q;We+=3){const Se=kt(xe[We],xe[We+1],_e,Ne,De,Te);if(Se>ee)ye=We,ee=Se;else if(Se===ee){const dt=Math.abs(We-he);dt<Pe&&(ye=We,Pe=dt)}}ee>X&&(ye-R>3&&Ae(xe,R,ye,X),xe[ye+2]=ee,q-ye>3&&Ae(xe,ye,q,X))}function kt(xe,R,q,X,ee,he){let ye=ee-q,Pe=he-X;if(ye!==0||Pe!==0){const _e=((xe-q)*ye+(R-X)*Pe)/(ye*ye+Pe*Pe);_e>1?(q=ee,X=he):_e>0&&(q+=ye*_e,X+=Pe*_e)}return ye=xe-q,Pe=R-X,ye*ye+Pe*Pe}function ut(xe,R,q,X){const ee={id:xe??null,type:R,geometry:q,tags:X,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(R==="Point"||R==="MultiPoint"||R==="LineString")Xe(ee,q);else if(R==="Polygon")Xe(ee,q[0]);else if(R==="MultiLineString")for(const he of q)Xe(ee,he);else if(R==="MultiPolygon")for(const he of q)Xe(ee,he[0]);return ee}function Xe(xe,R){for(let q=0;q<R.length;q+=3)xe.minX=Math.min(xe.minX,R[q]),xe.minY=Math.min(xe.minY,R[q+1]),xe.maxX=Math.max(xe.maxX,R[q]),xe.maxY=Math.max(xe.maxY,R[q+1])}function st(xe,R,q,X){if(!R.geometry)return;const ee=R.geometry.coordinates;if(ee&&ee.length===0)return;const he=R.geometry.type,ye=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2);let Pe=[],_e=R.id;if(q.promoteId?_e=R.properties[q.promoteId]:q.generateId&&(_e=X||0),he==="Point")xt(ee,Pe);else if(he==="MultiPoint")for(const Ne of ee)xt(Ne,Pe);else if(he==="LineString")mt(ee,Pe,ye,!1);else if(he==="MultiLineString"){if(q.lineMetrics){for(const Ne of ee)Pe=[],mt(Ne,Pe,ye,!1),xe.push(ut(_e,"LineString",Pe,R.properties));return}St(ee,Pe,ye,!1)}else if(he==="Polygon")St(ee,Pe,ye,!0);else{if(he!=="MultiPolygon"){if(he==="GeometryCollection"){for(const Ne of R.geometry.geometries)st(xe,{id:_e,geometry:Ne,properties:R.properties},q,X);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ne of ee){const De=[];St(Ne,De,ye,!0),Pe.push(De)}}xe.push(ut(_e,he,Pe,R.properties))}function xt(xe,R){R.push(lr(xe[0]),or(xe[1]),0)}function mt(xe,R,q,X){let ee,he,ye=0;for(let _e=0;_e<xe.length;_e++){const Ne=lr(xe[_e][0]),De=or(xe[_e][1]);R.push(Ne,De,0),_e>0&&(ye+=X?(ee*De-Ne*he)/2:Math.sqrt(Math.pow(Ne-ee,2)+Math.pow(De-he,2))),ee=Ne,he=De}const Pe=R.length-3;R[2]=1,Ae(R,0,Pe,q),R[Pe+2]=1,R.size=Math.abs(ye),R.start=0,R.end=R.size}function St(xe,R,q,X){for(let ee=0;ee<xe.length;ee++){const he=[];mt(xe[ee],he,q,X),R.push(he)}}function lr(xe){return xe/360+.5}function or(xe){const R=Math.sin(xe*Math.PI/180),q=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return q<0?0:q>1?1:q}function Mr(xe,R,q,X,ee,he,ye,Pe){if(X/=R,he>=(q/=R)&&ye<X)return xe;if(ye<q||he>=X)return null;const _e=[];for(const Ne of xe){const De=Ne.geometry;let Te=Ne.type;const We=ee===0?Ne.minX:Ne.minY,Se=ee===0?Ne.maxX:Ne.maxY;if(We>=q&&Se<X){_e.push(Ne);continue}if(Se<q||We>=X)continue;let dt=[];if(Te==="Point"||Te==="MultiPoint")kr(De,dt,q,X,ee);else if(Te==="LineString")Ar(De,dt,q,X,ee,!1,Pe.lineMetrics);else if(Te==="MultiLineString")$i(De,dt,q,X,ee,!1);else if(Te==="Polygon")$i(De,dt,q,X,ee,!0);else if(Te==="MultiPolygon")for(const Et of De){const Kt=[];$i(Et,Kt,q,X,ee,!0),Kt.length&&dt.push(Kt)}if(dt.length){if(Pe.lineMetrics&&Te==="LineString"){for(const Et of dt)_e.push(ut(Ne.id,Te,Et,Ne.tags));continue}Te!=="LineString"&&Te!=="MultiLineString"||(dt.length===1?(Te="LineString",dt=dt[0]):Te="MultiLineString"),Te!=="Point"&&Te!=="MultiPoint"||(Te=dt.length===3?"Point":"MultiPoint"),_e.push(ut(Ne.id,Te,dt,Ne.tags))}}return _e.length?_e:null}function kr(xe,R,q,X,ee){for(let he=0;he<xe.length;he+=3){const ye=xe[he+ee];ye>=q&&ye<=X&&Tn(R,xe[he],xe[he+1],xe[he+2])}}function Ar(xe,R,q,X,ee,he,ye){let Pe=di(xe);const _e=ee===0?tn:ri;let Ne,De,Te=xe.start;for(let Kt=0;Kt<xe.length-3;Kt+=3){const Vt=xe[Kt],$e=xe[Kt+1],vt=xe[Kt+2],yt=xe[Kt+3],er=xe[Kt+4],Wt=ee===0?Vt:$e,ir=ee===0?yt:er;let Bt=!1;ye&&(Ne=Math.sqrt(Math.pow(Vt-yt,2)+Math.pow($e-er,2))),Wt<q?ir>q&&(De=_e(Pe,Vt,$e,yt,er,q),ye&&(Pe.start=Te+Ne*De)):Wt>X?ir<X&&(De=_e(Pe,Vt,$e,yt,er,X),ye&&(Pe.start=Te+Ne*De)):Tn(Pe,Vt,$e,vt),ir<q&&Wt>=q&&(De=_e(Pe,Vt,$e,yt,er,q),Bt=!0),ir>X&&Wt<=X&&(De=_e(Pe,Vt,$e,yt,er,X),Bt=!0),!he&&Bt&&(ye&&(Pe.end=Te+Ne*De),R.push(Pe),Pe=di(xe)),ye&&(Te+=Ne)}let We=xe.length-3;const Se=xe[We],dt=xe[We+1],Et=ee===0?Se:dt;Et>=q&&Et<=X&&Tn(Pe,Se,dt,xe[We+2]),We=Pe.length-3,he&&We>=3&&(Pe[We]!==Pe[0]||Pe[We+1]!==Pe[1])&&Tn(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&R.push(Pe)}function di(xe){const R=[];return R.size=xe.size,R.start=xe.start,R.end=xe.end,R}function $i(xe,R,q,X,ee,he){for(const ye of xe)Ar(ye,R,q,X,ee,he,!1)}function Tn(xe,R,q,X){xe.push(R,q,X)}function tn(xe,R,q,X,ee,he){const ye=(he-R)/(X-R);return Tn(xe,he,q+(ee-q)*ye,1),ye}function ri(xe,R,q,X,ee,he){const ye=(he-q)/(ee-q);return Tn(xe,R+(X-R)*ye,he,1),ye}function zn(xe,R){const q=[];for(let X=0;X<xe.length;X++){const ee=xe[X],he=ee.type;let ye;if(he==="Point"||he==="MultiPoint"||he==="LineString")ye=rn(ee.geometry,R);else if(he==="MultiLineString"||he==="Polygon"){ye=[];for(const Pe of ee.geometry)ye.push(rn(Pe,R))}else if(he==="MultiPolygon"){ye=[];for(const Pe of ee.geometry){const _e=[];for(const Ne of Pe)_e.push(rn(Ne,R));ye.push(_e)}}q.push(ut(ee.id,he,ye,ee.tags))}return q}function rn(xe,R){const q=[];q.size=xe.size,xe.start!==void 0&&(q.start=xe.start,q.end=xe.end);for(let X=0;X<xe.length;X+=3)q.push(xe[X]+R,xe[X+1],xe[X+2]);return q}function Nn(xe,R){if(xe.transformed)return xe;const q=1<<xe.z,X=xe.x,ee=xe.y;for(const he of xe.features){const ye=he.geometry,Pe=he.type;if(he.geometry=[],Pe===1)for(let _e=0;_e<ye.length;_e+=2)he.geometry.push(Ui(ye[_e],ye[_e+1],R,q,X,ee));else for(let _e=0;_e<ye.length;_e++){const Ne=[];for(let De=0;De<ye[_e].length;De+=2)Ne.push(Ui(ye[_e][De],ye[_e][De+1],R,q,X,ee));he.geometry.push(Ne)}}return xe.transformed=!0,xe}function Ui(xe,R,q,X,ee,he){return[Math.round(q*(xe*X-ee)),Math.round(q*(R*X-he))]}function ao(xe,R,q,X,ee){const he=R===ee.maxZoom?0:ee.tolerance/((1<<R)*ee.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:q,y:X,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Pe of xe)wo(ye,Pe,he,ee);return ye}function wo(xe,R,q,X){const ee=R.geometry,he=R.type,ye=[];if(xe.minX=Math.min(xe.minX,R.minX),xe.minY=Math.min(xe.minY,R.minY),xe.maxX=Math.max(xe.maxX,R.maxX),xe.maxY=Math.max(xe.maxY,R.maxY),he==="Point"||he==="MultiPoint")for(let Pe=0;Pe<ee.length;Pe+=3)ye.push(ee[Pe],ee[Pe+1]),xe.numPoints++,xe.numSimplified++;else if(he==="LineString")Zi(ye,ee,xe,q,!1,!1);else if(he==="MultiLineString"||he==="Polygon")for(let Pe=0;Pe<ee.length;Pe++)Zi(ye,ee[Pe],xe,q,he==="Polygon",Pe===0);else if(he==="MultiPolygon")for(let Pe=0;Pe<ee.length;Pe++){const _e=ee[Pe];for(let Ne=0;Ne<_e.length;Ne++)Zi(ye,_e[Ne],xe,q,!0,Ne===0)}if(ye.length){let Pe=R.tags||null;if(he==="LineString"&&X.lineMetrics){Pe={};for(const Ne in R.tags)Pe[Ne]=R.tags[Ne];Pe.mapbox_clip_start=ee.start/ee.size,Pe.mapbox_clip_end=ee.end/ee.size}const _e={geometry:ye,type:he==="Polygon"||he==="MultiPolygon"?3:he==="LineString"||he==="MultiLineString"?2:1,tags:Pe};R.id!==null&&(_e.id=R.id),xe.features.push(_e)}}function Zi(xe,R,q,X,ee,he){const ye=X*X;if(X>0&&R.size<(ee?ye:X))return void(q.numPoints+=R.length/3);const Pe=[];for(let _e=0;_e<R.length;_e+=3)(X===0||R[_e+2]>ye)&&(q.numSimplified++,Pe.push(R[_e],R[_e+1])),q.numPoints++;ee&&function(_e,Ne){let De=0;for(let Te=0,We=_e.length,Se=We-2;Te<We;Se=Te,Te+=2)De+=(_e[Te]-_e[Se])*(_e[Te+1]+_e[Se+1]);if(De>0===Ne)for(let Te=0,We=_e.length;Te<We/2;Te+=2){const Se=_e[Te],dt=_e[Te+1];_e[Te]=_e[We-2-Te],_e[Te+1]=_e[We-1-Te],_e[We-2-Te]=Se,_e[We-1-Te]=dt}}(Pe,he),xe.push(Pe)}const pi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ni{constructor(R,q){const X=(q=this.options=function(he,ye){for(const Pe in ye)he[Pe]=ye[Pe];return he}(Object.create(pi),q)).debug;if(X&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");let ee=function(he,ye){const Pe=[];if(he.type==="FeatureCollection")for(let _e=0;_e<he.features.length;_e++)st(Pe,he.features[_e],ye,_e);else st(Pe,he.type==="Feature"?he:{geometry:he},ye);return Pe}(R,q);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ee=function(he,ye){const Pe=ye.buffer/ye.extent;let _e=he;const Ne=Mr(he,1,-1-Pe,Pe,0,-1,2,ye),De=Mr(he,1,1-Pe,2+Pe,0,-1,2,ye);return(Ne||De)&&(_e=Mr(he,1,-Pe,1+Pe,0,-1,2,ye)||[],Ne&&(_e=zn(Ne,1).concat(_e)),De&&(_e=_e.concat(zn(De,-1)))),_e}(ee,q),ee.length&&this.splitTile(ee,0,0,0),X&&(ee.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(R,q,X,ee,he,ye,Pe){const _e=[R,q,X,ee],Ne=this.options,De=Ne.debug;for(;_e.length;){ee=_e.pop(),X=_e.pop(),q=_e.pop(),R=_e.pop();const Te=1<<q,We=fi(q,X,ee);let Se=this.tiles[We];if(!Se&&(De>1&&console.time("creation"),Se=this.tiles[We]=ao(R,q,X,ee,Ne),this.tileCoords.push({z:q,x:X,y:ee}),De)){De>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,X,ee,Se.numFeatures,Se.numPoints,Se.numSimplified),console.timeEnd("creation"));const Bt=`z${q}`;this.stats[Bt]=(this.stats[Bt]||0)+1,this.total++}if(Se.source=R,he==null){if(q===Ne.indexMaxZoom||Se.numPoints<=Ne.indexMaxPoints)continue}else{if(q===Ne.maxZoom||q===he)continue;if(he!=null){const Bt=he-q;if(X!==ye>>Bt||ee!==Pe>>Bt)continue}}if(Se.source=null,R.length===0)continue;De>1&&console.time("clipping");const dt=.5*Ne.buffer/Ne.extent,Et=.5-dt,Kt=.5+dt,Vt=1+dt;let $e=null,vt=null,yt=null,er=null,Wt=Mr(R,Te,X-dt,X+Kt,0,Se.minX,Se.maxX,Ne),ir=Mr(R,Te,X+Et,X+Vt,0,Se.minX,Se.maxX,Ne);R=null,Wt&&($e=Mr(Wt,Te,ee-dt,ee+Kt,1,Se.minY,Se.maxY,Ne),vt=Mr(Wt,Te,ee+Et,ee+Vt,1,Se.minY,Se.maxY,Ne),Wt=null),ir&&(yt=Mr(ir,Te,ee-dt,ee+Kt,1,Se.minY,Se.maxY,Ne),er=Mr(ir,Te,ee+Et,ee+Vt,1,Se.minY,Se.maxY,Ne),ir=null),De>1&&console.timeEnd("clipping"),_e.push($e||[],q+1,2*X,2*ee),_e.push(vt||[],q+1,2*X,2*ee+1),_e.push(yt||[],q+1,2*X+1,2*ee),_e.push(er||[],q+1,2*X+1,2*ee+1)}}getTile(R,q,X){R=+R,q=+q,X=+X;const ee=this.options,{extent:he,debug:ye}=ee;if(R<0||R>24)return null;const Pe=1<<R,_e=fi(R,q=q+Pe&Pe-1,X);if(this.tiles[_e])return Nn(this.tiles[_e],he);ye>1&&console.log("drilling down to z%d-%d-%d",R,q,X);let Ne,De=R,Te=q,We=X;for(;!Ne&&De>0;)De--,Te>>=1,We>>=1,Ne=this.tiles[fi(De,Te,We)];return Ne&&Ne.source?(ye>1&&(console.log("found parent tile z%d-%d-%d",De,Te,We),console.time("drilling down")),this.splitTile(Ne.source,De,Te,We,R,q,X),ye>1&&console.timeEnd("drilling down"),this.tiles[_e]?Nn(this.tiles[_e],he):null):null}}function fi(xe,R,q){return 32*((1<<xe)*q+R)+xe}function mi(xe,R){return R?xe.properties[R]:xe.id}function Gi(xe,R){if(xe==null)return!0;if(xe.type==="Feature")return mi(xe,R)!=null;if(xe.type==="FeatureCollection"){const q=new Set;for(const X of xe.features){const ee=mi(X,R);if(ee==null||q.has(ee))return!1;q.add(ee)}return!0}return!1}function so(xe,R){const q=new Map;if(xe!=null)if(xe.type==="Feature")q.set(mi(xe,R),xe);else for(const X of xe.features)q.set(mi(X,R),X);return q}class na extends Ve{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(R,q){return M._(this,void 0,void 0,function*(){const X=R.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ee=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!ee)return null;const he=new Jt(ee.features);let ye=Ct(he);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:he,rawData:ye.buffer}})}loadData(R){return M._(this,void 0,void 0,function*(){var q;(q=this._pendingRequest)===null||q===void 0||q.abort();const X=!!(R&&R.request&&R.request.collectResourceTiming)&&new M.cw(R.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(R,this._pendingRequest),this._geoJSONIndex=R.cluster?new bt(function({superclusterOptions:ye,clusterProperties:Pe}){if(!Pe||!ye)return ye;const _e={},Ne={},De={accumulated:null,zoom:0},Te={properties:null},We=Object.keys(Pe);for(const Se of We){const[dt,Et]=Pe[Se],Kt=M.cD(Et),Vt=M.cD(typeof dt=="string"?[dt,["accumulated"],["get",Se]]:dt);_e[Se]=Kt.value,Ne[Se]=Vt.value}return ye.map=Se=>{Te.properties=Se;const dt={};for(const Et of We)dt[Et]=_e[Et].evaluate(De,Te);return dt},ye.reduce=(Se,dt)=>{Te.properties=dt;for(const Et of We)De.accumulated=Se[Et],Se[Et]=Ne[Et].evaluate(De,Te)},ye}(R)).load((yield this._pendingData).features):(ee=yield this._pendingData,new ni(ee,R.geojsonVtOptions)),this.loaded={};const he={};if(X){const ye=X.finish();ye&&(he.resourceTiming={},he.resourceTiming[R.source]=JSON.parse(JSON.stringify(ye)))}return he}catch(he){if(delete this._pendingRequest,M.ch(he))return{abandoned:!0};throw he}var ee})}getData(){return M._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(R){const q=this.loaded;return q&&q[R.uid]?super.reloadTile(R):this.loadTile(R)}loadAndProcessGeoJSON(R,q){return M._(this,void 0,void 0,function*(){let X=yield this.loadGeoJSON(R,q);if(delete this._pendingRequest,typeof X!="object")throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`);if(gt(X,!0),R.filter){const ee=M.cD(R.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ee.result==="error")throw new Error(ee.value.map(ye=>`${ye.key}: ${ye.message}`).join(", "));X={type:"FeatureCollection",features:X.features.filter(ye=>ee.value.evaluate({zoom:0},ye))}}return X})}loadGeoJSON(R,q){return M._(this,void 0,void 0,function*(){const{promoteId:X}=R;if(R.request){const ee=yield M.j(R.request,q);return this._dataUpdateable=Gi(ee.data,X)?so(ee.data,X):void 0,ee.data}if(typeof R.data=="string")try{const ee=JSON.parse(R.data);return this._dataUpdateable=Gi(ee,X)?so(ee,X):void 0,ee}catch{throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`)}if(!R.dataDiff)throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${R.source}`);return function(ee,he,ye){var Pe,_e,Ne,De;if(he.removeAll&&ee.clear(),he.remove)for(const Te of he.remove)ee.delete(Te);if(he.add)for(const Te of he.add){const We=mi(Te,ye);We!=null&&ee.set(We,Te)}if(he.update)for(const Te of he.update){let We=ee.get(Te.id);if(We==null)continue;const Se=!Te.removeAllProperties&&(((Pe=Te.removeProperties)===null||Pe===void 0?void 0:Pe.length)>0||((_e=Te.addOrUpdateProperties)===null||_e===void 0?void 0:_e.length)>0);if((Te.newGeometry||Te.removeAllProperties||Se)&&(We=Object.assign({},We),ee.set(Te.id,We),Se&&(We.properties=Object.assign({},We.properties))),Te.newGeometry&&(We.geometry=Te.newGeometry),Te.removeAllProperties)We.properties={};else if(((Ne=Te.removeProperties)===null||Ne===void 0?void 0:Ne.length)>0)for(const dt of Te.removeProperties)Object.prototype.hasOwnProperty.call(We.properties,dt)&&delete We.properties[dt];if(((De=Te.addOrUpdateProperties)===null||De===void 0?void 0:De.length)>0)for(const{key:dt,value:Et}of Te.addOrUpdateProperties)We.properties[dt]=Et}}(this._dataUpdateable,R.dataDiff,X),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(R){return M._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(R){return this._geoJSONIndex.getClusterExpansionZoom(R.clusterId)}getClusterChildren(R){return this._geoJSONIndex.getChildren(R.clusterId)}getClusterLeaves(R){return this._geoJSONIndex.getLeaves(R.clusterId,R.limit,R.offset)}}class Ai{constructor(R){this.self=R,this.actor=new M.H(R),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(q,X)=>{if(this.externalWorkerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.externalWorkerSourceTypes[q]=X},this.self.addProtocol=M.cj,this.self.removeProtocol=M.ck,this.self.registerRTLTextPlugin=q=>{M.cE.setMethods(q)},this.actor.registerMessageHandler("LDT",(q,X)=>this._getDEMWorkerSource(q,X.source).loadTile(X)),this.actor.registerMessageHandler("RDT",(q,X)=>M._(this,void 0,void 0,function*(){this._getDEMWorkerSource(q,X.source).removeTile(X)})),this.actor.registerMessageHandler("GCEZ",(q,X)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(q,X.type,X.source).getClusterExpansionZoom(X)})),this.actor.registerMessageHandler("GCC",(q,X)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(q,X.type,X.source).getClusterChildren(X)})),this.actor.registerMessageHandler("GCL",(q,X)=>M._(this,void 0,void 0,function*(){return this._getWorkerSource(q,X.type,X.source).getClusterLeaves(X)})),this.actor.registerMessageHandler("LD",(q,X)=>this._getWorkerSource(q,X.type,X.source).loadData(X)),this.actor.registerMessageHandler("GD",(q,X)=>this._getWorkerSource(q,X.type,X.source).getData()),this.actor.registerMessageHandler("LT",(q,X)=>this._getWorkerSource(q,X.type,X.source).loadTile(X)),this.actor.registerMessageHandler("RT",(q,X)=>this._getWorkerSource(q,X.type,X.source).reloadTile(X)),this.actor.registerMessageHandler("AT",(q,X)=>this._getWorkerSource(q,X.type,X.source).abortTile(X)),this.actor.registerMessageHandler("RMT",(q,X)=>this._getWorkerSource(q,X.type,X.source).removeTile(X)),this.actor.registerMessageHandler("RS",(q,X)=>M._(this,void 0,void 0,function*(){if(!this.workerSources[q]||!this.workerSources[q][X.type]||!this.workerSources[q][X.type][X.source])return;const ee=this.workerSources[q][X.type][X.source];delete this.workerSources[q][X.type][X.source],ee.removeSource!==void 0&&ee.removeSource(X)})),this.actor.registerMessageHandler("RM",q=>M._(this,void 0,void 0,function*(){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q]})),this.actor.registerMessageHandler("SR",(q,X)=>M._(this,void 0,void 0,function*(){this.referrer=X})),this.actor.registerMessageHandler("SRPS",(q,X)=>this._syncRTLPluginState(q,X)),this.actor.registerMessageHandler("IS",(q,X)=>M._(this,void 0,void 0,function*(){this.self.importScripts(X)})),this.actor.registerMessageHandler("SI",(q,X)=>this._setImages(q,X)),this.actor.registerMessageHandler("UL",(q,X)=>M._(this,void 0,void 0,function*(){this._getLayerIndex(q).update(X.layers,X.removedIds)})),this.actor.registerMessageHandler("SL",(q,X)=>M._(this,void 0,void 0,function*(){this._getLayerIndex(q).replace(X)}))}_setImages(R,q){return M._(this,void 0,void 0,function*(){this.availableImages[R]=q;for(const X in this.workerSources[R]){const ee=this.workerSources[R][X];for(const he in ee)ee[he].availableImages=q}})}_syncRTLPluginState(R,q){return M._(this,void 0,void 0,function*(){return yield M.cE.syncState(q,this.self.importScripts)})}_getAvailableImages(R){let q=this.availableImages[R];return q||(q=[]),q}_getLayerIndex(R){let q=this.layerIndexes[R];return q||(q=this.layerIndexes[R]=new h),q}_getWorkerSource(R,q,X){if(this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][q]||(this.workerSources[R][q]={}),!this.workerSources[R][q][X]){const ee={sendAsync:(he,ye)=>(he.targetMapId=R,this.actor.sendAsync(he,ye))};switch(q){case"vector":this.workerSources[R][q][X]=new Ve(ee,this._getLayerIndex(R),this._getAvailableImages(R));break;case"geojson":this.workerSources[R][q][X]=new na(ee,this._getLayerIndex(R),this._getAvailableImages(R));break;default:this.workerSources[R][q][X]=new this.externalWorkerSourceTypes[q](ee,this._getLayerIndex(R),this._getAvailableImages(R))}}return this.workerSources[R][q][X]}_getDEMWorkerSource(R,q){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][q]||(this.demWorkerSources[R][q]=new ze),this.demWorkerSources[R][q]}}return M.i(self)&&(self.worker=new Ai(self)),Ai}),W("index",["exports","./shared"],function(M,h){var Me="5.2.0";function Ze(){var d=new h.A(4);return h.A!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d}let qe,Ve;const ze={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(d,e,r){const l=requestAnimationFrame(p=>{u(),e(p)}),{unsubscribe:u}=h.s(d.signal,"abort",()=>{u(),cancelAnimationFrame(l),r(h.c())},!1)},frameAsync(d){return new Promise((e,r)=>{this.frame(d,e,r)})},getImageData(d,e=0){return this.getImageCanvasContext(d).getImageData(-e,-e,d.width+2*e,d.height+2*e)},getImageCanvasContext(d){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=d.width,e.height=d.height,r.drawImage(d,0,0,d.width,d.height),r},resolveURL:d=>(qe||(qe=document.createElement("a")),qe.href=d,qe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ve==null&&(Ve=matchMedia("(prefers-reduced-motion: reduce)")),Ve.matches)}};class ce{static testProp(e){if(!ce.docStyle)return e[0];for(let r=0;r<e.length;r++)if(e[r]in ce.docStyle)return e[r];return e[0]}static create(e,r,l){const u=window.document.createElement(e);return r!==void 0&&(u.className=r),l&&l.appendChild(u),u}static createNS(e,r){return window.document.createElementNS(e,r)}static disableDrag(){ce.docStyle&&ce.selectProp&&(ce.userSelect=ce.docStyle[ce.selectProp],ce.docStyle[ce.selectProp]="none")}static enableDrag(){ce.docStyle&&ce.selectProp&&(ce.docStyle[ce.selectProp]=ce.userSelect)}static setTransform(e,r){e.style[ce.transformProp]=r}static addEventListener(e,r,l,u={}){e.addEventListener(r,l,"passive"in u?u:u.capture)}static removeEventListener(e,r,l,u={}){e.removeEventListener(r,l,"passive"in u?u:u.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ce.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ce.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ce.suppressClickInternal,!0)},0)}static getScale(e){const r=e.getBoundingClientRect();return{x:r.width/e.offsetWidth||1,y:r.height/e.offsetHeight||1,boundingClientRect:r}}static getPoint(e,r,l){const u=r.boundingClientRect;return new h.P((l.clientX-u.left)/r.x-e.clientLeft,(l.clientY-u.top)/r.y-e.clientTop)}static mousePos(e,r){const l=ce.getScale(e);return ce.getPoint(e,l,r)}static touchPos(e,r){const l=[],u=ce.getScale(e);for(let p=0;p<r.length;p++)l.push(ce.getPoint(e,u,r[p]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const r=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=r.querySelectorAll("script");for(const u of l)u.remove();return ce.clean(r),r.innerHTML}static isPossiblyDangerous(e,r){const l=r.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const r=e.children;for(const l of r)ce.removeAttributes(l),ce.clean(l)}static removeAttributes(e){for(const{name:r,value:l}of e.attributes)ce.isPossiblyDangerous(r,l)&&e.removeAttribute(r)}}ce.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ce.selectProp=ce.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ce.transformProp=ce.testProp(["transform","WebkitTransform"]);const Ge={supported:!1,testSupport:function(d){!qt&&gt&&(Ft?Jt(d):nt=d)}};let nt,gt,qt=!1,Ft=!1;function Jt(d){const e=d.createTexture();d.bindTexture(d.TEXTURE_2D,e);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,gt),d.isContextLost())return;Ge.supported=!0}catch{}d.deleteTexture(e),qt=!0}var Mt;typeof document<"u"&&(gt=document.createElement("img"),gt.onload=()=>{nt&&Jt(nt),nt=null,Ft=!0},gt.onerror=()=>{qt=!0,nt=null},gt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(d){let e,r,l,u;d.resetRequestQueue=()=>{e=[],r=0,l=0,u={}},d.addThrottleControl=w=>{const P=l++;return u[P]=w,P},d.removeThrottleControl=w=>{delete u[w],_()},d.getImage=(w,P,A=!0)=>new Promise((D,O)=>{Ge.supported&&(w.headers||(w.headers={}),w.headers.accept="image/webp,*/*"),h.e(w,{type:"image"}),e.push({abortController:P,requestParameters:w,supportImageRefresh:A,state:"queued",onError:$=>{O($)},onSuccess:$=>{D($)}}),_()});const p=w=>h._(this,void 0,void 0,function*(){w.state="running";const{requestParameters:P,supportImageRefresh:A,onError:D,onSuccess:O,abortController:$}=w,U=A===!1&&!h.i(self)&&!h.g(P.url)&&(!P.headers||Object.keys(P.headers).reduce((J,re)=>J&&re==="accept",!0));r++;const Q=U?x(P,$):h.m(P,$);try{const J=yield Q;delete w.abortController,w.state="completed",J.data instanceof HTMLImageElement||h.b(J.data)?O(J):J.data&&O({data:yield(Y=J.data,typeof createImageBitmap=="function"?h.f(Y):h.h(Y)),cacheControl:J.cacheControl,expires:J.expires})}catch(J){delete w.abortController,D(J)}finally{r--,_()}var Y}),_=()=>{const w=(()=>{for(const P of Object.keys(u))if(u[P]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let P=r;P<w&&e.length>0;P++){const A=e.shift();A.abortController.signal.aborted?P--:p(A)}},x=(w,P)=>new Promise((A,D)=>{const O=new Image,$=w.url,U=w.credentials;U&&U==="include"?O.crossOrigin="use-credentials":(U&&U==="same-origin"||!h.d($))&&(O.crossOrigin="anonymous"),P.signal.addEventListener("abort",()=>{O.src="",D(h.c())}),O.fetchPriority="high",O.onload=()=>{O.onerror=O.onload=null,A({data:O})},O.onerror=()=>{O.onerror=O.onload=null,P.signal.aborted||D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},O.src=$})}(Mt||(Mt={})),Mt.resetRequestQueue();class cr{constructor(e){this._transformRequestFn=e}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Je(d){const e=[];if(typeof d=="string")e.push({id:"default",url:d});else if(d&&d.length>0){const r=[];for(const{id:l,url:u}of d){const p=`${l}${u}`;r.indexOf(p)===-1&&(r.push(p),e.push({id:l,url:u}))}}return e}function pt(d,e,r){try{const l=new URL(d);return l.pathname+=`${e}${r}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${d}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Lt{constructor(e,r,l,u){this.context=e,this.format=l,this.texture=e.gl.createTexture(),this.update(r,u)}update(e,r,l){const{width:u,height:p}=e,_=!(this.size&&this.size[0]===u&&this.size[1]===p||l),{context:x}=this,{gl:w}=x;if(this.useMipmap=!!(r&&r.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!r||r.premultiply!==!1)),_)this.size=[u,p],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,u,p,0,this.format,w.UNSIGNED_BYTE,e.data);else{const{x:P,y:A}=l||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?w.texSubImage2D(w.TEXTURE_2D,0,P,A,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,P,A,u,p,w.RGBA,w.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D)}bind(e,r,l){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),l!==p.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=p.LINEAR),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,l||e),this.filter=e),r!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Ct(d){const{userImage:e}=d;return!!(e&&e.render&&e.render())&&(d.data.replace(new Uint8Array(e.data.buffer)),!0)}class rr extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:r,promiseResolve:l}of this.requestors)l(this._getImagesForIds(r));this.requestors=[]}}getImage(e){const r=this.images[e];if(r&&!r.data&&r.spriteData){const l=r.spriteData;r.data=new h.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),r.spriteData=null}return r}addImage(e,r){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,r)&&(this.images[e]=r)}_validate(e,r){let l=!0;const u=r.data||r.spriteData;return this._validateStretch(r.stretchX,u&&u.width)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(r.stretchY,u&&u.height)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(r.content,r)||(this.fire(new h.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,r){if(!e)return!0;let l=0;for(const u of e){if(u[0]<l||u[1]<u[0]||r<u[1])return!1;l=u[1]}return!0}_validateContent(e,r){if(!e)return!0;if(e.length!==4)return!1;const l=r.spriteData,u=l&&l.width||r.data.width,p=l&&l.height||r.data.height;return!(e[0]<0||u<e[0]||e[1]<0||p<e[1]||e[2]<0||u<e[2]||e[3]<0||p<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,r,l=!0){const u=this.getImage(e);if(l&&(u.data.width!==r.data.width||u.data.height!==r.data.height))throw new Error(`size mismatch between old image (${u.data.width}x${u.data.height}) and new image (${r.data.width}x${r.data.height}).`);r.version=u.version+1,this.images[e]=r,this.updatedImages[e]=!0}removeImage(e){const r=this.images[e];delete this.images[e],delete this.patterns[e],r.userImage&&r.userImage.onRemove&&r.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((r,l)=>{let u=!0;if(!this.isLoaded())for(const p of e)this.images[p]||(u=!1);this.isLoaded()||u?r(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:r})})}_getImagesForIds(e){const r={};for(const l of e){let u=this.getImage(l);u||(this.fire(new h.l("styleimagemissing",{id:l})),u=this.getImage(l)),u?r[l]={data:u.data.clone(),pixelRatio:u.pixelRatio,sdf:u.sdf,version:u.version,stretchX:u.stretchX,stretchY:u.stretchY,content:u.content,textFitWidth:u.textFitWidth,textFitHeight:u.textFitHeight,hasRenderCallback:!!(u.userImage&&u.userImage.render)}:h.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return r}getPixelSize(){const{width:e,height:r}=this.atlasImage;return{width:e,height:r}}getPattern(e){const r=this.patterns[e],l=this.getImage(e);if(!l)return null;if(r&&r.position.version===l.version)return r.position;if(r)r.position.version=l.version;else{const u={w:l.data.width+2,h:l.data.height+2,x:0,y:0},p=new h.I(u,l);this.patterns[e]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const r=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Lt(e,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const p in this.patterns)e.push(this.patterns[p].bin);const{w:r,h:l}=h.p(e),u=this.atlasImage;u.resize({width:r||1,height:l||1});for(const p in this.patterns){const{bin:_}=this.patterns[p],x=_.x+1,w=_.y+1,P=this.getImage(p).data,A=P.width,D=P.height;h.R.copy(P,u,{x:0,y:0},{x,y:w},{width:A,height:D}),h.R.copy(P,u,{x:0,y:D-1},{x,y:w-1},{width:A,height:1}),h.R.copy(P,u,{x:0,y:0},{x,y:w+D},{width:A,height:1}),h.R.copy(P,u,{x:A-1,y:0},{x:x-1,y:w},{width:1,height:D}),h.R.copy(P,u,{x:0,y:0},{x:x+A,y:w},{width:1,height:D})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const r of e){if(this.callbackDispatchedThisFrame[r])continue;this.callbackDispatchedThisFrame[r]=!0;const l=this.getImage(r);l||h.w(`Image with ID: "${r}" was not found`),Ct(l)&&this.updateImage(r,l)}}}const sr=1e20;function Er(d,e,r,l,u,p,_,x,w){for(let P=e;P<e+l;P++)_r(d,r*p+P,p,u,_,x,w);for(let P=r;P<r+u;P++)_r(d,P*p+e,1,l,_,x,w)}function _r(d,e,r,l,u,p,_){p[0]=0,_[0]=-1e20,_[1]=sr,u[0]=d[e];for(let x=1,w=0,P=0;x<l;x++){u[x]=d[e+x*r];const A=x*x;do{const D=p[w];P=(u[x]-u[D]+A-D*D)/(x-D)/2}while(P<=_[w]&&--w>-1);w++,p[w]=x,_[w]=P,_[w+1]=sr}for(let x=0,w=0;x<l;x++){for(;_[w+1]<x;)w++;const P=p[w],A=x-P;d[e+x*r]=u[P]+A*A}}class Tt{constructor(e,r){this.requestManager=e,this.localIdeographFontFamily=r,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return h._(this,void 0,void 0,function*(){const r=[];for(const p in e)for(const _ of e[p])r.push(this._getAndCacheGlyphsPromise(p,_));const l=yield Promise.all(r),u={};for(const{stack:p,id:_,glyph:x}of l)u[p]||(u[p]={}),u[p][_]=x&&{id:x.id,bitmap:x.bitmap.clone(),metrics:x.metrics};return u})}_getAndCacheGlyphsPromise(e,r){return h._(this,void 0,void 0,function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let u=l.glyphs[r];if(u!==void 0)return{stack:e,id:r,glyph:u};if(u=this._tinySDF(l,e,r),u)return l.glyphs[r]=u,{stack:e,id:r,glyph:u};const p=Math.floor(r/256);if(256*p>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[p])return{stack:e,id:r,glyph:u};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[p]){const x=Tt.loadGlyphRange(e,p,this.url,this.requestManager);l.requests[p]=x}const _=yield l.requests[p];for(const x in _)this._doesCharSupportLocalGlyph(+x)||(l.glyphs[+x]=_[+x]);return l.ranges[p]=!0,{stack:e,id:r,glyph:_[r]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||h.u["CJK Unified Ideographs"](e)||h.u["Hangul Syllables"](e)||h.u.Hiragana(e)||h.u.Katakana(e)||h.u["CJK Symbols and Punctuation"](e)||h.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,r,l){const u=this.localIdeographFontFamily;if(!u||!this._doesCharSupportLocalGlyph(l))return;let p=e.tinySDF;if(!p){let x="400";/bold/i.test(r)?x="900":/medium/i.test(r)?x="500":/light/i.test(r)&&(x="200"),p=e.tinySDF=new Tt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:u,fontWeight:x})}const _=p.draw(String.fromCharCode(l));return{id:l,bitmap:new h.q({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}Tt.loadGlyphRange=function(d,e,r,l){return h._(this,void 0,void 0,function*(){const u=256*e,p=u+255,_=l.transformRequest(r.replace("{fontstack}",d).replace("{range}",`${u}-${p}`),"Glyphs"),x=yield h.n(_,new AbortController);if(!x||!x.data)throw new Error(`Could not load glyph range. range: ${e}, ${u}-${p}`);const w={};for(const P of h.o(x.data))w[P.id]=P;return w})},Tt.TinySDF=class{constructor({fontSize:d=24,buffer:e=3,radius:r=8,cutoff:l=.25,fontFamily:u="sans-serif",fontWeight:p="normal",fontStyle:_="normal"}={}){this.buffer=e,this.cutoff=l,this.radius=r;const x=this.size=d+4*e,w=this._createCanvas(x),P=this.ctx=w.getContext("2d",{willReadFrequently:!0});P.font=`${_} ${p} ${d}px ${u}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(d){const e=document.createElement("canvas");return e.width=e.height=d,e}draw(d){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:l,actualBoundingBoxLeft:u,actualBoundingBoxRight:p}=this.ctx.measureText(d),_=Math.ceil(r),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-u))),w=Math.min(this.size-this.buffer,_+Math.ceil(l)),P=x+2*this.buffer,A=w+2*this.buffer,D=Math.max(P*A,0),O=new Uint8ClampedArray(D),$={data:O,width:P,height:A,glyphWidth:x,glyphHeight:w,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(x===0||w===0)return $;const{ctx:U,buffer:Q,gridInner:Y,gridOuter:J}=this;U.clearRect(Q,Q,x,w),U.fillText(d,Q,Q+_);const re=U.getImageData(Q,Q,x,w);J.fill(sr,0,D),Y.fill(0,0,D);for(let le=0;le<w;le++)for(let ue=0;ue<x;ue++){const de=re.data[4*(le*x+ue)+3]/255;if(de===0)continue;const pe=(le+Q)*P+ue+Q;if(de===1)J[pe]=0,Y[pe]=sr;else{const se=.5-de;J[pe]=se>0?se*se:0,Y[pe]=se<0?se*se:0}}Er(J,0,0,P,A,P,this.f,this.v,this.z),Er(Y,Q,Q,x,w,P,this.f,this.v,this.z);for(let le=0;le<D;le++){const ue=Math.sqrt(J[le])-Math.sqrt(Y[le]);O[le]=Math.round(255-255*(ue/this.radius+this.cutoff))}return $}};class Nt{constructor(){this.specification=h.v.light.position}possiblyEvaluate(e,r){return h.z(e.expression.evaluate(r))}interpolate(e,r,l){return{x:h.B.number(e.x,r.x,l),y:h.B.number(e.y,r.y,l),z:h.B.number(e.z,r.z,l)}}}let bt;class _t extends h.E{constructor(e){super(),bt=bt||new h.r({anchor:new h.D(h.v.light.anchor),position:new Nt,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(bt),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r={}){if(!this._validate(h.t,e,r))for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l){return(!l||l.validate!==!1)&&h.x(this,e.call(h.y,{value:r,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const Re=new h.r({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class et extends h.E{constructor(e){super(),this._transitionable=new h.T(Re),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.C(0))}setSky(e,r={}){if(!this._validate(h.F,e,r)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const u=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),u):this._transitionable.setValue(l,u)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,l={}){return(l==null?void 0:l.validate)!==!1&&h.x(this,e.call(h.y,h.e({value:r,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class rt{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,r){const l=e.join(",")+String(r);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,r)),this.dashEntry[l]}getDashRanges(e,r,l){const u=[];let p=e.length%2==1?-e[e.length-1]*l:0,_=e[0]*l,x=!0;u.push({left:p,right:_,isDash:x,zeroLength:e[0]===0});let w=e[0];for(let P=1;P<e.length;P++){x=!x;const A=e[P];p=w*l,w+=A,_=w*l,u.push({left:p,right:_,isDash:x,zeroLength:A===0})}return u}addRoundDash(e,r,l){const u=r/2;for(let p=-l;p<=l;p++){const _=this.width*(this.nextRow+l+p);let x=0,w=e[x];for(let P=0;P<this.width;P++){P/w.right>1&&(w=e[++x]);const A=Math.abs(P-w.left),D=Math.abs(P-w.right),O=Math.min(A,D);let $;const U=p/l*(u+1);if(w.isDash){const Q=u-Math.abs(U);$=Math.sqrt(O*O+Q*Q)}else $=u-Math.sqrt(O*O+U*U);this.data[_+P]=Math.max(0,Math.min(255,$+128))}}}addRegularDash(e){for(let x=e.length-1;x>=0;--x){const w=e[x],P=e[x+1];w.zeroLength?e.splice(x,1):P&&P.isDash===w.isDash&&(P.left=w.left,e.splice(x,1))}const r=e[0],l=e[e.length-1];r.isDash===l.isDash&&(r.left=l.left-this.width,l.right=r.right+this.width);const u=this.width*this.nextRow;let p=0,_=e[p];for(let x=0;x<this.width;x++){x/_.right>1&&(_=e[++p]);const w=Math.abs(x-_.left),P=Math.abs(x-_.right),A=Math.min(w,P);this.data[u+x]=Math.max(0,Math.min(255,(_.isDash?A:-A)+128))}}addDash(e,r){const l=r?7:0,u=2*l+1;if(this.nextRow+u>this.height)return h.w("LineAtlas out of space"),null;let p=0;for(let x=0;x<e.length;x++)p+=e[x];if(p!==0){const x=this.width/p,w=this.getDashRanges(e,this.width,x);r?this.addRoundDash(w,x,l):this.addRegularDash(w)}const _={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:p};return this.nextRow+=u,this.dirty=!0,_}bind(e){const r=e.gl;this.texture?(r.bindTexture(r.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,r.texSubImage2D(r.TEXTURE_2D,0,0,0,this.width,this.height,r.ALPHA,r.UNSIGNED_BYTE,this.data))):(this.texture=r.createTexture(),r.bindTexture(r.TEXTURE_2D,this.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.REPEAT),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.ALPHA,this.width,this.height,0,r.ALPHA,r.UNSIGNED_BYTE,this.data))}}const me="maplibre_preloaded_worker_pool";class Ae{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ae.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[me]}numActive(){return Object.keys(this.active).length}}const kt=Math.floor(ze.hardwareConcurrency/2);let ut,Xe;function st(){return ut||(ut=new Ae),ut}Ae.workerCount=h.G(globalThis)?Math.max(Math.min(kt,3),1):1;class xt{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=r;const l=this.workerPool.acquire(r);for(let u=0;u<l.length;u++){const p=new h.H(l[u],r);p.name=`Worker ${u}`,this.actors.push(p)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,r){const l=[];for(const u of this.actors)l.push(u.sendAsync({type:e,data:r}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(r=>{r.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,r){for(const l of this.actors)l.registerMessageHandler(e,r)}}function mt(){return Xe||(Xe=new xt(st(),h.J),Xe.registerMessageHandler("GR",(d,e,r)=>h.m(e,r))),Xe}function St(d,e){const r=h.K();return h.L(r,r,[1,1,0]),h.M(r,r,[.5*d.width,.5*d.height,1]),d.calculatePosMatrix?h.N(r,r,d.calculatePosMatrix(e.toUnwrapped())):r}function lr(d,e,r,l,u,p){var _;const x=function(D,O,$){if(D)for(const U of D){const Q=O[U];if(Q&&Q.source===$&&Q.type==="fill-extrusion")return!0}else for(const U in O){const Q=O[U];if(Q.source===$&&Q.type==="fill-extrusion")return!0}return!1}((_=u==null?void 0:u.layers)!==null&&_!==void 0?_:null,e,d.id),w=p.maxPitchScaleFactor(),P=d.tilesIn(l,w,x);P.sort(or);const A=[];for(const D of P)A.push({wrappedTileID:D.tileID.wrapped().key,queryResults:D.tile.queryRenderedFeatures(e,r,d._state,D.queryGeometry,D.cameraQueryGeometry,D.scale,u,p,w,St(d.transform,D.tileID))});return function(D,O){for(const $ in D)for(const U of D[$])Mr(U,O);return D}(function(D){const O={},$={};for(const U of D){const Q=U.queryResults,Y=U.wrappedTileID,J=$[Y]=$[Y]||{};for(const re in Q){const le=Q[re],ue=J[re]=J[re]||{},de=O[re]=O[re]||[];for(const pe of le)ue[pe.featureIndex]||(ue[pe.featureIndex]=!0,de.push(pe))}}return O}(A),d)}function or(d,e){const r=d.tileID,l=e.tileID;return r.overscaledZ-l.overscaledZ||r.canonical.y-l.canonical.y||r.wrap-l.wrap||r.canonical.x-l.canonical.x}function Mr(d,e){const r=d.feature,l=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=l}function kr(d,e,r){return h._(this,void 0,void 0,function*(){let l=d;if(d.url?l=(yield h.j(e.transformRequest(d.url,"Source"),r)).data:yield ze.frameAsync(r),!l)return null;const u=h.O(h.e(l,d),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(u.vectorLayerIds=l.vector_layers.map(p=>p.id)),u})}class Ar{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof h.Q?new h.Q(e.lng,e.lat):h.Q.convert(e),this}setSouthWest(e){return this._sw=e instanceof h.Q?new h.Q(e.lng,e.lat):h.Q.convert(e),this}extend(e){const r=this._sw,l=this._ne;let u,p;if(e instanceof h.Q)u=e,p=e;else{if(!(e instanceof Ar))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Ar.convert(e)):this.extend(h.Q.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(h.Q.convert(e)):this;if(u=e._sw,p=e._ne,!u||!p)return this}return r||l?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),l.lng=Math.max(p.lng,l.lng),l.lat=Math.max(p.lat,l.lat)):(this._sw=new h.Q(u.lng,u.lat),this._ne=new h.Q(p.lng,p.lat)),this}getCenter(){return new h.Q((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.Q(this.getWest(),this.getNorth())}getSouthEast(){return new h.Q(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:l}=h.Q.convert(e);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&u}static convert(e){return e instanceof Ar?e:e&&new Ar(e)}static fromLngLat(e,r=0){const l=360*r/40075017,u=l/Math.cos(Math.PI/180*e.lat);return new Ar(new h.Q(e.lng-u,e.lat-l),new h.Q(e.lng+u,e.lat+l))}adjustAntiMeridian(){const e=new h.Q(this._sw.lng,this._sw.lat),r=new h.Q(this._ne.lng,this._ne.lat);return new Ar(e,e.lng>r.lng?new h.Q(r.lng+360,r.lat):r)}}class di{constructor(e,r,l){this.bounds=Ar.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),l=Math.floor(h.U(this.bounds.getWest())*r),u=Math.floor(h.S(this.bounds.getNorth())*r),p=Math.ceil(h.U(this.bounds.getEast())*r),_=Math.ceil(h.S(this.bounds.getSouth())*r);return e.x>=l&&e.x<p&&e.y>=u&&e.y<_}}class $i extends h.E{constructor(e,r,l,u){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.O(r,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield kr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(h.e(this,e),e.bounds&&(this.tileBounds=new di(e.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new h.k(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(r,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let u="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((p,_)=>{e.reloadPromise={resolve:p,reject:_}})}else e.actor=this.dispatcher.getActor(),u="LT";e.abortController=new AbortController;try{const p=yield e.actor.sendAsync({type:u,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,p)}catch(p){if(delete e.abortController,e.aborted)return;if(p&&p.status!==404)throw p;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,r){if(r&&r.resourceTiming&&(e.resourceTiming=r.resourceTiming),r&&this.map._refreshExpiredTiles&&e.setExpiryData(r),e.loadVectorData(r,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Tn extends h.E{constructor(e,r,l,u){super(),this.id=e,this.dispatcher=l,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},r),h.e(this,h.O(r,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield kr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(h.e(this,r),r.bounds&&(this.tileBounds=new di(r.bounds,this.minzoom,this.maxzoom)),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(r){this._tileJSONRequest=null,this.fire(new h.k(r))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return h.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield Mt.getImage(this.map._requestManager.transformRequest(r,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&l.cacheControl&&l.expires&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const u=this.map.painter.context,p=u.gl,_=l.data;e.texture=this.map.painter.getTileTexture(_.width),e.texture?e.texture.update(_,{useMipmap:!0}):(e.texture=new Lt(u,_,p.RGBA,{useMipmap:!0}),e.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE,p.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class tn extends Tn{constructor(e,r,l,u){super(e,r,l,u),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox",this.redFactor=r.redFactor,this.greenFactor=r.greenFactor,this.blueFactor=r.blueFactor,this.baseShift=r.baseShift}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(r,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const u=yield Mt.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){const p=u.data;this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const _=h.b(p)&&h.V()?p:yield this.readImageNow(p),x={type:this.type,uid:e.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const w=yield e.actor.sendAsync({type:"LDT",data:x});e.dem=w,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}readImageNow(e){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.W()){const r=e.width+2,l=e.height+2;try{return new h.R({width:r,height:l},yield h.X(e,-1,-1,r,l))}catch{}}return ze.getImageData(e,1)})}_getNeighboringTiles(e){const r=e.canonical,l=Math.pow(2,r.z),u=(r.x-1+l)%l,p=r.x===0?e.wrap-1:e.wrap,_=(r.x+1+l)%l,x=r.x+1===l?e.wrap+1:e.wrap,w={};return w[new h.Y(e.overscaledZ,p,r.z,u,r.y).key]={backfilled:!1},w[new h.Y(e.overscaledZ,x,r.z,_,r.y).key]={backfilled:!1},r.y>0&&(w[new h.Y(e.overscaledZ,p,r.z,u,r.y-1).key]={backfilled:!1},w[new h.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},w[new h.Y(e.overscaledZ,x,r.z,_,r.y-1).key]={backfilled:!1}),r.y+1<l&&(w[new h.Y(e.overscaledZ,p,r.z,u,r.y+1).key]={backfilled:!1},w[new h.Y(e.overscaledZ,e.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},w[new h.Y(e.overscaledZ,x,r.z,_,r.y+1).key]={backfilled:!1}),w}unloadTile(e){return h._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class ri extends h.E{constructor(e,r,l,u){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=l.getActor(),this.setEventedParent(u),this._data=r.data,this._options=h.e({},r),this._collectResourceTiming=r.collectResourceTiming,r.maxzoom!==void 0&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId,r.clusterMaxZoom!==void 0&&this.maxzoom<=r.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${r.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(r.buffer!==void 0?r.buffer:128),tolerance:this._pixelsToTileUnits(r.tolerance!==void 0?r.tolerance:.375),extent:h.Z,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:r.clusterMaxZoom!==void 0?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:h.Z,radius:this._pixelsToTileUnits(r.clusterRadius||50),log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(h.Z/this.tileSize)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return h._(this,void 0,void 0,function*(){const e=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,r,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:r,offset:l}})}_updateWorkerData(e){return h._(this,void 0,void 0,function*(){const r=h.e({type:this.type},this.workerOptions);e?r.dataDiff=e:typeof this._data=="string"?(r.request=this.map._requestManager.transformRequest(ze.resolveURL(this._data),"Source"),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.l("dataloading",{dataType:"source"}));try{const l=yield this.actor.sendAsync({type:"LD",data:r});if(this._pendingLoads--,this._removed||l.abandoned)return void this.fire(new h.l("dataabort",{dataType:"source"}));let u=null;l.resourceTiming&&l.resourceTiming[this.id]&&(u=l.resourceTiming[this.id].slice(0));const p={dataType:"source"};this._collectResourceTiming&&u&&u.length>0&&h.e(p,{resourceTiming:u}),this.fire(new h.l("data",Object.assign(Object.assign({},p),{sourceDataType:"metadata"}))),this.fire(new h.l("data",Object.assign(Object.assign({},p),{sourceDataType:"content"})))}catch(l){if(this._pendingLoads--,this._removed)return void this.fire(new h.l("dataabort",{dataType:"source"}));this.fire(new h.k(l))}})}loaded(){return this._pendingLoads===0}loadTile(e){return h._(this,void 0,void 0,function*(){const r=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const u=yield this.actor.sendAsync({type:r,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(u,this.map.painter,r==="RT")})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class zn extends h.E{constructor(e,r,l,u){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=r}load(e){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const r=yield Mt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,r&&r.data&&(this.image=r.data,e&&(this.coordinates=e),this._finishLoading())}catch(r){this._request=null,this._loaded=!0,this.fire(new h.k(r))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const r=e.map(h.$.fromLngLat);var l;return this.tileID=function(u){let p=1/0,_=1/0,x=-1/0,w=-1/0;for(const O of u)p=Math.min(p,O.x),_=Math.min(_,O.y),x=Math.max(x,O.x),w=Math.max(w,O.y);const P=Math.max(x-p,w-_),A=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),D=Math.pow(2,A);return new h.a0(A,Math.floor((p+x)/2*D),Math.floor((_+w)/2*D))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=r.map(u=>this.tileID.getTilePoint(u)._round()),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new h.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this.texture||(this.texture=new Lt(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class rn extends zn{constructor(e,r,l,u){super(e,r,l,u),this.roundZoom=!0,this.type="video",this.options=r}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const r of e.urls)this.urls.push(this.map._requestManager.transformRequest(r,"Source").url);try{const r=yield h.a1(this.urls);if(this._loaded=!0,!r)return;this.video=r,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(r){this.fire(new h.k(r))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const r=this.video.seekable;e<r.start(0)||e>r.end(0)?this.fire(new h.k(new h.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,r=e.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new Lt(e,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE));let l=!1;for(const u in this.tiles){const p=this.tiles[u];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture,l=!0)}l&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Nn extends zn{constructor(e,r,l,u){super(e,r,l,u),r.coordinates?Array.isArray(r.coordinates)&&r.coordinates.length===4&&!r.coordinates.some(p=>!Array.isArray(p)||p.length!==2||p.some(_=>typeof _!="number"))||this.fire(new h.k(new h.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.k(new h.a2(`sources.${e}`,null,'missing required property "coordinates"'))),r.animate&&typeof r.animate!="boolean"&&this.fire(new h.k(new h.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),r.canvas?typeof r.canvas=="string"||r.canvas instanceof HTMLCanvasElement||this.fire(new h.k(new h.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.k(new h.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=r,this.animate=r.animate===void 0||r.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const r=this.map.painter.context,l=r.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Lt(r,this.canvas,l.RGBA,{premultiply:!0});let u=!1;for(const p in this.tiles){const _=this.tiles[p];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,u=!0)}u&&this.fire(new h.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Ui={},ao=d=>{switch(d){case"geojson":return ri;case"image":return zn;case"raster":return Tn;case"raster-dem":return tn;case"vector":return $i;case"video":return rn;case"canvas":return Nn}return Ui[d]},wo="RTLPluginLoaded";class Zi extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=mt()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(r=>{throw this.status="error",r})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return h._(this,arguments,void 0,function*(r,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ze.resolveURL(r),!this.url)throw new Error(`requested url ${r} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.l(wo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let pi=null;function ni(){return pi||(pi=new Zi),pi}class fi{constructor(e,r){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=h.a3(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const r=e+this.timeAdded;r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,r,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,p){const _={};if(!p)return _;for(const x of u){const w=x.layerIds.map(P=>p.getLayer(P)).filter(Boolean);if(w.length!==0){x.layers=w,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(P=>w.filter(A=>A.id===P)[0]));for(const P of w)_[P.id]=x}}return _}(e.buckets,r==null?void 0:r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const p=this.buckets[u];if(p instanceof h.a5){if(this.hasSymbolBuckets=!0,!l)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const p=this.buckets[u];if(p instanceof h.a5&&p.hasRTLText){this.hasRTLText=!0,ni().lazyLoad();break}}this.queryPadding=0;for(const u in this.buckets){const p=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(u).queryRadius(p))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new h.a4}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const u=this.buckets[l];u.uploadPending()&&u.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Lt(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Lt(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,r,l,u,p,_,x,w,P,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:u,cameraQueryGeometry:p,scale:_,tileSize:this.tileSize,pixelPosMatrix:A,transform:w,params:x,queryPadding:this.queryPadding*P},e,r,l):{}}querySourceFeatures(e,r){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const u=l.loadVTLayers(),p=r&&r.sourceLayer?r.sourceLayer:"",_=u._geojsonTileLayer||u[p];if(!_)return;const x=h.a6(r&&r.filter),{z:w,x:P,y:A}=this.tileID.canonical,D={z:w,x:P,y:A};for(let O=0;O<_.length;O++){const $=_.feature(O);if(x.needGeometry){const Y=h.a7($,!0);if(!x.filter(new h.C(this.tileID.overscaledZ),Y,this.tileID.canonical))continue}else if(!x.filter(new h.C(this.tileID.overscaledZ),$))continue;const U=l.getId($,p),Q=new h.a8($,w,P,A,U);Q.tile=D,e.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const l=h.a9(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let u=!1;if(this.expirationTime>l)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const p=this.expirationTime-r;p?this.expirationTime=l+Math.max(p,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const u in this.buckets){if(!r.style.hasLayer(u))continue;const p=this.buckets[u],_=p.layers[0].sourceLayer||"_geojsonTileLayer",x=l[_],w=e[_];if(!x||!w||Object.keys(w).length===0)continue;p.update(w,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});const P=r&&r.style&&r.style.getLayer(u);P&&(this.queryPadding=Math.max(this.queryPadding,P.queryRadius(p)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ze.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ze.now()+e}setDependencies(e,r){const l={};for(const u of r)l[u]=!0;this.dependencies[e]=l}hasDependency(e,r){for(const l of e){const u=this.dependencies[l];if(u){for(const p of r)if(u[p])return!0}}return!1}}class mi{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,l){const u=e.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const p={value:r,timeout:void 0};if(l!==void 0&&(p.timeout=setTimeout(()=>{this.remove(e,p)},l)),this.data[u].push(p),this.order.push(u),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const l=e.wrapped().key,u=r===void 0?0:this.data[l].indexOf(r),p=this.data[l][u];return this.data[l].splice(u,1),p.timeout&&clearTimeout(p.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(p.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const l in this.data)for(const u of this.data[l])e(u.value)||r.push(u);for(const l of r)this.remove(l.value.tileID,l)}}class Gi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,l){const u=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},h.e(this.stateChanges[e][u],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const p in this.state[e])p!==u&&(this.deletedStates[e][p]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][u]===null){this.deletedStates[e][u]={};for(const p in this.state[e][u])l[p]||(this.deletedStates[e][u][p]=null)}else for(const p in l)this.deletedStates[e]&&this.deletedStates[e][u]&&this.deletedStates[e][u][p]===null&&delete this.deletedStates[e][u][p]}removeFeatureState(e,r,l){if(this.deletedStates[e]===null)return;const u=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&r!==void 0)this.deletedStates[e][u]!==null&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][l]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][u])for(l in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][l]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,r){const l=String(r),u=h.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const p=this.deletedStates[e][r];if(p===null)return{};for(const _ in p)delete u[_]}return u}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const l={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const p={};for(const _ in this.stateChanges[u])this.state[u][_]||(this.state[u][_]={}),h.e(this.state[u][_],this.stateChanges[u][_]),p[_]=this.state[u][_];l[u]=p}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const p={};if(this.deletedStates[u]===null)for(const _ in this.state[u])p[_]={},this.state[u][_]={};else for(const _ in this.deletedStates[u]){if(this.deletedStates[u][_]===null)this.state[u][_]={};else for(const x of Object.keys(this.deletedStates[u][_]))delete this.state[u][_][x];p[_]=this.state[u][_]}l[u]=l[u]||{},h.e(l[u],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const u in e)e[u].setFeatureState(l,r)}}function so(d,e,r){const l=e.intersectsFrustum(d);if(!r)return l;const u=e.intersectsPlane(r);return l===0||u===0?0:l===2&&u===2?2:1}function na(d,e,r,l,u){let p=d;const _=Math.atan(e/r),x=Math.hypot(e,r);return p=d+h.aa(l/x/Math.max(.5,Math.cos(h.ac(u/2)))),p+=1*h.aa(Math.cos(_))/2,p+=h.ad(d-p,-0,0),p}function Ai(d,e){const r=(e.roundZoom?Math.round:Math.floor)(d.zoom+h.aa(d.tileSize/e.tileSize));return Math.max(0,r)}function xe(d,e){const r=d.getCameraFrustum(),l=d.getClippingPlane(),u=d.screenPointToMercatorCoordinate(d.getCameraPoint()),p=h.$.fromLngLat(d.center,d.elevation);u.z=p.z+Math.cos(d.pitchInRadians)*d.cameraToCenterDistance/d.worldSize;const _=d.getCoveringTilesDetailsProvider(),x=_.allowVariableZoom(d,e),w=Ai(d,e),P=e.minzoom||0,A=e.maxzoom!==void 0?e.maxzoom:d.maxZoom,D=Math.min(Math.max(0,w),A),O=Math.pow(2,D),$=[O*u.x,O*u.y,0],U=[O*p.x,O*p.y,0],Q=Math.hypot(p.x-u.x,p.y-u.y),Y=Math.abs(p.z-u.z),J=Math.hypot(Q,Y),re=de=>({zoom:0,x:0,y:0,wrap:de,fullyVisible:!1}),le=[],ue=[];if(d.renderWorldCopies&&_.allowWorldCopies())for(let de=1;de<=3;de++)le.push(re(-de)),le.push(re(de));for(le.push(re(0));le.length>0;){const de=le.pop(),pe=de.x,se=de.y;let be=de.fullyVisible;const we={x:pe,y:se,z:de.zoom},Fe=_.getTileAABB(we,de.wrap,d.elevation,e);if(!be){const Qe=so(r,Fe,l);if(Qe===0)continue;be=Qe===2}const je=_.distanceToTile2d(u.x,u.y,we,Fe);let Oe=w;x&&(Oe=(e.calculateTileZoom||na)(d.zoom+h.aa(d.tileSize/e.tileSize),je,Y,J,d.fov)),Oe=(e.roundZoom?Math.round:Math.floor)(Oe),Oe=Math.max(0,Oe);const lt=Math.min(Oe,A);if(de.wrap=_.getWrap(p,we,de.wrap),de.zoom>=lt){if(de.zoom<P)continue;const Qe=D-de.zoom,He=$[0]-.5-(pe<<Qe),Pt=$[1]-.5-(se<<Qe),Rt=e.reparseOverscaled?Math.max(de.zoom,Oe):de.zoom;ue.push({tileID:new h.Y(de.zoom===A?Rt:de.zoom,de.wrap,de.zoom,pe,se),distanceSq:h.ab([U[0]-.5-pe,U[1]-.5-se]),tileDistanceToCamera:Math.sqrt(He*He+Pt*Pt)})}else for(let Qe=0;Qe<4;Qe++)le.push({zoom:de.zoom+1,x:(pe<<1)+Qe%2,y:(se<<1)+(Qe>>1),wrap:de.wrap,fullyVisible:be})}return ue.sort((de,pe)=>de.distanceSq-pe.distanceSq).map(de=>de.tileID)}class R extends h.E{constructor(e,r,l){super(),this.id=e,this.dispatcher=l,this.on("data",u=>this._dataHandler(u)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((u,p,_,x)=>{const w=new(ao(p.type))(u,p,_,x);if(w.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${w.id}`);return w})(e,r,l,this),this._tiles={},this._cache=new mi(0,u=>this._unloadTile(u)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Gi,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="loaded"&&r.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,r,l){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,r,l)}catch(u){e.state="errored",u.status!==404?this._source.fire(new h.k(u,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new h.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const l=this._tiles[r];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(q).map(e=>e.key)}getRenderableIds(e){const r=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&r.push(this._tiles[l]);return e?r.sort((l,u)=>{const p=l.tileID,_=u.tileID,x=new h.P(p.canonical.x,p.canonical.y)._rotate(-this.transform.bearingInRadians),w=new h.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians);return p.overscaledZ-_.overscaledZ||w.y-x.y||w.x-x.x}).map(l=>l.tileID.key):r.map(l=>l.tileID).sort(q).map(l=>l.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)(e||this._tiles[r].state!=="errored")&&this._reloadTile(r,"reloading")}}_reloadTile(e,r){return h._(this,void 0,void 0,function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=r),yield this._loadTile(l,e,r))})}_tileLoaded(e,r,l){e.timeAdded=ze.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new h.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const p=r[u];if(e.neighboringTiles&&e.neighboringTiles[p]){const _=this.getTileByID(p);l(e,_),l(_,e)}}function l(u,p){u.needsHillshadePrepare=!0,u.needsTerrainPrepare=!0;let _=p.tileID.canonical.x-u.tileID.canonical.x;const x=p.tileID.canonical.y-u.tileID.canonical.y,w=Math.pow(2,u.tileID.canonical.z),P=p.tileID.key;_===0&&x===0||Math.abs(x)>1||(Math.abs(_)>1&&(Math.abs(_+w)===1?_+=w:Math.abs(_-w)===1&&(_-=w)),p.dem&&u.dem&&(u.dem.backfillBorder(p.dem,_,x),u.neighboringTiles&&u.neighboringTiles[P]&&(u.neighboringTiles[P].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,l,u){for(const p in this._tiles){let _=this._tiles[p];if(u[p]||!_.hasData()||_.tileID.overscaledZ<=r||_.tileID.overscaledZ>l)continue;let x=_.tileID;for(;_&&_.tileID.overscaledZ>r+1;){const P=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[P.key],_&&_.hasData()&&(x=P)}let w=x;for(;w.overscaledZ>r;)if(w=w.scaledTo(w.overscaledZ-1),e[w.key]||e[w.canonical.key]){u[x.key]=x;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=r?l:null}for(let l=e.overscaledZ-1;l>=r;l--){const u=e.scaledTo(l),p=this._getLoadedTile(u);if(p)return p}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const r=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,u=Math.floor(r*l*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),p=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,u):u;this._cache.setMaxSize(p)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const l={};for(const u in this._tiles){const p=this._tiles[u];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+r),l[p.tileID.key]=p}this._tiles=l;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(u,this._tiles[u])}}_updateCoveredAndRetainedTiles(e,r,l,u,p,_){const x={},w={},P=Object.keys(e),A=ze.now();for(const D of P){const O=e[D],$=this._tiles[D];if(!$||$.fadeEndTime!==0&&$.fadeEndTime<=A)continue;const U=this.findLoadedParent(O,r),Q=this.findLoadedSibling(O),Y=U||Q||null;Y&&(this._addTile(Y.tileID),x[Y.tileID.key]=Y.tileID),w[D]=O}this._retainLoadedChildren(w,u,l,e);for(const D in x)e[D]||(this._coveredTiles[D]=!0,e[D]=x[D]);if(_){const D={},O={};for(const $ of p)this._tiles[$.key].hasData()?D[$.key]=$:O[$.key]=$;for(const $ in O){const U=O[$].children(this._source.maxzoom);this._tiles[U[0].key]&&this._tiles[U[1].key]&&this._tiles[U[2].key]&&this._tiles[U[3].key]&&(D[U[0].key]=e[U[0].key]=U[0],D[U[1].key]=e[U[1].key]=U[1],D[U[2].key]=e[U[2].key]=U[2],D[U[3].key]=e[U[3].key]=U[3],delete O[$])}for(const $ in O){const U=O[$],Q=this.findLoadedParent(U,this._source.minzoom),Y=this.findLoadedSibling(U),J=Q||Y||null;if(J){D[J.tileID.key]=e[J.tileID.key]=J.tileID;for(const re in D)D[re].isChildOf(J.tileID)&&delete D[re]}}for(const $ in this._tiles)D[$]||(this._coveredTiles[$]=!0)}}update(e,r){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=r,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(A=>new h.Y(A.canonical.z,A.wrap,A.canonical.z,A.canonical.x,A.canonical.y)):(l=xe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:r,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter(A=>this._source.hasTile(A)))):l=[];const u=Ai(e,this._source),p=Math.max(u-R.maxOverzooming,this._source.minzoom),_=Math.max(u+R.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const A={};for(const D of l)if(D.canonical.z>this._source.minzoom){const O=D.scaledTo(D.canonical.z-1);A[O.key]=O;const $=D.scaledTo(Math.max(this._source.minzoom,Math.min(D.canonical.z,5)));A[$.key]=$}l=l.concat(Object.values(A))}const x=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,x&&this.fire(new h.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const w=this._updateRetainedTiles(l,u);X(this._source.type)&&this._updateCoveredAndRetainedTiles(w,p,_,u,l,r);for(const A in w)this._tiles[A].clearFadeHold();const P=h.ae(this._tiles,w);for(const A of P){const D=this._tiles[A];D.hasSymbolBuckets&&!D.holdingForFade()?D.setHoldDuration(this.map._fadeDuration):D.hasSymbolBuckets&&!D.symbolFadeFinished()||this._removeTile(A)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,r){var l;const u={},p={},_=Math.max(r-R.maxOverzooming,this._source.minzoom),x=Math.max(r+R.maxUnderzooming,this._source.minzoom),w={};for(const P of e){const A=this._addTile(P);u[P.key]=P,A.hasData()||r<this._source.maxzoom&&(w[P.key]=P)}this._retainLoadedChildren(w,r,x,u);for(const P of e){let A=this._tiles[P.key];if(A.hasData())continue;if(r+1>this._source.maxzoom){const O=P.children(this._source.maxzoom)[0],$=this.getTile(O);if($&&$.hasData()){u[O.key]=O;continue}}else{const O=P.children(this._source.maxzoom);if(u[O[0].key]&&u[O[1].key]&&u[O[2].key]&&u[O[3].key])continue}let D=A.wasRequested();for(let O=P.overscaledZ-1;O>=_;--O){const $=P.scaledTo(O);if(p[$.key])break;if(p[$.key]=!0,A=this.getTile($),!A&&D&&(A=this._addTile($)),A){const U=A.hasData();if((U||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||D)&&(u[$.key]=$),D=A.wasRequested(),U)break}}}return u}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let l,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){l=this._loadedParentTiles[u.key];break}r.push(u.key);const p=u.scaledTo(u.overscaledZ-1);if(l=this._getLoadedTile(p),l)break;u=p}for(const p of r)this._loadedParentTiles[p]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const r=this._tiles[e].tileID,l=this._getLoadedTile(r);this._loadedSiblingTiles[r.key]=l}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const l=r;return r||(r=new fi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(r,e.key,r.state)),r.uses++,this._tiles[e.key]=r,l||this._source.fire(new h.l("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=r.getExpiryTimeout();l&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},l))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}_dataHandler(e){const r=e.sourceDataType;e.dataType==="source"&&r==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&r==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,r,l){const u=[],p=this.transform;if(!p)return u;const _=l?p.getCameraQueryGeometry(e):e,x=e.map(U=>p.screenPointToMercatorCoordinate(U,this.terrain)),w=_.map(U=>p.screenPointToMercatorCoordinate(U,this.terrain)),P=this.getIds();let A=1/0,D=1/0,O=-1/0,$=-1/0;for(const U of w)A=Math.min(A,U.x),D=Math.min(D,U.y),O=Math.max(O,U.x),$=Math.max($,U.y);for(let U=0;U<P.length;U++){const Q=this._tiles[P[U]];if(Q.holdingForFade())continue;const Y=Q.tileID,J=Math.pow(2,p.zoom-Q.tileID.overscaledZ),re=r*Q.queryPadding*h.Z/Q.tileSize/J,le=[Y.getTilePoint(new h.$(A,D)),Y.getTilePoint(new h.$(O,$))];if(le[0].x-re<h.Z&&le[0].y-re<h.Z&&le[1].x+re>=0&&le[1].y+re>=0){const ue=x.map(pe=>Y.getTilePoint(pe)),de=w.map(pe=>Y.getTilePoint(pe));u.push({tile:Q,tileID:Y,queryGeometry:ue,cameraQueryGeometry:de,scale:J})}}return u}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(l=>this._tiles[l].tileID);return this.transform&&this.transform.populateCache(r),r}hasTransition(){if(this._source.hasTransition())return!0;if(X(this._source.type)){const e=ze.now();for(const r in this._tiles)if(this._tiles[r].fadeEndTime>=e)return!0}return!1}setFeatureState(e,r,l){this._state.updateState(e=e||"_geojsonTileLayer",r,l)}removeFeatureState(e,r,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,l)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,l){const u=this._tiles[e];u&&u.setDependencies(r,l)}reloadTilesForDependencies(e,r){for(const l in this._tiles)this._tiles[l].hasDependency(e,r)&&this._reloadTile(l,"reloading");this._cache.filter(l=>!l.hasDependency(e,r))}}function q(d,e){const r=Math.abs(2*d.wrap)-+(d.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return d.overscaledZ-e.overscaledZ||l-r||e.canonical.y-d.canonical.y||e.canonical.x-d.canonical.x}function X(d){return d==="raster"||d==="image"||d==="video"}R.maxOverzooming=10,R.maxUnderzooming=3;class ee{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=h.ad(e,0,1);let r=1,l=this._distances[r];const u=e*this.paddedLength+this.padding;for(;l<u&&r<this._distances.length;)l=this._distances[++r];const p=r-1,_=this._distances[p],x=l-_,w=x>0?(u-_)/x:0;return this.points[p].mult(1-w).add(this.points[r].mult(w))}}function he(d,e){let r=!0;return d==="always"||d!=="never"&&e!=="never"||(r=!1),r}class ye{constructor(e,r,l){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(r/l);for(let _=0;_<this.xCellCount*this.yCellCount;_++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,l,u,p){this._forEachCell(r,l,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(l),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(e,r,l,u){this._forEachCell(r-u,l-u,r+u,l+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(l),this.circles.push(u)}_insertBoxCell(e,r,l,u,p,_){this.boxCells[p].push(_)}_insertCircleCell(e,r,l,u,p,_){this.circleCells[p].push(_)}_query(e,r,l,u,p,_,x){if(l<0||e>this.width||u<0||r>this.height)return[];const w=[];if(e<=0&&r<=0&&this.width<=l&&this.height<=u){if(p)return[{key:null,x1:e,y1:r,x2:l,y2:u}];for(let P=0;P<this.boxKeys.length;P++)w.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const A=this.circles[3*P],D=this.circles[3*P+1],O=this.circles[3*P+2];w.push({key:this.circleKeys[P],x1:A-O,y1:D-O,x2:A+O,y2:D+O})}}else this._forEachCell(e,r,l,u,this._queryCell,w,{hitTest:p,overlapMode:_,seenUids:{box:{},circle:{}}},x);return w}query(e,r,l,u){return this._query(e,r,l,u,!1,null)}hitTest(e,r,l,u,p,_){return this._query(e,r,l,u,!0,p,_).length>0}hitTestCircle(e,r,l,u,p){const _=e-l,x=e+l,w=r-l,P=r+l;if(x<0||_>this.width||P<0||w>this.height)return!1;const A=[];return this._forEachCell(_,w,x,P,this._queryCellCircle,A,{hitTest:!0,overlapMode:u,circle:{x:e,y:r,radius:l},seenUids:{box:{},circle:{}}},p),A.length>0}_queryCell(e,r,l,u,p,_,x,w){const{seenUids:P,hitTest:A,overlapMode:D}=x,O=this.boxCells[p];if(O!==null){const U=this.bboxes;for(const Q of O)if(!P.box[Q]){P.box[Q]=!0;const Y=4*Q,J=this.boxKeys[Q];if(e<=U[Y+2]&&r<=U[Y+3]&&l>=U[Y+0]&&u>=U[Y+1]&&(!w||w(J))&&(!A||!he(D,J.overlapMode))&&(_.push({key:J,x1:U[Y],y1:U[Y+1],x2:U[Y+2],y2:U[Y+3]}),A))return!0}}const $=this.circleCells[p];if($!==null){const U=this.circles;for(const Q of $)if(!P.circle[Q]){P.circle[Q]=!0;const Y=3*Q,J=this.circleKeys[Q];if(this._circleAndRectCollide(U[Y],U[Y+1],U[Y+2],e,r,l,u)&&(!w||w(J))&&(!A||!he(D,J.overlapMode))){const re=U[Y],le=U[Y+1],ue=U[Y+2];if(_.push({key:J,x1:re-ue,y1:le-ue,x2:re+ue,y2:le+ue}),A)return!0}}}return!1}_queryCellCircle(e,r,l,u,p,_,x,w){const{circle:P,seenUids:A,overlapMode:D}=x,O=this.boxCells[p];if(O!==null){const U=this.bboxes;for(const Q of O)if(!A.box[Q]){A.box[Q]=!0;const Y=4*Q,J=this.boxKeys[Q];if(this._circleAndRectCollide(P.x,P.y,P.radius,U[Y+0],U[Y+1],U[Y+2],U[Y+3])&&(!w||w(J))&&!he(D,J.overlapMode))return _.push(!0),!0}}const $=this.circleCells[p];if($!==null){const U=this.circles;for(const Q of $)if(!A.circle[Q]){A.circle[Q]=!0;const Y=3*Q,J=this.circleKeys[Q];if(this._circlesCollide(U[Y],U[Y+1],U[Y+2],P.x,P.y,P.radius)&&(!w||w(J))&&!he(D,J.overlapMode))return _.push(!0),!0}}}_forEachCell(e,r,l,u,p,_,x,w){const P=this._convertToXCellCoord(e),A=this._convertToYCellCoord(r),D=this._convertToXCellCoord(l),O=this._convertToYCellCoord(u);for(let $=P;$<=D;$++)for(let U=A;U<=O;U++)if(p.call(this,e,r,l,u,this.xCellCount*U+$,_,x,w))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,l,u,p,_){const x=u-e,w=p-r,P=l+_;return P*P>x*x+w*w}_circleAndRectCollide(e,r,l,u,p,_,x){const w=(_-u)/2,P=Math.abs(e-(u+w));if(P>w+l)return!1;const A=(x-p)/2,D=Math.abs(r-(p+A));if(D>A+l)return!1;if(P<=w||D<=A)return!0;const O=P-w,$=D-A;return O*O+$*$<=l*l}}function Pe(d,e,r){const l=h.K();if(!d){const{vecSouth:D,vecEast:O}=Ne(e),$=Ze();$[0]=O[0],$[1]=O[1],$[2]=D[0],$[3]=D[1],u=$,(A=(_=(p=$)[0])*(P=p[3])-(w=p[2])*(x=p[1]))&&(u[0]=P*(A=1/A),u[1]=-x*A,u[2]=-w*A,u[3]=_*A),l[0]=$[0],l[1]=$[1],l[4]=$[2],l[5]=$[3]}var u,p,_,x,w,P,A;return h.M(l,l,[1/r,1/r,1]),l}function _e(d,e,r,l){if(d){const u=h.K();if(!e){const{vecSouth:p,vecEast:_}=Ne(r);u[0]=_[0],u[1]=_[1],u[4]=p[0],u[5]=p[1]}return h.M(u,u,[l,l,1]),u}return r.pixelsToClipSpaceMatrix}function Ne(d){const e=Math.cos(d.rollInRadians),r=Math.sin(d.rollInRadians),l=Math.cos(d.pitchInRadians),u=Math.cos(d.bearingInRadians),p=Math.sin(d.bearingInRadians),_=h.aj();_[0]=-u*l*r-p*e,_[1]=-p*l*r+u*e;const x=h.ak(_);x<1e-9?h.al(_):h.am(_,_,1/x);const w=h.aj();w[0]=u*l*e-p*r,w[1]=p*l*e+u*r;const P=h.ak(w);return P<1e-9?h.al(w):h.am(w,w,1/P),{vecEast:w,vecSouth:_}}function De(d,e,r,l){let u;l?(u=[d,e,l(d,e),1],h.ao(u,u,r)):(u=[d,e,0,1],on(u,u,r));const p=u[3];return{point:new h.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function Te(d,e){return .5+d/e*.5}function We(d,e){return d.x>=-e[0]&&d.x<=e[0]&&d.y>=-e[1]&&d.y<=e[1]}function Se(d,e,r,l,u,p,_,x,w,P,A,D,O){const $=r?d.textSizeData:d.iconSizeData,U=h.af($,e.transform.zoom),Q=[256/e.width*2+1,256/e.height*2+1],Y=r?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;Y.clear();const J=d.lineVertexArray,re=r?d.text.placedSymbolArray:d.icon.placedSymbolArray,le=e.transform.width/e.transform.height;let ue=!1;for(let de=0;de<re.length;de++){const pe=re.get(de);if(pe.hidden||pe.writingMode===h.ag.vertical&&!ue){Zr(pe.numGlyphs,Y);continue}ue=!1;const se=new h.P(pe.anchorX,pe.anchorY),be={getElevation:O,pitchedLabelPlaneMatrix:l,lineVertexArray:J,pitchWithMap:p,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:se,unwrappedTileID:w,width:P,height:A,translation:D},we=er(pe.anchorX,pe.anchorY,be);if(!We(we.point,Q)){Zr(pe.numGlyphs,Y);continue}const Fe=Te(e.transform.cameraToCenterDistance,we.signedDistanceFromCamera),je=h.ah($,U,pe),Oe=p?je*e.transform.getPitchedTextCorrection(pe.anchorX,pe.anchorY,w)/Fe:je*Fe,lt=Kt({projectionContext:be,pitchedLabelPlaneMatrixInverse:u,symbol:pe,fontSize:Oe,flip:!1,keepUpright:_,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:le,rotateToLine:x});ue=lt.useVertical,(lt.notEnoughRoom||ue||lt.needsFlipping&&Kt({projectionContext:be,pitchedLabelPlaneMatrixInverse:u,symbol:pe,fontSize:Oe,flip:!0,keepUpright:_,glyphOffsetArray:d.glyphOffsetArray,dynamicLayoutVertexArray:Y,aspectRatio:le,rotateToLine:x}).notEnoughRoom)&&Zr(pe.numGlyphs,Y)}r?d.text.dynamicLayoutVertexBuffer.updateData(Y):d.icon.dynamicLayoutVertexBuffer.updateData(Y)}function dt(d,e,r,l,u,p,_,x){const w=p.glyphStartIndex+p.numGlyphs,P=p.lineStartIndex,A=p.lineStartIndex+p.lineLength,D=e.getoffsetX(p.glyphStartIndex),O=e.getoffsetX(w-1),$=Bt(d*D,r,l,u,p.segment,P,A,x,_);if(!$)return null;const U=Bt(d*O,r,l,u,p.segment,P,A,x,_);return U?x.projectionCache.anyProjectionOccluded?null:{first:$,last:U}:null}function Et(d,e,r,l){return d===h.ag.horizontal&&Math.abs(r.y-e.y)>Math.abs(r.x-e.x)*l?{useVertical:!0}:(d===h.ag.vertical?e.y<r.y:e.x>r.x)?{needsFlipping:!0}:null}function Kt(d){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:r,symbol:l,fontSize:u,flip:p,keepUpright:_,glyphOffsetArray:x,dynamicLayoutVertexArray:w,aspectRatio:P,rotateToLine:A}=d,D=u/24,O=l.lineOffsetX*D,$=l.lineOffsetY*D;let U;if(l.numGlyphs>1){const Q=l.glyphStartIndex+l.numGlyphs,Y=l.lineStartIndex,J=l.lineStartIndex+l.lineLength,re=dt(D,x,O,$,p,l,A,e);if(!re)return{notEnoughRoom:!0};const le=yt(re.first.point.x,re.first.point.y,e,r),ue=yt(re.last.point.x,re.last.point.y,e,r);if(_&&!p){const de=Et(l.writingMode,le,ue,P);if(de)return de}U=[re.first];for(let de=l.glyphStartIndex+1;de<Q-1;de++)U.push(Bt(D*x.getoffsetX(de),O,$,p,l.segment,Y,J,e,A));U.push(re.last)}else{if(_&&!p){const Y=vt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,J=l.lineStartIndex+l.segment+1,re=new h.P(e.lineVertexArray.getx(J),e.lineVertexArray.gety(J)),le=vt(re.x,re.y,e),ue=le.signedDistanceFromCamera>0?le.point:Vt(e.tileAnchorPoint,re,Y,1,e),de=yt(Y.x,Y.y,e,r),pe=yt(ue.x,ue.y,e,r),se=Et(l.writingMode,de,pe,P);if(se)return se}const Q=Bt(D*x.getoffsetX(l.glyphStartIndex),O,$,p,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,A);if(!Q||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};U=[Q]}for(const Q of U)h.an(w,Q.point,Q.angle);return{}}function Vt(d,e,r,l,u){const p=d.add(d.sub(e)._unit()),_=vt(p.x,p.y,u).point,x=r.sub(_);return r.add(x._mult(l/x.mag()))}function $e(d,e,r){const l=e.projectionCache;if(l.projections[d])return l.projections[d];const u=new h.P(e.lineVertexArray.getx(d),e.lineVertexArray.gety(d)),p=vt(u.x,u.y,e);if(p.signedDistanceFromCamera>0)return l.projections[d]=p.point,l.anyProjectionOccluded=l.anyProjectionOccluded||p.isOccluded,p.point;const _=d-r.direction;return Vt(r.distanceFromAnchor===0?e.tileAnchorPoint:new h.P(e.lineVertexArray.getx(_),e.lineVertexArray.gety(_)),u,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,e)}function vt(d,e,r){const l=d+r.translation[0],u=e+r.translation[1];let p;return r.pitchWithMap?(p=De(l,u,r.pitchedLabelPlaneMatrix,r.getElevation),p.isOccluded=!1):(p=r.transform.projectTileCoordinates(l,u,r.unwrappedTileID,r.getElevation),p.point.x=(.5*p.point.x+.5)*r.width,p.point.y=(.5*-p.point.y+.5)*r.height),p}function yt(d,e,r,l){if(r.pitchWithMap){const u=[d,e,0,1];return h.ao(u,u,l),r.transform.projectTileCoordinates(u[0]/u[3],u[1]/u[3],r.unwrappedTileID,r.getElevation).point}return{x:d/r.width*2-1,y:e/r.height*2-1}}function er(d,e,r){return r.transform.projectTileCoordinates(d,e,r.unwrappedTileID,r.getElevation)}function Wt(d,e,r){return d._unit()._perp()._mult(e*r)}function ir(d,e,r,l,u,p,_,x,w){if(x.projectionCache.offsets[d])return x.projectionCache.offsets[d];const P=r.add(e);if(d+w.direction<l||d+w.direction>=u)return x.projectionCache.offsets[d]=P,P;const A=$e(d+w.direction,x,w),D=Wt(A.sub(r),_,w.direction),O=r.add(D),$=A.add(D);return x.projectionCache.offsets[d]=h.ap(p,P,O,$)||P,x.projectionCache.offsets[d]}function Bt(d,e,r,l,u,p,_,x,w){const P=l?d-e:d+e;let A=P>0?1:-1,D=0;l&&(A*=-1,D=Math.PI),A<0&&(D+=Math.PI);let O,$=A>0?p+u:p+u+1;x.projectionCache.cachedAnchorPoint?O=x.projectionCache.cachedAnchorPoint:(O=vt(x.tileAnchorPoint.x,x.tileAnchorPoint.y,x).point,x.projectionCache.cachedAnchorPoint=O);let U,Q,Y=O,J=O,re=0,le=0;const ue=Math.abs(P),de=[];let pe;for(;re+le<=ue;){if($+=A,$<p||$>=_)return null;re+=le,J=Y,Q=U;const we={absOffsetX:ue,direction:A,distanceFromAnchor:re,previousVertex:J};if(Y=$e($,x,we),r===0)de.push(J),pe=Y.sub(J);else{let Fe;const je=Y.sub(J);Fe=je.mag()===0?Wt($e($+A,x,we).sub(Y),r,A):Wt(je,r,A),Q||(Q=J.add(Fe)),U=ir($,Fe,Y,p,_,Q,r,x,we),de.push(Q),pe=U.sub(Q)}le=pe.mag()}const se=pe._mult((ue-re)/le)._add(Q||J),be=D+Math.atan2(Y.y-J.y,Y.x-J.x);return de.push(se),{point:se,angle:w?be:0,path:de}}const Da=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Zr(d,e){for(let r=0;r<d;r++){const l=e.length;e.resize(l+4),e.float32.set(Da,3*l)}}function on(d,e,r){const l=e[0],u=e[1];return d[0]=r[0]*l+r[4]*u+r[12],d[1]=r[1]*l+r[5]*u+r[13],d[3]=r[3]*l+r[7]*u+r[15],d}const jr=100;class Ol{constructor(e,r=new ye(e.width+200,e.height+200,25),l=new ye(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+jr,this.screenBottomBoundary=e.height+jr,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,r,l,u,p,_,x,w,P,A,D,O){const $=this.projectAndGetPerspectiveRatio(e.anchorPointX+w[0],e.anchorPointY+w[1],p,A,O),U=l*$.perspectiveRatio;let Q;if(_||x)Q=this._projectCollisionBox(e,U,u,p,_,x,w,$,A,D,O);else{const pe=$.x+(D?D.x*U:0),se=$.y+(D?D.y*U:0);Q={allPointsOccluded:!1,box:[pe+e.x1*U,se+e.y1*U,pe+e.x2*U,se+e.y2*U]}}const[Y,J,re,le]=Q.box,ue=_?Q.allPointsOccluded:$.isOccluded;let de=ue;return de||(de=$.perspectiveRatio<this.perspectiveRatioCutoff),de||(de=!this.isInsideGrid(Y,J,re,le)),de||r!=="always"&&this.grid.hitTest(Y,J,re,le,r,P)?{box:[Y,J,re,le],placeable:!1,offscreen:!1,occluded:ue}:{box:[Y,J,re,le],placeable:!0,offscreen:this.isOffscreen(Y,J,re,le),occluded:ue}}placeCollisionCircles(e,r,l,u,p,_,x,w,P,A,D,O,$,U){const Q=[],Y=new h.P(r.anchorX,r.anchorY),J=this.getPerspectiveRatio(Y.x,Y.y,_,U),re=(P?p*this.transform.getPitchedTextCorrection(r.anchorX,r.anchorY,_)/J:p*J)/h.au,le={getElevation:U,pitchedLabelPlaneMatrix:x,lineVertexArray:l,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:Y,unwrappedTileID:_,width:this.transform.width,height:this.transform.height,translation:$},ue=dt(re,u,r.lineOffsetX*re,r.lineOffsetY*re,!1,r,!1,le);let de=!1,pe=!1,se=!0;if(ue){const be=.5*D*J+O,we=new h.P(-100,-100),Fe=new h.P(this.screenRightBoundary,this.screenBottomBoundary),je=new ee,Oe=ue.first,lt=ue.last;let Qe=[];for(let Rt=Oe.path.length-1;Rt>=1;Rt--)Qe.push(Oe.path[Rt]);for(let Rt=1;Rt<lt.path.length;Rt++)Qe.push(lt.path[Rt]);const He=2.5*be;if(P){const Rt=this.projectPathToScreenSpace(Qe,le);Qe=Rt.some(nr=>nr.signedDistanceFromCamera<=0)?[]:Rt.map(nr=>nr.point)}let Pt=[];if(Qe.length>0){const Rt=Qe[0].clone(),nr=Qe[0].clone();for(let pr=1;pr<Qe.length;pr++)Rt.x=Math.min(Rt.x,Qe[pr].x),Rt.y=Math.min(Rt.y,Qe[pr].y),nr.x=Math.max(nr.x,Qe[pr].x),nr.y=Math.max(nr.y,Qe[pr].y);Pt=Rt.x>=we.x&&nr.x<=Fe.x&&Rt.y>=we.y&&nr.y<=Fe.y?[Qe]:nr.x<we.x||Rt.x>Fe.x||nr.y<we.y||Rt.y>Fe.y?[]:h.aq([Qe],we.x,we.y,Fe.x,Fe.y)}for(const Rt of Pt){je.reset(Rt,.25*be);let nr=0;nr=je.length<=.5*be?1:Math.ceil(je.paddedLength/He)+1;for(let pr=0;pr<nr;pr++){const Pr=pr/Math.max(nr-1,1),Ur=je.lerp(Pr),Fr=Ur.x+jr,wr=Ur.y+jr;Q.push(Fr,wr,be,0);const zr=Fr-be,yn=wr-be,vn=Fr+be,an=wr+be;if(se=se&&this.isOffscreen(zr,yn,vn,an),pe=pe||this.isInsideGrid(zr,yn,vn,an),e!=="always"&&this.grid.hitTestCircle(Fr,wr,be,e,A)&&(de=!0,!w))return{circles:[],offscreen:!1,collisionDetected:de}}}}return{circles:!w&&de||!pe||J<this.perspectiveRatioCutoff?[]:Q,offscreen:se,collisionDetected:de}}projectPathToScreenSpace(e,r){const l=function(u,p){const _=h.K();return h.ai(_,p.pitchedLabelPlaneMatrix),u.map(x=>{const w=De(x.x,x.y,_,p.getElevation),P=p.transform.projectTileCoordinates(w.point.x,w.point.y,p.unwrappedTileID,p.getElevation);return P.point.x=(.5*P.point.x+.5)*p.width,P.point.y=(.5*-P.point.y+.5)*p.height,P})}(e,r);return function(u){let p=0,_=0,x=0,w=0;for(let P=0;P<u.length;P++)u[P].isOccluded?(x=P+1,w=0):(w++,w>_&&(_=w,p=x));return u.slice(p,p+_)}(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let l=1/0,u=1/0,p=-1/0,_=-1/0;for(const A of e){const D=new h.P(A.x+jr,A.y+jr);l=Math.min(l,D.x),u=Math.min(u,D.y),p=Math.max(p,D.x),_=Math.max(_,D.y),r.push(D)}const x=this.grid.query(l,u,p,_).concat(this.ignoredGrid.query(l,u,p,_)),w={},P={};for(const A of x){const D=A.key;if(w[D.bucketInstanceId]===void 0&&(w[D.bucketInstanceId]={}),w[D.bucketInstanceId][D.featureIndex])continue;const O=[new h.P(A.x1,A.y1),new h.P(A.x2,A.y1),new h.P(A.x2,A.y2),new h.P(A.x1,A.y2)];h.ar(r,O)&&(w[D.bucketInstanceId][D.featureIndex]=!0,P[D.bucketInstanceId]===void 0&&(P[D.bucketInstanceId]=[]),P[D.bucketInstanceId].push(D.featureIndex))}return P}insertCollisionBox(e,r,l,u,p,_){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:u,featureIndex:p,collisionGroupID:_,overlapMode:r},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,l,u,p,_){const x=l?this.ignoredGrid:this.grid,w={bucketInstanceId:u,featureIndex:p,collisionGroupID:_,overlapMode:r};for(let P=0;P<e.length;P+=4)x.insertCircle(w,e[P],e[P+1],e[P+2])}projectAndGetPerspectiveRatio(e,r,l,u,p){if(p){let _;u?(_=[e,r,u(e,r),1],h.ao(_,_,p)):(_=[e,r,0,1],on(_,_,p));const x=_[3];return{x:(_[0]/x+1)/2*this.transform.width+jr,y:(-_[1]/x+1)/2*this.transform.height+jr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/x*.5,isOccluded:!1,signedDistanceFromCamera:x}}{const _=this.transform.projectTileCoordinates(e,r,l,u);return{x:(_.point.x+1)/2*this.transform.width+jr,y:(1-_.point.y)/2*this.transform.height+jr,perspectiveRatio:.5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5,isOccluded:_.isOccluded,signedDistanceFromCamera:_.signedDistanceFromCamera}}}getPerspectiveRatio(e,r,l,u){const p=this.transform.projectTileCoordinates(e,r,l,u);return .5+this.transform.cameraToCenterDistance/p.signedDistanceFromCamera*.5}isOffscreen(e,r,l,u){return l<jr||e>=this.screenRightBoundary||u<jr||r>this.screenBottomBoundary}isInsideGrid(e,r,l,u){return l>=0&&e<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=h.as([]);return h.L(e,e,[-100,-100,0]),e}_projectCollisionBox(e,r,l,u,p,_,x,w,P,A,D){let O=1,$=0,U=0,Q=1;const Y=e.anchorPointX+x[0],J=e.anchorPointY+x[1];if(_&&!p){const Qe=this.projectAndGetPerspectiveRatio(Y+1,J,u,P,D),He=Qe.x-w.x,Pt=Math.atan((Qe.y-w.y)/He)+(He<0?Math.PI:0),Rt=Math.sin(Pt),nr=Math.cos(Pt);O=nr,$=Rt,U=-Rt,Q=nr}else if(!_&&p){const Qe=Ne(this.transform);O=Qe.vecEast[0],$=Qe.vecEast[1],U=Qe.vecSouth[0],Q=Qe.vecSouth[1]}let re=w.x,le=w.y,ue=r;p&&(re=Y,le=J,ue=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ue*=this.transform.getPitchedTextCorrection(Y,J,u),A||(ue*=h.ad(.5+w.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),A&&(re+=O*A.x*ue+U*A.y*ue,le+=$*A.x*ue+Q*A.y*ue);const de=e.x1*ue,pe=e.x2*ue,se=(de+pe)/2,be=e.y1*ue,we=e.y2*ue,Fe=(be+we)/2,je=[{offsetX:de,offsetY:be},{offsetX:se,offsetY:be},{offsetX:pe,offsetY:be},{offsetX:pe,offsetY:Fe},{offsetX:pe,offsetY:we},{offsetX:se,offsetY:we},{offsetX:de,offsetY:we},{offsetX:de,offsetY:Fe}];let Oe=[];for(const{offsetX:Qe,offsetY:He}of je)Oe.push(new h.P(re+O*Qe+U*He,le+$*Qe+Q*He));let lt=!1;if(p){const Qe=Oe.map(He=>this.projectAndGetPerspectiveRatio(He.x,He.y,u,P,D));lt=Qe.some(He=>!He.isOccluded),Oe=Qe.map(He=>new h.P(He.x,He.y))}else lt=!0;return{box:h.at(Oe),allPointsOccluded:!lt}}}class ii{constructor(e,r,l,u){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):u&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class Dr{constructor(e,r,l,u,p){this.text=new ii(e?e.text:null,r,l,p),this.icon=new ii(e?e.icon:null,r,u,p)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Fu{constructor(e,r,l){this.text=e,this.icon=r,this.skipFade=l}}class cs{constructor(e,r,l,u,p){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=l,this.bucketIndex=u,this.tileID=p}}class Bu{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:l=>l.collisionGroupID===r}}return this.collisionGroups[e]}}function ia(d,e,r,l,u){const{horizontalAlign:p,verticalAlign:_}=h.aA(d);return new h.P(-(p-.5)*e+l[0]*u,-(_-.5)*r+l[1]*u)}class Gr{constructor(e,r,l,u,p){this.transform=e.clone(),this.terrain=r,this.collisionIndex=new Ol(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Bu(u),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const r=this.terrain;return r?(l,u)=>r.getElevation(e,l,u):null}getBucketParts(e,r,l,u){const p=l.getBucket(r),_=l.latestFeatureIndex;if(!p||!_||r.id!==p.layerIds[0])return;const x=l.collisionBoxArray,w=p.layers[0].layout,P=p.layers[0].paint,A=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),D=l.tileSize/h.Z,O=l.tileID.toUnwrapped(),$=w.get("text-rotation-alignment")==="map",U=h.av(l,1,this.transform.zoom),Q=h.aw(this.collisionIndex.transform,l,P.get("text-translate"),P.get("text-translate-anchor")),Y=h.aw(this.collisionIndex.transform,l,P.get("icon-translate"),P.get("icon-translate-anchor")),J=Pe($,this.transform,U);this.retainedQueryData[p.bucketInstanceId]=new cs(p.bucketInstanceId,_,p.sourceLayerIndex,p.index,l.tileID);const re={bucket:p,layout:w,translationText:Q,translationIcon:Y,unwrappedTileID:O,pitchedLabelPlaneMatrix:J,scale:A,textPixelRatio:D,holdingForFade:l.holdingForFade(),collisionBoxArray:x,partiallyEvaluatedTextSize:h.af(p.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const le of p.sortKeyRanges){const{sortKey:ue,symbolInstanceStart:de,symbolInstanceEnd:pe}=le;e.push({sortKey:ue,symbolInstanceStart:de,symbolInstanceEnd:pe,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,r,l,u,p,_,x,w,P,A,D,O,$,U,Q,Y,J,re,le,ue){const de=h.ax[e.textAnchor],pe=[e.textOffset0,e.textOffset1],se=ia(de,l,u,pe,p),be=this.collisionIndex.placeCollisionBox(r,O,w,P,A,x,_,Y,D.predicate,le,se,ue);if((!re||this.collisionIndex.placeCollisionBox(re,O,w,P,A,x,_,J,D.predicate,le,se,ue).placeable)&&be.placeable){let we;if(this.prevPlacement&&this.prevPlacement.variableOffsets[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID]&&this.prevPlacement.placements[$.crossTileID].text&&(we=this.prevPlacement.variableOffsets[$.crossTileID].anchor),$.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[$.crossTileID]={textOffset:pe,width:l,height:u,anchor:de,textBoxScale:p,prevAnchor:we},this.markUsedJustification(U,de,$,Q),U.allowVerticalPlacement&&(this.markUsedOrientation(U,Q,$),this.placedOrientations[$.crossTileID]=Q),{shift:se,placedGlyphBoxes:be}}}placeLayerBucketPart(e,r,l){const{bucket:u,layout:p,translationText:_,translationIcon:x,unwrappedTileID:w,pitchedLabelPlaneMatrix:P,textPixelRatio:A,holdingForFade:D,collisionBoxArray:O,partiallyEvaluatedTextSize:$,collisionGroup:U}=e.parameters,Q=p.get("text-optional"),Y=p.get("icon-optional"),J=h.ay(p,"text-overlap","text-allow-overlap"),re=J==="always",le=h.ay(p,"icon-overlap","icon-allow-overlap"),ue=le==="always",de=p.get("text-rotation-alignment")==="map",pe=p.get("text-pitch-alignment")==="map",se=p.get("icon-text-fit")!=="none",be=p.get("symbol-z-order")==="viewport-y",we=re&&(ue||!u.hasIconData()||Y),Fe=ue&&(re||!u.hasTextData()||Q);!u.collisionArrays&&O&&u.deserializeCollisionBoxes(O);const je=this.retainedQueryData[u.bucketInstanceId].tileID,Oe=this._getTerrainElevationFunc(je),lt=this.transform.getFastPathSimpleProjectionMatrix(je),Qe=(He,Pt,Rt)=>{var nr,pr;if(r[He.crossTileID])return;if(D)return void(this.placements[He.crossTileID]=new Fu(!1,!1,!1));let Pr=!1,Ur=!1,Fr=!0,wr=null,zr={box:null,placeable:!1,offscreen:null,occluded:!1},yn={placeable:!1},vn=null,an=null,In=null,Ho=0,zo=0,wi=0;Pt.textFeatureIndex?Ho=Pt.textFeatureIndex:He.useRuntimeCollisionCircles&&(Ho=He.featureIndex),Pt.verticalTextFeatureIndex&&(zo=Pt.verticalTextFeatureIndex);const Li=Pt.textBox;if(Li){const Ti=Br=>{let Rr=h.ag.horizontal;if(u.allowVerticalPlacement&&!Br&&this.prevPlacement){const sn=this.prevPlacement.placedOrientations[He.crossTileID];sn&&(this.placedOrientations[He.crossTileID]=sn,Rr=sn,this.markUsedOrientation(u,Rr,He))}return Rr},go=(Br,Rr)=>{if(u.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Pt.verticalTextBox){for(const sn of u.writingModes)if(sn===h.ag.vertical?(zr=Rr(),yn=zr):zr=Br(),zr&&zr.placeable)break}else zr=Br()},ro=He.textAnchorOffsetStartIndex,_o=He.textAnchorOffsetEndIndex;if(_o===ro){const Br=(Rr,sn)=>{const ln=this.collisionIndex.placeCollisionBox(Rr,J,A,je,w,pe,de,_,U.predicate,Oe,void 0,lt);return ln&&ln.placeable&&(this.markUsedOrientation(u,sn,He),this.placedOrientations[He.crossTileID]=sn),ln};go(()=>Br(Li,h.ag.horizontal),()=>{const Rr=Pt.verticalTextBox;return u.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Rr?Br(Rr,h.ag.vertical):{box:null,offscreen:null}}),Ti(zr&&zr.placeable)}else{let Br=h.ax[(pr=(nr=this.prevPlacement)===null||nr===void 0?void 0:nr.variableOffsets[He.crossTileID])===null||pr===void 0?void 0:pr.anchor];const Rr=(ln,Ia,Wh)=>{const vc=ln.x2-ln.x1,xc=ln.y2-ln.y1,ah=He.textBoxScale,Ma=se&&le==="never"?Ia:null;let Si=null,mu=J==="never"?1:2,ml="never";Br&&mu++;for(let gu=0;gu<mu;gu++){for(let _u=ro;_u<_o;_u++){const sh=u.textAnchorOffsets.get(_u);if(Br&&sh.textAnchor!==Br)continue;const Pi=this.attemptAnchorPlacement(sh,ln,vc,xc,ah,de,pe,A,je,w,U,ml,He,u,Wh,_,x,Ma,Oe);if(Pi&&(Si=Pi.placedGlyphBoxes,Si&&Si.placeable))return Pr=!0,wr=Pi.shift,Si}Br?Br=null:ml=J}return l&&!Si&&(Si={box:this.collisionIndex.placeCollisionBox(Li,"always",A,je,w,pe,de,_,U.predicate,Oe,void 0,lt).box,offscreen:!1,placeable:!1,occluded:!1}),Si};go(()=>Rr(Li,Pt.iconBox,h.ag.horizontal),()=>{const ln=Pt.verticalTextBox;return u.allowVerticalPlacement&&(!zr||!zr.placeable)&&He.numVerticalGlyphVertices>0&&ln?Rr(ln,Pt.verticalIconBox,h.ag.vertical):{box:null,occluded:!0,offscreen:null}}),zr&&(Pr=zr.placeable,Fr=zr.offscreen);const sn=Ti(zr&&zr.placeable);if(!Pr&&this.prevPlacement){const ln=this.prevPlacement.variableOffsets[He.crossTileID];ln&&(this.variableOffsets[He.crossTileID]=ln,this.markUsedJustification(u,ln.anchor,He,sn))}}}if(vn=zr,Pr=vn&&vn.placeable,Fr=vn&&vn.offscreen,He.useRuntimeCollisionCircles){const Ti=u.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),go=h.ah(u.textSizeData,$,Ti),ro=p.get("text-padding");an=this.collisionIndex.placeCollisionCircles(J,Ti,u.lineVertexArray,u.glyphOffsetArray,go,w,P,l,pe,U.predicate,He.collisionCircleDiameter,ro,_,Oe),an.circles.length&&an.collisionDetected&&!l&&h.w("Collisions detected, but collision boxes are not shown"),Pr=re||an.circles.length>0&&!an.collisionDetected,Fr=Fr&&an.offscreen}if(Pt.iconFeatureIndex&&(wi=Pt.iconFeatureIndex),Pt.iconBox){const Ti=go=>this.collisionIndex.placeCollisionBox(go,le,A,je,w,pe,de,x,U.predicate,Oe,se&&wr?wr:void 0,lt);yn&&yn.placeable&&Pt.verticalIconBox?(In=Ti(Pt.verticalIconBox),Ur=In.placeable):(In=Ti(Pt.iconBox),Ur=In.placeable),Fr=Fr&&In.offscreen}const Ro=Q||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,Ca=Y||He.numIconVertices===0;Ro||Ca?Ca?Ro||(Ur=Ur&&Pr):Pr=Ur&&Pr:Ur=Pr=Ur&&Pr;const Ea=Ur&&In.placeable;if(Pr&&vn.placeable&&this.collisionIndex.insertCollisionBox(vn.box,J,p.get("text-ignore-placement"),u.bucketInstanceId,yn&&yn.placeable&&zo?zo:Ho,U.ID),Ea&&this.collisionIndex.insertCollisionBox(In.box,le,p.get("icon-ignore-placement"),u.bucketInstanceId,wi,U.ID),an&&Pr&&this.collisionIndex.insertCollisionCircles(an.circles,J,p.get("text-ignore-placement"),u.bucketInstanceId,Ho,U.ID),l&&this.storeCollisionData(u.bucketInstanceId,Rt,Pt,vn,In,an),He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(u.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new Fu((Pr||we)&&!(vn!=null&&vn.occluded),(Ur||Fe)&&!(In!=null&&In.occluded),Fr||u.justReloaded),r[He.crossTileID]=!0};if(be){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const He=u.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Pt=He.length-1;Pt>=0;--Pt){const Rt=He[Pt];Qe(u.symbolInstances.get(Rt),u.collisionArrays[Rt],Rt)}}else for(let He=e.symbolInstanceStart;He<e.symbolInstanceEnd;He++)Qe(u.symbolInstances.get(He),u.collisionArrays[He],He);u.justReloaded=!1}storeCollisionData(e,r,l,u,p,_){if(l.textBox||l.iconBox){let x,w;this.collisionBoxArrays.has(e)?x=this.collisionBoxArrays.get(e):(x=new Map,this.collisionBoxArrays.set(e,x)),x.has(r)?w=x.get(r):(w={text:null,icon:null},x.set(r,w)),l.textBox&&(w.text=u.box),l.iconBox&&(w.icon=p.box)}if(_){let x=this.collisionCircleArrays[e];x===void 0&&(x=this.collisionCircleArrays[e]=[]);for(let w=0;w<_.circles.length;w+=4)x.push(_.circles[w+0]-jr),x.push(_.circles[w+1]-jr),x.push(_.circles[w+2]),x.push(_.collisionDetected?1:0)}}markUsedJustification(e,r,l,u){let p;p=u===h.ag.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[h.az(r)];const _=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const x of _)x>=0&&(e.text.placedSymbolArray.get(x).crossTileID=p>=0&&x!==p?0:l.crossTileID)}markUsedOrientation(e,r,l){const u=r===h.ag.horizontal||r===h.ag.horizontalOnly?r:0,p=r===h.ag.vertical?r:0,_=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const x of _)e.text.placedSymbolArray.get(x).placedOrientation=u;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=p)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let l=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(e):1,p=r?r.opacities:{},_=r?r.variableOffsets:{},x=r?r.placedOrientations:{};for(const w in this.placements){const P=this.placements[w],A=p[w];A?(this.opacities[w]=new Dr(A,u,P.text,P.icon),l=l||P.text!==A.text.placed||P.icon!==A.icon.placed):(this.opacities[w]=new Dr(null,u,P.text,P.icon,P.skipFade),l=l||P.text||P.icon)}for(const w in p){const P=p[w];if(!this.opacities[w]){const A=new Dr(P,u,!1,!1);A.isHidden()||(this.opacities[w]=A,l=l||P.text.placed||P.icon.placed)}}for(const w in _)this.variableOffsets[w]||!this.opacities[w]||this.opacities[w].isHidden()||(this.variableOffsets[w]=_[w]);for(const w in x)this.placedOrientations[w]||!this.opacities[w]||this.opacities[w].isHidden()||(this.placedOrientations[w]=x[w]);if(r&&r.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const l={};for(const u of r){const p=u.getBucket(e);p&&u.latestFeatureIndex&&e.id===p.layerIds[0]&&this.updateBucketOpacities(p,u.tileID,l,u.collisionBoxArray)}}updateBucketOpacities(e,r,l,u){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const p=e.layers[0],_=p.layout,x=new Dr(null,0,!1,!1,!0),w=_.get("text-allow-overlap"),P=_.get("icon-allow-overlap"),A=p._unevaluatedLayout.hasValue("text-variable-anchor")||p._unevaluatedLayout.hasValue("text-variable-anchor-offset"),D=_.get("text-rotation-alignment")==="map",O=_.get("text-pitch-alignment")==="map",$=_.get("icon-text-fit")!=="none",U=new Dr(null,0,w&&(P||!e.hasIconData()||_.get("icon-optional")),P&&(w||!e.hasTextData()||_.get("text-optional")),!0);!e.collisionArrays&&u&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(u);const Q=(J,re,le)=>{for(let ue=0;ue<re/4;ue++)J.opacityVertexArray.emplaceBack(le);J.hasVisibleVertices=J.hasVisibleVertices||le!==Vn},Y=this.collisionBoxArrays.get(e.bucketInstanceId);for(let J=0;J<e.symbolInstances.length;J++){const re=e.symbolInstances.get(J),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:ue,crossTileID:de}=re;let pe=this.opacities[de];l[de]?pe=x:pe||(pe=U,this.opacities[de]=pe),l[de]=!0;const se=re.numIconVertices>0,be=this.placedOrientations[re.crossTileID],we=be===h.ag.vertical,Fe=be===h.ag.horizontal||be===h.ag.horizontalOnly;if(le>0||ue>0){const Oe=Vu(pe.text);Q(e.text,le,we?Vn:Oe),Q(e.text,ue,Fe?Vn:Oe);const lt=pe.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach(Pt=>{Pt>=0&&(e.text.placedSymbolArray.get(Pt).hidden=lt||we?1:0)}),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=lt||Fe?1:0);const Qe=this.variableOffsets[re.crossTileID];Qe&&this.markUsedJustification(e,Qe.anchor,re,be);const He=this.placedOrientations[re.crossTileID];He&&(this.markUsedJustification(e,"left",re,He),this.markUsedOrientation(e,He,re))}if(se){const Oe=Vu(pe.icon),lt=!($&&re.verticalPlacedIconSymbolIndex&&we);re.placedIconSymbolIndex>=0&&(Q(e.icon,re.numIconVertices,lt?Oe:Vn),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=pe.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(Q(e.icon,re.numVerticalIconVertices,lt?Vn:Oe),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=pe.icon.isHidden())}const je=Y&&Y.has(J)?Y.get(J):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Oe=e.collisionArrays[J];if(Oe){let lt=new h.P(0,0);if(Oe.textBox||Oe.verticalTextBox){let Qe=!0;if(A){const He=this.variableOffsets[de];He?(lt=ia(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),D&&lt._rotate(O?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Qe=!1}if(Oe.textBox||Oe.verticalTextBox){let He;Oe.textBox&&(He=we),Oe.verticalTextBox&&(He=Fe),ju(e.textCollisionBox.collisionVertexArray,pe.text.placed,!Qe||He,je.text,lt.x,lt.y)}}if(Oe.iconBox||Oe.verticalIconBox){const Qe=!!(!Fe&&Oe.verticalIconBox);let He;Oe.iconBox&&(He=Qe),Oe.verticalIconBox&&(He=!Qe),ju(e.iconCollisionBox.collisionVertexArray,pe.icon.placed,He,je.icon,$?lt.x:0,$?lt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const l=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function ju(d,e,r,l,u,p){l&&l.length!==0||(l=[0,0,0,0]);const _=l[0]-jr,x=l[1]-jr,w=l[2]-jr,P=l[3]-jr;d.emplaceBack(e?1:0,r?1:0,u||0,p||0,_,x),d.emplaceBack(e?1:0,r?1:0,u||0,p||0,w,x),d.emplaceBack(e?1:0,r?1:0,u||0,p||0,w,P),d.emplaceBack(e?1:0,r?1:0,u||0,p||0,_,P)}const Fl=Math.pow(2,25),Nu=Math.pow(2,24),Bo=Math.pow(2,17),Vc=Math.pow(2,16),$c=Math.pow(2,9),Bl=Math.pow(2,8),To=Math.pow(2,1);function Vu(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const e=d.placed?1:0,r=Math.floor(127*d.opacity);return r*Fl+e*Nu+r*Bo+e*Vc+r*$c+e*Bl+r*To+e}const Vn=0;class $u{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,r,l,u,p){const _=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(_,u,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort((x,w)=>x.sortKey-w.sortKey));this._currentPartIndex<_.length;)if(r.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,p())return!0;return!1}}class Uu{constructor(e,r,l,u,p,_,x,w){this.placement=new Gr(e,r,_,x,w),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=u,this._showCollisionBoxes=p,this._done=!1}isDone(){return this._done}continuePlacement(e,r,l){const u=ze.now(),p=()=>!this._forceFullPlacement&&ze.now()-u>2;for(;this._currentPlacementIndex>=0;){const _=r[e[this._currentPlacementIndex]],x=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=x)&&(!_.maxzoom||_.maxzoom>x)){if(this._inProgressLayer||(this._inProgressLayer=new $u(_)),this._inProgressLayer.continuePlacement(l[_.source],this.placement,this._showCollisionBoxes,_,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const hs=512/h.Z/2;class ds{constructor(e,r,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const u=new Map;for(let p=0;p<r.length;p++){const _=r.get(p),x=_.key,w=u.get(x);w?w.push(_):u.set(x,[_])}for(const[p,_]of u){const x={positions:_.map(w=>({x:Math.floor(w.anchorX*hs),y:Math.floor(w.anchorY*hs)})),crossTileIDs:_.map(w=>w.crossTileID)};if(x.positions.length>128){const w=new h.aB(x.positions.length,16,Uint16Array);for(const{x:P,y:A}of x.positions)w.add(P,A);w.finish(),delete x.positions,x.index=w}this._symbolsByKey[p]=x}}getScaledCoordinates(e,r){const{x:l,y:u,z:p}=this.tileID.canonical,{x:_,y:x,z:w}=r.canonical,P=hs/Math.pow(2,w-p),A=(x*h.Z+e.anchorY)*P,D=u*h.Z*hs;return{x:Math.floor((_*h.Z+e.anchorX)*P-l*h.Z*hs),y:Math.floor(A-D)}}findMatches(e,r,l){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z);for(let p=0;p<e.length;p++){const _=e.get(p);if(_.crossTileID)continue;const x=this._symbolsByKey[_.key];if(!x)continue;const w=this.getScaledCoordinates(_,r);if(x.index){const P=x.index.range(w.x-u,w.y-u,w.x+u,w.y+u).sort();for(const A of P){const D=x.crossTileIDs[A];if(!l[D]){l[D]=!0,_.crossTileID=D;break}}}else if(x.positions)for(let P=0;P<x.positions.length;P++){const A=x.positions[P],D=x.crossTileIDs[P];if(Math.abs(A.x-w.x)<=u&&Math.abs(A.y-w.y)<=u&&!l[D]){l[D]=!0,_.crossTileID=D;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class ps{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class oa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const l in this.indexes){const u=this.indexes[l],p={};for(const _ in u){const x=u[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+r),p[x.tileID.key]=x}this.indexes[l]=p}this.lng=e}addBucket(e,r,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let p=0;p<r.symbolInstances.length;p++)r.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const u=this.usedCrossTileIDs[e.overscaledZ];for(const p in this.indexes){const _=this.indexes[p];if(Number(p)>e.overscaledZ)for(const x in _){const w=_[x];w.tileID.isChildOf(e)&&w.findMatches(r.symbolInstances,e,u)}else{const x=_[e.scaledTo(Number(p)).key];x&&x.findMatches(r.symbolInstances,e,u)}}for(let p=0;p<r.symbolInstances.length;p++){const _=r.symbolInstances.get(p);_.crossTileID||(_.crossTileID=l.generate(),u[_.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ds(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const l of r.getCrossTileIDsLists())for(const u of l)delete this.usedCrossTileIDs[e][u]}removeStaleBuckets(e){let r=!1;for(const l in this.indexes){const u=this.indexes[l];for(const p in u)e[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,u[p]),delete u[p],r=!0)}return r}}class fs{constructor(){this.layerIndexes={},this.crossTileIDs=new ps,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,l){let u=this.layerIndexes[e.id];u===void 0&&(u=this.layerIndexes[e.id]=new oa);let p=!1;const _={};u.handleWrapJump(l);for(const x of r){const w=x.getBucket(e);w&&e.id===w.layerIds[0]&&(w.bucketInstanceId||(w.bucketInstanceId=++this.maxBucketInstanceId),u.addBucket(x.tileID,w,this.crossTileIDs)&&(p=!0),_[w.bucketInstanceId]=!0)}return u.removeStaleBuckets(_)&&(p=!0),p}pruneUnusedLayers(e){const r={};e.forEach(l=>{r[l]=!0});for(const l in this.layerIndexes)r[l]||delete this.layerIndexes[l]}}var La="void main() {fragColor=vec4(1.0);}";const lo={prelude:fr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:fr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:fr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:fr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:fr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:fr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:fr(La,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:fr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:fr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:fr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:fr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:fr(La,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:fr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:fr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:fr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:fr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:fr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:fr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:fr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:fr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:fr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:fr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:fr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:fr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:fr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:fr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:fr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:fr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:fr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:fr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function fr(d,e){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),u=d.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),p=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=p?p.concat(u):u,x={};return{fragmentSource:d=d.replace(r,(w,P,A,D,O)=>(x[O]=!0,P==="define"?`
#ifndef HAS_UNIFORM_u_${O}
in ${A} ${D} ${O};
#else
uniform ${A} ${D} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${A} ${D} ${O} = u_${O};
#endif
`)),vertexSource:e=e.replace(r,(w,P,A,D,O)=>{const $=D==="float"?"vec2":"vec4",U=O.match(/color/)?"color":$;return x[O]?P==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${A} ${$} a_${O};
out ${A} ${D} ${O};
#else
uniform ${A} ${D} u_${O};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${A} ${D} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${U}(a_${O}, u_${O}_t);
#else
    ${A} ${D} ${O} = u_${O};
#endif
`:P==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
in ${A} ${$} a_${O};
#else
uniform ${A} ${D} u_${O};
#endif
`:U==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${A} ${D} ${O} = a_${O};
#else
    ${A} ${D} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${A} ${D} ${O} = unpack_mix_${U}(a_${O}, u_${O}_t);
#else
    ${A} ${D} ${O} = u_${O};
#endif
`}),staticAttributes:l,staticUniforms:_}}class gi{constructor(e,r,l){this.vertexBuffer=e,this.indexBuffer=r,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var _i=h.aC([{name:"a_pos",type:"Int16",components:2}]);const ur="#define PROJECTION_MERCATOR",jl="mercator";class qs{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return jl}get shaderDefine(){return ur}get shaderPreludeCode(){return lo.projectionMercator}get vertexShaderPreludeCode(){return lo.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aD.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,r,l,u,p){if(this._cachedMesh)return this._cachedMesh;const _=new h.aE;_.emplaceBack(0,0),_.emplaceBack(h.Z,0),_.emplaceBack(0,h.Z),_.emplaceBack(h.Z,h.Z);const x=e.createVertexBuffer(_,_i.members),w=h.aF.simpleSegment(0,0,4,2),P=new h.aG;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3);const A=e.createIndexBuffer(P);return this._cachedMesh=new gi(x,A,w),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function ar(d,e){const r=h.ad(e.lat,-85.051129,h.aI);return new h.P(h.U(e.lng)*d,h.S(r)*d)}function Sn(d,e){return new h.$(e.x/d,e.y/d).toLngLat()}function cn(d){return d.cameraToCenterDistance*Math.min(.85*Math.tan(h.ac(90-d.pitch)),Math.tan(h.ac(89.25-d.pitch)))}function Wr(d,e){const r=d.canonical,l=e/h.aH(r.z),u=r.x+Math.pow(2,r.z)*d.wrap,p=h.as(new Float64Array(16));return h.L(p,p,[u*l,r.y*l,0]),h.M(p,p,[l/h.Z,l/h.Z,1]),p}function Nl(d,e,r,l,u){const p=h.$.fromLngLat(d,e),_=u*h.aJ(1,d.lat),x=_*Math.cos(h.ac(r)),w=Math.sqrt(_*_-x*x),P=w*Math.sin(h.ac(-l)),A=w*Math.cos(h.ac(-l));return new h.$(p.x+P,p.y+A,p.z+x)}class hn{constructor(e=0,r=0,l=0,u=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(l)||l<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=l,this.right=u}interpolate(e,r,l){return r.top!=null&&e.top!=null&&(this.top=h.B.number(e.top,r.top,l)),r.bottom!=null&&e.bottom!=null&&(this.bottom=h.B.number(e.bottom,r.bottom,l)),r.left!=null&&e.left!=null&&(this.left=h.B.number(e.left,r.left,l)),r.right!=null&&e.right!=null&&(this.right=h.B.number(e.right,r.right,l)),this}getCenter(e,r){const l=h.ad((this.left+e-this.right)/2,0,e),u=h.ad((this.top+r-this.bottom)/2,0,r);return new h.P(l,u)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new hn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function $n(d,e){if(!d.renderWorldCopies||d.lngRange)return;const r=e.lng-d.center.lng;e.lng+=r>180?-360:r<-180?360:0}function Un(d){return Math.max(0,Math.floor(d))}class Oa{constructor(e,r,l,u,p,_){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=r||0,this._maxZoom=l||22,this._minPitch=u??0,this._maxPitch=p??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.Q(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Un(this._zoom),this._scale=h.aH(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new hn,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,r,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Un(this._zoom),this._scale=h.aH(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new hn(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,r&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const r=h.aK(e,-180,180)*Math.PI/180;var l,u,p,_,x,w,P,A,D;this._bearingInRadians!==r&&(this._unmodified=!1,this._bearingInRadians=r,this._calcMatrices(),this._rotationMatrix=Ze(),l=this._rotationMatrix,p=-this._bearingInRadians,_=(u=this._rotationMatrix)[0],x=u[1],w=u[2],P=u[3],A=Math.sin(p),D=Math.cos(p),l[0]=_*D+w*A,l[1]=x*D+P*A,l[2]=_*-A+w*D,l[3]=x*-A+P*D)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const r=h.ad(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==r&&(this._unmodified=!1,this._pitchInRadians=r,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const r=e/180*Math.PI;this._rollInRadians!==r&&(this._unmodified=!1,this._rollInRadians=r,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aL(this._fovInRadians)}setFov(e){e=h.ad(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=h.ac(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const r=this.getConstrained(this._center,e).zoom;this._zoom!==r&&(this._unmodified=!1,this._zoom=r,this._tileZoom=Math.max(0,Math.floor(r)),this._scale=h.aH(r),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,r){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=r,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,l){this._unmodified=!1,this._edgeInsets.interpolate(e,r,l),this._constrain(),this._calcMatrices()}resize(e,r,l=!0){this._width=e,this._height=r,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Ar([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.aI])}getConstrained(e,r){return this._callbacks.getConstrained(e,r)}getCameraQueryGeometry(e,r){if(r.length===1)return[r[0],e];{let l=e.x,u=e.y,p=e.x,_=e.y;for(const x of r)l=Math.min(l,x.x),u=Math.min(u,x.y),p=Math.max(p,x.x),_=Math.max(_,x.y);return[new h.P(l,u),new h.P(p,u),new h.P(p,_),new h.P(l,_),new h.P(l,u)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:r,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(r),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=h.as(new Float64Array(16));h.M(e,e,[this._width/2,-this._height/2,1]),h.L(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=h.as(new Float64Array(16)),h.M(e,e,[1,-1,1]),h.L(e,e,[-1,-1,0]),h.M(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,r,l,u){const p=l!==void 0?l:this.bearing,_=u=u!==void 0?u:this.pitch,x=h.$.fromLngLat(e,r),w=-Math.cos(h.ac(_)),P=Math.sin(h.ac(_)),A=P*Math.sin(h.ac(p)),D=-P*Math.cos(h.ac(p));let O=this.elevation;const $=r-O;let U;w*$>=0||Math.abs(w)<.1?(U=1e4,O=r+U*w):U=-$/w;let Q,Y,J=h.aM(1,x.y),re=0;do{if(re+=1,re>10)break;Y=U/J,Q=new h.$(x.x+A*Y,x.y+D*Y),J=1/Q.meterInMercatorCoordinateUnits()}while(Math.abs(U-Y*J)>1e-12);return{center:Q.toLngLat(),elevation:O,zoom:h.aa(this.height/2/Math.tan(this.fovInRadians/2)/Y/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const r=h.aJ(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/r,u=h.$.fromLngLat(this.center,this.elevation),p=Nl(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const _=this.calculateCenterFromCameraLngLatAlt(p.toLngLat(),h.aM(p.z,u.y),this.bearing,this.pitch);this._elevation=_.elevation,this._center=_.center,this.setZoom(_.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=h.aJ(1,this.center.lat)*this.worldSize;return Nl(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const r=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/r,e.canonical.y/r,1/r/h.Z,1/r/h.Z]}}class Pn{constructor(e,r){this.min=e,this.max=r,this.center=h.aN([],h.aO([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],l=h.aP(this.min),u=h.aP(this.max);for(let p=0;p<r.length;p++)l[p]=r[p]?this.min[p]:this.center[p],u[p]=r[p]?this.center[p]:this.max[p];return u[2]=this.max[2],new Pn(l,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let r=!0;for(let l=0;l<e.planes.length;l++){const u=this.intersectsPlane(e.planes[l]);if(u===0)return 0;u===1&&(r=!1)}return r?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let r=e[3],l=e[3];for(let u=0;u<3;u++)e[u]>0?(r+=e[u]*this.min[u],l+=e[u]*this.max[u]):(l+=e[u]*this.min[u],r+=e[u]*this.max[u]);return r>=0?2:l<0?0:1}}class Nr{distanceToTile2d(e,r,l,u){const p=u.distanceX([e,r]),_=u.distanceY([e,r]);return Math.hypot(p,_)}getWrap(e,r,l){return l}getTileAABB(e,r,l,u){var p,_;let x=l,w=l;if(u.terrain){const A=new h.Y(e.z,r,e.z,e.x,e.y),D=u.terrain.getMinMaxElevation(A);x=(p=D.minElevation)!==null&&p!==void 0?p:l,w=(_=D.maxElevation)!==null&&_!==void 0?_:l}const P=1<<e.z;return new Pn([r+e.x/P,e.y/P,x],[r+(e.x+1)/P,(e.y+1)/P,w])}allowVariableZoom(e,r){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,u=h.ad(78.5-l/2,0,60);return!!r.terrain||e.pitch>u}allowWorldCopies(){return!0}recalculateCache(){}}class oi{constructor(e,r,l){this.points=e,this.planes=r,this.aabb=l}static fromInvProjectionMatrix(e,r=1,l=0){const u=Math.pow(2,l),p=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(P=>{const A=1/(P=h.ao([],P,e))[3]/r*u;return h.aQ(P,P,[A,A,1/P[3],A])}),_=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(P=>{const A=h.aR([],p[P[0]],p[P[1]]),D=h.aR([],p[P[2]],p[P[1]]),O=h.aS([],h.aT([],A,D)),$=-h.aU(O,p[P[1]]);return O.concat($)}),x=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],w=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const P of p)for(let A=0;A<3;A++)x[A]=Math.min(x[A],P[A]),w[A]=Math.max(w[A],P[A]);return new oi(p,_,new Pn(x,w))}}class Zn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,r){}constructor(e,r,l,u,p){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Oa({calcMatrices:()=>{this._calcMatrices()},getConstrained:(_,x)=>this.getConstrained(_,x)},e,r,l,u,p),this._coveringTilesDetailsProvider=new Nr}clone(){const e=new Zn;return e.apply(this),e}apply(e,r,l){this._helper.apply(e,r,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const r=[new h.aV(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new h.P(0,0)),u=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),p=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),_=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),x=Math.floor(Math.min(l.x,u.x,p.x,_.x)),w=Math.floor(Math.max(l.x,u.x,p.x,_.x)),P=1;for(let A=x-P;A<=w+P;A++)A!==0&&r.push(new h.aV(A,e))}return r}getCameraFrustum(){return oi.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const r=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(r,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,r){const l=h.aJ(this.elevation,this.center.lat),u=this.screenPointToMercatorCoordinateAtZ(r,l),p=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),_=h.$.fromLngLat(e),x=new h.$(_.x-(u.x-p.x),_.y-(u.y-p.y));this.setCenter(x==null?void 0:x.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,r){return r?this.coordinatePoint(h.$.fromLngLat(e),r.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.$.fromLngLat(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,r){const l=r||0,u=[e.x,e.y,0,1],p=[e.x,e.y,1,1];h.ao(u,u,this._pixelMatrixInverse),h.ao(p,p,this._pixelMatrixInverse);const _=u[3],x=p[3],w=u[1]/_,P=p[1]/x,A=u[2]/_,D=p[2]/x,O=A===D?0:(l-A)/(D-A);return new h.$(h.B.number(u[0]/_,p[0]/x,O)/this.worldSize,h.B.number(w,P,O)/this.worldSize,l)}coordinatePoint(e,r=0,l=this._pixelMatrix){const u=[e.x*this.worldSize,e.y*this.worldSize,r,1];return h.ao(u,u,l),new h.P(u[0]/u[3],u[1]/u[3])}getBounds(){const e=Math.max(0,this._helper._height/2-cn(this));return new Ar().extend(this.screenPointToLocation(new h.P(0,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(e,r){return r?r.pointCoordinate(e)!=null:e.y>this.height/2-cn(this)}calculatePosMatrix(e,r=!1,l){var u;const p=(u=e.key)!==null&&u!==void 0?u:h.aW(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),_=r?this._alignedPosMatrixCache:this._posMatrixCache;if(_.has(p)){const P=_.get(p);return l?P.f32:P.f64}const x=Wr(e,this.worldSize);h.N(x,r?this._alignedProjMatrix:this._viewProjMatrix,x);const w={f64:x,f32:new Float32Array(x)};return _.set(p,w),l?w.f32:w.f64}calculateFogMatrix(e){const r=e.key,l=this._fogMatrixCacheF32;if(l.has(r))return l.get(r);const u=Wr(e,this.worldSize);return h.N(u,this._fogMatrix,u),l.set(r,new Float32Array(u)),l.get(r)}getConstrained(e,r){r=h.ad(+r,this.minZoom,this.maxZoom);const l={center:new h.Q(e.lng,e.lat),zoom:r};let u=this._helper._lngRange;this._helper._renderWorldCopies||u!==null||(u=[-179.9999999999,180-1e-10]);const p=this.tileSize*h.aH(l.zoom);let _=0,x=p,w=0,P=p,A=0,D=0;const{x:O,y:$}=this.size;if(this._helper._latRange){const le=this._helper._latRange;_=h.S(le[1])*p,x=h.S(le[0])*p,x-_<$&&(A=$/(x-_))}u&&(w=h.aK(h.U(u[0])*p,0,p),P=h.aK(h.U(u[1])*p,0,p),P<w&&(P+=p),P-w<O&&(D=O/(P-w)));const{x:U,y:Q}=ar(p,e);let Y,J;const re=Math.max(D||0,A||0);if(re){const le=new h.P(D?(P+w)/2:U,A?(x+_)/2:Q);return l.center=Sn(p,le).wrap(),l.zoom+=h.aa(re),l}if(this._helper._latRange){const le=$/2;Q-le<_&&(J=_+le),Q+le>x&&(J=x-le)}if(u){const le=(w+P)/2;let ue=U;this._helper._renderWorldCopies&&(ue=h.aK(U,le-p/2,le+p/2));const de=O/2;ue-de<w&&(Y=w+de),ue+de>P&&(Y=P-de)}if(Y!==void 0||J!==void 0){const le=new h.P(Y??U,J??Q);l.center=Sn(p,le).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}_calculateNearFarZIfNeeded(e,r,l){if(!this._helper.autoCalculateNearFarZ)return;const u=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),p=e-u*this._helper._pixelPerMeter/Math.cos(r),_=u<0?p:e,x=Math.PI/2+this.pitchInRadians,w=h.ac(this.fov)*(Math.abs(Math.cos(h.ac(this.roll)))*this.height+Math.abs(Math.sin(h.ac(this.roll)))*this.width)/this.height*(.5+l.y/this.height),P=Math.sin(w)*_/Math.sin(h.ad(Math.PI-x-w,.01,Math.PI-.01)),A=cn(this),D=Math.atan(A/this._helper.cameraToCenterDistance),O=h.ac(.75),$=D>O?2*D*(.5+l.y/(2*A)):O,U=Math.sin($)*_/Math.sin(h.ad(Math.PI-x-$,.01,Math.PI-.01)),Q=Math.min(P,U);this._helper._farZ=1.01*(Math.cos(Math.PI/2-r)*Q+_),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,r=ar(this.worldSize,this.center),l=r.x,u=r.y;this._helper._pixelPerMeter=h.aJ(1,this.center.lat)*this.worldSize;const p=h.ac(Math.min(this.pitch,89.25)),_=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(p));let x;this._calculateNearFarZIfNeeded(_,p,e),x=new Float64Array(16),h.aX(x,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.ai(this._invProjMatrix,x),x[8]=2*-e.x/this._helper._width,x[9]=2*e.y/this._helper._height,this._projectionMatrix=h.aY(x),h.M(x,x,[1,-1,1]),h.L(x,x,[0,0,-this._helper.cameraToCenterDistance]),h.aZ(x,x,-this.rollInRadians),h.a_(x,x,this.pitchInRadians),h.aZ(x,x,-this.bearingInRadians),h.L(x,x,[-l,-u,0]),this._mercatorMatrix=h.M([],x,[this.worldSize,this.worldSize,this.worldSize]),h.M(x,x,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x),h.L(x,x,[0,0,-this.elevation]),this._viewProjMatrix=x,this._invViewProjMatrix=h.ai([],x);const w=[0,0,-1,1];h.ao(w,w,this._invViewProjMatrix),this._cameraPosition=[w[0]/w[3],w[1]/w[3],w[2]/w[3]],this._fogMatrix=new Float64Array(16),h.aX(this._fogMatrix,this.fovInRadians,this.width/this.height,_,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,h.M(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.L(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.aZ(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.a_(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.aZ(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.L(this._fogMatrix,this._fogMatrix,[-l,-u,0]),h.M(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.L(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.N(new Float64Array(16),this.clipSpaceToPixelsMatrix,x);const P=this._helper._width%2/2,A=this._helper._height%2/2,D=Math.cos(this.bearingInRadians),O=Math.sin(-this.bearingInRadians),$=l-Math.round(l)+D*P+O*A,U=u-Math.round(u)+D*A+O*P,Q=new Float64Array(x);if(h.L(Q,Q,[$>.5?$-1:$,U>.5?U-1:U,0]),this._alignedProjMatrix=Q,x=h.ai(new Float64Array(16),this._pixelMatrix),!x)throw new Error("failed to invert matrix");this._pixelMatrixInverse=x,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new h.P(0,0)),r=[e.x*this.worldSize,e.y*this.worldSize,0,1];return h.ao(r,r,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=h.aJ(1,this.center.lat)*this.worldSize;return Nl(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,r){const l=h.$.fromLngLat(e),u=[l.x*this.worldSize,l.y*this.worldSize,r,1];return h.ao(u,u,this._viewProjMatrix),u[2]/u[3]}getProjectionData(e){const{overscaledTileID:r,aligned:l,applyTerrainMatrix:u}=e,p=this._helper.getMercatorTileCoordinates(r),_=r?this.calculatePosMatrix(r,l,!0):null;let x;return x=r&&r.terrainRttPosMatrix32f&&u?r.terrainRttPosMatrix32f:_||h.a$(),{mainMatrix:x,tileMercatorCoords:p,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:x}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,r,l){return 1}transformLightDirection(e){return h.aP(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,r,l,u){const p=this.calculatePosMatrix(l);let _;u?(_=[e,r,u(e,r),1],h.ao(_,_,p)):(_=[e,r,0,1],on(_,_,p));const x=_[3];return{point:new h.P(_[0]/x,_[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}populateCache(e){for(const r of e)this.calculatePosMatrix(r)}getMatrixForModel(e,r){const l=h.$.fromLngLat(e,r),u=l.meterInMercatorCoordinateUnits(),p=h.b0();return h.L(p,p,[l.x,l.y,l.z]),h.aZ(p,p,Math.PI),h.a_(p,p,Math.PI/2),h.M(p,p,[-u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=new h.Y(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:r,applyGlobeMatrix:e}),u=Wr(r,this.worldSize);h.N(u,this._viewProjMatrix,u),l.tileMercatorCoords=[0,0,1,1];const p=[h.Z,h.Z,this.worldSize/this._helper.pixelsPerMeter],_=h.b1();return h.M(_,u,p),l.fallbackMatrix=_,l.mainMatrix=_,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function jo(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function dn(d){if(d.useSlerp)if(d.k<1){const e=h.b2(d.startEulerAngles.roll,d.startEulerAngles.pitch,d.startEulerAngles.bearing),r=h.b2(d.endEulerAngles.roll,d.endEulerAngles.pitch,d.endEulerAngles.bearing),l=new Float64Array(4);h.b3(l,e,r,d.k);const u=h.b4(l);d.tr.setRoll(u.roll),d.tr.setPitch(u.pitch),d.tr.setBearing(u.bearing)}else d.tr.setRoll(d.endEulerAngles.roll),d.tr.setPitch(d.endEulerAngles.pitch),d.tr.setBearing(d.endEulerAngles.bearing);else d.tr.setRoll(h.B.number(d.startEulerAngles.roll,d.endEulerAngles.roll,d.k)),d.tr.setPitch(h.B.number(d.startEulerAngles.pitch,d.endEulerAngles.pitch,d.k)),d.tr.setBearing(h.B.number(d.startEulerAngles.bearing,d.endEulerAngles.bearing,d.k))}function Zu(d,e,r,l,u){const p=u.padding,_=ar(u.worldSize,r.getNorthWest()),x=ar(u.worldSize,r.getNorthEast()),w=ar(u.worldSize,r.getSouthEast()),P=ar(u.worldSize,r.getSouthWest()),A=h.ac(-l),D=_.rotate(A),O=x.rotate(A),$=w.rotate(A),U=P.rotate(A),Q=new h.P(Math.max(D.x,O.x,U.x,$.x),Math.max(D.y,O.y,U.y,$.y)),Y=new h.P(Math.min(D.x,O.x,U.x,$.x),Math.min(D.y,O.y,U.y,$.y)),J=Q.sub(Y),re=(u.width-(p.left+p.right+e.left+e.right))/J.x,le=(u.height-(p.top+p.bottom+e.top+e.bottom))/J.y;if(le<0||re<0)return void jo();const ue=Math.min(h.aa(u.scale*Math.min(re,le)),d.maxZoom),de=h.P.convert(d.offset),pe=new h.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(h.ac(l)),se=de.add(pe).mult(u.scale/h.aH(ue));return{center:Sn(u.worldSize,_.add(w).div(2).sub(se)),zoom:ue,bearing:l}}class qi{get useGlobeControls(){return!1}handlePanInertia(e,r){return{easingOffset:e,easingCenter:r.center}}handleMapControlsRollPitchBearingZoom(e,r){e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta),e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta)}handleMapControlsPan(e,r,l){e.around.distSqr(r.centerPoint)<.01||r.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,r,l,u,p){return Zu(e,r,l,u,p)}handleJumpToCenterZoom(e,r){e.zoom!==(r.zoom!==void 0?+r.zoom:e.zoom)&&e.setZoom(+r.zoom),r.center!==void 0&&e.setCenter(h.Q.convert(r.center))}handleEaseTo(e,r){const l=e.zoom,u=e.padding,p={roll:e.roll,pitch:e.pitch,bearing:e.bearing},_={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},x=r.zoom!==void 0,w=!e.isPaddingEqual(r.padding);let P=!1;const A=x?+r.zoom:e.zoom;let D=e.centerPoint.add(r.offsetAsPoint);const O=e.screenPointToLocation(D),{center:$,zoom:U}=e.getConstrained(h.Q.convert(r.center||O),A??l);$n(e,$);const Q=ar(e.worldSize,O),Y=ar(e.worldSize,$).sub(Q),J=h.aH(U-l);return P=U!==l,{easeFunc:re=>{if(P&&e.setZoom(h.B.number(l,U,re)),h.b5(p,_)||dn({startEulerAngles:p,endEulerAngles:_,tr:e,k:re,useSlerp:p.roll!=_.roll}),w&&(e.interpolatePadding(u,r.padding,re),D=e.centerPoint.add(r.offsetAsPoint)),r.around)e.setLocationAtPoint(r.around,r.aroundPoint);else{const le=h.aH(e.zoom-l),ue=U>l?Math.min(2,J):Math.max(.5,J),de=Math.pow(ue,1-re),pe=Sn(e.worldSize,Q.add(Y.mult(re*de)).mult(le));e.setLocationAtPoint(e.renderWorldCopies?pe.wrap():pe,D)}},isZooming:P,elevationCenter:$}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.zoom,p=e.getConstrained(h.Q.convert(r.center||r.locationAtOffset),l?+r.zoom:u),_=p.center,x=p.zoom;$n(e,_);const w=ar(e.worldSize,r.locationAtOffset),P=ar(e.worldSize,_).sub(w),A=P.mag(),D=h.aH(x-u);let O;if(r.minZoom!==void 0){const $=Math.min(+r.minZoom,u,x),U=e.getConstrained(_,$).zoom;O=h.aH(U-u)}return{easeFunc:($,U,Q,Y)=>{e.setZoom($===1?x:u+h.aa(U));const J=$===1?_:Sn(e.worldSize,w.add(P.mult(Q)).mult(U));e.setLocationAtPoint(e.renderWorldCopies?J.wrap():J,Y)},scaleOfZoom:D,targetCenter:_,scaleOfMinZoom:O,pixelPathLength:A}}}class Lr{constructor(e,r,l){this.blendFunction=e,this.blendColor=r,this.mask=l}}Lr.Replace=[1,0],Lr.disabled=new Lr(Lr.Replace,h.b6.transparent,[!1,!1,!1,!1]),Lr.unblended=new Lr(Lr.Replace,h.b6.transparent,[!0,!0,!0,!0]),Lr.alphaBlended=new Lr([1,771],h.b6.transparent,[!0,!0,!0,!0]);const Vl=2305;class hr{constructor(e,r,l){this.enable=e,this.mode=r,this.frontFace=l}}hr.disabled=new hr(!1,1029,Vl),hr.backCCW=new hr(!0,1029,Vl),hr.frontCCW=new hr(!0,1028,Vl);class Qt{constructor(e,r,l){this.func=e,this.mask=r,this.range=l}}Qt.ReadOnly=!1,Qt.ReadWrite=!0,Qt.disabled=new Qt(519,Qt.ReadOnly,[0,1]);const Fa=7680;class yr{constructor(e,r,l,u,p,_){this.test=e,this.ref=r,this.mask=l,this.fail=u,this.depthFail=p,this.pass=_}}yr.disabled=new yr({func:519,mask:0},0,0,Fa,Fa,Fa);const No=new WeakMap;function Gn(d){var e;if(No.has(d))return No.get(d);{const r=(e=d.getParameter(d.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return No.set(d,r),r}}class So{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const r=e.context,l=r.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const u=new h.aE;u.emplaceBack(-1,-1),u.emplaceBack(2,-1),u.emplaceBack(-1,2);const p=new h.aG;p.emplaceBack(0,1,2),this._fullscreenTriangle=new gi(r.createVertexBuffer(u,_i.members),r.createIndexBuffer(p),h.aF.simpleSegment(0,0,u.length,p.length)),this._resultBuffer=new Uint8Array(4),r.activeTexture.set(l.TEXTURE1);const _=l.createTexture();l.bindTexture(l.TEXTURE_2D,_),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=r.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(_),Gn(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,r){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,r),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,r=e.gl;e.activeTexture.set(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,r){const l=this._cachedRenderContext.context,u=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:h.b6.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,u.TRIANGLES,Qt.disabled,yr.disabled,Lr.unblended,hr.disabled,((p,_)=>({u_input:p,u_output_expected:_}))(e,r),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Gn(u)){u.bindBuffer(u.PIXEL_PACK_BUFFER,this._pbo),u.readBuffer(u.COLOR_ATTACHMENT0),u.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),u.bindBuffer(u.PIXEL_PACK_BUFFER,null);const p=u.fenceSync(u.SYNC_GPU_COMMANDS_COMPLETE,0);u.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:p}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Gn(e)){const r=e.clientWaitSync(this._readbackQueue.sync,0,0);if(r===e.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(r===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=So._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let r=0;return r+=e[0]/256,r+=e[1]/65536,r+=e[2]/16777216,e[3]<127&&(r=-r),r/128}}const Ba=h.Z/128;function Ws(d,e){const r=d.granularity!==void 0?Math.max(d.granularity,1):1,l=r+(d.generateBorders?2:0),u=r+(d.extendToNorthPole||d.generateBorders?1:0)+(d.extendToSouthPole||d.generateBorders?1:0),p=l+1,_=u+1,x=d.generateBorders?-1:0,w=d.generateBorders||d.extendToNorthPole?-1:0,P=r+(d.generateBorders?1:0),A=r+(d.generateBorders||d.extendToSouthPole?1:0),D=p*_,O=l*u*6,$=p*_>65536;if($&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const U=$||e==="32bit",Q=new Int16Array(2*D);let Y=0;for(let le=w;le<=A;le++)for(let ue=x;ue<=P;ue++){let de=ue/r*h.Z;ue===-1&&(de=-64),ue===r+1&&(de=h.Z+Ba);let pe=le/r*h.Z;le===-1&&(pe=d.extendToNorthPole?h.b8:-64),le===r+1&&(pe=d.extendToSouthPole?h.b9:h.Z+Ba),Q[Y++]=de,Q[Y++]=pe}const J=U?new Uint32Array(O):new Uint16Array(O);let re=0;for(let le=0;le<u;le++)for(let ue=0;ue<l;ue++){const de=ue+1+le*p,pe=ue+(le+1)*p,se=ue+1+(le+1)*p;J[re++]=ue+le*p,J[re++]=pe,J[re++]=de,J[re++]=de,J[re++]=pe,J[re++]=se}return{vertices:Q.buffer.slice(0),indices:J.buffer.slice(0),uses32bitIndices:U}}const ms=new h.aD({fill:new h.ba(128,2),line:new h.ba(512,0),tile:new h.ba(128,32),stencil:new h.ba(128,1),circle:3});class aa{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return lo.projectionGlobe}get vertexShaderPreludeCode(){return lo.projectionMercator.vertexSource}get subdivisionGranularity(){return ms}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new So(e));const r=h.S(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-r*Math.PI*2))-.5*Math.PI,u=this._errorMeasurement.updateErrorLoop(r,l),p=ze.now();u!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=u,this._errorMeasurementLastChangeTime=p);const _=Math.min(Math.max((p-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.bb(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.bc(_))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,r,l,u,p){const _=(p==="stencil"?ms.stencil:ms.tile).getGranularityForZoomLevel(r.z);return this._getMesh(e,{granularity:_,generateBorders:l,extendToNorthPole:r.y===0&&u,extendToSouthPole:r.y===(1<<r.z)-1&&u})}_getMesh(e,r){const l=this._getMeshKey(r);if(l in this._tileMeshCache)return this._tileMeshCache[l];const u=function(p,_){const x=Ws(_,"16bit"),w=h.aE.deserialize({arrayBuffer:x.vertices,length:x.vertices.byteLength/2/2}),P=h.aG.deserialize({arrayBuffer:x.indices,length:x.indices.byteLength/2/3});return new gi(p.createVertexBuffer(w,_i.members),p.createIndexBuffer(P),h.aF.simpleSegment(0,0,w.length,P.length))}(e,r);return this._tileMeshCache[l]=u,u}recalculate(e){}hasTransition(){const e=ze.now();let r=!1;return r=r||(e-this._errorMeasurementLastChangeTime)/1e3<.7,r=r||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,r}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const $l=new h.r({type:new h.D(h.v.projection.type)});class gs extends h.E{constructor(e){super(),this._transitionable=new h.T($l),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.C(0)),this._mercatorProjection=new qs,this._verticalPerspectiveProjection=new aa}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof h.bd){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,r,l,u,p){return this.currentProjection.getMeshFromTileID(e,r,l,u,p)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Ul(d){const e=pn(d.worldSize,d.center.lat);return 2*Math.PI*e}function Wi(d,e,r,l,u){const p=1/(1<<u),_=e/h.Z*p+l*p,x=h.bf((d/h.Z*p+r*p)*Math.PI*2+Math.PI,2*Math.PI),w=2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI,P=Math.cos(w),A=new Float64Array(3);return A[0]=Math.sin(x)*P,A[1]=Math.sin(w),A[2]=Math.cos(x)*P,A}function Cn(d){return function(e,r){const l=Math.cos(r),u=new Float64Array(3);return u[0]=Math.sin(e)*l,u[1]=Math.sin(r),u[2]=Math.cos(e)*l,u}(d.lng*Math.PI/180,d.lat*Math.PI/180)}function pn(d,e){return d/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Hs(d){const e=Math.asin(d[1])/Math.PI*180,r=Math.sqrt(d[0]*d[0]+d[2]*d[2]);if(r>1e-6){const l=d[0]/r,u=Math.acos(d[2]/r),p=(l>0?u:-u)/Math.PI*180;return new h.Q(h.aK(p,-180,180),e)}return new h.Q(0,e)}function qn(d){return Math.cos(d*Math.PI/180)}function Xr(d,e){const r=qn(d),l=qn(e);return h.aa(l/r)}function Zl(d,e){const r=d.rotate(e.bearingInRadians),l=e.zoom+Xr(e.center.lat,0),u=h.bb(1/qn(e.center.lat),1/qn(Math.min(Math.abs(e.center.lat),60)),h.be(l,7,3,0,1)),p=360/Ul({worldSize:e.worldSize,center:{lat:e.center.lat}});return new h.Q(e.center.lng-r.x*p*u,h.ad(e.center.lat+r.y*p,-85.051129,h.aI))}function Wn(d){const e=.5*d,r=Math.sin(e),l=Math.cos(e);return Math.log(r+l)-Math.log(l-r)}function Hi(d,e,r,l){const u=d.lat+r*l;if(Math.abs(r)>1){const p=(Math.sign(d.lat+r)!==Math.sign(d.lat)?-Math.abs(d.lat):Math.abs(d.lat))*Math.PI/180,_=Math.abs(d.lat+r)*Math.PI/180,x=Wn(p+l*(_-p)),w=Wn(p),P=Wn(_);return new h.Q(d.lng+e*((x-w)/(P-w)),u)}return new h.Q(d.lng+e*l,u)}class Gu{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,r,l,u){const p=`${e.z}_${e.x}_${e.y}`,_=this._cache.get(p);if(_)return _;const x=this._cachePrevious.get(p);if(x)return this._cache.set(p,x),x;const w=this._aabbFactory(e,r,l,u);return this._cache.set(p,w),this._hadAnyChanges=!0,w}}function sa(d,e,r){const l=d-e;return l<0?-l:Math.max(0,l-r)}function qu(d,e,r,l,u){const p=d-r;let _;return _=p<0?Math.min(-p,1+p-u):p>1?Math.min(Math.max(p-u,0),1-p):0,Math.max(_,sa(e,l,u))}class Wu{constructor(){this._aabbCache=new Gu(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,r,l,u){const p=1<<l.z,_=1/p,x=l.x/p,w=l.y/p;let P=2;return P=Math.min(P,qu(e,r,x,w,_)),P=Math.min(P,qu(e,r,x+.5,-w-_,_)),P=Math.min(P,qu(e,r,x+.5,2-w-_,_)),P}getWrap(e,r,l){const u=1<<r.z,p=1/u,_=r.x/u,x=sa(e.x,_,p),w=sa(e.x,_-1,p),P=sa(e.x,_+1,p),A=Math.min(x,w,P);return A===P?1:A===w?-1:0}allowVariableZoom(e,r){return Ai(e,r)>4}allowWorldCopies(){return!1}getTileAABB(e,r,l,u){return this._aabbCache.getTileAABB(e,r,l,u)}_computeTileAABB(e,r,l,u){if(e.z<=0)return new Pn([-1,-1,-1],[1,1,1]);if(e.z===1)return new Pn([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const p=[Wi(0,0,e.x,e.y,e.z),Wi(h.Z,0,e.x,e.y,e.z),Wi(h.Z,h.Z,e.x,e.y,e.z),Wi(0,h.Z,e.x,e.y,e.z)],_=[1,1,1],x=[-1,-1,-1];for(const w of p)for(let P=0;P<3;P++)_[P]=Math.min(_[P],w[P]),x[P]=Math.max(x[P],w[P]);if(e.y===0||e.y===(1<<e.z)-1){const w=[0,e.y===0?1:-1,0];for(let P=0;P<3;P++)_[P]=Math.min(_[P],w[P]),x[P]=Math.max(x[P],w[P])}return new Pn(_,x)}}}class _s{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r){this._helper.resize(e,r)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=h.bg(),this._projectionMatrix=h.b0(),this._globeViewProjMatrix32f=h.a$(),this._globeViewProjMatrixNoCorrection=h.b0(),this._globeViewProjMatrixNoCorrectionInverted=h.b0(),this._globeProjMatrixInverted=h.b0(),this._cameraPosition=h.bh(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Oa({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._coveringTilesDetailsProvider=new Wu}clone(){const e=new _s;return e.apply(this),e}apply(e,r){this._globeLatitudeErrorCorrectionRadians=r||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=h.bh();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:r,applyGlobeMatrix:l}=e,u=this._helper.getMercatorTileCoordinates(r);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:u,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const r=this.pitchInRadians,l=this.cameraToCenterDistance/e,u=Math.sin(r)*l,p=Math.cos(r)*l+1,_=1/Math.sqrt(u*u+p*p)*1;let x=-u,w=p;const P=Math.sqrt(x*x+w*w);x/=P,w/=P;const A=[0,x,w];return h.bi(A,A,[0,0,0],-this.bearingInRadians),h.bj(A,A,[0,0,0],-1*this.center.lat*Math.PI/180),h.bk(A,A,[0,0,0],this.center.lng*Math.PI/180),h.aN(A,A,.25),[...A,.25*-_]}isLocationOccluded(e){return!this.isSurfacePointVisible(Cn(e))}transformLightDirection(e){const r=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,u=Math.cos(l),p=[Math.sin(r)*u,Math.sin(l),Math.cos(r)*u],_=[p[2],0,-p[0]],x=[0,0,0];h.aT(x,_,p),h.aS(_,_),h.aS(x,x);const w=[0,0,0];return h.aS(w,[_[0]*e[0]+x[0]*e[1]+p[0]*e[2],_[1]*e[0]+x[1]*e[1]+p[1]*e[2],_[2]*e[0]+x[2]*e[1]+p[2]*e[2]]),w}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,r,l){const u=function(x,w,P){const A=1/(1<<P.z);return new h.$(x/h.Z*A+P.x*A,w/h.Z*A+P.y*A)}(e,r,l.canonical),p=(_=u.y,[h.bf(u.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI]);var _;return this.getCircleRadiusCorrection()/Math.cos(p[1])}projectTileCoordinates(e,r,l,u){const p=l.canonical,_=Wi(e,r,p.x,p.y,p.z),x=1+(u?u(e,r):0)/h.bq,w=[_[0]*x,_[1]*x,_[2]*x,1];h.ao(w,w,this._globeViewProjMatrixNoCorrection);const P=this._cachedClippingPlane,A=P[0]*_[0]+P[1]*_[1]+P[2]*_[2]+P[3]<0;return{point:new h.P(w[0]/w[3],w[1]/w[3]),signedDistanceFromCamera:w[3],isOccluded:A}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=pn(this.worldSize,this.center.lat),r=h.b1(),l=h.b1();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),h.aX(r,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const u=this.centerOffset;r[8]=2*-u.x/this._helper._width,r[9]=2*u.y/this._helper._height,this._projectionMatrix=h.aY(r),this._globeProjMatrixInverted=h.b1(),h.ai(this._globeProjMatrixInverted,r),h.L(r,r,[0,0,-this.cameraToCenterDistance]),h.aZ(r,r,this.rollInRadians),h.a_(r,r,-this.pitchInRadians),h.aZ(r,r,this.bearingInRadians),h.L(r,r,[0,0,-e]);const p=h.bh();p[0]=e,p[1]=e,p[2]=e,h.a_(l,r,this.center.lat*Math.PI/180),h.bl(l,l,-this.center.lng*Math.PI/180),h.M(l,l,p),this._globeViewProjMatrixNoCorrection=l,h.a_(r,r,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bl(r,r,-this.center.lng*Math.PI/180),h.M(r,r,p),this._globeViewProjMatrix32f=new Float32Array(r),this._globeViewProjMatrixNoCorrectionInverted=h.b1(),h.ai(this._globeViewProjMatrixNoCorrectionInverted,l);const _=h.bh();this._cameraPosition=h.bh(),this._cameraPosition[2]=this.cameraToCenterDistance/e,h.bi(this._cameraPosition,this._cameraPosition,_,-this.rollInRadians),h.bj(this._cameraPosition,this._cameraPosition,_,this.pitchInRadians),h.bi(this._cameraPosition,this._cameraPosition,_,-this.bearingInRadians),h.aO(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bj(this._cameraPosition,this._cameraPosition,_,-this.center.lat*Math.PI/180),h.bk(this._cameraPosition,this._cameraPosition,_,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const x=h.aY(this._globeViewProjMatrixNoCorrectionInverted);h.M(x,x,[1,1,-1]),this._cachedFrustum=oi.fromInvProjectionMatrix(x)}calculateFogMatrix(e){h.w("calculateFogMatrix is not supported on globe projection.");const r=h.b1();return h.as(r),r}getVisibleUnwrappedCoordinates(e){return[new h.aV(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Cn(e);h.aN(l,l,1+r/h.bq);const u=h.bg();return h.ao(u,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),u[2]/u[3]}populateCache(e){}getBounds(){const e=.5*this.width,r=.5*this.height,l=[new h.P(0,0),new h.P(e,0),new h.P(this.width,0),new h.P(this.width,r),new h.P(this.width,this.height),new h.P(e,this.height),new h.P(0,this.height),new h.P(0,r)],u=[];for(const D of l)u.push(this.unprojectScreenPoint(D));let p=0,_=0,x=0,w=0;const P=this.center;for(const D of u){const O=h.bm(P.lng,D.lng),$=h.bm(P.lat,D.lat);O<_&&(_=O),O>p&&(p=O),$<w&&(w=$),$>x&&(x=$)}const A=[P.lng+_,P.lat+w,P.lng+p,P.lat+x];return this.isSurfacePointOnScreen([0,1,0])&&(A[3]=90,A[0]=-180,A[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(A[1]=-90,A[0]=-180,A[2]=180),new Ar(A)}getConstrained(e,r){const l=h.ad(e.lat,-85.051129,h.aI),u=h.ad(+r,this.minZoom+Xr(0,l),this.maxZoom);return{center:new h.Q(e.lng,l),zoom:u}}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){const l=Cn(this.unprojectScreenPoint(r)),u=Cn(e),p=h.bh();h.bn(p);const _=h.bh();h.bk(_,l,p,-this.center.lng*Math.PI/180),h.bj(_,_,p,this.center.lat*Math.PI/180);const x=u[0]*u[0]+u[2]*u[2],w=_[0]*_[0];if(x<w)return;const P=Math.sqrt(x-w),A=-P,D=h.bo(u[0],u[2],_[0],P),O=h.bo(u[0],u[2],_[0],A),$=h.bh();h.bk($,u,p,-D);const U=h.bo($[1],$[2],_[1],_[2]),Q=h.bh();h.bk(Q,u,p,-O);const Y=h.bo(Q[1],Q[2],_[1],_[2]),J=.5*Math.PI,re=U>=-J&&U<=J,le=Y>=-J&&Y<=J;let ue,de;if(re&&le){const we=this.center.lng*Math.PI/180,Fe=this.center.lat*Math.PI/180;h.br(D,we)+h.br(U,Fe)<h.br(O,we)+h.br(Y,Fe)?(ue=D,de=U):(ue=O,de=Y)}else if(re)ue=D,de=U;else{if(!le)return;ue=O,de=Y}const pe=ue/Math.PI*180,se=de/Math.PI*180,be=this.center.lat;this.setCenter(new h.Q(pe,h.ad(se,-90,90))),this.setZoom(this.zoom+Xr(be,this.center.lat))}locationToScreenPoint(e,r){const l=Cn(e);if(r){const u=r.getElevationForLngLatZoom(e,this._helper._tileZoom);h.aN(l,l,1+u/h.bq)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const r=h.bg();return h.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],new h.P((.5*r[0]+.5)*this.width,(.5*-r[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,r){if(r){const l=r.pointCoordinate(e);if(l)return l}return h.$.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,r){var l;return(l=this.screenPointToMercatorCoordinate(e,r))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,r){const l=this._cameraPosition,u=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,u)}getRayDirectionFromPixel(e){const r=h.bg();r[0]=e.x/this.width*2-1,r[1]=-1*(e.y/this.height*2-1),r[2]=1,r[3]=1,h.ao(r,r,this._globeViewProjMatrixNoCorrectionInverted),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3];const l=h.bh();l[0]=r[0]-this._cameraPosition[0],l[1]=r[1]-this._cameraPosition[1],l[2]=r[2]-this._cameraPosition[2];const u=h.bh();return h.aS(u,l),u}isSurfacePointVisible(e){const r=this._cachedClippingPlane;return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]+r[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const r=h.bg();return h.ao(r,[...e,1],this._globeViewProjMatrixNoCorrection),r[0]/=r[3],r[1]/=r[3],r[2]/=r[3],r[0]>-1&&r[0]<1&&r[1]>-1&&r[1]<1&&r[2]>-1&&r[2]<1}rayPlanetIntersection(e,r){const l=h.aU(e,r),u=h.bh(),p=h.bh();h.aN(p,r,l),h.aR(u,e,p);const _=1-h.aU(u,u);if(_<0)return null;const x=h.aU(e,e)-1,w=-l+(l<0?1:-1)*Math.sqrt(_),P=x/w,A=w;return{tMin:Math.min(P,A),tMax:Math.max(P,A)}}unprojectScreenPoint(e){const r=this._cameraPosition,l=this.getRayDirectionFromPixel(e),u=this.rayPlanetIntersection(r,l);if(u){const P=h.bh();h.aO(P,r,[l[0]*u.tMin,l[1]*u.tMin,l[2]*u.tMin]);const A=h.bh();return h.aS(A,P),Hs(A)}const p=this._cachedClippingPlane[0]*l[0]+this._cachedClippingPlane[1]*l[1]+this._cachedClippingPlane[2]*l[2],_=-h.bp(this._cachedClippingPlane,r)/p,x=h.bh();if(_>0)h.aO(x,r,[l[0]*_,l[1]*_,l[2]*_]);else{const P=h.bh();h.aO(P,r,[2*l[0],2*l[1],2*l[2]]);const A=h.bp(this._cachedClippingPlane,P);h.aR(x,P,[this._cachedClippingPlane[0]*A,this._cachedClippingPlane[1]*A,this._cachedClippingPlane[2]*A])}const w=h.bh();return h.aS(w,x),Hs(w)}getMatrixForModel(e,r){const l=h.Q.convert(e),u=1/h.bq,p=h.b0();return h.bl(p,p,l.lng/180*Math.PI),h.a_(p,p,-l.lat/180*Math.PI),h.L(p,p,[0,0,1+r/h.bq]),h.a_(p,p,.5*Math.PI),h.M(p,p,[u,u,u]),p}getProjectionDataForCustomLayer(e=!0){const r=this.getProjectionData({overscaledTileID:new h.Y(0,0,0,0,0),applyGlobeMatrix:e});return r.tileMercatorCoords=[0,0,1,1],r}getFastPathSimpleProjectionMatrix(e){}}class la{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,r,l){return this._helper.interpolatePadding(e,r,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,r,l=!0){this._helper.resize(e,r,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,r){this._helper.overrideNearFarZ(e,r)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,r){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=r,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Oa({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,r)=>this.getConstrained(e,r)}),this._globeness=1,this._mercatorTransform=new Zn,this._verticalPerspectiveTransform=new _s}clone(){const e=new la;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const r=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:r.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:r.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return h.bb(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.bb(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,r,l){const u=this._mercatorTransform.getPitchedTextCorrection(e,r,l),p=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,r,l);return h.bb(u,p,this._globeness)}projectTileCoordinates(e,r,l,u){return this.currentTransform.projectTileCoordinates(e,r,l,u)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,r){return this.currentTransform.lngLatToCameraDepth(e,r)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,r){return this.currentTransform.getConstrained(e,r)}calculateCenterFromCameraLngLatAlt(e,r,l,u){return this._helper.calculateCenterFromCameraLngLatAlt(e,r,l,u)}setLocationAtPoint(e,r){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,r),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,r),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,r){return this.currentTransform.locationToScreenPoint(e,r)}screenPointToMercatorCoordinate(e,r){return this.currentTransform.screenPointToMercatorCoordinate(e,r)}screenPointToLocation(e,r){return this.currentTransform.screenPointToLocation(e,r)}isPointOnMapSurface(e,r){return this.currentTransform.isPointOnMapSurface(e,r)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,r){return this.currentTransform.getMatrixForModel(e,r)}getProjectionDataForCustomLayer(e=!0){const r=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return r;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=r.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class Rn{get useGlobeControls(){return!0}handlePanInertia(e,r){const l=Zl(e,r);return Math.abs(l.lng-r.center.lng)>180&&(l.lng=r.center.lng+179.5*Math.sign(l.lng-r.center.lng)),{easingCenter:l,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,r){const l=e.around,u=r.screenPointToLocation(l);e.bearingDelta&&r.setBearing(r.bearing+e.bearingDelta),e.pitchDelta&&r.setPitch(r.pitch+e.pitchDelta),e.rollDelta&&r.setRoll(r.roll+e.rollDelta);const p=r.zoom;e.zoomDelta&&r.setZoom(r.zoom+e.zoomDelta);const _=r.zoom-p;if(_===0)return;const x=h.bm(r.center.lng,u.lng),w=x/(Math.abs(x/180)+1),P=h.bm(r.center.lat,u.lat),A=r.getRayDirectionFromPixel(l),D=r.cameraPosition,O=-1*h.aU(D,A),$=h.bh();h.aO($,D,[A[0]*O,A[1]*O,A[2]*O]);const U=h.bs($)-1,Q=Math.exp(.5*-Math.max(U-.3,0)),Y=pn(r.worldSize,r.center.lat)/Math.min(r.width,r.height),J=h.be(Y,.9,.5,1,.25),re=(1-h.aH(-_))*Math.min(Q,J),le=r.center.lat,ue=r.zoom,de=new h.Q(r.center.lng+w*re,h.ad(r.center.lat+P*re,-85.051129,h.aI));r.setLocationAtPoint(u,l);const pe=r.center,se=h.be(Math.abs(x),45,85,0,1),be=h.be(Y,.75,.35,0,1),we=Math.pow(Math.max(se,be),.25),Fe=h.bm(pe.lng,de.lng),je=h.bm(pe.lat,de.lat);r.setCenter(new h.Q(pe.lng+Fe*we,pe.lat+je*we).wrap()),r.setZoom(ue+Xr(le,r.center.lat))}handleMapControlsPan(e,r,l){if(!e.panDelta)return;const u=r.center.lat,p=r.zoom;r.setCenter(Zl(e.panDelta,r).wrap()),r.setZoom(p+Xr(u,r.center.lat))}cameraForBoxAndBearing(e,r,l,u,p){const _=Zu(e,r,l,u,p),x=r.left/p.width*2-1,w=(p.width-r.right)/p.width*2-1,P=r.top/p.height*-2+1,A=(p.height-r.bottom)/p.height*-2+1,D=h.bm(l.getWest(),l.getEast())<0,O=D?l.getEast():l.getWest(),$=D?l.getWest():l.getEast(),U=Math.max(l.getNorth(),l.getSouth()),Q=Math.min(l.getNorth(),l.getSouth()),Y=O+.5*h.bm(O,$),J=U+.5*h.bm(U,Q),re=p.clone();re.setCenter(_.center),re.setBearing(_.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(_.zoom);const le=re.modelViewProjectionMatrix,ue=[Cn(l.getNorthWest()),Cn(l.getNorthEast()),Cn(l.getSouthWest()),Cn(l.getSouthEast()),Cn(new h.Q($,J)),Cn(new h.Q(O,J)),Cn(new h.Q(Y,U)),Cn(new h.Q(Y,Q))],de=Cn(_.center);let pe=Number.POSITIVE_INFINITY;for(const se of ue)x<0&&(pe=Rn.getLesserNonNegativeNonNull(pe,Rn.solveVectorScale(se,de,le,"x",x))),w>0&&(pe=Rn.getLesserNonNegativeNonNull(pe,Rn.solveVectorScale(se,de,le,"x",w))),P>0&&(pe=Rn.getLesserNonNegativeNonNull(pe,Rn.solveVectorScale(se,de,le,"y",P))),A<0&&(pe=Rn.getLesserNonNegativeNonNull(pe,Rn.solveVectorScale(se,de,le,"y",A)));if(Number.isFinite(pe)&&pe!==0)return _.zoom=re.zoom+h.aa(pe),_;jo()}handleJumpToCenterZoom(e,r){const l=e.center.lat,u=e.getConstrained(r.center?h.Q.convert(r.center):e.center,e.zoom).center;e.setCenter(u.wrap());const p=r.zoom!==void 0?+r.zoom:e.zoom+Xr(l,u.lat);e.zoom!==p&&e.setZoom(p)}handleEaseTo(e,r){const l=e.zoom,u=e.center,p=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},x={roll:r.roll===void 0?e.roll:r.roll,pitch:r.pitch===void 0?e.pitch:r.pitch,bearing:r.bearing===void 0?e.bearing:r.bearing},w=r.zoom!==void 0,P=!e.isPaddingEqual(r.padding);let A=!1;const D=r.center?h.Q.convert(r.center):u,O=e.getConstrained(D,l).center;$n(e,O);const $=e.clone();$.setCenter(O),$.setZoom(w?+r.zoom:l+Xr(u.lat,D.lat)),$.setBearing(r.bearing);const U=new h.P(h.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),h.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));$.setLocationAtPoint(O,U);const Q=(r.offset&&r.offsetAsPoint.mag())>0?$.center:O,Y=w?+r.zoom:l+Xr(u.lat,Q.lat),J=l+Xr(u.lat,0),re=Y+Xr(Q.lat,0),le=h.bm(u.lng,Q.lng),ue=h.bm(u.lat,Q.lat),de=h.aH(re-J);return A=Y!==l,{easeFunc:pe=>{if(h.b5(_,x)||dn({startEulerAngles:_,endEulerAngles:x,tr:e,k:pe,useSlerp:_.roll!=x.roll}),P&&e.interpolatePadding(p,r.padding,pe),r.around)h.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(r.around,r.aroundPoint);else{const se=re>J?Math.min(2,de):Math.max(.5,de),be=Math.pow(se,1-pe),we=Hi(u,le,ue,pe*be);e.setCenter(we.wrap())}if(A){const se=h.B.number(J,re,pe)+Xr(0,e.center.lat);e.setZoom(se)}},isZooming:A,elevationCenter:Q}}handleFlyTo(e,r){const l=r.zoom!==void 0,u=e.center,p=e.zoom,_=e.padding,x=!e.isPaddingEqual(r.padding),w=e.getConstrained(h.Q.convert(r.center||r.locationAtOffset),p).center,P=l?+r.zoom:e.zoom+Xr(e.center.lat,w.lat),A=e.clone();A.setCenter(w),A.setZoom(P),A.setBearing(r.bearing);const D=new h.P(h.ad(e.centerPoint.x+r.offsetAsPoint.x,0,e.width),h.ad(e.centerPoint.y+r.offsetAsPoint.y,0,e.height));A.setLocationAtPoint(w,D);const O=A.center;$n(e,O);const $=function(ue,de,pe){const se=Cn(de),be=Cn(pe),we=h.aU(se,be),Fe=Math.acos(we),je=Ul(ue);return Fe/(2*Math.PI)*je}(e,u,O),U=p+Xr(u.lat,0),Q=P+Xr(O.lat,0),Y=h.aH(Q-U);let J;if(typeof r.minZoom=="number"){const ue=+r.minZoom+Xr(O.lat,0),de=Math.min(ue,U,Q)+Xr(0,O.lat),pe=e.getConstrained(O,de).zoom+Xr(O.lat,0);J=h.aH(pe-U)}const re=h.bm(u.lng,O.lng),le=h.bm(u.lat,O.lat);return{easeFunc:(ue,de,pe,se)=>{const be=Hi(u,re,le,pe);x&&e.interpolatePadding(_,r.padding,ue);const we=ue===1?O:be;e.setCenter(we.wrap());const Fe=U+h.aa(de);e.setZoom(ue===1?P:Fe+Xr(0,we.lat))},scaleOfZoom:Y,targetCenter:O,scaleOfMinZoom:J,pixelPathLength:$}}static solveVectorScale(e,r,l,u,p){const _=u==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],x=[l[3],l[7],l[11],l[15]],w=e[0]*_[0]+e[1]*_[1]+e[2]*_[2],P=e[0]*x[0]+e[1]*x[1]+e[2]*x[2],A=r[0]*_[0]+r[1]*_[1]+r[2]*_[2],D=r[0]*x[0]+r[1]*x[1]+r[2]*x[2];return A+p*P===w+p*D||x[3]*(w-A)+_[3]*(D-P)+w*D==A*P?null:(A+_[3]-p*D-p*x[3])/(A-w-p*D+p*P)}static getLesserNonNegativeNonNull(e,r){return r!==null&&r>=0&&r<e?r:e}}class Xs{constructor(e){this._globe=e,this._mercatorCameraHelper=new qi,this._verticalPerspectiveCameraHelper=new Rn}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,r){return this.currentHelper.handlePanInertia(e,r)}handleMapControlsRollPitchBearingZoom(e,r){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,r)}handleMapControlsPan(e,r,l){this.currentHelper.handleMapControlsPan(e,r,l)}cameraForBoxAndBearing(e,r,l,u,p){return this.currentHelper.cameraForBoxAndBearing(e,r,l,u,p)}handleJumpToCenterZoom(e,r){this.currentHelper.handleJumpToCenterZoom(e,r)}handleEaseTo(e,r){return this.currentHelper.handleEaseTo(e,r)}handleFlyTo(e,r){return this.currentHelper.handleFlyTo(e,r)}}const ja=(d,e)=>h.x(d,e&&e.filter(r=>r.identifier!=="source.canvas")),Hu=h.bt();class Ks extends h.E{constructor(e,r={}){super(),this._rtlPluginLoaded=()=>{for(const l in this.sourceCaches){const u=this.sourceCaches[l].getSource().type;u!=="vector"&&u!=="geojson"||this.sourceCaches[l].reload()}},this.map=e,this.dispatcher=new xt(st(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(l,u)=>this.getGlyphs(l,u)),this.dispatcher.registerMessageHandler("GI",(l,u)=>this.getImages(l,u)),this.imageManager=new rr,this.imageManager.setEventedParent(this),this.glyphManager=new Tt(e._requestManager,r.localIdeographFontFamily),this.lineAtlas=new rt(256,512),this.crossTileSymbolIndex=new fs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bu,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.bv()),ni().on(wo,this._rtlPluginLoaded),this.on("data",l=>{if(l.dataType!=="source"||l.sourceDataType!=="metadata")return;const u=this.sourceCaches[l.sourceId];if(!u)return;const p=u.getSource();if(p&&p.vectorLayerIds)for(const _ in this._layers){const x=this._layers[_];x.source===p.id&&this._validateLayer(x)}})}loadURL(e,r={},l){this.fire(new h.l("dataloading",{dataType:"style"})),r.validate=typeof r.validate!="boolean"||r.validate;const u=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const p=this._loadStyleRequest;h.j(u,this._loadStyleRequest).then(_=>{this._loadStyleRequest=null,this._load(_.data,r,l)}).catch(_=>{this._loadStyleRequest=null,_&&!p.signal.aborted&&this.fire(new h.k(_))})}loadJSON(e,r={},l){this.fire(new h.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ze.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,r.validate=r.validate!==!1,this._load(e,r,l)}).catch(()=>{})}loadEmpty(){this.fire(new h.l("dataloading",{dataType:"style"})),this._load(Hu,{validate:!1})}_load(e,r,l){var u,p;const _=r.transformStyle?r.transformStyle(l,e):e;if(!r.validate||!ja(this,h.y(_))){this._loaded=!0,this.stylesheet=_;for(const x in _.sources)this.addSource(x,_.sources[x],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new _t(this.stylesheet.light),this._setProjectionInternal(((u=this.stylesheet.projection)===null||u===void 0?void 0:u.type)||"mercator"),this.sky=new et(this.stylesheet.sky),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new h.l("data",{dataType:"style"})),this.fire(new h.l("style.load"))}}_createLayers(){const e=h.bw(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(r=>r.id),this._layers={},this._serializedLayers=null;for(const r of e){const l=h.bx(r);l.setEventedParent(this,{layer:{id:r.id}}),this._layers[r.id]=l}}_loadSprite(e,r=!1,l=void 0){let u;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(p,_,x,w){return h._(this,void 0,void 0,function*(){const P=Je(p),A=x>1?"@2x":"",D={},O={};for(const{id:$,url:U}of P){const Q=_.transformRequest(pt(U,A,".json"),"SpriteJSON");D[$]=h.j(Q,w);const Y=_.transformRequest(pt(U,A,".png"),"SpriteImage");O[$]=Mt.getImage(Y,w)}return yield Promise.all([...Object.values(D),...Object.values(O)]),function($,U){return h._(this,void 0,void 0,function*(){const Q={};for(const Y in $){Q[Y]={};const J=ze.getImageCanvasContext((yield U[Y]).data),re=(yield $[Y]).data;for(const le in re){const{width:ue,height:de,x:pe,y:se,sdf:be,pixelRatio:we,stretchX:Fe,stretchY:je,content:Oe,textFitWidth:lt,textFitHeight:Qe}=re[le];Q[Y][le]={data:null,pixelRatio:we,sdf:be,stretchX:Fe,stretchY:je,content:Oe,textFitWidth:lt,textFitHeight:Qe,spriteData:{width:ue,height:de,x:pe,y:se,context:J}}}}return Q})}(D,O)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(p=>{if(this._spriteRequest=null,p)for(const _ in p){this._spritesImagesIds[_]=[];const x=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter(w=>!(w in p)):[];for(const w of x)this.imageManager.removeImage(w),this._changedImages[w]=!0;for(const w in p[_]){const P=_==="default"?w:`${_}:${w}`;this._spritesImagesIds[_].push(P),P in this.imageManager.images?this.imageManager.updateImage(P,p[_][w],!1):this.imageManager.addImage(P,p[_][w]),r&&(this._changedImages[P]=!0)}}}).catch(p=>{this._spriteRequest=null,u=p,this.fire(new h.k(u))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"})),l&&l(u)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}_validateLayer(e){const r=this.sourceCaches[e.source];if(!r)return;const l=e.sourceLayer;if(!l)return;const u=r.getSource();(u.type==="geojson"||u.vectorLayerIds&&u.vectorLayerIds.indexOf(l)===-1)&&this.fire(new h.k(new Error(`Source layer "${l}" does not exist on source "${u.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,r=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(r?h.by(l):l);const u=[];for(const p of e)if(l[p]){const _=r?h.by(l[p]):l[p];u.push(_)}return u}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const r=Object.keys(this._layers);for(const l of r){const u=this._layers[l];u.type!=="custom"&&(e[l]=u.serialize())}return e}hasTransitions(){var e,r,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((r=this.sky)===null||r===void 0)&&r.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const u in this.sourceCaches)if(this.sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const r=this._changed;if(r){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const _ in this._updatedSources){const x=this._updatedSources[_];if(x==="reload")this._reloadSource(_);else{if(x!=="clear")throw new Error(`Invalid action ${x}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const u in this.sourceCaches){const p=this.sourceCaches[u];l[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];p.recalculate(e,this._availableImages),!p.isHidden(e.zoom)&&p.source&&(this.sourceCaches[p.source].used=!0)}for(const u in l){const p=this.sourceCaches[u];!!l[u]!=!!p.used&&p.fire(new h.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:u}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,r&&this.fire(new h.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:r})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,r={}){var l;this._checkLoaded();const u=this.serialize();if(e=r.transformStyle?r.transformStyle(u,e):e,((l=r.validate)===null||l===void 0||l)&&ja(this,h.y(e)))return!1;(e=h.by(e)).layers=h.bw(e.layers);const p=h.bz(u,e),_=this._getOperationsToPerform(p);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const x of _.operations)x();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const r=[],l=[];for(const u of e)switch(u.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":r.push(()=>this.addLayer.apply(this,u.args));break;case"removeLayer":r.push(()=>this.removeLayer.apply(this,u.args));break;case"setPaintProperty":r.push(()=>this.setPaintProperty.apply(this,u.args));break;case"setLayoutProperty":r.push(()=>this.setLayoutProperty.apply(this,u.args));break;case"setFilter":r.push(()=>this.setFilter.apply(this,u.args));break;case"addSource":r.push(()=>this.addSource.apply(this,u.args));break;case"removeSource":r.push(()=>this.removeSource.apply(this,u.args));break;case"setLayerZoomRange":r.push(()=>this.setLayerZoomRange.apply(this,u.args));break;case"setLight":r.push(()=>this.setLight.apply(this,u.args));break;case"setGeoJSONSourceData":r.push(()=>this.setGeoJSONSourceData.apply(this,u.args));break;case"setGlyphs":r.push(()=>this.setGlyphs.apply(this,u.args));break;case"setSprite":r.push(()=>this.setSprite.apply(this,u.args));break;case"setTerrain":r.push(()=>this.map.setTerrain.apply(this,u.args));break;case"setSky":r.push(()=>this.setSky.apply(this,u.args));break;case"setProjection":this.setProjection.apply(this,u.args);break;case"setTransition":r.push(()=>{});break;default:l.push(u.command)}return{operations:r,unimplemented:l}}addImage(e,r){if(this.getImage(e))return this.fire(new h.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,r),this._afterImageUpdated(e)}updateImage(e,r){this.imageManager.updateImage(e,r)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new h.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,r,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(h.y.source,`sources.${e}`,r,null,l))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=this.sourceCaches[e]=new R(e,r,this.dispatcher);u.style=this,u.setEventedParent(this,()=>({isSourceLoaded:u.loaded(),source:u.serialize(),sourceId:e})),u.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new h.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const r=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],r.fire(new h.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),r.setEventedParent(null),r.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,r){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(r),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,r,l={}){this._checkLoaded();const u=e.id;if(this.getLayer(u))return void this.fire(new h.k(new Error(`Layer "${u}" already exists on this map.`)));let p;if(e.type==="custom"){if(ja(this,h.bA(e)))return;p=h.bx(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(u,e.source),e=h.by(e),e=h.e(e,{source:u})),this._validate(h.y.layer,`layers.${u}`,e,{arrayIndex:-1},l))return;p=h.bx(e),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}})}const _=r?this._order.indexOf(r):this._order.length;if(r&&_===-1)this.fire(new h.k(new Error(`Cannot add layer "${u}" before non-existing layer "${r}".`)));else{if(this._order.splice(_,0,u),this._layerOrderChanged=!0,this._layers[u]=p,this._removedLayers[u]&&p.source&&p.type!=="custom"){const x=this._removedLayers[u];delete this._removedLayers[u],x.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",this.sourceCaches[p.source].pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map)}}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new h.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const l=this._order.indexOf(e);this._order.splice(l,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new h.k(new Error(`Cannot move layer "${e}" before non-existing layer "${r}".`))):(this._order.splice(u,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const r=this._layers[e];if(!r)return void this.fire(new h.k(new Error(`Cannot remove non-existing layer "${e}".`)));r.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],r.onRemove&&r.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,r,l){this._checkLoaded();const u=this.getLayer(e);u?u.minzoom===r&&u.maxzoom===l||(r!=null&&(u.minzoom=r),l!=null&&(u.maxzoom=l),this._updateLayer(u)):this.fire(new h.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,r,l={}){this._checkLoaded();const u=this.getLayer(e);if(u){if(!h.bB(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(h.y.filter,`layers.${u.id}.filter`,r,null,l)||(u.filter=h.by(r),this._updateLayer(u)))}else this.fire(new h.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return h.by(this.getLayer(e).filter)}setLayoutProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?h.bB(p.getLayoutProperty(r),l)||(p.setLayoutProperty(r,l,u),this._updateLayer(p)):this.fire(new h.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,r){const l=this.getLayer(e);if(l)return l.getLayoutProperty(r);this.fire(new h.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,r,l,u={}){this._checkLoaded();const p=this.getLayer(e);p?h.bB(p.getPaintProperty(r),l)||(p.setPaintProperty(r,l,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new h.k(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,r){return this.getLayer(e).getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const l=e.source,u=e.sourceLayer,p=this.sourceCaches[l];if(p===void 0)return void this.fire(new h.k(new Error(`The source '${l}' does not exist in the map's style.`)));const _=p.getSource().type;_==="geojson"&&u?this.fire(new h.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||u?(e.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),p.setFeatureState(u,e.id,r)):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,r){this._checkLoaded();const l=e.source,u=this.sourceCaches[l];if(u===void 0)return void this.fire(new h.k(new Error(`The source '${l}' does not exist in the map's style.`)));const p=u.getSource().type,_=p==="vector"?e.sourceLayer:void 0;p!=="vector"||_?r&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new h.k(new Error("A feature id is required to remove its specific state property."))):u.removeFeatureState(_,e.id,r):this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const r=e.source,l=e.sourceLayer,u=this.sourceCaches[r];if(u!==void 0)return u.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new h.k(new Error("The feature id parameter must be provided."))),u.getFeatureState(l,e.id)):void this.fire(new h.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.k(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=h.bC(this.sourceCaches,p=>p.serialize()),r=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,u=this.stylesheet;return h.bD({version:u.version,name:u.name,metadata:u.metadata,light:u.light,sky:u.sky,center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,sprite:u.sprite,glyphs:u.glyphs,transition:u.transition,projection:u.projection,sources:e,layers:r,terrain:l},p=>p!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const r=_=>this._layers[_].type==="fill-extrusion",l={},u=[];for(let _=this._order.length-1;_>=0;_--){const x=this._order[_];if(r(x)){l[x]=_;for(const w of e){const P=w[x];if(P)for(const A of P)u.push(A)}}}u.sort((_,x)=>x.intersectionZ-_.intersectionZ);const p=[];for(let _=this._order.length-1;_>=0;_--){const x=this._order[_];if(r(x))for(let w=u.length-1;w>=0;w--){const P=u[w].feature;if(l[P.layer.id]<_)break;p.push(P),u.pop()}else for(const w of e){const P=w[x];if(P)for(const A of P)p.push(A.feature)}}return p}queryRenderedFeatures(e,r,l){r&&r.filter&&this._validate(h.y.filter,"queryRenderedFeatures.filter",r.filter,null,r);const u={};if(r&&r.layers){if(!(Array.isArray(r.layers)||r.layers instanceof Set))return this.fire(new h.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const P of r.layers){const A=this._layers[P];if(!A)return this.fire(new h.k(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];u[A.source]=!0}}const p=[];r.availableImages=this._availableImages;const _=this._serializedAllLayers(),x=r.layers instanceof Set?r.layers:Array.isArray(r.layers)?new Set(r.layers):null,w=Object.assign(Object.assign({},r),{layers:x});for(const P in this.sourceCaches)r.layers&&!u[P]||p.push(lr(this.sourceCaches[P],this._layers,_,e,w,l));return this.placement&&p.push(function(P,A,D,O,$,U,Q){const Y={},J=U.queryRenderedSymbols(O),re=[];for(const le of Object.keys(J).map(Number))re.push(Q[le]);re.sort(or);for(const le of re){const ue=le.featureIndex.lookupSymbolFeatures(J[le.bucketInstanceId],A,le.bucketIndex,le.sourceLayerIndex,$.filter,$.layers,$.availableImages,P);for(const de in ue){const pe=Y[de]=Y[de]||[],se=ue[de];se.sort((be,we)=>{const Fe=le.featureSortOrder;if(Fe){const je=Fe.indexOf(be.featureIndex);return Fe.indexOf(we.featureIndex)-je}return we.featureIndex-be.featureIndex});for(const be of se)pe.push(be)}}return function(le,ue,de){for(const pe in le)for(const se of le[pe])Mr(se,de[ue[pe].source]);return le}(Y,P,D)}(this._layers,_,this.sourceCaches,e,w,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(e,r){r&&r.filter&&this._validate(h.y.filter,"querySourceFeatures.filter",r.filter,null,r);const l=this.sourceCaches[e];return l?function(u,p){const _=u.getRenderableIds().map(P=>u.getTileByID(P)),x=[],w={};for(let P=0;P<_.length;P++){const A=_[P],D=A.tileID.canonical.key;w[D]||(w[D]=!0,A.querySourceFeatures(x,p))}return x}(l,r):[]}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const l=this.light.getLight();let u=!1;for(const _ in e)if(!h.bB(e[_],l[_])){u=!0;break}if(!u)return;const p={now:ze.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,r),this.light.updateTransitions(p)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,r={}){this._checkLoaded();const l=this.getSky();let u=!1;if(!e&&!l)return;if(e&&!l)u=!0;else if(!e&&l)u=!0;else for(const _ in e)if(!h.bB(e[_],l[_])){u=!0;break}if(!u)return;const p={now:ze.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,r),this.sky.updateTransitions(p)}_setProjectionInternal(e){const r=function(l){if(Array.isArray(l)){const u=new gs({type:l});return{projection:u,transform:new la,cameraHelper:new Xs(u)}}switch(l){case"mercator":return{projection:new qs,transform:new Zn,cameraHelper:new qi};case"globe":{const u=new gs({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:u,transform:new la,cameraHelper:new Xs(u)}}case"vertical-perspective":return{projection:new aa,transform:new _s,cameraHelper:new Rn};default:return h.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new qs,transform:new Zn,cameraHelper:new qi}}}(e);this.projection=r.projection,this.map.migrateProjection(r.transform,r.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,r,l,u,p={}){return(!p||p.validate!==!1)&&ja(this,e.call(h.y,h.e({key:r,style:this.serialize(),value:l,styleSpec:h.v},u)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ni().off(wo,this._rtlPluginLoaded);for(const r in this._layers)this._layers[r].setEventedParent(null);for(const r in this.sourceCaches){const l=this.sourceCaches[r];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const r in this.sourceCaches)this.sourceCaches[r].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,r,l,u,p=!1){let _=!1,x=!1;const w={};for(const P of this._order){const A=this._layers[P];if(A.type!=="symbol")continue;if(!w[A.source]){const O=this.sourceCaches[A.source];w[A.source]=O.getRenderableIds(!0).map($=>O.getTileByID($)).sort(($,U)=>U.tileID.overscaledZ-$.tileID.overscaledZ||($.tileID.isLessThan(U.tileID)?-1:1))}const D=this.crossTileSymbolIndex.addLayer(A,w[A.source],e.center.lng);_=_||D}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((p=p||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ze.now(),e.zoom))&&(this.pauseablePlacement=new Uu(e,this.map.terrain,this._order,p,r,l,u,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,w),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ze.now()),x=!0),_&&this.pauseablePlacement.placement.setStale()),x||_)for(const P of this._order){const A=this._layers[P];A.type==="symbol"&&this.placement.updateLayerOpacities(A,w[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ze.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r){return h._(this,void 0,void 0,function*(){const l=yield this.imageManager.getImages(r.icons);this._updateTilesForChangedImages();const u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,r.icons),l})}getGlyphs(e,r){return h._(this,void 0,void 0,function*(){const l=yield this.glyphManager.getGlyphs(r.stacks),u=this.sourceCaches[r.source];return u&&u.setDependencies(r.tileID.key,r.type,[""]),l})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,r={}){this._checkLoaded(),e&&this._validate(h.y.glyphs,"glyphs",e,null,r)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,r,l={},u){this._checkLoaded();const p=[{id:e,url:r}],_=[...Je(this.stylesheet.sprite),...p];this._validate(h.y.sprite,"sprite",_,null,l)||(this.stylesheet.sprite=_,this._loadSprite(p,!0,u))}removeSprite(e){this._checkLoaded();const r=Je(this.stylesheet.sprite);if(r.find(l=>l.id===e)){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;r.splice(r.findIndex(l=>l.id===e),1),this.stylesheet.sprite=r.length>0?r:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.l("data",{dataType:"style"}))}else this.fire(new h.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Je(this.stylesheet.sprite)}setSprite(e,r={},l){this._checkLoaded(),e&&this._validate(h.y.sprite,"sprite",e,null,r)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Xi=h.aC([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Uh{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,r,l,u,p,_,x,w,P){this.context=e;let A=this.boundPaintVertexBuffers.length!==u.length;for(let D=0;!A&&D<u.length;D++)this.boundPaintVertexBuffers[D]!==u[D]&&(A=!0);!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==l||A||this.boundIndexBuffer!==p||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==x||this.boundDynamicVertexBuffer2!==w||this.boundDynamicVertexBuffer3!==P?this.freshBind(r,l,u,p,_,x,w,P):(e.bindVertexArray.set(this.vao),x&&x.bind(),p&&p.dynamicDraw&&p.bind(),w&&w.bind(),P&&P.bind())}freshBind(e,r,l,u,p,_,x,w){const P=e.numAttributes,A=this.context,D=A.gl;this.vao&&this.destroy(),this.vao=A.createVertexArray(),A.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=x,this.boundDynamicVertexBuffer3=w,r.enableAttributes(D,e);for(const O of l)O.enableAttributes(D,e);_&&_.enableAttributes(D,e),x&&x.enableAttributes(D,e),w&&w.enableAttributes(D,e),r.bind(),r.setVertexAttribPointers(D,e,p);for(const O of l)O.bind(),O.setVertexAttribPointers(D,e,p);_&&(_.bind(),_.setVertexAttribPointers(D,e,p)),u&&u.bind(),x&&(x.bind(),x.setVertexAttribPointers(D,e,p)),w&&(w.bind(),w.setVertexAttribPointers(D,e,p)),A.currentNumAttributes=P}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Xu=(d,e,r,l,u)=>({u_texture:0,u_ele_delta:d,u_fog_matrix:e,u_fog_color:r?r.properties.get("fog-color"):h.b6.white,u_fog_ground_blend:r?r.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?0:r?r.calculateFogBlendOpacity(l):0,u_horizon_color:r?r.properties.get("horizon-color"):h.b6.white,u_horizon_fog_blend:r?r.properties.get("horizon-fog-blend"):1,u_is_globe_mode:u?1:0}),Ys={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ua(d){const e=[];for(let r=0;r<d.length;r++){if(d[r]===null)continue;const l=d[r].split(" ");e.push(l.pop())}return e}class Zh{constructor(e,r,l,u,p,_,x,w){const P=e.gl;this.program=P.createProgram();const A=ua(r.staticAttributes),D=l?l.getBinderAttributes():[],O=A.concat(D),$=lo.prelude.staticUniforms?ua(lo.prelude.staticUniforms):[],U=x.staticUniforms?ua(x.staticUniforms):[],Q=r.staticUniforms?ua(r.staticUniforms):[],Y=l?l.getBinderUniforms():[],J=$.concat(U).concat(Q).concat(Y),re=[];for(const we of J)re.indexOf(we)<0&&re.push(we);const le=l?l.defines():[];Gn(P)&&le.unshift("#version 300 es"),p&&le.push("#define OVERDRAW_INSPECTOR;"),_&&le.push("#define TERRAIN3D;"),w&&le.push(w);let ue=le.concat(lo.prelude.fragmentSource,x.fragmentSource,r.fragmentSource).join(`
`),de=le.concat(lo.prelude.vertexSource,x.vertexSource,r.vertexSource).join(`
`);Gn(P)||(ue=function(we){return we.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ue),de=function(we){return we.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(de));const pe=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);if(P.shaderSource(pe,ue),P.compileShader(pe),!P.getShaderParameter(pe,P.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${P.getShaderInfoLog(pe)}`);P.attachShader(this.program,pe);const se=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);if(P.shaderSource(se,de),P.compileShader(se),!P.getShaderParameter(se,P.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${P.getShaderInfoLog(se)}`);P.attachShader(this.program,se),this.attributes={};const be={};this.numAttributes=O.length;for(let we=0;we<this.numAttributes;we++)O[we]&&(P.bindAttribLocation(this.program,we,O[we]),this.attributes[O[we]]=we);if(P.linkProgram(this.program),!P.getProgramParameter(this.program,P.LINK_STATUS))throw new Error(`Program failed to link: ${P.getProgramInfoLog(this.program)}`);P.deleteShader(se),P.deleteShader(pe);for(let we=0;we<re.length;we++){const Fe=re[we];if(Fe&&!be[Fe]){const je=P.getUniformLocation(this.program,Fe);je&&(be[Fe]=je)}}this.fixedUniforms=u(e,be),this.terrainUniforms=((we,Fe)=>({u_depth:new h.bE(we,Fe.u_depth),u_terrain:new h.bE(we,Fe.u_terrain),u_terrain_dim:new h.b7(we,Fe.u_terrain_dim),u_terrain_matrix:new h.bG(we,Fe.u_terrain_matrix),u_terrain_unpack:new h.bH(we,Fe.u_terrain_unpack),u_terrain_exaggeration:new h.b7(we,Fe.u_terrain_exaggeration)}))(e,be),this.projectionUniforms=((we,Fe)=>({u_projection_matrix:new h.bG(we,Fe.u_projection_matrix),u_projection_tile_mercator_coords:new h.bH(we,Fe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bH(we,Fe.u_projection_clipping_plane),u_projection_transition:new h.b7(we,Fe.u_projection_transition),u_projection_fallback_matrix:new h.bG(we,Fe.u_projection_fallback_matrix)}))(e,be),this.binderUniforms=l?l.getUniforms(e,be):[]}draw(e,r,l,u,p,_,x,w,P,A,D,O,$,U,Q,Y,J,re,le){const ue=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(u),e.setColorMode(p),e.setCullFace(_),w){e.activeTexture.set(ue.TEXTURE2),ue.bindTexture(ue.TEXTURE_2D,w.depthTexture),e.activeTexture.set(ue.TEXTURE3),ue.bindTexture(ue.TEXTURE_2D,w.texture);for(const pe in this.terrainUniforms)this.terrainUniforms[pe].set(w[pe])}if(P)for(const pe in P)this.projectionUniforms[Ys[pe]].set(P[pe]);if(x)for(const pe in this.fixedUniforms)this.fixedUniforms[pe].set(x[pe]);Y&&Y.setUniforms(e,this.binderUniforms,U,{zoom:Q});let de=0;switch(r){case ue.LINES:de=2;break;case ue.TRIANGLES:de=3;break;case ue.LINE_STRIP:de=1}for(const pe of $.get()){const se=pe.vaos||(pe.vaos={});(se[A]||(se[A]=new Uh)).bind(e,this,D,Y?Y.getPaintVertexBuffers():[],O,pe.vertexOffset,J,re,le),ue.drawElements(r,pe.primitiveLength*de,ue.UNSIGNED_SHORT,pe.primitiveOffset*de*2)}}}function ys(d,e,r){const l=1/h.av(r,1,e.transform.tileZoom),u=Math.pow(2,r.tileID.overscaledZ),p=r.tileSize*Math.pow(2,e.transform.tileZoom)/u,_=p*(r.tileID.canonical.x+r.tileID.wrap*u),x=p*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[l,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[_>>16,x>>16],u_pixel_coord_lower:[65535&_,65535&x]}}const Uc=(d,e,r,l)=>{const u=d.style.light,p=u.properties.get("position"),_=[p.x,p.y,p.z],x=h.bK();u.properties.get("anchor")==="viewport"&&h.bL(x,d.transform.bearingInRadians),h.bM(_,_,x);const w=d.transform.transformLightDirection(_),P=u.properties.get("color");return{u_lightpos:_,u_lightpos_globe:w,u_lightintensity:u.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+e,u_opacity:r,u_fill_translate:l}},vs=(d,e,r,l,u,p,_)=>h.e(Uc(d,e,r,l),ys(p,d,_),{u_height_factor:-Math.pow(2,u.overscaledZ)/_.tileSize/8}),Zc=(d,e,r,l)=>h.e(ys(e,d,r),{u_fill_translate:l}),Gc=(d,e)=>({u_world:d,u_fill_translate:e}),Ku=(d,e,r,l,u)=>h.e(Zc(d,e,r,u),{u_world:l}),qc=(d,e,r,l,u)=>{const p=d.transform;let _,x,w=0;if(r.paint.get("circle-pitch-alignment")==="map"){const P=h.av(e,1,p.zoom);_=!0,x=[P,P],w=P/(h.Z*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*u}else _=!1,x=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+_,u_device_pixel_ratio:d.pixelRatio,u_extrude_scale:x,u_globe_extrude_scale:w,u_translate:l}},Yu=d=>({u_pixel_extrude_scale:[1/d.width,1/d.height]}),Wc=d=>({u_viewport_size:[d.width,d.height]}),Gl=(d,e=1)=>({u_color:d,u_overlay:0,u_overlay_scale:e}),Qu=(d,e,r,l)=>{const u=h.av(d,1,e)/(h.Z*Math.pow(2,d.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:h.av(d,1,e),u_intensity:r,u_globe_extrude_scale:u}},Ju=(d,e,r,l)=>{const u=h.K();h.bN(u,0,d.width,d.height,0,0,1);const p=d.context.gl;return{u_matrix:u,u_world:[p.drawingBufferWidth,p.drawingBufferHeight],u_image:r,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},Na=(d,e,r)=>{const l=r.paint.get("hillshade-shadow-color"),u=r.paint.get("hillshade-highlight-color"),p=r.paint.get("hillshade-accent-color");let _=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);return r.paint.get("hillshade-illumination-anchor")==="viewport"&&(_+=d.transform.bearingInRadians),{u_image:0,u_latrange:Xc(0,e.tileID),u_light:[r.paint.get("hillshade-exaggeration"),_],u_shadow:l,u_highlight:u,u_accent:p}},Hc=(d,e)=>{const r=e.stride,l=h.K();return h.bN(l,0,h.Z,-8192,0,0,1),h.L(l,l,[0,-8192,0]),{u_matrix:l,u_image:1,u_dimension:[r,r],u_zoom:d.overscaledZ,u_unpack:e.getUnpackVector()}};function Xc(d,e){const r=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new h.$(0,l/r).toLngLat().lat,new h.$(0,(l+1)/r).toLngLat().lat]}const Va=(d,e,r,l)=>{const u=d.transform;return{u_translation:ql(d,e,r),u_ratio:l/h.av(e,1,u.zoom),u_device_pixel_ratio:d.pixelRatio,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]]}},Gh=(d,e,r,l,u)=>h.e(Va(d,e,r,l),{u_image:0,u_image_height:u}),xs=(d,e,r,l,u)=>{const p=d.transform,_=Kc(e,p);return{u_translation:ql(d,e,r),u_texsize:e.imageAtlasTexture.size,u_ratio:l/h.av(e,1,p.zoom),u_device_pixel_ratio:d.pixelRatio,u_image:0,u_scale:[_,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},Qs=(d,e,r,l,u,p)=>{const _=d.lineAtlas,x=Kc(e,d.transform),w=r.layout.get("line-cap")==="round",P=_.getDash(u.from,w),A=_.getDash(u.to,w),D=P.width*p.fromScale,O=A.width*p.toScale;return h.e(Va(d,e,r,l),{u_patternscale_a:[x/D,-P.height/2],u_patternscale_b:[x/O,-A.height/2],u_sdfgamma:_.width/(256*Math.min(D,O)*d.pixelRatio)/2,u_image:0,u_tex_y_a:P.y,u_tex_y_b:A.y,u_mix:p.t})};function Kc(d,e){return 1/h.av(d,1,e.tileZoom)}function ql(d,e,r){return h.aw(d.transform,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const ec=(d,e,r,l,u)=>{return{u_tl_parent:d,u_scale_parent:e,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(p=l.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:tc(l.paint.get("raster-hue-rotate")),u_coords_top:[u[0].x,u[0].y,u[1].x,u[1].y],u_coords_bottom:[u[3].x,u[3].y,u[2].x,u[2].y]};var p,_};function tc(d){d*=Math.PI/180;const e=Math.sin(d),r=Math.cos(d);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}const Js=(d,e,r,l,u,p,_,x,w,P,A,D,O)=>{const $=_.transform;return{u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:$.width/$.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_label_plane_matrix:x,u_coord_matrix:w,u_is_text:+A,u_pitch_with_map:+l,u_is_along_line:u,u_is_variable_anchor:p,u_texsize:D,u_texture:0,u_translation:P,u_pitched_scale:O}},Wl=(d,e,r,l,u,p,_,x,w,P,A,D,O,$)=>{const U=_.transform;return h.e(Js(d,e,r,l,u,p,_,x,w,P,A,D,$),{u_gamma_scale:l?Math.cos(U.pitch*Math.PI/180)*U.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:1})},Vo=(d,e,r,l,u,p,_,x,w,P,A,D,O)=>h.e(Wl(d,e,r,l,u,p,_,x,w,P,!0,A,0,O),{u_texsize_icon:D,u_texture_icon:1}),$o=(d,e)=>({u_opacity:d,u_color:e}),rc=(d,e,r,l,u)=>h.e(function(p,_,x,w){const P=x.imageManager.getPattern(p.from.toString()),A=x.imageManager.getPattern(p.to.toString()),{width:D,height:O}=x.imageManager.getPixelSize(),$=Math.pow(2,w.tileID.overscaledZ),U=w.tileSize*Math.pow(2,x.transform.tileZoom)/$,Q=U*(w.tileID.canonical.x+w.tileID.wrap*$),Y=U*w.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:P.tl,u_pattern_br_a:P.br,u_pattern_tl_b:A.tl,u_pattern_br_b:A.br,u_texsize:[D,O],u_mix:_.t,u_pattern_size_a:P.displaySize,u_pattern_size_b:A.displaySize,u_scale_a:_.fromScale,u_scale_b:_.toScale,u_tile_units_to_pixels:1/h.av(w,1,x.transform.tileZoom),u_pixel_coord_upper:[Q>>16,Y>>16],u_pixel_coord_lower:[65535&Q,65535&Y]}}(r,u,e,l),{u_opacity:d}),Hl=(d,e)=>{},Xl={fillExtrusion:(d,e)=>({u_lightpos:new h.bI(d,e.u_lightpos),u_lightpos_globe:new h.bI(d,e.u_lightpos_globe),u_lightintensity:new h.b7(d,e.u_lightintensity),u_lightcolor:new h.bI(d,e.u_lightcolor),u_vertical_gradient:new h.b7(d,e.u_vertical_gradient),u_opacity:new h.b7(d,e.u_opacity),u_fill_translate:new h.bJ(d,e.u_fill_translate)}),fillExtrusionPattern:(d,e)=>({u_lightpos:new h.bI(d,e.u_lightpos),u_lightpos_globe:new h.bI(d,e.u_lightpos_globe),u_lightintensity:new h.b7(d,e.u_lightintensity),u_lightcolor:new h.bI(d,e.u_lightcolor),u_vertical_gradient:new h.b7(d,e.u_vertical_gradient),u_height_factor:new h.b7(d,e.u_height_factor),u_opacity:new h.b7(d,e.u_opacity),u_fill_translate:new h.bJ(d,e.u_fill_translate),u_image:new h.bE(d,e.u_image),u_texsize:new h.bJ(d,e.u_texsize),u_pixel_coord_upper:new h.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bJ(d,e.u_pixel_coord_lower),u_scale:new h.bI(d,e.u_scale),u_fade:new h.b7(d,e.u_fade)}),fill:(d,e)=>({u_fill_translate:new h.bJ(d,e.u_fill_translate)}),fillPattern:(d,e)=>({u_image:new h.bE(d,e.u_image),u_texsize:new h.bJ(d,e.u_texsize),u_pixel_coord_upper:new h.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bJ(d,e.u_pixel_coord_lower),u_scale:new h.bI(d,e.u_scale),u_fade:new h.b7(d,e.u_fade),u_fill_translate:new h.bJ(d,e.u_fill_translate)}),fillOutline:(d,e)=>({u_world:new h.bJ(d,e.u_world),u_fill_translate:new h.bJ(d,e.u_fill_translate)}),fillOutlinePattern:(d,e)=>({u_world:new h.bJ(d,e.u_world),u_image:new h.bE(d,e.u_image),u_texsize:new h.bJ(d,e.u_texsize),u_pixel_coord_upper:new h.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bJ(d,e.u_pixel_coord_lower),u_scale:new h.bI(d,e.u_scale),u_fade:new h.b7(d,e.u_fade),u_fill_translate:new h.bJ(d,e.u_fill_translate)}),circle:(d,e)=>({u_camera_to_center_distance:new h.b7(d,e.u_camera_to_center_distance),u_scale_with_map:new h.bE(d,e.u_scale_with_map),u_pitch_with_map:new h.bE(d,e.u_pitch_with_map),u_extrude_scale:new h.bJ(d,e.u_extrude_scale),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_globe_extrude_scale:new h.b7(d,e.u_globe_extrude_scale),u_translate:new h.bJ(d,e.u_translate)}),collisionBox:(d,e)=>({u_pixel_extrude_scale:new h.bJ(d,e.u_pixel_extrude_scale)}),collisionCircle:(d,e)=>({u_viewport_size:new h.bJ(d,e.u_viewport_size)}),debug:(d,e)=>({u_color:new h.bF(d,e.u_color),u_overlay:new h.bE(d,e.u_overlay),u_overlay_scale:new h.b7(d,e.u_overlay_scale)}),depth:Hl,clippingMask:Hl,heatmap:(d,e)=>({u_extrude_scale:new h.b7(d,e.u_extrude_scale),u_intensity:new h.b7(d,e.u_intensity),u_globe_extrude_scale:new h.b7(d,e.u_globe_extrude_scale)}),heatmapTexture:(d,e)=>({u_matrix:new h.bG(d,e.u_matrix),u_world:new h.bJ(d,e.u_world),u_image:new h.bE(d,e.u_image),u_color_ramp:new h.bE(d,e.u_color_ramp),u_opacity:new h.b7(d,e.u_opacity)}),hillshade:(d,e)=>({u_image:new h.bE(d,e.u_image),u_latrange:new h.bJ(d,e.u_latrange),u_light:new h.bJ(d,e.u_light),u_shadow:new h.bF(d,e.u_shadow),u_highlight:new h.bF(d,e.u_highlight),u_accent:new h.bF(d,e.u_accent)}),hillshadePrepare:(d,e)=>({u_matrix:new h.bG(d,e.u_matrix),u_image:new h.bE(d,e.u_image),u_dimension:new h.bJ(d,e.u_dimension),u_zoom:new h.b7(d,e.u_zoom),u_unpack:new h.bH(d,e.u_unpack)}),line:(d,e)=>({u_translation:new h.bJ(d,e.u_translation),u_ratio:new h.b7(d,e.u_ratio),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new h.bJ(d,e.u_units_to_pixels)}),lineGradient:(d,e)=>({u_translation:new h.bJ(d,e.u_translation),u_ratio:new h.b7(d,e.u_ratio),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new h.bJ(d,e.u_units_to_pixels),u_image:new h.bE(d,e.u_image),u_image_height:new h.b7(d,e.u_image_height)}),linePattern:(d,e)=>({u_translation:new h.bJ(d,e.u_translation),u_texsize:new h.bJ(d,e.u_texsize),u_ratio:new h.b7(d,e.u_ratio),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_image:new h.bE(d,e.u_image),u_units_to_pixels:new h.bJ(d,e.u_units_to_pixels),u_scale:new h.bI(d,e.u_scale),u_fade:new h.b7(d,e.u_fade)}),lineSDF:(d,e)=>({u_translation:new h.bJ(d,e.u_translation),u_ratio:new h.b7(d,e.u_ratio),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_units_to_pixels:new h.bJ(d,e.u_units_to_pixels),u_patternscale_a:new h.bJ(d,e.u_patternscale_a),u_patternscale_b:new h.bJ(d,e.u_patternscale_b),u_sdfgamma:new h.b7(d,e.u_sdfgamma),u_image:new h.bE(d,e.u_image),u_tex_y_a:new h.b7(d,e.u_tex_y_a),u_tex_y_b:new h.b7(d,e.u_tex_y_b),u_mix:new h.b7(d,e.u_mix)}),raster:(d,e)=>({u_tl_parent:new h.bJ(d,e.u_tl_parent),u_scale_parent:new h.b7(d,e.u_scale_parent),u_buffer_scale:new h.b7(d,e.u_buffer_scale),u_fade_t:new h.b7(d,e.u_fade_t),u_opacity:new h.b7(d,e.u_opacity),u_image0:new h.bE(d,e.u_image0),u_image1:new h.bE(d,e.u_image1),u_brightness_low:new h.b7(d,e.u_brightness_low),u_brightness_high:new h.b7(d,e.u_brightness_high),u_saturation_factor:new h.b7(d,e.u_saturation_factor),u_contrast_factor:new h.b7(d,e.u_contrast_factor),u_spin_weights:new h.bI(d,e.u_spin_weights),u_coords_top:new h.bH(d,e.u_coords_top),u_coords_bottom:new h.bH(d,e.u_coords_bottom)}),symbolIcon:(d,e)=>({u_is_size_zoom_constant:new h.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bE(d,e.u_is_size_feature_constant),u_size_t:new h.b7(d,e.u_size_t),u_size:new h.b7(d,e.u_size),u_camera_to_center_distance:new h.b7(d,e.u_camera_to_center_distance),u_pitch:new h.b7(d,e.u_pitch),u_rotate_symbol:new h.bE(d,e.u_rotate_symbol),u_aspect_ratio:new h.b7(d,e.u_aspect_ratio),u_fade_change:new h.b7(d,e.u_fade_change),u_label_plane_matrix:new h.bG(d,e.u_label_plane_matrix),u_coord_matrix:new h.bG(d,e.u_coord_matrix),u_is_text:new h.bE(d,e.u_is_text),u_pitch_with_map:new h.bE(d,e.u_pitch_with_map),u_is_along_line:new h.bE(d,e.u_is_along_line),u_is_variable_anchor:new h.bE(d,e.u_is_variable_anchor),u_texsize:new h.bJ(d,e.u_texsize),u_texture:new h.bE(d,e.u_texture),u_translation:new h.bJ(d,e.u_translation),u_pitched_scale:new h.b7(d,e.u_pitched_scale)}),symbolSDF:(d,e)=>({u_is_size_zoom_constant:new h.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bE(d,e.u_is_size_feature_constant),u_size_t:new h.b7(d,e.u_size_t),u_size:new h.b7(d,e.u_size),u_camera_to_center_distance:new h.b7(d,e.u_camera_to_center_distance),u_pitch:new h.b7(d,e.u_pitch),u_rotate_symbol:new h.bE(d,e.u_rotate_symbol),u_aspect_ratio:new h.b7(d,e.u_aspect_ratio),u_fade_change:new h.b7(d,e.u_fade_change),u_label_plane_matrix:new h.bG(d,e.u_label_plane_matrix),u_coord_matrix:new h.bG(d,e.u_coord_matrix),u_is_text:new h.bE(d,e.u_is_text),u_pitch_with_map:new h.bE(d,e.u_pitch_with_map),u_is_along_line:new h.bE(d,e.u_is_along_line),u_is_variable_anchor:new h.bE(d,e.u_is_variable_anchor),u_texsize:new h.bJ(d,e.u_texsize),u_texture:new h.bE(d,e.u_texture),u_gamma_scale:new h.b7(d,e.u_gamma_scale),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_is_halo:new h.bE(d,e.u_is_halo),u_translation:new h.bJ(d,e.u_translation),u_pitched_scale:new h.b7(d,e.u_pitched_scale)}),symbolTextAndIcon:(d,e)=>({u_is_size_zoom_constant:new h.bE(d,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bE(d,e.u_is_size_feature_constant),u_size_t:new h.b7(d,e.u_size_t),u_size:new h.b7(d,e.u_size),u_camera_to_center_distance:new h.b7(d,e.u_camera_to_center_distance),u_pitch:new h.b7(d,e.u_pitch),u_rotate_symbol:new h.bE(d,e.u_rotate_symbol),u_aspect_ratio:new h.b7(d,e.u_aspect_ratio),u_fade_change:new h.b7(d,e.u_fade_change),u_label_plane_matrix:new h.bG(d,e.u_label_plane_matrix),u_coord_matrix:new h.bG(d,e.u_coord_matrix),u_is_text:new h.bE(d,e.u_is_text),u_pitch_with_map:new h.bE(d,e.u_pitch_with_map),u_is_along_line:new h.bE(d,e.u_is_along_line),u_is_variable_anchor:new h.bE(d,e.u_is_variable_anchor),u_texsize:new h.bJ(d,e.u_texsize),u_texsize_icon:new h.bJ(d,e.u_texsize_icon),u_texture:new h.bE(d,e.u_texture),u_texture_icon:new h.bE(d,e.u_texture_icon),u_gamma_scale:new h.b7(d,e.u_gamma_scale),u_device_pixel_ratio:new h.b7(d,e.u_device_pixel_ratio),u_is_halo:new h.bE(d,e.u_is_halo),u_translation:new h.bJ(d,e.u_translation),u_pitched_scale:new h.b7(d,e.u_pitched_scale)}),background:(d,e)=>({u_opacity:new h.b7(d,e.u_opacity),u_color:new h.bF(d,e.u_color)}),backgroundPattern:(d,e)=>({u_opacity:new h.b7(d,e.u_opacity),u_image:new h.bE(d,e.u_image),u_pattern_tl_a:new h.bJ(d,e.u_pattern_tl_a),u_pattern_br_a:new h.bJ(d,e.u_pattern_br_a),u_pattern_tl_b:new h.bJ(d,e.u_pattern_tl_b),u_pattern_br_b:new h.bJ(d,e.u_pattern_br_b),u_texsize:new h.bJ(d,e.u_texsize),u_mix:new h.b7(d,e.u_mix),u_pattern_size_a:new h.bJ(d,e.u_pattern_size_a),u_pattern_size_b:new h.bJ(d,e.u_pattern_size_b),u_scale_a:new h.b7(d,e.u_scale_a),u_scale_b:new h.b7(d,e.u_scale_b),u_pixel_coord_upper:new h.bJ(d,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bJ(d,e.u_pixel_coord_lower),u_tile_units_to_pixels:new h.b7(d,e.u_tile_units_to_pixels)}),terrain:(d,e)=>({u_texture:new h.bE(d,e.u_texture),u_ele_delta:new h.b7(d,e.u_ele_delta),u_fog_matrix:new h.bG(d,e.u_fog_matrix),u_fog_color:new h.bF(d,e.u_fog_color),u_fog_ground_blend:new h.b7(d,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.b7(d,e.u_fog_ground_blend_opacity),u_horizon_color:new h.bF(d,e.u_horizon_color),u_horizon_fog_blend:new h.b7(d,e.u_horizon_fog_blend),u_is_globe_mode:new h.b7(d,e.u_is_globe_mode)}),terrainDepth:(d,e)=>({u_ele_delta:new h.b7(d,e.u_ele_delta)}),terrainCoords:(d,e)=>({u_texture:new h.bE(d,e.u_texture),u_terrain_coords_id:new h.b7(d,e.u_terrain_coords_id),u_ele_delta:new h.b7(d,e.u_ele_delta)}),projectionErrorMeasurement:(d,e)=>({u_input:new h.b7(d,e.u_input),u_output_expected:new h.b7(d,e.u_output_expected)}),atmosphere:(d,e)=>({u_sun_pos:new h.bI(d,e.u_sun_pos),u_atmosphere_blend:new h.b7(d,e.u_atmosphere_blend),u_globe_position:new h.bI(d,e.u_globe_position),u_globe_radius:new h.b7(d,e.u_globe_radius),u_inv_proj_matrix:new h.bG(d,e.u_inv_proj_matrix)}),sky:(d,e)=>({u_sky_color:new h.bF(d,e.u_sky_color),u_horizon_color:new h.bF(d,e.u_horizon_color),u_horizon:new h.bJ(d,e.u_horizon),u_horizon_normal:new h.bJ(d,e.u_horizon_normal),u_sky_horizon_blend:new h.b7(d,e.u_sky_horizon_blend),u_sky_blend:new h.b7(d,e.u_sky_blend)})};class nc{constructor(e,r,l){this.context=e;const u=e.gl;this.buffer=u.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $a={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class uo{constructor(e,r,l,u){this.length=r.length,this.attributes=l,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.context=e;const p=e.gl;this.buffer=p.createBuffer(),e.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let l=0;l<this.attributes.length;l++){const u=r.attributes[this.attributes[l].name];u!==void 0&&e.enableVertexAttribArray(u)}}setVertexAttribPointers(e,r,l){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],_=r.attributes[p.name];_!==void 0&&e.vertexAttribPointer(_,p.components,e[$a[p.type]],!1,this.itemSize,p.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class br{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Kl extends br{getDefault(){return h.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class qh extends br{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Yc extends br{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class ic extends br{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Yl extends br{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Qc extends br{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class oc extends br{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class el extends br{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ql extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class Jl extends br{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class ac extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class Ua extends br{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class bs extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class Qr extends br{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ws extends br{getDefault(){return h.b6.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class sc extends br{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class eu extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class ca extends br{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class tl extends br{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Ts extends br{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class rl extends br{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class tu extends br{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Za extends br{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class ha extends br{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Po extends br{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class ru extends br{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class nu extends br{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class dr extends br{getDefault(){return null}set(e){var r;if(e===this.current&&!this.dirty)return;const l=this.gl;Gn(l)?l.bindVertexArray(e):(r=l.getExtension("OES_vertex_array_object"))===null||r===void 0||r.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Uo extends br{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class lc extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class uc extends br{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Co extends br{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class Jc extends Co{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class eh extends Co{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class cc extends Co{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const hc="Framebuffer is not complete";class iu{constructor(e,r,l,u,p){this.context=e,this.width=r,this.height=l;const _=e.gl,x=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Jc(e,x),u)this.depthAttachment=p?new cc(e,x):new eh(e,x);else if(p)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error(hc)}destroy(){const e=this.context.gl,r=this.colorAttachment.get();if(r&&e.deleteTexture(r),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class nl{constructor(e){var r,l;if(this.gl=e,this.clearColor=new Kl(this),this.clearDepth=new qh(this),this.clearStencil=new Yc(this),this.colorMask=new ic(this),this.depthMask=new Yl(this),this.stencilMask=new Qc(this),this.stencilFunc=new oc(this),this.stencilOp=new el(this),this.stencilTest=new Ql(this),this.depthRange=new Jl(this),this.depthTest=new ac(this),this.depthFunc=new Ua(this),this.blend=new bs(this),this.blendFunc=new Qr(this),this.blendColor=new ws(this),this.blendEquation=new sc(this),this.cullFace=new eu(this),this.cullFaceSide=new ca(this),this.frontFace=new tl(this),this.program=new Ts(this),this.activeTexture=new rl(this),this.viewport=new tu(this),this.bindFramebuffer=new Za(this),this.bindRenderbuffer=new ha(this),this.bindTexture=new Po(this),this.bindVertexBuffer=new ru(this),this.bindElementBuffer=new nu(this),this.bindVertexArray=new dr(this),this.pixelStoreUnpack=new Uo(this),this.pixelStoreUnpackPremultiplyAlpha=new lc(this),this.pixelStoreUnpackFlipY=new uc(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Gn(e)){this.HALF_FLOAT=e.HALF_FLOAT;const u=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(r=e.RGBA16F)!==null&&r!==void 0?r:u==null?void 0:u.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:u==null?void 0:u.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const u=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=u==null?void 0:u.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r){return new nc(this,e,r)}createVertexBuffer(e,r,l){return new uo(this,e,r,l)}createRenderbuffer(e,r,l){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,e,r,l),this.bindRenderbuffer.set(null),p}createFramebuffer(e,r,l,u){return new iu(this,e,r,l,u)}clear({color:e,depth:r,stencil:l}){const u=this.gl;let p=0;e&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),r!==void 0&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),l!==void 0&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),u.clear(p)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){h.bB(e.blendFunction,Lr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Gn(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var r;return Gn(this.gl)?this.gl.deleteVertexArray(e):(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let yi;function Ss(d,e,r,l,u){const p=d.context,_=d.transform,x=p.gl,w=d.useProgram("collisionBox"),P=[];let A=0,D=0;for(let J=0;J<l.length;J++){const re=l[J],le=e.getTile(re).getBucket(r);if(!le)continue;const ue=u?le.textCollisionBox:le.iconCollisionBox,de=le.collisionCircleArray;de.length>0&&(P.push({circleArray:de,circleOffset:D,coord:re}),A+=de.length/4,D=A),ue&&w.draw(p,x.LINES,Qt.disabled,yr.disabled,d.colorModeForRenderPass(),hr.disabled,Yu(d.transform),d.style.map.terrain&&d.style.map.terrain.getTerrainData(re),_.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),r.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,null,d.transform.zoom,null,null,ue.collisionVertexBuffer)}if(!u||!P.length)return;const O=d.useProgram("collisionCircle"),$=new h.bO;$.resize(4*A),$._trim();let U=0;for(const J of P)for(let re=0;re<J.circleArray.length/4;re++){const le=4*re,ue=J.circleArray[le+0],de=J.circleArray[le+1],pe=J.circleArray[le+2],se=J.circleArray[le+3];$.emplace(U++,ue,de,pe,se,0),$.emplace(U++,ue,de,pe,se,1),$.emplace(U++,ue,de,pe,se,2),$.emplace(U++,ue,de,pe,se,3)}(!yi||yi.length<2*A)&&(yi=function(J){const re=2*J,le=new h.bQ;le.resize(re),le._trim();for(let ue=0;ue<re;ue++){const de=6*ue;le.uint16[de+0]=4*ue+0,le.uint16[de+1]=4*ue+1,le.uint16[de+2]=4*ue+2,le.uint16[de+3]=4*ue+2,le.uint16[de+4]=4*ue+3,le.uint16[de+5]=4*ue+0}return le}(A));const Q=p.createIndexBuffer(yi,!0),Y=p.createVertexBuffer($,h.bP.members,!0);for(const J of P){const re=Wc(d.transform);O.draw(p,x.TRIANGLES,Qt.disabled,yr.disabled,d.colorModeForRenderPass(),hr.disabled,re,d.style.map.terrain&&d.style.map.terrain.getTerrainData(J.coord),null,r.id,Y,Q,h.aF.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,d.transform.zoom,null,null,null)}Y.destroy(),Q.destroy()}const il=h.as(new Float32Array(16));function th(d,e,r,l,u,p){const{horizontalAlign:_,verticalAlign:x}=h.aA(d);return new h.P((-(_-.5)*e/u+l[0])*p,(-(x-.5)*r/u+l[1])*p)}function ou(d,e,r,l,u,p){const _=e.tileAnchorPoint.add(new h.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let x=l.mult(p);r||(x=x.rotate(-u));const w=_.add(x);return De(w.x,w.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(r){const x=vt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(d),w=Math.atan(x.y/x.x)+(x.x<0?Math.PI:0);return d.add(l.rotate(w))}return d.add(l)}function da(d,e,r,l,u,p,_,x,w,P,A,D){const O=d.text.placedSymbolArray,$=d.text.dynamicLayoutVertexArray,U=d.icon.dynamicLayoutVertexArray,Q={};$.clear();for(let Y=0;Y<O.length;Y++){const J=O.get(Y),re=J.hidden||!J.crossTileID||d.allowVerticalPlacement&&!J.placedOrientation?null:l[J.crossTileID];if(re){const le=new h.P(J.anchorX,J.anchorY),ue={getElevation:D,width:u.width,height:u.height,pitchedLabelPlaneMatrix:p,pitchWithMap:r,transform:u,tileAnchorPoint:le,translation:P,unwrappedTileID:A},de=r?er(le.x,le.y,ue):vt(le.x,le.y,ue),pe=Te(u.cameraToCenterDistance,de.signedDistanceFromCamera);let se=h.ah(d.textSizeData,x,J)*pe/h.au;r&&(se*=d.tilePixelRatio/_);const{width:be,height:we,anchor:Fe,textOffset:je,textBoxScale:Oe}=re,lt=th(Fe,be,we,je,Oe,se),Qe=u.getPitchedTextCorrection(le.x+P[0],le.y+P[1],A),He=ou(de.point,ue,e,lt,-u.bearingInRadians,Qe),Pt=d.allowVerticalPlacement&&J.placedOrientation===h.ag.vertical?Math.PI/2:0;for(let Rt=0;Rt<J.numGlyphs;Rt++)h.an($,He,Pt);w&&J.associatedIconIndex>=0&&(Q[J.associatedIconIndex]={shiftedAnchor:He,angle:Pt})}else Zr(J.numGlyphs,$)}if(w){U.clear();const Y=d.icon.placedSymbolArray;for(let J=0;J<Y.length;J++){const re=Y.get(J);if(re.hidden)Zr(re.numGlyphs,U);else{const le=Q[J];if(le)for(let ue=0;ue<re.numGlyphs;ue++)h.an(U,le.shiftedAnchor,le.angle);else Zr(re.numGlyphs,U)}}d.icon.dynamicLayoutVertexBuffer.updateData(U)}d.text.dynamicLayoutVertexBuffer.updateData($)}function dc(d,e,r){return r.iconsInText&&e?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function pc(d,e,r,l,u,p,_,x,w,P,A,D,O){const $=d.context,U=$.gl,Q=d.transform,Y=x==="map",J=w==="map",re=x!=="viewport"&&r.layout.get("symbol-placement")!=="point",le=Y&&!J&&!re,ue=!r.layout.get("symbol-sort-key").isConstant();let de=!1;const pe=d.getDepthModeForSublayer(0,Qt.ReadOnly),se=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),be=[],we=Q.getCircleRadiusCorrection();for(const Fe of l){const je=e.getTile(Fe),Oe=je.getBucket(r);if(!Oe)continue;const lt=u?Oe.text:Oe.icon;if(!lt||!lt.segments.get().length||!lt.hasVisibleVertices)continue;const Qe=lt.programConfigurations.get(r.id),He=u||Oe.sdfIcons,Pt=u?Oe.textSizeData:Oe.iconSizeData,Rt=J||Q.pitch!==0,nr=d.useProgram(dc(He,u,Oe),Qe),pr=h.af(Pt,Q.zoom),Pr=d.style.map.terrain&&d.style.map.terrain.getTerrainData(Fe);let Ur,Fr,wr,zr,yn=[0,0],vn=null;if(u)Fr=je.glyphAtlasTexture,wr=U.LINEAR,Ur=je.glyphAtlasTexture.size,Oe.iconsInText&&(yn=je.imageAtlasTexture.size,vn=je.imageAtlasTexture,zr=Rt||d.options.rotating||d.options.zooming||Pt.kind==="composite"||Pt.kind==="camera"?U.LINEAR:U.NEAREST);else{const Br=r.layout.get("icon-size").constantOr(0)!==1||Oe.iconsNeedLinear;Fr=je.imageAtlasTexture,wr=He||d.options.rotating||d.options.zooming||Br||Rt?U.LINEAR:U.NEAREST,Ur=je.imageAtlasTexture.size}const an=h.av(je,1,d.transform.zoom),In=Pe(Y,d.transform,an),Ho=h.K();h.ai(Ho,In);const zo=_e(J,Y,d.transform,an),wi=h.aw(Q,je,p,_),Li=Q.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Ro=se&&Oe.hasTextData(),Ca=r.layout.get("icon-text-fit")!=="none"&&Ro&&Oe.hasIconData();if(re){const Br=d.style.map.terrain?(sn,ln)=>d.style.map.terrain.getElevation(Fe,sn,ln):null,Rr=r.layout.get("text-rotation-alignment")==="map";Se(Oe,d,u,In,Ho,J,P,Rr,Fe.toUnwrapped(),Q.width,Q.height,wi,Br)}const Ea=u&&se||Ca,Ti=re||Ea?il:J?In:d.transform.clipSpaceToPixelsMatrix,go=He&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ro;ro=He?Oe.iconsInText?Vo(Pt.kind,pr,le,J,re,Ea,d,Ti,zo,wi,Ur,yn,we):Wl(Pt.kind,pr,le,J,re,Ea,d,Ti,zo,wi,u,Ur,0,we):Js(Pt.kind,pr,le,J,re,Ea,d,Ti,zo,wi,u,Ur,we);const _o={program:nr,buffers:lt,uniformValues:ro,projectionData:Li,atlasTexture:Fr,atlasTextureIcon:vn,atlasInterpolation:wr,atlasInterpolationIcon:zr,isSDF:He,hasHalo:go};if(ue&&Oe.canOverlap){de=!0;const Br=lt.segments.get();for(const Rr of Br)be.push({segments:new h.aF([Rr]),sortKey:Rr.sortKey,state:_o,terrainData:Pr})}else be.push({segments:lt.segments,sortKey:0,state:_o,terrainData:Pr})}de&&be.sort((Fe,je)=>Fe.sortKey-je.sortKey);for(const Fe of be){const je=Fe.state;if($.activeTexture.set(U.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,U.CLAMP_TO_EDGE),je.atlasTextureIcon&&($.activeTexture.set(U.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),je.isSDF){const Oe=je.uniformValues;je.hasHalo&&(Oe.u_is_halo=1,ol(je.buffers,Fe.segments,r,d,je.program,pe,A,D,Oe,je.projectionData,Fe.terrainData)),Oe.u_is_halo=0}ol(je.buffers,Fe.segments,r,d,je.program,pe,A,D,je.uniformValues,je.projectionData,Fe.terrainData)}}function ol(d,e,r,l,u,p,_,x,w,P,A){const D=l.context;u.draw(D,D.gl.TRIANGLES,p,_,x,hr.backCCW,w,A,P,r.id,d.layoutVertexBuffer,d.indexBuffer,e,r.paint,l.transform.zoom,d.programConfigurations.get(r.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function Hr(d,e,r,l,u){const p=d.context,_=p.gl,x=yr.disabled,w=new Lr([_.ONE,_.ONE],h.b6.transparent,[!0,!0,!0,!0]),P=e.getBucket(r);if(!P)return;const A=l.key;let D=r.heatmapFbos.get(A);D||(D=pa(p,e.tileSize,e.tileSize),r.heatmapFbos.set(A,D)),p.bindFramebuffer.set(D.framebuffer),p.viewport.set([0,0,e.tileSize,e.tileSize]),p.clear({color:h.b6.transparent});const O=P.programConfigurations.get(r.id),$=d.useProgram("heatmap",O,!u),U=d.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Q=d.style.map.terrain.getTerrainData(l);$.draw(p,_.TRIANGLES,Qt.disabled,x,w,hr.disabled,Qu(e,d.transform.zoom,r.paint.get("heatmap-intensity"),1),Q,U,r.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,r.paint,d.transform.zoom,O)}function au(d,e,r,l,u){const p=d.context,_=p.gl,x=d.transform;p.setColorMode(d.colorModeForRenderPass());const w=fa(p,e),P=r.key,A=e.heatmapFbos.get(P);if(!A)return;p.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,A.colorAttachment.get()),p.activeTexture.set(_.TEXTURE1),w.bind(_.LINEAR,_.CLAMP_TO_EDGE);const D=x.getProjectionData({overscaledTileID:r,applyTerrainMatrix:u,applyGlobeMatrix:!l});d.useProgram("heatmapTexture").draw(p,_.TRIANGLES,Qt.disabled,yr.disabled,d.colorModeForRenderPass(),hr.disabled,Ju(d,e,0,1),null,D,e.id,d.rasterBoundsBuffer,d.quadTriangleIndexBuffer,d.rasterBoundsSegments,e.paint,x.zoom),A.destroy(),e.heatmapFbos.delete(P)}function pa(d,e,r){var l,u;const p=d.gl,_=p.createTexture();p.bindTexture(p.TEXTURE_2D,_),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.LINEAR);const x=(l=d.HALF_FLOAT)!==null&&l!==void 0?l:p.UNSIGNED_BYTE,w=(u=d.RGBA16F)!==null&&u!==void 0?u:p.RGBA;p.texImage2D(p.TEXTURE_2D,0,w,e,r,0,p.RGBA,x,null);const P=d.createFramebuffer(e,r,!1,!1);return P.colorAttachment.set(_),P}function fa(d,e){return e.colorRampTexture||(e.colorRampTexture=new Lt(d,e.colorRamp,d.gl.RGBA)),e.colorRampTexture}function su(d,e,r,l,u){if(!r||!l||!l.imageAtlas)return;const p=l.imageAtlas.patternPositions;let _=p[r.to.toString()],x=p[r.from.toString()];if(!_&&x&&(_=x),!x&&_&&(x=_),!_||!x){const w=u.getPaintProperty(e);_=p[w],x=p[w]}_&&x&&d.setConstantPatternPositions(_,x)}function al(d,e,r,l,u,p,_,x){const w=d.context.gl,P="fill-pattern",A=r.paint.get(P),D=A&&A.constantOr(1),O=r.getCrossfadeParameters();let $,U,Q,Y,J;const re=d.transform,le=r.paint.get("fill-translate"),ue=r.paint.get("fill-translate-anchor");_?(U=D&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=w.LINES):(U=D?"fillPattern":"fill",$=w.TRIANGLES);const de=A.constantOr(null);for(const pe of l){const se=e.getTile(pe);if(D&&!se.patternsLoaded())continue;const be=se.getBucket(r);if(!be)continue;const we=be.programConfigurations.get(r.id),Fe=d.useProgram(U,we),je=d.style.map.terrain&&d.style.map.terrain.getTerrainData(pe);D&&(d.context.activeTexture.set(w.TEXTURE0),se.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),we.updatePaintBuffers(O)),su(we,P,de,se,r);const Oe=re.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!x,applyTerrainMatrix:!0}),lt=h.aw(re,se,le,ue);if(_){Y=be.indexBuffer2,J=be.segments2;const He=[w.drawingBufferWidth,w.drawingBufferHeight];Q=U==="fillOutlinePattern"&&D?Ku(d,O,se,He,lt):Gc(He,lt)}else Y=be.indexBuffer,J=be.segments,Q=D?Zc(d,O,se,lt):{u_fill_translate:lt};let Qe;if(d.renderPass==="translucent"&&x){const[He]=d.getStencilConfigForOverlapAndUpdateStencilID(l);Qe=He[pe.overscaledZ]}else Qe=d.stencilModeForClipping(pe);Fe.draw(d.context,$,u,Qe,p,hr.backCCW,Q,je,Oe,r.id,be.layoutVertexBuffer,Y,J,r.paint,d.transform.zoom,we)}}function Eo(d,e,r,l,u,p,_,x){const w=d.context,P=w.gl,A="fill-extrusion-pattern",D=r.paint.get(A),O=D.constantOr(1),$=r.getCrossfadeParameters(),U=r.paint.get("fill-extrusion-opacity"),Q=D.constantOr(null),Y=d.transform;for(const J of l){const re=e.getTile(J),le=re.getBucket(r);if(!le)continue;const ue=d.style.map.terrain&&d.style.map.terrain.getTerrainData(J),de=le.programConfigurations.get(r.id),pe=d.useProgram(O?"fillExtrusionPattern":"fillExtrusion",de);O&&(d.context.activeTexture.set(P.TEXTURE0),re.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),de.updatePaintBuffers($));const se=Y.getProjectionData({overscaledTileID:J,applyGlobeMatrix:!x,applyTerrainMatrix:!0});su(de,A,Q,re,r);const be=h.aw(Y,re,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),we=r.paint.get("fill-extrusion-vertical-gradient"),Fe=O?vs(d,we,U,be,J,$,re):Uc(d,we,U,be);pe.draw(w,w.gl.TRIANGLES,u,p,_,hr.backCCW,Fe,ue,se,r.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,r.paint,d.transform.zoom,de,d.style.map.terrain&&le.centroidVertexBuffer)}}function ma(d,e,r,l,u,p,_,x,w){var P;const A=d.style.projection,D=d.context,O=d.transform,$=D.gl,U=d.useProgram("hillshade"),Q=!d.options.moving;for(const Y of l){const J=e.getTile(Y),re=J.fbo;if(!re)continue;const le=A.getMeshFromTileID(D,Y.canonical,x,!0,"raster"),ue=(P=d.style.map.terrain)===null||P===void 0?void 0:P.getTerrainData(Y);D.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,re.colorAttachment.get());const de=O.getProjectionData({overscaledTileID:Y,aligned:Q,applyGlobeMatrix:!w,applyTerrainMatrix:!0});U.draw(D,$.TRIANGLES,p,u[Y.overscaledZ],_,hr.backCCW,Na(d,J,r),ue,de,r.id,le.vertexBuffer,le.indexBuffer,le.segments)}}const ga=[new h.P(0,0),new h.P(h.Z,0),new h.P(h.Z,h.Z),new h.P(0,h.Z)];function Ps(d,e,r,l,u,p,_,x,w=!1,P=!1){const A=l[l.length-1].overscaledZ,D=d.context,O=D.gl,$=d.useProgram("raster"),U=d.transform,Q=d.style.projection,Y=d.colorModeForRenderPass(),J=!d.options.moving;for(const re of l){const le=d.getDepthModeForSublayer(re.overscaledZ-A,r.paint.get("raster-opacity")===1?Qt.ReadWrite:Qt.ReadOnly,O.LESS),ue=e.getTile(re);ue.registerFadeDuration(r.paint.get("raster-fade-duration"));const de=e.findLoadedParent(re,0),pe=e.findLoadedSibling(re),se=Jr(ue,de||pe||null,e,r,d.transform,d.style.map.terrain);let be,we;const Fe=r.paint.get("raster-resampling")==="nearest"?O.NEAREST:O.LINEAR;D.activeTexture.set(O.TEXTURE0),ue.texture.bind(Fe,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),D.activeTexture.set(O.TEXTURE1),de?(de.texture.bind(Fe,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),be=Math.pow(2,de.tileID.overscaledZ-ue.tileID.overscaledZ),we=[ue.tileID.canonical.x*be%1,ue.tileID.canonical.y*be%1]):ue.texture.bind(Fe,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST),ue.texture.useMipmap&&D.extTextureFilterAnisotropic&&d.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const je=d.style.map.terrain&&d.style.map.terrain.getTerrainData(re),Oe=U.getProjectionData({overscaledTileID:re,aligned:J,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),lt=ec(we||[0,0],be||1,se,r,x),Qe=Q.getMeshFromTileID(D,re.canonical,p,_,"raster");$.draw(D,O.TRIANGLES,le,u?u[re.overscaledZ]:yr.disabled,Y,w?hr.frontCCW:hr.backCCW,lt,je,Oe,r.id,Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}}function Jr(d,e,r,l,u,p){const _=l.paint.get("raster-fade-duration");if(!p&&_>0){const x=ze.now(),w=(x-d.timeAdded)/_,P=e?(x-e.timeAdded)/_:-1,A=r.getSource(),D=Ai(u,{tileSize:A.tileSize,roundZoom:A.roundZoom}),O=!e||Math.abs(e.tileID.overscaledZ-D)>Math.abs(d.tileID.overscaledZ-D),$=O&&d.refreshedUponExpiration?1:h.ad(O?w:1-P,0,1);return d.refreshedUponExpiration&&w>=1&&(d.refreshedUponExpiration=!1),e?{opacity:1,mix:1-$}:{opacity:$,mix:0}}return{opacity:1,mix:0}}const Ga=new h.b6(1,0,0,1),zi=new h.b6(0,1,0,1),Cs=new h.b6(0,0,1,1),Es=new h.b6(1,0,1,1),lu=new h.b6(0,1,1,1);function Zo(d,e,r,l){ya(d,0,e+r/2,d.transform.width,r,l)}function _a(d,e,r,l){ya(d,e-r/2,0,r,d.transform.height,l)}function ya(d,e,r,l,u,p){const _=d.context,x=_.gl;x.enable(x.SCISSOR_TEST),x.scissor(e*d.pixelRatio,r*d.pixelRatio,l*d.pixelRatio,u*d.pixelRatio),_.clear({color:p}),x.disable(x.SCISSOR_TEST)}function rh(d,e,r){const l=d.context,u=l.gl,p=d.useProgram("debug"),_=Qt.disabled,x=yr.disabled,w=d.colorModeForRenderPass(),P="$debug",A=d.style.map.terrain&&d.style.map.terrain.getTerrainData(r);l.activeTexture.set(u.TEXTURE0);const D=e.getTileByID(r.key).latestRawTileData,O=Math.floor((D&&D.byteLength||0)/1024),$=e.getTile(r).tileSize,U=512/Math.min($,512)*(r.overscaledZ/d.transform.zoom)*.5;let Q=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(Q+=` => ${r.overscaledZ}`),function(J,re){J.initDebugOverlayCanvas();const le=J.debugOverlayCanvas,ue=J.context.gl,de=J.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,le.width,le.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold 36px Open Sans, sans-serif",de.fillText(re,5,5),de.strokeText(re,5,5),J.debugOverlayTexture.update(le),J.debugOverlayTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE)}(d,`${Q} ${O}kB`);const Y=d.transform.getProjectionData({overscaledTileID:r,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(l,u.TRIANGLES,_,x,Lr.alphaBlended,hr.disabled,Gl(h.b6.transparent,U),null,Y,P,d.debugBuffer,d.quadTriangleIndexBuffer,d.debugSegments),p.draw(l,u.LINE_STRIP,_,x,w,hr.disabled,Gl(h.b6.red),A,Y,P,d.debugBuffer,d.tileBorderIndexBuffer,d.debugSegments)}function uu(d,e,r,l){const{isRenderingGlobe:u}=l,p=d.context,_=p.gl,x=d.transform,w=d.colorModeForRenderPass(),P=d.getDepthModeFor3D(),A=d.useProgram("terrain");p.bindFramebuffer.set(null),p.viewport.set([0,0,d.width,d.height]);for(const D of r){const O=e.getTerrainMesh(D.tileID),$=d.renderToTexture.getTexture(D),U=e.getTerrainData(D.tileID);p.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,$.texture);const Q=e.getMeshFrameDelta(x.zoom),Y=x.calculateFogMatrix(D.tileID.toUnwrapped()),J=Xu(Q,Y,d.style.sky,x.pitch,u),re=x.getProjectionData({overscaledTileID:D.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});A.draw(p,_.TRIANGLES,P,yr.disabled,w,hr.backCCW,J,U,re,"terrain",O.vertexBuffer,O.indexBuffer,O.segments)}}function fc(d,e){if(!e.mesh){const r=new h.aE;r.emplaceBack(-1,-1),r.emplaceBack(1,-1),r.emplaceBack(1,1),r.emplaceBack(-1,1);const l=new h.aG;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new gi(d.createVertexBuffer(r,_i.members),d.createIndexBuffer(l),h.aF.simpleSegment(0,0,r.length,l.length))}return e.mesh}class nh{constructor(e,r){this.context=new nl(e),this.transform=r,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.as(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=R.maxUnderzooming+R.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new fs}resize(e,r,l){if(this.width=Math.floor(e*l),this.height=Math.floor(r*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const u of this.style._order)this.style._layers[u].resize()}setup(){const e=this.context,r=new h.aE;r.emplaceBack(0,0),r.emplaceBack(h.Z,0),r.emplaceBack(0,h.Z),r.emplaceBack(h.Z,h.Z),this.tileExtentBuffer=e.createVertexBuffer(r,_i.members),this.tileExtentSegments=h.aF.simpleSegment(0,0,4,2);const l=new h.aE;l.emplaceBack(0,0),l.emplaceBack(h.Z,0),l.emplaceBack(0,h.Z),l.emplaceBack(h.Z,h.Z),this.debugBuffer=e.createVertexBuffer(l,_i.members),this.debugSegments=h.aF.simpleSegment(0,0,4,5);const u=new h.bV;u.emplaceBack(0,0,0,0),u.emplaceBack(h.Z,0,h.Z,0),u.emplaceBack(0,h.Z,0,h.Z),u.emplaceBack(h.Z,h.Z,h.Z,h.Z),this.rasterBoundsBuffer=e.createVertexBuffer(u,Xi.members),this.rasterBoundsSegments=h.aF.simpleSegment(0,0,4,2);const p=new h.aE;p.emplaceBack(0,0),p.emplaceBack(h.Z,0),p.emplaceBack(0,h.Z),p.emplaceBack(h.Z,h.Z),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(p,_i.members),this.rasterBoundsSegmentsPosOnly=h.aF.simpleSegment(0,0,4,5);const _=new h.aE;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(_,_i.members),this.viewportSegments=h.aF.simpleSegment(0,0,4,2);const x=new h.bW;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);const w=new h.aG;w.emplaceBack(1,0,2),w.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(w);const P=this.context.gl;this.stencilClearMode=new yr({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.tileExtentMesh=new gi(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,r=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=h.K();h.bN(l,0,this.width,this.height,0,0,1),h.M(l,l,[r.drawingBufferWidth,r.drawingBufferHeight,0]);const u={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,r.TRIANGLES,Qt.disabled,this.stencilClearMode,Lr.disabled,hr.disabled,null,null,u,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,r,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!r||!r.length)return;this.currentStencilSource=e.source,this.nextStencilID+r.length>256&&this.clearStencil();const u=this.context;u.setColorMode(Lr.disabled),u.setDepthMode(Qt.disabled);const p={};for(const _ of r)p[_.key]=this.nextStencilID++;this._renderTileMasks(p,r,l,!0),this._renderTileMasks(p,r,l,!1),this._tileClippingMaskIDs=p}_renderTileMasks(e,r,l,u){const p=this.context,_=p.gl,x=this.style.projection,w=this.transform,P=this.useProgram("clippingMask");for(const A of r){const D=e[A.key],O=this.style.map.terrain&&this.style.map.terrain.getTerrainData(A),$=x.getMeshFromTileID(this.context,A.canonical,u,!0,"stencil"),U=w.getProjectionData({overscaledTileID:A,applyGlobeMatrix:!0,applyTerrainMatrix:!0});P.draw(p,_.TRIANGLES,Qt.disabled,new yr({func:_.ALWAYS,mask:0},D,255,_.KEEP,_.KEEP,_.REPLACE),Lr.disabled,l?hr.disabled:hr.backCCW,null,O,U,"$clipping",$.vertexBuffer,$.indexBuffer,$.segments)}}_renderTilesDepthBuffer(){const e=this.context,r=e.gl,l=this.style.projection,u=this.transform,p=this.useProgram("depth"),_=this.getDepthModeFor3D(),x=xe(u,{tileSize:u.tileSize});for(const w of x){const P=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w),A=l.getMeshFromTileID(this.context,w.canonical,!0,!0,"raster"),D=u.getProjectionData({overscaledTileID:w,applyGlobeMatrix:!0,applyTerrainMatrix:!0});p.draw(e,r.TRIANGLES,_,yr.disabled,Lr.disabled,hr.backCCW,null,P,D,"$clipping",A.vertexBuffer,A.indexBuffer,A.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new yr({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){const r=this.context.gl;return new yr({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const r=this.context.gl,l=e.sort((_,x)=>x.overscaledZ-_.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const _={};for(let x=0;x<p;x++)_[x+u]=new yr({func:r.GEQUAL,mask:255},x+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=p,[_,l]}return[{[u]:yr.disabled},l]}stencilConfigForOverlapTwoPass(e){const r=this.context.gl,l=e.sort((_,x)=>x.overscaledZ-_.overscaledZ),u=l[l.length-1].overscaledZ,p=l[0].overscaledZ-u+1;if(this.clearStencil(),p>1){const _={},x={};for(let w=0;w<p;w++)_[w+u]=new yr({func:r.GREATER,mask:255},p+1+w,255,r.KEEP,r.KEEP,r.REPLACE),x[w+u]=new yr({func:r.GREATER,mask:255},1+w,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID=2*p+1,[_,x,l]}return this.nextStencilID=3,[{[u]:new yr({func:r.GREATER,mask:255},2,255,r.KEEP,r.KEEP,r.REPLACE)},{[u]:new yr({func:r.GREATER,mask:255},1,255,r.KEEP,r.KEEP,r.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Lr([e.CONSTANT_COLOR,e.ONE],new h.b6(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Lr.unblended:Lr.alphaBlended}getDepthModeForSublayer(e,r,l){if(!this.opaquePassEnabledForLayer())return Qt.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Qt(l||this.context.gl.LEQUAL,r,[u,u])}getDepthModeFor3D(){return new Qt(this.context.gl.LEQUAL,Qt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){var l,u;this.style=e,this.options=r,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ze.now()),this.imageManager.beginFrame();const p=this.style._order,_=this.style.sourceCaches,x={},w={},P={},A={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const O in _){const $=_[O];$.used&&$.prepare(this.context),x[O]=$.getVisibleCoordinates(!1),w[O]=x[O].slice().reverse(),P[O]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let O=0;O<p.length;O++)if(this.style._layers[p[O]].is3D()){this.opaquePassCutoff=O;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const O of p){const $=this.style._layers[O];if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const U=w[$.source];($.type==="custom"||U.length)&&this.renderLayer(this,_[$.source],$,U,A)}if((u=this.style.projection)===null||u===void 0||u.updateGPUdependent({context:this.context,useProgram:O=>this.useProgram(O)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?h.b6.black:h.b6.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(O,$){const U=O.context,Q=U.gl,Y=((pe,se,be)=>{const we=Math.cos(se.rollInRadians),Fe=Math.sin(se.rollInRadians),je=cn(se),Oe=se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:pe.properties.get("sky-color"),u_horizon_color:pe.properties.get("horizon-color"),u_horizon:[(se.width/2-je*Fe)*be,(se.height/2+je*we)*be],u_horizon_normal:[-Fe,we],u_sky_horizon_blend:pe.properties.get("sky-horizon-blend")*se.height/2*be,u_sky_blend:Oe}})($,O.style.map.transform,O.pixelRatio),J=new Qt(Q.LEQUAL,Qt.ReadWrite,[0,1]),re=yr.disabled,le=O.colorModeForRenderPass(),ue=O.useProgram("sky"),de=fc(U,$);ue.draw(U,Q.TRIANGLES,J,re,le,hr.disabled,Y,null,void 0,"sky",de.vertexBuffer,de.indexBuffer,de.segments)}(this,this.style.sky),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const O=this.style._layers[p[this.currentLayer]],$=_[O.source],U=x[O.source];this._renderTileClippingMasks(O,U,!1),this.renderLayer(this,$,O,U,A)}this.renderPass="translucent";let D=!1;for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const O=this.style._layers[p[this.currentLayer]],$=_[O.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(O,A))continue;this.opaquePassEnabledForLayer()||D||(D=!0,A.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const U=(O.type==="symbol"?P:w)[O.source];this._renderTileClippingMasks(O,x[O.source],!1),this.renderLayer(this,$,O,U,A)}if(A.isRenderingGlobe&&function(O,$,U){const Q=O.context,Y=Q.gl,J=O.useProgram("atmosphere"),re=new Qt(Y.LEQUAL,Qt.ReadOnly,[0,1]),le=O.transform,ue=function(Oe,lt){const Qe=Oe.properties.get("position"),He=[-Qe.x,-Qe.y,-Qe.z],Pt=h.as(new Float64Array(16));return Oe.properties.get("anchor")==="map"&&(h.aZ(Pt,Pt,lt.rollInRadians),h.a_(Pt,Pt,-lt.pitchInRadians),h.aZ(Pt,Pt,lt.bearingInRadians),h.a_(Pt,Pt,lt.center.lat*Math.PI/180),h.bl(Pt,Pt,-lt.center.lng*Math.PI/180)),h.bU(He,He,Pt),He}(U,O.transform),de=le.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),pe=$.properties.get("atmosphere-blend")*de.projectionTransition;if(pe===0)return;const se=pn(le.worldSize,le.center.lat),be=le.inverseProjectionMatrix,we=new Float64Array(4);we[3]=1,h.ao(we,we,le.modelViewProjectionMatrix),we[0]/=we[3],we[1]/=we[3],we[2]/=we[3],we[3]=1,h.ao(we,we,be),we[0]/=we[3],we[1]/=we[3],we[2]/=we[3],we[3]=1;const Fe=((Oe,lt,Qe,He,Pt)=>({u_sun_pos:Oe,u_atmosphere_blend:lt,u_globe_position:Qe,u_globe_radius:He,u_inv_proj_matrix:Pt}))(ue,pe,[we[0],we[1],we[2]],se,be),je=fc(Q,$);J.draw(Q,Y.TRIANGLES,re,yr.disabled,Lr.alphaBlended,hr.disabled,Fe,null,null,"atmosphere",je.vertexBuffer,je.indexBuffer,je.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const O=function($,U){let Q=null;const Y=Object.values($._layers).flatMap(ue=>ue.source&&!ue.isHidden(U)?[$.sourceCaches[ue.source]]:[]),J=Y.filter(ue=>ue.getSource().type==="vector"),re=Y.filter(ue=>ue.getSource().type!=="vector"),le=ue=>{(!Q||Q.getSource().maxzoom<ue.getSource().maxzoom)&&(Q=ue)};return J.forEach(ue=>le(ue)),Q||re.forEach(ue=>le(ue)),Q}(this.style,this.transform.zoom);O&&function($,U,Q){for(let Y=0;Y<Q.length;Y++)rh($,U,Q[Y])}(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const $=O.transform.padding;Zo(O,O.transform.height-($.top||0),3,Ga),Zo(O,$.bottom||0,3,zi),_a(O,$.left||0,3,Cs),_a(O,O.transform.width-($.right||0),3,Es);const U=O.transform.centerPoint;(function(Q,Y,J,re){ya(Q,Y-1,J-10,2,20,re),ya(Q,Y-10,J-1,20,2,re)})(O,U.x,O.transform.height-U.y,lu)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const r=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let u=this.terrainFacilitator.dirty;u||(u=e?!h.bX(r,l):!h.bY(r,l)),u||(u=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),u&&(h.bZ(r,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(p,_){const x=p.context,w=x.gl,P=p.transform,A=Lr.unblended,D=new Qt(w.LEQUAL,Qt.ReadWrite,[0,1]),O=_.sourceCache.getRenderableTiles(),$=p.useProgram("terrainDepth");x.bindFramebuffer.set(_.getFramebuffer("depth").framebuffer),x.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),x.clear({color:h.b6.transparent,depth:1});for(const U of O){const Q=_.getTerrainMesh(U.tileID),Y=_.getTerrainData(U.tileID),J=P.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:_.getMeshFrameDelta(P.zoom)};$.draw(x,w.TRIANGLES,D,yr.disabled,A,hr.backCCW,re,Y,J,"terrain",Q.vertexBuffer,Q.indexBuffer,Q.segments)}x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain),function(p,_){const x=p.context,w=x.gl,P=p.transform,A=Lr.unblended,D=new Qt(w.LEQUAL,Qt.ReadWrite,[0,1]),O=_.getCoordsTexture(),$=_.sourceCache.getRenderableTiles(),U=p.useProgram("terrainCoords");x.bindFramebuffer.set(_.getFramebuffer("coords").framebuffer),x.viewport.set([0,0,p.width/devicePixelRatio,p.height/devicePixelRatio]),x.clear({color:h.b6.transparent,depth:1}),_.coordsIndex=[];for(const Q of $){const Y=_.getTerrainMesh(Q.tileID),J=_.getTerrainData(Q.tileID);x.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,O.texture);const re={u_terrain_coords_id:(255-_.coordsIndex.length)/255,u_texture:0,u_ele_delta:_.getMeshFrameDelta(P.zoom)},le=P.getProjectionData({overscaledTileID:Q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,w.TRIANGLES,D,yr.disabled,A,hr.backCCW,re,J,le,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments),_.coordsIndex.push(Q.tileID.key)}x.bindFramebuffer.set(null),x.viewport.set([0,0,p.width,p.height])}(this,this.style.map.terrain))}renderLayer(e,r,l,u,p){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(u||[]).length)&&(this.id=l.id,h.b_(l)?function(_,x,w,P,A,D){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:O}=D,$=yr.disabled,U=_.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Q,Y,J,re,le,ue,de,pe,se){const be=Y.transform,we=Y.style.map.terrain,Fe=le==="map",je=ue==="map";for(const Oe of Q){const lt=re.getTile(Oe),Qe=lt.getBucket(J);if(!Qe||!Qe.text||!Qe.text.segments.get().length)continue;const He=h.af(Qe.textSizeData,be.zoom),Pt=h.av(lt,1,Y.transform.zoom),Rt=Pe(Fe,Y.transform,Pt),nr=J.layout.get("icon-text-fit")!=="none"&&Qe.hasIconData();if(He){const pr=Math.pow(2,be.zoom-lt.tileID.overscaledZ),Pr=we?(Ur,Fr)=>we.getElevation(Oe,Ur,Fr):null;da(Qe,Fe,je,se,be,Rt,pr,He,nr,h.aw(be,lt,de,pe),Oe.toUnwrapped(),Pr)}}}(P,_,w,x,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),A),w.paint.get("icon-opacity").constantOr(1)!==0&&pc(_,x,w,P,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),$,U,O),w.paint.get("text-opacity").constantOr(1)!==0&&pc(_,x,w,P,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),$,U,O),x.map.showCollisionBoxes&&(Ss(_,x,w,P,!0),Ss(_,x,w,P,!1))}(e,r,l,u,this.style.placement.variableOffsets,p):h.b$(l)?function(_,x,w,P,A){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,O=w.paint.get("circle-opacity"),$=w.paint.get("circle-stroke-width"),U=w.paint.get("circle-stroke-opacity"),Q=!w.layout.get("circle-sort-key").isConstant();if(O.constantOr(1)===0&&($.constantOr(1)===0||U.constantOr(1)===0))return;const Y=_.context,J=Y.gl,re=_.transform,le=_.getDepthModeForSublayer(0,Qt.ReadOnly),ue=yr.disabled,de=_.colorModeForRenderPass(),pe=[],se=re.getCircleRadiusCorrection();for(let be=0;be<P.length;be++){const we=P[be],Fe=x.getTile(we),je=Fe.getBucket(w);if(!je)continue;const Oe=w.paint.get("circle-translate"),lt=w.paint.get("circle-translate-anchor"),Qe=h.aw(re,Fe,Oe,lt),He=je.programConfigurations.get(w.id),Pt=_.useProgram("circle",He),Rt=je.layoutVertexBuffer,nr=je.indexBuffer,pr=_.style.map.terrain&&_.style.map.terrain.getTerrainData(we),Pr={programConfiguration:He,program:Pt,layoutVertexBuffer:Rt,indexBuffer:nr,uniformValues:qc(_,Fe,w,Qe,se),terrainData:pr,projectionData:re.getProjectionData({overscaledTileID:we,applyGlobeMatrix:!D,applyTerrainMatrix:!0})};if(Q){const Ur=je.segments.get();for(const Fr of Ur)pe.push({segments:new h.aF([Fr]),sortKey:Fr.sortKey,state:Pr})}else pe.push({segments:je.segments,sortKey:0,state:Pr})}Q&&pe.sort((be,we)=>be.sortKey-we.sortKey);for(const be of pe){const{programConfiguration:we,program:Fe,layoutVertexBuffer:je,indexBuffer:Oe,uniformValues:lt,terrainData:Qe,projectionData:He}=be.state;Fe.draw(Y,J.TRIANGLES,le,ue,de,hr.backCCW,lt,Qe,He,w.id,je,Oe,be.segments,w.paint,_.transform.zoom,we)}}(e,r,l,u,p):h.c0(l)?function(_,x,w,P,A){if(w.paint.get("heatmap-opacity")===0)return;const D=_.context,{isRenderingToTexture:O,isRenderingGlobe:$}=A;if(_.style.map.terrain){for(const U of P){const Q=x.getTile(U);x.hasRenderableParent(U)||(_.renderPass==="offscreen"?Hr(_,Q,w,U,$):_.renderPass==="translucent"&&au(_,w,U,O,$))}D.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?function(U,Q,Y,J){const re=U.context,le=re.gl,ue=U.transform,de=yr.disabled,pe=new Lr([le.ONE,le.ONE],h.b6.transparent,[!0,!0,!0,!0]);(function(se,be,we){const Fe=se.gl;se.activeTexture.set(Fe.TEXTURE1),se.viewport.set([0,0,be.width/4,be.height/4]);let je=we.heatmapFbos.get(h.bR);je?(Fe.bindTexture(Fe.TEXTURE_2D,je.colorAttachment.get()),se.bindFramebuffer.set(je.framebuffer)):(je=pa(se,be.width/4,be.height/4),we.heatmapFbos.set(h.bR,je))})(re,U,Y),re.clear({color:h.b6.transparent});for(let se=0;se<J.length;se++){const be=J[se];if(Q.hasRenderableParent(be))continue;const we=Q.getTile(be),Fe=we.getBucket(Y);if(!Fe)continue;const je=Fe.programConfigurations.get(Y.id),Oe=U.useProgram("heatmap",je),lt=ue.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Qe=ue.getCircleRadiusCorrection();Oe.draw(re,le.TRIANGLES,Qt.disabled,de,pe,hr.backCCW,Qu(we,ue.zoom,Y.paint.get("heatmap-intensity"),Qe),null,lt,Y.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,Y.paint,ue.zoom,je)}re.viewport.set([0,0,U.width,U.height])}(_,x,w,P):_.renderPass==="translucent"&&function(U,Q){const Y=U.context,J=Y.gl;Y.setColorMode(U.colorModeForRenderPass());const re=Q.heatmapFbos.get(h.bR);re&&(Y.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,re.colorAttachment.get()),Y.activeTexture.set(J.TEXTURE1),fa(Y,Q).bind(J.LINEAR,J.CLAMP_TO_EDGE),U.useProgram("heatmapTexture").draw(Y,J.TRIANGLES,Qt.disabled,yr.disabled,U.colorModeForRenderPass(),hr.disabled,Ju(U,Q,0,1),null,null,Q.id,U.viewportBuffer,U.quadTriangleIndexBuffer,U.viewportSegments,Q.paint,U.transform.zoom))}(_,w)}(e,r,l,u,p):h.c1(l)?function(_,x,w,P,A){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,O=w.paint.get("line-opacity"),$=w.paint.get("line-width");if(O.constantOr(1)===0||$.constantOr(1)===0)return;const U=_.getDepthModeForSublayer(0,Qt.ReadOnly),Q=_.colorModeForRenderPass(),Y=w.paint.get("line-dasharray"),J=w.paint.get("line-pattern"),re=J.constantOr(1),le=w.paint.get("line-gradient"),ue=w.getCrossfadeParameters(),de=re?"linePattern":Y?"lineSDF":le?"lineGradient":"line",pe=_.context,se=pe.gl,be=_.transform;let we=!0;for(const Fe of P){const je=x.getTile(Fe);if(re&&!je.patternsLoaded())continue;const Oe=je.getBucket(w);if(!Oe)continue;const lt=Oe.programConfigurations.get(w.id),Qe=_.context.program.get(),He=_.useProgram(de,lt),Pt=we||He.program!==Qe,Rt=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Fe),nr=J.constantOr(null);if(nr&&je.imageAtlas){const wr=je.imageAtlas,zr=wr.patternPositions[nr.to.toString()],yn=wr.patternPositions[nr.from.toString()];zr&&yn&&lt.setConstantPatternPositions(zr,yn)}const pr=be.getProjectionData({overscaledTileID:Fe,applyGlobeMatrix:!D,applyTerrainMatrix:!0}),Pr=be.getPixelScale(),Ur=re?xs(_,je,w,Pr,ue):Y?Qs(_,je,w,Pr,Y,ue):le?Gh(_,je,w,Pr,Oe.lineClipsArray.length):Va(_,je,w,Pr);if(re)pe.activeTexture.set(se.TEXTURE0),je.imageAtlasTexture.bind(se.LINEAR,se.CLAMP_TO_EDGE),lt.updatePaintBuffers(ue);else if(Y&&(Pt||_.lineAtlas.dirty))pe.activeTexture.set(se.TEXTURE0),_.lineAtlas.bind(pe);else if(le){const wr=Oe.gradients[w.id];let zr=wr.texture;if(w.gradientVersion!==wr.version){let yn=256;if(w.stepInterpolant){const vn=x.getSource().maxzoom,an=Fe.canonical.z===vn?Math.ceil(1<<_.transform.maxZoom-Fe.canonical.z):1;yn=h.ad(h.bS(Oe.maxLineLength/h.Z*1024*an),256,pe.maxTextureSize)}wr.gradient=h.bT({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:yn,image:wr.gradient||void 0,clips:Oe.lineClipsArray}),wr.texture?wr.texture.update(wr.gradient):wr.texture=new Lt(pe,wr.gradient,se.RGBA),wr.version=w.gradientVersion,zr=wr.texture}pe.activeTexture.set(se.TEXTURE0),zr.bind(w.stepInterpolant?se.NEAREST:se.LINEAR,se.CLAMP_TO_EDGE)}let Fr;if(D){const[wr]=_.getStencilConfigForOverlapAndUpdateStencilID(P);Fr=wr[Fe.overscaledZ]}else Fr=_.stencilModeForClipping(Fe);He.draw(pe,se.TRIANGLES,U,Fr,Q,hr.disabled,Ur,Rt,pr,w.id,Oe.layoutVertexBuffer,Oe.indexBuffer,Oe.segments,w.paint,_.transform.zoom,lt,Oe.layoutVertexBuffer2),we=!1}}(e,r,l,u,p):h.c2(l)?function(_,x,w,P,A){const D=w.paint.get("fill-color"),O=w.paint.get("fill-opacity");if(O.constantOr(1)===0)return;const{isRenderingToTexture:$}=A,U=_.colorModeForRenderPass(),Q=w.paint.get("fill-pattern"),Y=_.opaquePassEnabledForLayer()&&!Q.constantOr(1)&&D.constantOr(h.b6.transparent).a===1&&O.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===Y){const J=_.getDepthModeForSublayer(1,_.renderPass==="opaque"?Qt.ReadWrite:Qt.ReadOnly);al(_,x,w,P,J,U,!1,$)}if(_.renderPass==="translucent"&&w.paint.get("fill-antialias")){const J=_.getDepthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Qt.ReadOnly);al(_,x,w,P,J,U,!0,$)}}(e,r,l,u,p):h.c3(l)?function(_,x,w,P,A){const D=w.paint.get("fill-extrusion-opacity");if(D===0)return;const{isRenderingToTexture:O}=A;if(_.renderPass==="translucent"){const $=new Qt(_.context.gl.LEQUAL,Qt.ReadWrite,_.depthRangeFor3D);if(D!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))Eo(_,x,w,P,$,yr.disabled,Lr.disabled,O),Eo(_,x,w,P,$,_.stencilModeFor3D(),_.colorModeForRenderPass(),O);else{const U=_.colorModeForRenderPass();Eo(_,x,w,P,$,yr.disabled,U,O)}}}(e,r,l,u,p):h.c4(l)?function(_,x,w,P,A){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const{isRenderingToTexture:D}=A,O=_.context,$=_.style.projection.useSubdivision,U=_.getDepthModeForSublayer(0,Qt.ReadOnly),Q=_.colorModeForRenderPass();if(_.renderPass==="offscreen")(function(Y,J,re,le,ue,de,pe){const se=Y.context,be=se.gl;for(const we of re){const Fe=J.getTile(we),je=Fe.dem;if(!je||!je.data||!Fe.needsHillshadePrepare)continue;const Oe=je.dim,lt=je.stride,Qe=je.getPixels();if(se.activeTexture.set(be.TEXTURE1),se.pixelStoreUnpackPremultiplyAlpha.set(!1),Fe.demTexture=Fe.demTexture||Y.getTileTexture(lt),Fe.demTexture){const Pt=Fe.demTexture;Pt.update(Qe,{premultiply:!1}),Pt.bind(be.NEAREST,be.CLAMP_TO_EDGE)}else Fe.demTexture=new Lt(se,Qe,be.RGBA,{premultiply:!1}),Fe.demTexture.bind(be.NEAREST,be.CLAMP_TO_EDGE);se.activeTexture.set(be.TEXTURE0);let He=Fe.fbo;if(!He){const Pt=new Lt(se,{width:Oe,height:Oe,data:null},be.RGBA);Pt.bind(be.LINEAR,be.CLAMP_TO_EDGE),He=Fe.fbo=se.createFramebuffer(Oe,Oe,!0,!1),He.colorAttachment.set(Pt.texture)}se.bindFramebuffer.set(He.framebuffer),se.viewport.set([0,0,Oe,Oe]),Y.useProgram("hillshadePrepare").draw(se,be.TRIANGLES,ue,de,pe,hr.disabled,Hc(Fe.tileID,je),null,null,le.id,Y.rasterBoundsBuffer,Y.quadTriangleIndexBuffer,Y.rasterBoundsSegments),Fe.needsHillshadePrepare=!1}})(_,x,P,w,U,yr.disabled,Q),O.viewport.set([0,0,_.width,_.height]);else if(_.renderPass==="translucent")if($){const[Y,J,re]=_.stencilConfigForOverlapTwoPass(P);ma(_,x,w,re,Y,U,Q,!1,D),ma(_,x,w,re,J,U,Q,!0,D)}else{const[Y,J]=_.getStencilConfigForOverlapAndUpdateStencilID(P);ma(_,x,w,J,Y,U,Q,!1,D)}}(e,r,l,u,p):h.c5(l)?function(_,x,w,P,A){if(_.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!P.length)return;const{isRenderingToTexture:D}=A,O=x.getSource(),$=_.style.projection.useSubdivision;if(O instanceof zn)Ps(_,x,w,P,null,!1,!1,O.tileCoords,O.flippedWindingOrder,D);else if($){const[U,Q,Y]=_.stencilConfigForOverlapTwoPass(P);Ps(_,x,w,Y,U,!1,!0,ga,!1,D),Ps(_,x,w,Y,Q,!0,!0,ga,!1,D)}else{const[U,Q]=_.getStencilConfigForOverlapAndUpdateStencilID(P);Ps(_,x,w,Q,U,!1,!0,ga,!1,D)}}(e,r,l,u,p):h.c6(l)?function(_,x,w,P,A){const D=w.paint.get("background-color"),O=w.paint.get("background-opacity");if(O===0)return;const{isRenderingToTexture:$}=A,U=_.context,Q=U.gl,Y=_.style.projection,J=_.transform,re=J.tileSize,le=w.paint.get("background-pattern");if(_.isPatternMissing(le))return;const ue=!le&&D.a===1&&O===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==ue)return;const de=yr.disabled,pe=_.getDepthModeForSublayer(0,ue==="opaque"?Qt.ReadWrite:Qt.ReadOnly),se=_.colorModeForRenderPass(),be=_.useProgram(le?"backgroundPattern":"background"),we=P||xe(J,{tileSize:re,terrain:_.style.map.terrain});le&&(U.activeTexture.set(Q.TEXTURE0),_.imageManager.bind(_.context));const Fe=w.getCrossfadeParameters();for(const je of we){const Oe=J.getProjectionData({overscaledTileID:je,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),lt=le?rc(O,_,le,{tileID:je,tileSize:re},Fe):$o(O,D),Qe=_.style.map.terrain&&_.style.map.terrain.getTerrainData(je),He=Y.getMeshFromTileID(U,je.canonical,!1,!0,"raster");be.draw(U,Q.TRIANGLES,pe,de,se,hr.backCCW,lt,Qe,Oe,w.id,He.vertexBuffer,He.indexBuffer,He.segments)}}(e,0,l,u,p):h.c7(l)&&function(_,x,w,P){const{isRenderingGlobe:A}=P,D=_.context,O=w.implementation,$=_.style.projection,U=_.transform,Q=U.getProjectionDataForCustomLayer(A),Y={farZ:U.farZ,nearZ:U.nearZ,fov:U.fov*Math.PI/180,modelViewProjectionMatrix:U.modelViewProjectionMatrix,projectionMatrix:U.projectionMatrix,shaderData:{variantName:$.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${$.shaderPreludeCode.vertexSource}`,define:$.shaderDefine},defaultProjectionData:Q},J=O.renderingMode?O.renderingMode:"2d";if(_.renderPass==="offscreen"){const re=O.prerender;re&&(_.setCustomLayerDefaults(),D.setColorMode(_.colorModeForRenderPass()),re.call(O,D.gl,Y),D.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),D.setColorMode(_.colorModeForRenderPass()),D.setStencilMode(yr.disabled);const re=J==="3d"?_.getDepthModeFor3D():_.getDepthModeForSublayer(0,Qt.ReadOnly);D.setDepthMode(re),O.render(D.gl,Y),D.setDirty(),_.setBaseState(),D.bindFramebuffer.set(null)}}(e,0,l,p))}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const r=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!r||!l}useProgram(e,r,l=!1){this.cache=this.cache||{};const u=!!this.style.map.terrain,p=this.style.projection,_=e+(r?r.cacheKey:"")+`/${l?jl:p.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(u?"/terrain":"");return this.cache[_]||(this.cache[_]=new Zh(this.context,lo[e],r,Xl[e],this._showOverdrawInspector,u,l?lo.projectionMercator:p.shaderPreludeCode,l?ur:p.shaderDefine)),this.cache[_]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Lt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:r}=this.context.gl;return this.width!==e||this.height!==r}}function sl(d,e){let r,l=!1,u=null,p=null;const _=()=>{u=null,l&&(d.apply(p,r),u=setTimeout(_,e),l=!1)};return(...x)=>(l=!0,p=this,r=x,u||_(),u)}class ai{constructor(e){this._getCurrentHash=()=>{const r=window.location.hash.replace("#","");if(this._hashName){let l;return r.split("&").map(u=>u.split("=")).forEach(u=>{u[0]===this._hashName&&(l=u)}),(l&&l[1]||"").split("/")}return r.split("/")},this._onHashChange=()=>{const r=this._getCurrentHash();if(!this._isValidHash(r))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(r[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:l,pitch:+(r[4]||0)}),!0},this._updateHashUnthrottled=()=>{const r=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,r)},this._removeHash=()=>{const r=this._getCurrentHash();if(r.length===0)return;const l=r.join("/");let u=l;u.split("&").length>0&&(u=u.split("&")[0]),this._hashName&&(u=`${this._hashName}=${l}`);let p=window.location.hash.replace(u,"");p.startsWith("#&")?p=p.slice(0,1)+p.slice(2):p==="#"&&(p="");let _=window.location.href.replace(/(#.+)?$/,p);_=_.replace("&&","&"),window.history.replaceState(window.history.state,null,_)},this._updateHash=sl(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const r=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,u=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),_=Math.round(r.lng*p)/p,x=Math.round(r.lat*p)/p,w=this._map.getBearing(),P=this._map.getPitch();let A="";if(A+=e?`/${_}/${x}/${l}`:`${l}/${x}/${_}`,(w||P)&&(A+="/"+Math.round(10*w)/10),P&&(A+=`/${Math.round(P)}`),this._hashName){const D=this._hashName;let O=!1;const $=window.location.hash.slice(1).split("&").map(U=>{const Q=U.split("=")[0];return Q===D?(O=!0,`${Q}=${A}`):U}).filter(U=>U);return O||$.push(`${D}=${A}`),`#${$.join("&")}`}return`#${A}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new h.Q(+e[2],+e[1])}catch{return!1}const r=+e[0],l=+(e[3]||0),u=+(e[4]||0);return r>=this._map.getMinZoom()&&r<=this._map.getMaxZoom()&&l>=-180&&l<=180&&u>=this._map.getMinPitch()&&u<=this._map.getMaxPitch()}}const qa={linearity:.3,easing:h.c8(0,0,.3,1)},Wa=h.e({deceleration:2500,maxSpeed:1400},qa),co=h.e({deceleration:20,maxSpeed:1400},qa),Is=h.e({deceleration:1e3,maxSpeed:360},qa),Io=h.e({deceleration:1e3,maxSpeed:90},qa),cu=h.e({deceleration:1e3,maxSpeed:360},qa);class ih{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ze.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=ze.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)r.zoom+=p.zoomDelta||0,r.bearing+=p.bearingDelta||0,r.pitch+=p.pitchDelta||0,r.roll+=p.rollDelta||0,p.panDelta&&r.pan._add(p.panDelta),p.around&&(r.around=p.around),p.pinchAround&&(r.pinchAround=p.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const p=Ki(r.pan.mag(),l,h.e({},Wa,e||{})),_=r.pan.mult(p.amount/r.pan.mag()),x=this._map.cameraHelper.handlePanInertia(_,this._map.transform);u.center=x.easingCenter,u.offset=x.easingOffset,va(u,p)}if(r.zoom){const p=Ki(r.zoom,l,co);u.zoom=this._map.transform.zoom+p.amount,va(u,p)}if(r.bearing){const p=Ki(r.bearing,l,Is);u.bearing=this._map.transform.bearing+h.ad(p.amount,-179,179),va(u,p)}if(r.pitch){const p=Ki(r.pitch,l,Io);u.pitch=this._map.transform.pitch+p.amount,va(u,p)}if(r.roll){const p=Ki(r.roll,l,cu);u.roll=this._map.transform.roll+h.ad(p.amount,-179,179),va(u,p)}if(u.zoom||u.bearing){const p=r.pinchAround===void 0?r.around:r.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),h.e(u,{noMoveStart:!0})}}function va(d,e){(!d.duration||d.duration<e.duration)&&(d.duration=e.duration,d.easing=e.easing)}function Ki(d,e,r){const{maxSpeed:l,linearity:u,deceleration:p}=r,_=h.ad(d*u/(e/1e3),-l,l),x=Math.abs(_)/(p*u);return{easing:r.easing,duration:1e3*x,amount:_*(x/2)}}class Vr extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l,u={}){const p=ce.mousePos(r.getCanvas(),l),_=r.unproject(p);super(e,h.e({point:p,lngLat:_,originalEvent:l},u)),this._defaultPrevented=!1,this.target=r}}class fn extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){const u=e==="touchend"?l.changedTouches:l.touches,p=ce.touchPos(r.getCanvasContainer(),u),_=p.map(w=>r.unproject(w)),x=p.reduce((w,P,A,D)=>w.add(P.div(D.length)),new h.P(0,0));super(e,{points:p,point:x,lngLats:_,lngLat:r.unproject(x),originalEvent:l}),this._defaultPrevented=!1}}class Ms extends h.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class Yi{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Ms(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new Vr(e.type,this._map,e))}mouseup(e){this._map.fire(new Vr(e.type,this._map,e))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||this._map.fire(new Vr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Vr(e.type,this._map,e))}mouseover(e){this._map.fire(new Vr(e.type,this._map,e))}mouseout(e){this._map.fire(new Vr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new fn(e.type,this._map,e))}touchmove(e){this._map.fire(new fn(e.type,this._map,e))}touchend(e){this._map.fire(new fn(e.type,this._map,e))}touchcancel(e){this._map.fire(new fn(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ho{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Vr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Vr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Vr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qi{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(h.P.convert(e),this._map.terrain)}}class qr{constructor(e,r){this._map=e,this._tr=new Qi(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(ce.disableDrag(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const l=r;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const u=this._startPos;this._lastPos=l,this._box||(this._box=ce.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const p=Math.min(u.x,l.x),_=Math.max(u.x,l.x),x=Math.min(u.y,l.y),w=Math.max(u.y,l.y);ce.setTransform(this._box,`translate(${p}px,${x}px)`),this._box.style.width=_-p+"px",this._box.style.height=w-x+"px"}mouseupWindow(e,r){if(!this._active||e.button!==0)return;const l=this._startPos,u=r;if(this.reset(),ce.suppressClick(),l.x!==u.x||l.y!==u.y)return this._map.fire(new h.l("boxzoomend",{originalEvent:e})),{cameraAnimation:p=>p.fitScreenCoordinates(l,u,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ce.remove(this._box),this._box=null),ce.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new h.l(e,{originalEvent:r}))}}function Or(d,e){if(d.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${d.length}, points ${e.length}`);const r={};for(let l=0;l<d.length;l++)r[d[l].identifier]=e[l];return r}class xa{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,r,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=function(u){const p=new h.P(0,0);for(const _ of u)p._add(_);return p.div(u.length)}(r),this.touches=Or(l,r)))}touchmove(e,r,l){if(this.aborted||!this.centroid)return;const u=Or(l,r);for(const p in this.touches){const _=u[p];(!_||_.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(e,r,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class mn{constructor(e){this.singleTap=new xa(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,r,l){this.singleTap.touchstart(e,r,l)}touchmove(e,r,l){this.singleTap.touchmove(e,r,l)}touchend(e,r,l){const u=this.singleTap.touchend(e,r,l);if(u){const p=e.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(u)<30;if(p&&_||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class En{constructor(e){this._tr=new Qi(e),this._zoomIn=new mn({numTouches:1,numTaps:2}),this._zoomOut=new mn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,l){this._zoomIn.touchstart(e,r,l),this._zoomOut.touchstart(e,r,l)}touchmove(e,r,l){this._zoomIn.touchmove(e,r,l),this._zoomOut.touchmove(e,r,l)}touchend(e,r,l){const u=this._zoomIn.touchend(e,r,l),p=this._zoomOut.touchend(e,r,l),_=this._tr;return u?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(u)},{originalEvent:e})}):p?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:x=>x.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(p)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const r=this._moveFunction(...e);if(r.bearingDelta||r.pitchDelta||r.rollDelta||r.around||r.panDelta)return this._active=!0,r}dragStart(e,r){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(r)?r[0]:r,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,r){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const u=Array.isArray(r)?r[0]:r;return!this._moved&&u.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=u,this._move(l,u))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ce.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const ft={0:1,2:2};class _n{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const r=ce.mouseButton(e);this._eventButton=r}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(r,l){const u=ft[l];return r.buttons===void 0||(r.buttons&u)!==u}(e,this._eventButton)}isValidEndEvent(e){return ce.mouseButton(e)===this._eventButton}}class ks{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class mc{constructor(e=new _n({checkCorrectEvent:()=>!0}),r=new ks){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=r}_executeRelevantHandler(e,r,l){return e instanceof MouseEvent?r(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.startMove(r),r=>this.oneFingerTouchMoveStateManager.startMove(r))}endMove(e){this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.endMove(r),r=>this.oneFingerTouchMoveStateManager.endMove(r))}isValidStartEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidStartEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidStartEvent(r))}isValidMoveEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidMoveEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(r))}isValidEndEvent(e){return this._executeRelevantHandler(e,r=>this.mouseMoveStateManager.isValidEndEvent(r),r=>this.oneFingerTouchMoveStateManager.isValidEndEvent(r))}}const Go=d=>{d.mousedown=d.dragStart,d.mousemoveWindow=d.dragMove,d.mouseup=d.dragEnd,d.contextmenu=e=>{e.preventDefault()}};class ba{constructor(e,r){this._clickTolerance=e.clickTolerance||1,this._map=r,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,r,l){return this._calculateTransform(e,r,l)}touchmove(e,r,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,r,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,r,l){this._calculateTransform(e,r,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,l){l.length>0&&(this._active=!0);const u=Or(l,r),p=new h.P(0,0),_=new h.P(0,0);let x=0;for(const P in u){const A=u[P],D=this._touches[P];D&&(p._add(A),_._add(A.sub(D)),x++,u[P]=A)}if(this._touches=u,this._shouldBePrevented(x)||!_.mag())return;const w=_.div(x);return this._sum._add(w),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(x),panDelta:w}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ll{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,r,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,l){if(!this._firstTwoTouches)return;e.preventDefault();const[u,p]=this._firstTwoTouches,_=Yt(l,r,u),x=Yt(l,r,p);if(!_||!x)return;const w=this._aroundCenter?null:_.add(x).div(2);return this._move([_,x],w,e)}touchend(e,r,l){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,_=Yt(l,r,u),x=Yt(l,r,p);_&&x||(this._active&&ce.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Yt(d,e,r){for(let l=0;l<d.length;l++)if(d[l].identifier===r)return e[l]}function Ha(d,e){return Math.log(d/e)/Math.LN2}class hu extends ll{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ha(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ha(this._distance,l),pinchAround:r}}}function ul(d,e){return 180*d.angleWith(e)/Math.PI}class oh extends ll{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r,l){const u=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ul(this._vector,u),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,l=ul(e,this._startVector);return Math.abs(l)<r}}function Mo(d){return Math.abs(d.y)>Math.abs(d.x)}class wa extends ll{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,r,l){super.touchstart(e,r,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Mo(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const u=e[0].sub(this._lastPoints[0]),p=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(u,p,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(u.y+p.y)/2*-.5}):void 0}gestureBeginsVertically(e,r,l){if(this._valid!==void 0)return this._valid;const u=e.mag()>=2,p=r.mag()>=2;if(!u&&!p)return;if(!u||!p)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const _=e.y>0==r.y>0;return Mo(e)&&Mo(r)&&_}}const Ta={panStep:100,bearingStep:15,pitchStep:10};class As{constructor(e){this._tr=new Qi(e);const r=Ta;this._panStep=r.panStep,this._bearingStep=r.bearingStep,this._pitchStep=r.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,l=0,u=0,p=0,_=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),p=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),p=1);break;case 38:e.shiftKey?u=1:(e.preventDefault(),_=-1);break;case 40:e.shiftKey?u=-1:(e.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(l=0,u=0),{cameraAnimation:x=>{const w=this._tr;x.easeTo({duration:300,easeId:"keyboardHandler",easing:du,zoom:r?Math.round(w.zoom)+r*(e.shiftKey?2:1):w.zoom,bearing:w.bearing+l*this._bearingStep,pitch:w.pitch+u*this._pitchStep,offset:[-p*this._panStep,-_*this._panStep],center:w.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function du(d){return d*(2-d)}const vi=4.000244140625;class Ri{constructor(e,r){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Qi(e),this._triggerRenderFrame=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let r=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=ze.now(),u=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,r!==0&&r%vi==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=ce.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(h.Q.convert(l.center)):r,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const x=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=x),typeof this._targetZoom=="number"&&(this._targetZoom+=x)}if(this._delta!==0){const x=this._type==="wheel"&&Math.abs(this._delta)>vi?this._wheelZoomRate:this._defaultZoomRate;let w=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&w!==0&&(w=1/w);const P=typeof this._targetZoom!="number"?e.scale:h.aH(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,h.aa(P*w))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const r=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,u=this._easing;let p,_=!1;if(this._type==="wheel"&&l&&u){const x=ze.now()-this._lastWheelEventTime,w=Math.min((x+5)/200,1),P=u(w);p=h.B.number(l,r,P),w<1?this._frameId||(this._frameId=!0):_=!0}else p=r,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=p,{noInertia:!0,needsRenderFrame:!_,zoomDelta:p-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=h.ca;if(this._prevEase){const l=this._prevEase,u=(ze.now()-l.start)/l.duration,p=l.easing(u+.01)-l.easing(u),_=.27/Math.sqrt(p*p+1e-4)*.01,x=Math.sqrt(.0729-_*_);r=h.c8(_,x,.25,1)}return this._prevEase={start:ze.now(),duration:e,easing:r},r}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Sa{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hn{constructor(e){this._tr=new Qi(e),this.reset()}reset(){this._active=!1}dblclick(e,r){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sr{constructor(){this._tap=new mn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,r,l){if(!this._swipePoint)if(this._tapTime){const u=r[0],p=e.timeStamp-this._tapTime<500,_=this._tapPoint.dist(u)<30;p&&_?l.length>0&&(this._swipePoint=u,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,r,l)}touchmove(e,r,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const u=r[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,e.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(e,r,l)}touchend(e,r,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const u=this._tap.touchend(e,r,l);u&&(this._tapTime=e.timeStamp,this._tapPoint=u)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class po{constructor(e,r,l){this._el=e,this._mousePan=r,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class cl{constructor(e,r,l,u){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=r,this._mousePitch=l,this._mouseRoll=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class hl{constructor(e,r,l,u){this._el=e,this._touchZoom=r,this._touchRotate=l,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class dl{constructor(e,r){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=r,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ce.create("div","maplibregl-cooperative-gesture-screen",e);let r=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(r=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),u=document.createElement("div");u.className="maplibregl-desktop-message",u.textContent=r,this._container.appendChild(u);const p=document.createElement("div");p.className="maplibregl-mobile-message",p.textContent=l,this._container.appendChild(p),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ce.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,r){this._enabled&&(this._map.fire(new h.l("cooperativegestureprevented",{gestureType:e,originalEvent:r})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Dn=d=>d.zoom||d.drag||d.roll||d.pitch||d.rotate;class Di extends h.l{}function xr(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta||d.rollDelta}class xi{constructor(e,r){this.handleWindowEvent=u=>{this.handleEvent(u,`${u.type}Window`)},this.handleEvent=(u,p)=>{if(u.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=u.type==="renderFrame"?void 0:u,x={needsRenderFrame:!1},w={},P={},A=u.touches,D=A?this._getMapTouches(A):void 0,O=D?ce.touchPos(this._map.getCanvas(),D):ce.mousePos(this._map.getCanvas(),u);for(const{handlerName:Q,handler:Y,allowed:J}of this._handlers){if(!Y.isEnabled())continue;let re;this._blockedByActive(P,J,Q)?Y.reset():Y[p||u.type]&&(re=Y[p||u.type](u,O,D),this.mergeHandlerResult(x,w,re,Q,_),re&&re.needsRenderFrame&&this._triggerRenderFrame()),(re||Y.isActive())&&(P[Q]=Y)}const $={};for(const Q in this._previousActiveHandlers)P[Q]||($[Q]=_);this._previousActiveHandlers=P,(Object.keys($).length||xr(x))&&(this._changes.push([x,w,$]),this._triggerRenderFrame()),(Object.keys(P).length||xr(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=x;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ih(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(r);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[u,p,_]of this._listeners)ce.addEventListener(u,p,u===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[e,r,l]of this._listeners)ce.removeEventListener(e,r,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const r=this._map,l=r.getCanvasContainer();this._add("mapEvent",new Yi(r,e));const u=r.boxZoom=new qr(r,e);this._add("boxZoom",u),e.interactive&&e.boxZoom&&u.enable();const p=r.cooperativeGestures=new dl(r,e.cooperativeGestures);this._add("cooperativeGestures",p),e.cooperativeGestures&&p.enable();const _=new En(r),x=new Hn(r);r.doubleClickZoom=new Sa(x,_),this._add("tapZoom",_),this._add("clickZoom",x),e.interactive&&e.doubleClickZoom&&r.doubleClickZoom.enable();const w=new Sr;this._add("tapDragZoom",w);const P=r.touchPitch=new wa(r);this._add("touchPitch",P),e.interactive&&e.touchPitch&&r.touchPitch.enable(e.touchPitch);const A=()=>r.project(r.getCenter()),D=function({enable:ue,clickTolerance:de,aroundCenter:pe=!0,minPixelCenterThreshold:se=100,rotateDegreesPerPixelMoved:be=.8},we){const Fe=new _n({checkCorrectEvent:je=>ce.mouseButton(je)===0&&je.ctrlKey||ce.mouseButton(je)===2&&!je.ctrlKey});return new gn({clickTolerance:de,move:(je,Oe)=>{const lt=we();if(pe&&Math.abs(lt.y-je.y)>se)return{bearingDelta:h.c9(new h.P(je.x,Oe.y),Oe,lt)};let Qe=(Oe.x-je.x)*be;return pe&&Oe.y<lt.y&&(Qe=-Qe),{bearingDelta:Qe}},moveStateManager:Fe,enable:ue,assignEvents:Go})}(e,A),O=function({enable:ue,clickTolerance:de,pitchDegreesPerPixelMoved:pe=-.5}){const se=new _n({checkCorrectEvent:be=>ce.mouseButton(be)===0&&be.ctrlKey||ce.mouseButton(be)===2});return new gn({clickTolerance:de,move:(be,we)=>({pitchDelta:(we.y-be.y)*pe}),moveStateManager:se,enable:ue,assignEvents:Go})}(e),$=function({enable:ue,clickTolerance:de,rollDegreesPerPixelMoved:pe=.3},se){const be=new _n({checkCorrectEvent:we=>ce.mouseButton(we)===2&&we.ctrlKey});return new gn({clickTolerance:de,move:(we,Fe)=>{const je=se();let Oe=(Fe.x-we.x)*pe;return Fe.y<je.y&&(Oe=-Oe),{rollDelta:Oe}},moveStateManager:be,enable:ue,assignEvents:Go})}(e,A);r.dragRotate=new cl(e,D,O,$),this._add("mouseRotate",D,["mousePitch"]),this._add("mousePitch",O,["mouseRotate","mouseRoll"]),this._add("mouseRoll",$,["mousePitch"]),e.interactive&&e.dragRotate&&r.dragRotate.enable();const U=function({enable:ue,clickTolerance:de}){const pe=new _n({checkCorrectEvent:se=>ce.mouseButton(se)===0&&!se.ctrlKey});return new gn({clickTolerance:de,move:(se,be)=>({around:be,panDelta:be.sub(se)}),activateOnStart:!0,moveStateManager:pe,enable:ue,assignEvents:Go})}(e),Q=new ba(e,r);r.dragPan=new po(l,U,Q),this._add("mousePan",U),this._add("touchPan",Q,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&r.dragPan.enable(e.dragPan);const Y=new oh,J=new hu;r.touchZoomRotate=new hl(l,J,Y,w),this._add("touchRotate",Y,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&r.touchZoomRotate.enable(e.touchZoomRotate);const re=r.scrollZoom=new Ri(r,()=>this._triggerRenderFrame());this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&r.scrollZoom.enable(e.scrollZoom);const le=r.keyboard=new As(r);this._add("keyboard",le),e.interactive&&e.keyboard&&r.keyboard.enable(),this._add("blockableMapEvent",new ho(r))}_add(e,r,l){this._handlers.push({handlerName:e,handler:r,allowed:l}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Dn(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,r,l){for(const u in e)if(u!==l&&(!r||r.indexOf(u)<0))return!0;return!1}_getMapTouches(e){const r=[];for(const l of e)this._el.contains(l.target)&&r.push(l);return r}mergeHandlerResult(e,r,l,u,p){if(!l)return;h.e(e,l);const _={handlerName:u,originalEvent:l.originalEvent||p};l.zoomDelta!==void 0&&(r.zoom=_),l.panDelta!==void 0&&(r.drag=_),l.rollDelta!==void 0&&(r.roll=_),l.pitchDelta!==void 0&&(r.pitch=_),l.bearingDelta!==void 0&&(r.rotate=_)}_applyChanges(){const e={},r={},l={};for(const[u,p,_]of this._changes)u.panDelta&&(e.panDelta=(e.panDelta||new h.P(0,0))._add(u.panDelta)),u.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+u.pitchDelta),u.rollDelta&&(e.rollDelta=(e.rollDelta||0)+u.rollDelta),u.around!==void 0&&(e.around=u.around),u.pinchAround!==void 0&&(e.pinchAround=u.pinchAround),u.noInertia&&(e.noInertia=u.noInertia),h.e(r,p),h.e(l,_);this._updateMapTransform(e,r,l),this._changes=[]}_updateMapTransform(e,r,l){const u=this._map,p=u._getTransformForUpdate(),_=u.terrain;if(!(xr(e)||_&&this._terrainMovement))return this._fireEvents(r,l,!0);u._stop(!0);let{panDelta:x,zoomDelta:w,bearingDelta:P,pitchDelta:A,rollDelta:D,around:O,pinchAround:$}=e;$!==void 0&&(O=$),O=O||u.transform.centerPoint,_&&!p.isPointOnMapSurface(O)&&(O=p.centerPoint);const U={panDelta:x,zoomDelta:w,rollDelta:D,pitchDelta:A,bearingDelta:P,around:O};this._map.cameraHelper.useGlobeControls&&!p.isPointOnMapSurface(O)&&(O=p.centerPoint);const Q=O.distSqr(p.centerPoint)<.01?p.center:p.screenPointToLocation(x?O.sub(x):O);_?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,p),this._terrainMovement||!r.drag&&!r.zoom?r.drag&&this._terrainMovement?p.setCenter(p.screenPointToLocation(p.centerPoint.sub(x))):this._map.cameraHelper.handleMapControlsPan(U,p,Q):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(U,p,Q))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(U,p),this._map.cameraHelper.handleMapControlsPan(U,p,Q)),u._applyUpdatedTransform(p),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,l,!0)}_fireEvents(e,r,l){const u=Dn(this._eventsInProgress),p=Dn(e),_={};for(const D in e){const{originalEvent:O}=e[D];this._eventsInProgress[D]||(_[`${D}start`]=O),this._eventsInProgress[D]=e[D]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const D in _)this._fireEvent(D,_[D]);p&&this._fireEvent("move",p.originalEvent);for(const D in e){const{originalEvent:O}=e[D];this._fireEvent(D,O)}const x={};let w;for(const D in this._eventsInProgress){const{handlerName:O,originalEvent:$}=this._eventsInProgress[D];this._handlersById[O].isActive()||(delete this._eventsInProgress[D],w=r[O]||$,x[`${D}end`]=w)}for(const D in x)this._fireEvent(D,x[D]);const P=Dn(this._eventsInProgress),A=(u||p)&&!P;if(A&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const D=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&D.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(D)}if(l&&A){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),O=$=>$!==0&&-this._bearingSnap<$&&$<this._bearingSnap;!D||!D.essential&&ze.prefersReducedMotion?(this._map.fire(new h.l("moveend",{originalEvent:w})),O(this._map.getBearing())&&this._map.resetNorth()):(O(D.bearing||this._map.getBearing())&&(D.bearing=0),D.freezeElevation=!0,this._map.easeTo(D,{originalEvent:w})),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new h.l(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Di("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class zt extends h.E{constructor(e,r,l){super(),this._renderFrameCallback=()=>{const u=Math.min((ze.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=r,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,r){e.apply(this.transform),this.transform=e,this.cameraHelper=r}getCenter(){return new h.Q(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,r){return this.jumpTo({elevation:e},r),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,r,l){return e=h.P.convert(e).mult(-1),this.panTo(this.transform.center,h.e({offset:e},r),l)}panTo(e,r,l){return this.easeTo(h.e({center:e},r),l)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,l){return this.easeTo(h.e({zoom:e},r),l)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,r){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new h.l("movestart",r)).fire(new h.l("move",r)).fire(new h.l("moveend",r))),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,l){return this.easeTo(h.e({bearing:e},r),l)}resetNorth(e,r){return this.rotateTo(0,h.e({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}getRoll(){return this.transform.roll}setRoll(e,r){return this.jumpTo({roll:e},r),this}cameraForBounds(e,r){e=Ar.convert(e).adjustAntiMeridian();const l=r&&r.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,r)}_cameraForBoxAndBearing(e,r,l,u){const p={top:0,bottom:0,right:0,left:0};if(typeof(u=h.e({padding:p,offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=="number"){const P=u.padding;u.padding={top:P,bottom:P,right:P,left:P}}const _=h.e(p,u.padding);u.padding=_;const x=this.transform,w=new Ar(e,r);return this.cameraHelper.cameraForBoxAndBearing(u,_,w,l,x)}fitBounds(e,r,l){return this._fitInternal(this.cameraForBounds(e,r),r,l)}fitScreenCoordinates(e,r,l,u,p){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(e)),this.transform.screenPointToLocation(h.P.convert(r)),l,u),u,p)}_fitInternal(e,r,l){return e?(delete(r=h.e(e,r)).padding,r.linear?this.easeTo(r,l):this.flyTo(r,l)):this}jumpTo(e,r){this.stop();const l=this._getTransformForUpdate();let u=!1,p=!1,_=!1;const x=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const w=l.zoom!==x;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(u=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(p=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(_=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new h.l("movestart",r)).fire(new h.l("move",r)),w&&this.fire(new h.l("zoomstart",r)).fire(new h.l("zoom",r)).fire(new h.l("zoomend",r)),u&&this.fire(new h.l("rotatestart",r)).fire(new h.l("rotate",r)).fire(new h.l("rotateend",r)),p&&this.fire(new h.l("pitchstart",r)).fire(new h.l("pitch",r)).fire(new h.l("pitchend",r)),_&&this.fire(new h.l("rollstart",r)).fire(new h.l("roll",r)).fire(new h.l("rollend",r)),this.fire(new h.l("moveend",r))}calculateCameraOptionsFromTo(e,r,l,u=0){const p=h.$.fromLngLat(e,r),_=h.$.fromLngLat(l,u),x=_.x-p.x,w=_.y-p.y,P=_.z-p.z,A=Math.hypot(x,w,P);if(A===0)throw new Error("Can't calculate camera options with same From and To");const D=Math.hypot(x,w),O=h.aa(this.transform.cameraToCenterDistance/A/this.transform.tileSize),$=180*Math.atan2(x,-w)/Math.PI;let U=180*Math.acos(D/A)/Math.PI;return U=P<0?90-U:90+U,{center:_.toLngLat(),elevation:u,zoom:O,pitch:U,bearing:$}}calculateCameraOptionsFromCameraLngLatAltRotation(e,r,l,u,p){const _=this.transform.calculateCenterFromCameraLngLatAlt(e,r,l,u);return{center:_.center,elevation:_.elevation,zoom:_.zoom,bearing:l,pitch:u,roll:p}}easeTo(e,r){this._stop(!1,e.easeId),((e=h.e({offset:[0,0],duration:500,easing:h.ca},e)).animate===!1||!e.essential&&ze.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),u=this.getBearing(),p=l.pitch,_=l.roll,x="bearing"in e?this._normalizeBearing(e.bearing,u):u,w="pitch"in e?+e.pitch:p,P="roll"in e?this._normalizeBearing(e.roll,_):_,A="padding"in e?e.padding:l.padding,D=h.P.convert(e.offset);let O,$;e.around&&(O=h.Q.convert(e.around),$=l.locationToScreenPoint(O));const U={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Q=this.cameraHelper.handleEaseTo(l,{bearing:x,pitch:w,roll:P,padding:A,around:O,aroundPoint:$,offsetAsPoint:D,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||u!==x,this._pitching=this._pitching||w!==p,this._rolling=this._rolling||P!==_,this._padding=!l.isPaddingEqual(A),this._zooming=this._zooming||Q.isZooming,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,U),this.terrain&&this._prepareElevation(Q.elevationCenter),this._ease(Y=>{Q.easeFunc(Y),this.terrain&&!e.freezeElevation&&this._updateElevation(Y),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},Y=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r,Y)},e),this}_prepareEase(e,r,l={}){this._moving=!0,r||l.moving||this.fire(new h.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new h.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new h.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new h.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new h.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const r=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&r!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(r-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=r}this.transform.setElevation(h.B.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const r=e.getCameraLngLat(),l=e.getCameraAltitude(),u=this.terrain?this.terrain.getElevationForLngLatZoom(r,e.zoom):0;if(l<u){const p=this.calculateCameraOptionsFromTo(r,u,e.center,e.elevation);return{pitch:p.pitch,zoom:p.zoom}}return{}}_applyUpdatedTransform(e){const r=[];if(r.push(u=>this._elevateCameraIfInsideTerrain(u)),this.transformCameraUpdate&&r.push(u=>this.transformCameraUpdate(u)),!r.length)return;const l=e.clone();for(const u of r){const p=l.clone(),{center:_,zoom:x,roll:w,pitch:P,bearing:A,elevation:D}=u(p);_&&p.setCenter(_),D!==void 0&&p.setElevation(D),x!==void 0&&p.setZoom(x),w!==void 0&&p.setRoll(w),P!==void 0&&p.setPitch(P),A!==void 0&&p.setBearing(A),l.apply(p)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new h.l("move",e)),this._zooming&&this.fire(new h.l("zoom",e)),this._rotating&&this.fire(new h.l("rotate",e)),this._pitching&&this.fire(new h.l("pitch",e)),this._rolling&&this.fire(new h.l("roll",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;delete this._easeId;const l=this._zooming,u=this._rotating,p=this._pitching,_=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new h.l("zoomend",e)),u&&this.fire(new h.l("rotateend",e)),p&&this.fire(new h.l("pitchend",e)),_&&this.fire(new h.l("rollend",e)),this.fire(new h.l("moveend",e))}flyTo(e,r){if(!e.essential&&ze.prefersReducedMotion){const Oe=h.O(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Oe,r)}this.stop(),e=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.ca},e);const l=this._getTransformForUpdate(),u=l.bearing,p=l.pitch,_=l.roll,x=l.padding,w="bearing"in e?this._normalizeBearing(e.bearing,u):u,P="pitch"in e?+e.pitch:p,A="roll"in e?this._normalizeBearing(e.roll,_):_,D="padding"in e?e.padding:l.padding,O=h.P.convert(e.offset);let $=l.centerPoint.add(O);const U=l.screenPointToLocation($),Q=this.cameraHelper.handleFlyTo(l,{bearing:w,pitch:P,roll:A,padding:D,locationAtOffset:U,offsetAsPoint:O,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let Y=e.curve;const J=Math.max(l.width,l.height),re=J/Q.scaleOfZoom,le=Q.pixelPathLength;typeof Q.scaleOfMinZoom=="number"&&(Y=Math.sqrt(J/Q.scaleOfMinZoom/le*2));const ue=Y*Y;function de(Oe){const lt=(re*re-J*J+(Oe?-1:1)*ue*ue*le*le)/(2*(Oe?re:J)*ue*le);return Math.log(Math.sqrt(lt*lt+1)-lt)}function pe(Oe){return(Math.exp(Oe)-Math.exp(-Oe))/2}function se(Oe){return(Math.exp(Oe)+Math.exp(-Oe))/2}const be=de(!1);let we=function(Oe){return se(be)/se(be+Y*Oe)},Fe=function(Oe){return J*((se(be)*(pe(lt=be+Y*Oe)/se(lt))-pe(be))/ue)/le;var lt},je=(de(!0)-be)/Y;if(Math.abs(le)<2e-6||!isFinite(je)){if(Math.abs(J-re)<1e-6)return this.easeTo(e,r);const Oe=re<J?-1:1;je=Math.abs(Math.log(re/J))/Y,Fe=()=>0,we=lt=>Math.exp(Oe*Y*lt)}return e.duration="duration"in e?+e.duration:1e3*je/("screenSpeed"in e?+e.screenSpeed/Y:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=u!==w,this._pitching=P!==p,this._rolling=A!==_,this._padding=!l.isPaddingEqual(D),this._prepareEase(r,!1),this.terrain&&this._prepareElevation(Q.targetCenter),this._ease(Oe=>{const lt=Oe*je,Qe=1/we(lt),He=Fe(lt);this._rotating&&l.setBearing(h.B.number(u,w,Oe)),this._pitching&&l.setPitch(h.B.number(p,P,Oe)),this._rolling&&l.setRoll(h.B.number(_,A,Oe)),this._padding&&(l.interpolatePadding(x,D,Oe),$=l.centerPoint.add(O)),Q.easeFunc(Oe,Qe,He,$),this.terrain&&!e.freezeElevation&&this._updateElevation(Oe),this._applyUpdatedTransform(l),this._fireMoveEvents(r)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(r)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const u=this._onEaseEnd;delete this._onEaseEnd,u.call(this,r)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,r,l){l.animate===!1||l.duration===0?(e(1),r()):(this._easeStart=ze.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,r){e=h.aK(e,-180,180);const l=Math.abs(e-r);return Math.abs(e-360-r)<l&&(e-=360),Math.abs(e+360-r)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(h.Q.convert(e),this.transform.tileZoom):null}}const $t={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Xa{constructor(e=$t){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=r=>{!r||r.sourceDataType!=="metadata"&&r.sourceDataType!=="visibility"&&r.dataType!=="style"&&r.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ce.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ce.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ce.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,r){const l=this._map._getUIString(`AttributionControl.${r}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(u=>typeof u!="string"?"":u)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style.sourceCaches;for(const u in r){const p=r[u];if(p.used||p.usedForTerrain){const _=p.getSource();_.attribution&&e.indexOf(_.attribution)<0&&e.push(_.attribution)}}e=e.filter(u=>String(u).trim()),e.sort((u,p)=>u.length-p.length),e=e.filter((u,p)=>{for(let _=p+1;_<e.length;_++)if(e[_].indexOf(u)>=0)return!1;return!0});const l=e.join(" | ");l!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=ce.sanitize(l),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class zs{constructor(e={}){this._updateCompact=()=>{const r=this._container.children;if(r.length){const l=r[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ce.create("div","maplibregl-ctrl");const r=ce.create("a","maplibregl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://maplibre.org/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ce.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class pu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,l=r?this._queue.concat(r):this._queue;for(const u of l)if(u.id===e)return void(u.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const r=this._currentlyRunning=this._queue;this._queue=[];for(const l of r)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ln=h.aC([{name:"a_pos3d",type:"Int16",components:3}]);class gc extends h.E{constructor(e){super(),this._lastTilesetChange=ze.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,r){this.sourceCache.update(e,r),this._renderableTilesKeys=[];const l={};for(const u of xe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:r,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[u.key]=!0,this._renderableTilesKeys.push(u.key),this._tiles[u.key]||(u.terrainRttPosMatrix32f=new Float64Array(16),h.bN(u.terrainRttPosMatrix32f,0,h.Z,h.Z,0,0,1),this._tiles[u.key]=new fi(u,this.tileSize),this._lastTilesetChange=ze.now());for(const u in this._tiles)l[u]||delete this._tiles[u]}freeRtt(e){for(const r in this._tiles){const l=this._tiles[r];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const r={};for(const l of this._renderableTilesKeys){const u=this._tiles[l].tileID,p=e.clone(),_=h.b1();if(u.canonical.equals(e.canonical))h.bN(_,0,h.Z,h.Z,0,0,1);else if(u.canonical.isChildOf(e.canonical)){const x=u.canonical.z-e.canonical.z,w=u.canonical.x-(u.canonical.x>>x<<x),P=u.canonical.y-(u.canonical.y>>x<<x),A=h.Z>>x;h.bN(_,0,A,A,0,0,1),h.L(_,_,[-w*A,-P*A,0])}else{if(!e.canonical.isChildOf(u.canonical))continue;{const x=e.canonical.z-u.canonical.z,w=e.canonical.x-(e.canonical.x>>x<<x),P=e.canonical.y-(e.canonical.y>>x<<x),A=h.Z>>x;h.bN(_,0,h.Z,h.Z,0,0,1),h.L(_,_,[w*A,P*A,0]),h.M(_,_,[1/2**x,1/2**x,0])}}p.terrainRttPosMatrix32f=new Float32Array(_),r[l]=p}return r}getSourceTile(e,r){const l=this.sourceCache._source;let u=e.overscaledZ-this.deltaZoom;if(u>l.maxzoom&&(u=l.maxzoom),u<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(u).key);let p=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!p||!p.dem)&&r)for(;u>=l.minzoom&&(!p||!p.dem);)p=this.sourceCache.getTileByID(e.scaledTo(u--).key);return p}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class si{constructor(e,r,l){this._meshCache={},this.painter=e,this.sourceCache=new gc(r),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,r,l,u=h.Z){var p;if(!(r>=0&&r<u&&l>=0&&l<u))return 0;const _=this.getTerrainData(e),x=(p=_.tile)===null||p===void 0?void 0:p.dem;if(!x)return 0;const w=h.cb([],[r/u*h.Z,l/u*h.Z],_.u_terrain_matrix),P=[w[0]*x.dim,w[1]*x.dim],A=Math.floor(P[0]),D=Math.floor(P[1]),O=P[0]-A,$=P[1]-D;return x.get(A,D)*(1-O)*(1-$)+x.get(A+1,D)*O*(1-$)+x.get(A,D+1)*(1-O)*$+x.get(A+1,D+1)*O*$}getElevationForLngLatZoom(e,r){if(!h.cc(r,e.wrap()))return 0;const{tileID:l,mercatorX:u,mercatorY:p}=this._getOverscaledTileIDFromLngLatZoom(e,r);return this.getElevation(l,u%h.Z,p%h.Z,h.Z)}getElevation(e,r,l,u=h.Z){return this.getDEMElevation(e,r,l,u)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const u=this.painter.context,p=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Lt(u,p,u.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Lt(u,new h.R({width:1,height:1}),u.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.as([])}const r=this.sourceCache.getSourceTile(e,!0);if(r&&r.dem&&(!r.demTexture||r.needsTerrainPrepare)){const u=this.painter.context;r.demTexture=this.painter.getTileTexture(r.dem.stride),r.demTexture?r.demTexture.update(r.dem.getPixels(),{premultiply:!1}):r.demTexture=new Lt(u,r.dem.getPixels(),u.gl.RGBA,{premultiply:!1}),r.demTexture.bind(u.gl.NEAREST,u.gl.CLAMP_TO_EDGE),r.needsTerrainPrepare=!1}const l=r&&r+r.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const u=this.sourceCache.sourceCache._source.maxzoom;let p=e.canonical.z-r.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=u?p=e.canonical.z-u:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=e.canonical.x-(e.canonical.x>>p<<p),x=e.canonical.y-(e.canonical.y>>p<<p),w=h.cd(new Float64Array(16),[1/(h.Z<<p),1/(h.Z<<p),0]);h.L(w,w,[_*h.Z,x*h.Z,0]),this._demMatrixCache[e.key]={matrix:w,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:r&&r.dem&&r.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:r&&r.dem&&r.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(r&&r.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:r}}getFramebuffer(e){const r=this.painter,l=r.width/devicePixelRatio,u=r.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===u||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Lt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Lt(r.context,{width:l,height:u,data:null},r.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(r.context.gl.NEAREST,r.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=r.context.createFramebuffer(l,u,!0,!1),this._fbo.depthAttachment.set(r.context.createRenderbuffer(r.context.gl.DEPTH_COMPONENT16,l,u))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const r=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let p=0,_=0;p<this._coordsTextureSize;p++)for(let x=0;x<this._coordsTextureSize;x++,_+=4)r[_+0]=255&x,r[_+1]=255&p,r[_+2]=x>>8<<4|p>>8,r[_+3]=0;const l=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(r.buffer)),u=new Lt(e,l,e.gl.RGBA,{premultiply:!1});return u.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=u,u}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const r=new Uint8Array(4),l=this.painter.context,u=l.gl,p=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),_=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),x=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),u.readPixels(p,x-_-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null);const w=r[0]+(r[2]>>4<<8),P=r[1]+((15&r[2])<<8),A=this.coordsIndex[255-r[3]],D=A&&this.sourceCache.getTileByID(A);if(!D)return null;const O=this._coordsTextureSize,$=(1<<D.tileID.canonical.z)*O;return new h.$((D.tileID.canonical.x*O+w)/$+D.tileID.wrap,(D.tileID.canonical.y*O+P)/$,this.getElevation(D.tileID,w,P,O))}depthAtPoint(e){const r=new Uint8Array(4),l=this.painter.context,u=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),u.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,u.RGBA,u.UNSIGNED_BYTE,r),l.bindFramebuffer.set(null),(r[0]/16777216+r[1]/65536+r[2]/256+r[3])/256}getTerrainMesh(e){var r;const l=((r=this.painter.style.projection)===null||r===void 0?void 0:r.transitionState)>0,u=l&&e.canonical.y===0,p=l&&e.canonical.y===(1<<e.canonical.z)-1,_=`m_${u?"n":""}_${p?"s":""}`;if(this._meshCache[_])return this._meshCache[_];const x=this.painter.context,w=new h.ce,P=new h.aG,A=this.meshSize,D=h.Z/A,O=A*A;for(let se=0;se<=A;se++)for(let be=0;be<=A;be++)w.emplaceBack(be*D,se*D,0);for(let se=0;se<O;se+=A+1)for(let be=0;be<A;be++)P.emplaceBack(be+se,A+be+se+1,A+be+se+2),P.emplaceBack(be+se,A+be+se+2,be+se+1);const $=w.length,U=$+(A+1),Q=(A+1)*A,Y=u?h.b8:0,J=u?0:1,re=p?h.b9:h.Z,le=p?0:1;for(let se=0;se<=A;se++)w.emplaceBack(se*D,Y,J);for(let se=0;se<=A;se++)w.emplaceBack(se*D,re,le);for(let se=0;se<A;se++)P.emplaceBack(Q+se,U+se,U+se+1),P.emplaceBack(Q+se,U+se+1,Q+se+1),P.emplaceBack(0+se,$+se+1,$+se),P.emplaceBack(0+se,0+se+1,$+se+1);const ue=w.length,de=ue+2*(A+1);for(const se of[0,1])for(let be=0;be<=A;be++)for(const we of[0,1])w.emplaceBack(se*h.Z,be*D,we);for(let se=0;se<2*A;se+=2)P.emplaceBack(ue+se,ue+se+1,ue+se+3),P.emplaceBack(ue+se,ue+se+3,ue+se+2),P.emplaceBack(de+se,de+se+3,de+se+1),P.emplaceBack(de+se,de+se+2,de+se+3);const pe=new gi(x.createVertexBuffer(w,Ln.members),x.createIndexBuffer(P),h.aF.simpleSegment(0,0,w.length,P.length));return this._meshCache[_]=pe,pe}getMeshFrameDelta(e){return 2*Math.PI*h.bq/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,r){var l;const{tileID:u}=this._getOverscaledTileIDFromLngLatZoom(e,r);return(l=this.getMinMaxElevation(u).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const r=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return r&&r.dem&&(l.minElevation=r.dem.min*this.exaggeration,l.maxElevation=r.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,r){const l=h.$.fromLngLat(e.wrap()),u=(1<<r)*h.Z,p=l.x*u,_=l.y*u,x=Math.floor(p/h.Z),w=Math.floor(_/h.Z);return{tileID:new h.Y(r,0,r,x,w),mercatorX:p,mercatorY:_}}}class _c{constructor(e,r,l){this._context=e,this._size=r,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const r=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new Lt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),r.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),r.colorAttachment.set(l.texture),{id:e,fbo:r,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(r=>e.id!==r),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const r of this._recentlyUsed)if(!this._objects[r].inUse)return this._objects[r];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const ko={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class $r{constructor(e,r){this.painter=e,this.terrain=r,this.pool=new _c(e.context,30,r.sourceCache.tileSize*r.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,r){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(l=>!e._layers[l].isHidden(r)),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const u=e.sourceCaches[l].getVisibleCoordinates();for(const p of u){const _=this.terrain.sourceCache.getTerrainCoords(p);for(const x in _)this._coordsAscending[l][x]||(this._coordsAscending[l][x]=[]),this._coordsAscending[l][x].push(_[x])}}this._coordsAscendingStr={};for(const l of e._order){const u=e._layers[l],p=u.source;if(ko[u.type]&&!this._coordsAscendingStr[p]){this._coordsAscendingStr[p]={};for(const _ in this._coordsAscending[p])this._coordsAscendingStr[p][_]=this._coordsAscending[p][_].map(x=>x.key).sort().join()}}for(const l of this._renderableTiles)for(const u in this._coordsAscendingStr){const p=this._coordsAscendingStr[u][l.tileID.key];p&&p!==l.rttCoords[u]&&(l.rtt=[])}}renderLayer(e,r){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},r),{isRenderingToTexture:!0}),u=e.type,p=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(ko[u]&&(this._prevType&&ko[this._prevType]||this._stacks.push([]),this._prevType=u,this._stacks[this._stacks.length-1].push(e.id),!_))return!0;if(ko[this._prevType]||ko[u]&&_){this._prevType=u;const x=this._stacks.length-1,w=this._stacks[x]||[];for(const P of this._renderableTiles){if(this.pool.isFull()&&(uu(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(P),P.rtt[x]){const D=this.pool.getObjectForId(P.rtt[x].id);if(D.stamp===P.rtt[x].stamp){this.pool.useObject(D);continue}}const A=this.pool.getOrCreateFreeObject();this.pool.useObject(A),this.pool.stampObject(A),P.rtt[x]={id:A.id,stamp:A.stamp},p.context.bindFramebuffer.set(A.fbo.framebuffer),p.context.clear({color:h.b6.transparent,stencil:0}),p.currentStencilSource=void 0;for(let D=0;D<w.length;D++){const O=p.style._layers[w[D]],$=O.source?this._coordsAscending[O.source][P.tileID.key]:[P.tileID];p.context.viewport.set([0,0,A.fbo.width,A.fbo.height]),p._renderTileClippingMasks(O,$,!0),p.renderLayer(p,p.style.sourceCaches[O.source],O,$,l),O.source&&(P.rttCoords[O.source]=this._coordsAscendingStr[O.source][P.tileID.key])}}return uu(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),ko[u]}return!1}}const Kr={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},yc=Me,Ka={hash:!1,interactive:!0,bearingSnap:7,attributionControl:$t,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},qo={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class fu{constructor(e,r,l=!1){this.mousedown=p=>{this.startMove(p,ce.mousePos(this.element,p)),ce.addEventListener(window,"mousemove",this.mousemove),ce.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=p=>{this.move(p,ce.mousePos(this.element,p))},this.mouseup=p=>{this._rotatePitchHanlder.dragEnd(p),this.offTemp()},this.touchstart=p=>{p.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ce.touchPos(this.element,p.targetTouches)[0],this.startMove(p,this._startPos),ce.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.addEventListener(window,"touchend",this.touchend))},this.touchmove=p=>{p.targetTouches.length!==1?this.reset():(this._lastPos=ce.touchPos(this.element,p.targetTouches)[0],this.move(p,this._lastPos))},this.touchend=p=>{p.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=r;const u=new mc;this._rotatePitchHanlder=new gn({clickTolerance:3,move:(p,_)=>{const x=r.getBoundingClientRect(),w=new h.P((x.bottom-x.top)/2,(x.right-x.left)/2);return{bearingDelta:h.c9(new h.P(p.x,_.y),_,w),pitchDelta:l?-.5*(_.y-p.y):void 0}},moveStateManager:u,enable:!0,assignEvents:()=>{}}),this.map=e,ce.addEventListener(r,"mousedown",this.mousedown),ce.addEventListener(r,"touchstart",this.touchstart,{passive:!1}),ce.addEventListener(r,"touchcancel",this.reset)}startMove(e,r){this._rotatePitchHanlder.dragStart(e,r),ce.disableDrag()}move(e,r){const l=this.map,{bearingDelta:u,pitchDelta:p}=this._rotatePitchHanlder.dragMove(e,r)||{};u&&l.setBearing(l.getBearing()+u),p&&l.setPitch(l.getPitch()+p)}off(){const e=this.element;ce.removeEventListener(e,"mousedown",this.mousedown),ce.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend),ce.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ce.enableDrag(),ce.removeEventListener(window,"mousemove",this.mousemove),ce.removeEventListener(window,"mouseup",this.mouseup),ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ce.removeEventListener(window,"touchend",this.touchend)}}let Ji;function Ya(d,e,r){const l=new h.Q(d.lng,d.lat);if(d=new h.Q(d.lng,d.lat),e){const u=new h.Q(d.lng-360,d.lat),p=new h.Q(d.lng+360,d.lat),_=r.locationToScreenPoint(d).distSqr(e);r.locationToScreenPoint(u).distSqr(e)<_?d=u:r.locationToScreenPoint(p).distSqr(e)<_&&(d=p)}for(;Math.abs(d.lng-r.center.lng)>180;){const u=r.locationToScreenPoint(d);if(u.x>=0&&u.y>=0&&u.x<=r.width&&u.y<=r.height)break;d.lng>r.center.lng?d.lng-=360:d.lng+=360}return d.lng!==l.lng&&r.isPointOnMapSurface(r.locationToScreenPoint(d))?d:l}const eo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Rs(d,e,r){const l=d.classList;for(const u in eo)l.remove(`maplibregl-${r}-anchor-${u}`);l.add(`maplibregl-${r}-anchor-${e}`)}class Qa extends h.E{constructor(e){if(super(),this._onKeyPress=r=>{const l=r.code,u=r.charCode||r.keyCode;l!=="Space"&&l!=="Enter"&&u!==32&&u!==13||this.togglePopup()},this._onMapClick=r=>{const l=r.originalEvent.target,u=this._element;this._popup&&(l===u||u.contains(l))&&this.togglePopup()},this._update=r=>{var l;if(!this._map)return;const u=this._map.loaded()&&!this._map.isMoving();((r==null?void 0:r.type)==="terrain"||(r==null?void 0:r.type)==="render"&&!u)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ya(this._lngLat,this._flatPos,this._map.transform):(l=this._lngLat)===null||l===void 0?void 0:l.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(p=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let _="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?_="rotateX(0deg)":this._pitchAlignment==="map"&&(_=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||r&&r.type!=="moveend"||(this._pos=this._pos.round()),ce.setTransform(this._element,`${eo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${_} ${p}`),ze.frameAsync(new AbortController).then(()=>{this._updateOpacity(r&&r.type==="moveend")}).catch(()=>{})},this._onMove=r=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=r.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=r.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.l("dragstart"))),this.fire(new h.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.l("dragend")),this._state="inactive"},this._addDragHandler=r=>{this._element.contains(r.originalEvent.target)&&(r.preventDefault(),this._positionDelta=r.point.sub(this._pos).add(this._offset),this._pointerdownPos=r.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=h.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ce.create("div");const r=ce.createNS("http://www.w3.org/2000/svg","svg"),l=41,u=27;r.setAttributeNS(null,"display","block"),r.setAttributeNS(null,"height",`${l}px`),r.setAttributeNS(null,"width",`${u}px`),r.setAttributeNS(null,"viewBox",`0 0 ${u} ${l}`);const p=ce.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"stroke","none"),p.setAttributeNS(null,"stroke-width","1"),p.setAttributeNS(null,"fill","none"),p.setAttributeNS(null,"fill-rule","evenodd");const _=ce.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const x=ce.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"transform","translate(3.0, 29.0)"),x.setAttributeNS(null,"fill","#000000");const w=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const J of w){const re=ce.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",J.rx),re.setAttributeNS(null,"ry",J.ry),x.appendChild(re)}const P=ce.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"fill",this._color);const A=ce.createNS("http://www.w3.org/2000/svg","path");A.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),P.appendChild(A);const D=ce.createNS("http://www.w3.org/2000/svg","g");D.setAttributeNS(null,"opacity","0.25"),D.setAttributeNS(null,"fill","#000000");const O=ce.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),D.appendChild(O);const $=ce.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$.setAttributeNS(null,"fill","#FFFFFF");const U=ce.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=ce.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const Y=ce.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#FFFFFF"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962"),U.appendChild(Q),U.appendChild(Y),_.appendChild(x),_.appendChild(P),_.appendChild(D),_.appendChild($),_.appendChild(U),r.appendChild(_),r.setAttributeNS(null,"height",l*this._scale+"px"),r.setAttributeNS(null,"width",u*this._scale+"px"),this._element.appendChild(r),this._offset=h.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",r=>{r.preventDefault()}),this._element.addEventListener("mousedown",r=>{r.preventDefault()}),Rs(this._element,this._anchor,"marker"),e&&e.className)for(const r of e.className.split(" "))this._element.classList.add(r);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ce.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=h.Q.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const u=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var r,l;if(!(!((r=this._map)===null||r===void 0)&&r.terrain)){const D=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==D&&(this._element.style.opacity=D))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const u=this._map,p=u.terrain.depthAtPoint(this._pos),_=u.terrain.getElevationForLngLatZoom(this._lngLat,u.transform.tileZoom);if(u.transform.lngLatToCameraDepth(this._lngLat,_)-p<.006)return void(this._element.style.opacity=this._opacity);const x=-this._offset.y/u.transform.pixelsPerMeter,w=Math.sin(u.getPitch()*Math.PI/180)*x,P=u.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),A=u.transform.lngLatToCameraDepth(this._lngLat,_+w)-P>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&A&&this._popup.remove(),this._element.style.opacity=A?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=h.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,r){return(this._opacity===void 0||e===void 0&&r===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),r!==void 0&&(this._opacityWhenCovered=r),this._map&&this._updateOpacity(!0),this}}const pl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Pa=0,to=!1;const bi={maxWidth:100,unit:"metric"};function Ao(d,e,r){const l=r&&r.maxWidth||100,u=d._container.clientHeight/2,p=d._container.clientWidth/2,_=d.unproject([p-l/2,u]),x=d.unproject([p+l/2,u]),w=Math.round(d.project(x).x-d.project(_).x),P=Math.min(l,w,d._container.clientWidth),A=_.distanceTo(x);if(r&&r.unit==="imperial"){const D=3.2808*A;D>5280?Wo(e,P,D/5280,d._getUIString("ScaleControl.Miles")):Wo(e,P,D,d._getUIString("ScaleControl.Feet"))}else r&&r.unit==="nautical"?Wo(e,P,A/1852,d._getUIString("ScaleControl.NauticalMiles")):A>=1e3?Wo(e,P,A/1e3,d._getUIString("ScaleControl.Kilometers")):Wo(e,P,A,d._getUIString("ScaleControl.Meters"))}function Wo(d,e,r,l){const u=function(p){const _=Math.pow(10,`${Math.floor(p)}`.length-1);let x=p/_;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:x>=1?1:function(w){const P=Math.pow(10,Math.ceil(-Math.log(w)/Math.LN10));return Math.round(w*P)/P}(x),_*x}(r);d.style.width=e*(u/r)+"px",d.innerHTML=`${u}&nbsp;${l}`}const fl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},fo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function mo(d){if(d){if(typeof d=="number"){const e=Math.round(Math.abs(d)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,d),"top-left":new h.P(e,e),"top-right":new h.P(-e,e),bottom:new h.P(0,-d),"bottom-left":new h.P(e,-e),"bottom-right":new h.P(-e,-e),left:new h.P(d,0),right:new h.P(-d,0)}}if(d instanceof h.P||Array.isArray(d)){const e=h.P.convert(d);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:h.P.convert(d.center||[0,0]),top:h.P.convert(d.top||[0,0]),"top-left":h.P.convert(d["top-left"]||[0,0]),"top-right":h.P.convert(d["top-right"]||[0,0]),bottom:h.P.convert(d.bottom||[0,0]),"bottom-left":h.P.convert(d["bottom-left"]||[0,0]),"bottom-right":h.P.convert(d["bottom-right"]||[0,0]),left:h.P.convert(d.left||[0,0]),right:h.P.convert(d.right||[0,0])}}return mo(new h.P(0,0))}const Ds=Me;M.AJAXError=h.ci,M.Event=h.l,M.Evented=h.E,M.LngLat=h.Q,M.MercatorCoordinate=h.$,M.Point=h.P,M.addProtocol=h.cj,M.config=h.a,M.removeProtocol=h.ck,M.AttributionControl=Xa,M.BoxZoomHandler=qr,M.CanvasSource=Nn,M.CooperativeGesturesHandler=dl,M.DoubleClickZoomHandler=Sa,M.DragPanHandler=po,M.DragRotateHandler=cl,M.EdgeInsets=hn,M.FullscreenControl=class extends h.E{constructor(d={}){super(),this._onFullscreenChange=()=>{var e;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=r==null?void 0:r.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,d&&d.container&&(d.container instanceof HTMLElement?this._container=d.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ce.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const d=this._fullscreenButton=ce.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ce.create("span","maplibregl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.title=d}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},M.GeoJSONSource=ri,M.GeolocateControl=class extends h.E{constructor(d){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new h.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const r=new h.Q(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,u=this._map.getBearing(),p=h.e({bearing:u},this.options.fitBoundsOptions),_=Ar.fromLngLat(r,l);this._map.fitBounds(_,p,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const r=new h.Q(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&to)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=ce.create("button","maplibregl-ctrl-geolocate",this._container),ce.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{const r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ce.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Qa({element:this._dotElement}),this._circleElement=ce.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qa({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{r.geolocateSource||this._watchState!=="ACTIVE_LOCK"||r.originalEvent&&r.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.l("trackuserlocationend")),this.fire(new h.l("userlocationlostfocus")))})}},this.options=h.e({},pl,d)}onAdd(d){return this._map=d,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(e=!1){if(Ji!==void 0&&!e)return Ji;if(window.navigator.permissions===void 0)return Ji=!!window.navigator.geolocation,Ji;try{Ji=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Ji=!!window.navigator.geolocation}return Ji})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ce.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pa=0,to=!1}_isOutOfMapMaxBounds(d){const e=this._map.getMaxBounds(),r=d.coords;return e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const d=this._map.getBounds(),e=d.getSouthEast(),r=d.getNorthEast(),l=e.distanceTo(r),u=Math.ceil(this._accuracy/(l/this._map._container.clientHeight)*2);this._circleElement.style.width=`${u}px`,this._circleElement.style.height=`${u}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pa--,to=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.l("trackuserlocationstart")),this.fire(new h.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Pa++,Pa>1?(d={maximumAge:6e5,timeout:0},to=!0):(d=this.options.positionOptions,to=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},M.GlobeControl=class{constructor(){this._toggleProjection=()=>{var d;const e=(d=this._map.getProjection())===null||d===void 0?void 0:d.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var d;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((d=this._map.getProjection())===null||d===void 0?void 0:d.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(d){return this._map=d,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ce.create("button","maplibregl-ctrl-globe",this._container),ce.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},M.Hash=ai,M.ImageSource=zn,M.KeyboardHandler=As,M.LngLatBounds=Ar,M.LogoControl=zs,M.Map=class extends zt{constructor(d){var e,r;h.cf.mark(h.cg.create);const l=Object.assign(Object.assign(Object.assign({},Ka),d),{canvasContextAttributes:Object.assign(Object.assign({},Ka.canvasContextAttributes),d.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const u=new Zn,p=new qi;if(l.minZoom!==void 0&&u.setMinZoom(l.minZoom),l.maxZoom!==void 0&&u.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&u.setMinPitch(l.minPitch),l.maxPitch!==void 0&&u.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&u.setRenderWorldCopies(l.renderWorldCopies),super(u,p,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new pu,this._controls=[],this._mapId=h.a3(),this._contextLost=x=>{x.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.l("webglcontextlost",{originalEvent:x}))},this._contextRestored=x=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.l("webglcontextrestored",{originalEvent:x}))},this._onMapScroll=x=>{if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Kr),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Mt.addThrottleControl(()=>this.isMoving()),this._requestManager=new cr(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let x=!1;const w=sl(P=>{this._trackResize&&!this._removed&&(this.resize(P),this.redraw())},50);this._resizeObserver=new ResizeObserver(P=>{x?w(P):x=!0}),this._resizeObserver.observe(this._container)}this.handlers=new xi(this,l),this._hash=l.hash&&new ai(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,h.e({},l.fitBoundsOptions,{duration:0}))));const _=typeof l.style=="string"||((r=(e=l.style)===null||e===void 0?void 0:e.projection)===null||r===void 0?void 0:r.type)!=="globe";this.resize(null,_),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new Xa(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new zs,l.logoPosition),this.on("style.load",()=>{if(_||this._resizeTransform(),this.transform.unmodified){const x=h.O(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(x)}}),this.on("data",x=>{this._update(x.dataType==="style"),this.fire(new h.l(`${x.dataType}data`,x))}),this.on("dataloading",x=>{this.fire(new h.l(`${x.dataType}dataloading`,x))}),this.on("dataabort",x=>{this.fire(new h.l("sourcedataabort",x))})}_getMapId(){return this._mapId}addControl(d,e){if(e===void 0&&(e=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new h.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=d.onAdd(this);this._controls.push(d);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(r,l.firstChild):l.appendChild(r),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new h.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(d);return e>-1&&this._controls.splice(e,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}calculateCameraOptionsFromTo(d,e,r,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(d,e,r,l)}resize(d,e=!0){const[r,l]=this._containerDimensions(),u=this._getClampedPixelRatio(r,l);if(this._resizeCanvas(r,l,u),this.painter.resize(r,l,u),this.painter.overLimit()){const _=this.painter.context.gl;this._maxCanvasSize=[_.drawingBufferWidth,_.drawingBufferHeight];const x=this._getClampedPixelRatio(r,l);this._resizeCanvas(r,l,x),this.painter.resize(r,l,x)}this._resizeTransform(e);const p=!this._moving;return p&&(this.stop(),this.fire(new h.l("movestart",d)).fire(new h.l("move",d))),this.fire(new h.l("resize",d)),p&&this.fire(new h.l("moveend",d)),this}_resizeTransform(d=!0){var e;const[r,l]=this._containerDimensions();this.transform.resize(r,l,d),(e=this._requestedCameraState)===null||e===void 0||e.resize(r,l,d)}_getClampedPixelRatio(d,e){const{0:r,1:l}=this._maxCanvasSize,u=this.getPixelRatio(),p=d*u,_=e*u;return Math.min(p>r?r/p:1,_>l?l/_:1)*u}getPixelRatio(){var d;return(d=this._overridePixelRatio)!==null&&d!==void 0?d:devicePixelRatio}setPixelRatio(d){this._overridePixelRatio=d,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(d){return this.transform.setMaxBounds(Ar.convert(d)),this._update()}setMinZoom(d){if((d=d??-2)>=-2&&d<=this.transform.maxZoom)return this.transform.setMinZoom(d),this._update(),this.getZoom()<d&&this.setZoom(d),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d??22)>=this.transform.minZoom)return this.transform.setMaxZoom(d),this._update(),this.getZoom()>d&&this.setZoom(d),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.setMinPitch(d),this._update(),this.getPitch()<d&&this.setPitch(d),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(d>=this.transform.minPitch)return this.transform.setMaxPitch(d),this._update(),this.getPitch()>d&&this.setPitch(d),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.setRenderWorldCopies(d),this._update()}project(d){return this.transform.locationToScreenPoint(h.Q.convert(d),this.style&&this.terrain)}unproject(d){return this.transform.screenPointToLocation(h.P.convert(d),this.terrain)}isMoving(){var d;return this._moving||((d=this.handlers)===null||d===void 0?void 0:d.isMoving())}isZooming(){var d;return this._zooming||((d=this.handlers)===null||d===void 0?void 0:d.isZooming())}isRotating(){var d;return this._rotating||((d=this.handlers)===null||d===void 0?void 0:d.isRotating())}_createDelegatedListener(d,e,r){if(d==="mouseenter"||d==="mouseover"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:p=>{const _=e.filter(w=>this.getLayer(w)),x=_.length!==0?this.queryRenderedFeatures(p.point,{layers:_}):[];x.length?l||(l=!0,r.call(this,new Vr(d,this,p.originalEvent,{features:x}))):l=!1},mouseout:()=>{l=!1}}}}if(d==="mouseleave"||d==="mouseout"){let l=!1;return{layers:e,listener:r,delegates:{mousemove:_=>{const x=e.filter(w=>this.getLayer(w));(x.length!==0?this.queryRenderedFeatures(_.point,{layers:x}):[]).length?l=!0:l&&(l=!1,r.call(this,new Vr(d,this,_.originalEvent)))},mouseout:_=>{l&&(l=!1,r.call(this,new Vr(d,this,_.originalEvent)))}}}}{const l=u=>{const p=e.filter(x=>this.getLayer(x)),_=p.length!==0?this.queryRenderedFeatures(u.point,{layers:p}):[];_.length&&(u.features=_,r.call(this,u),delete u.features)};return{layers:e,listener:r,delegates:{[d]:l}}}}_saveDelegatedListener(d,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(e)}_removeDelegatedListener(d,e,r){if(!this._delegatedListeners||!this._delegatedListeners[d])return;const l=this._delegatedListeners[d];for(let u=0;u<l.length;u++){const p=l[u];if(p.listener===r&&p.layers.length===e.length&&p.layers.every(_=>e.includes(_))){for(const _ in p.delegates)this.off(_,p.delegates[_]);return void l.splice(u,1)}}}on(d,e,r){if(r===void 0)return super.on(d,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(d,l,r);this._saveDelegatedListener(d,u);for(const p in u.delegates)this.on(p,u.delegates[p]);return{unsubscribe:()=>{this._removeDelegatedListener(d,l,r)}}}once(d,e,r){if(r===void 0)return super.once(d,e);const l=typeof e=="string"?[e]:e,u=this._createDelegatedListener(d,l,r);for(const p in u.delegates){const _=u.delegates[p];u.delegates[p]=(...x)=>{this._removeDelegatedListener(d,l,r),_(...x)}}this._saveDelegatedListener(d,u);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(d,e,r){return r===void 0?super.off(d,e):(this._removeDelegatedListener(d,typeof e=="string"?[e]:e,r),this)}queryRenderedFeatures(d,e){if(!this.style)return[];let r;const l=d instanceof h.P||Array.isArray(d),u=l?d:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:d)||{},u instanceof h.P||typeof u[0]=="number")r=[h.P.convert(u)];else{const p=h.P.convert(u[0]),_=h.P.convert(u[1]);r=[p,new h.P(_.x,p.y),_,new h.P(p.x,_.y),p]}return this.style.queryRenderedFeatures(r,e,this.transform)}querySourceFeatures(d,e){return this.style.querySourceFeatures(d,e)}setStyle(d,e){return(e=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&d?(this._diffStyle(d,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(d,e))}setTransformRequest(d){return this._requestManager.setTransformRequest(d),this}_getUIString(d){const e=this._locale[d];if(e==null)throw new Error(`Missing UI string '${d}'`);return e}_updateStyle(d,e){var r,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(d,e));const u=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!d)),d?(this.style=new Ks(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d,e,u):this.style.loadJSON(d,e,u),this):((l=(r=this.style)===null||r===void 0?void 0:r.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ks(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,e){if(typeof d=="string"){const r=this._requestManager.transformRequest(d,"Style");h.j(r,new AbortController).then(l=>{this._updateDiff(l.data,e)}).catch(l=>{l&&this.fire(new h.k(l))})}else typeof d=="object"&&this._updateDiff(d,e)}_updateDiff(d,e){try{this.style.setState(d,e)&&this._update(!0)}catch(r){h.w(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(d,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(d,e){return this._lazyInitEmptyStyle(),this.style.addSource(d,e),this._update(!0)}isSourceLoaded(d){const e=this.style&&this.style.sourceCaches[d];if(e!==void 0)return e.loaded();this.fire(new h.k(new Error(`There is no source with ID '${d}'`)))}setTerrain(d){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),d){const e=this.style.sourceCaches[d.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${d.source}`);this.terrain===null&&e.reload();for(const r in this.style._layers){const l=this.style._layers[r];l.type==="hillshade"&&l.source===d.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new si(this.painter,e,d),this.painter.renderToTexture=new $r(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId!==d.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.l("terrain",{terrain:d})),this}getTerrain(){var d,e;return(e=(d=this.terrain)===null||d===void 0?void 0:d.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const d=this.style&&this.style.sourceCaches;for(const e in d){const r=d[e]._tiles;for(const l in r){const u=r[l];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}removeSource(d){return this.style.removeSource(d),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,e,r={}){const{pixelRatio:l=1,sdf:u=!1,stretchX:p,stretchY:_,content:x,textFitWidth:w,textFitHeight:P}=r;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||h.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:A,height:D,data:O}=e,$=e;return this.style.addImage(d,{data:new h.R({width:A,height:D},new Uint8Array(O)),pixelRatio:l,stretchX:p,stretchY:_,content:x,textFitWidth:w,textFitHeight:P,sdf:u,version:0,userImage:$}),$.onAdd&&$.onAdd(this,d),this}}{const{width:A,height:D,data:O}=ze.getImageData(e);this.style.addImage(d,{data:new h.R({width:A,height:D},O),pixelRatio:l,stretchX:p,stretchY:_,content:x,textFitWidth:w,textFitHeight:P,sdf:u,version:0})}}updateImage(d,e){const r=this.style.getImage(d);if(!r)return this.fire(new h.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||h.b(e)?ze.getImageData(e):e,{width:u,height:p,data:_}=l;if(u===void 0||p===void 0)return this.fire(new h.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(u!==r.data.width||p!==r.data.height)return this.fire(new h.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const x=!(e instanceof HTMLImageElement||h.b(e));return r.data.replace(_,x),this.style.updateImage(d,r),this}getImage(d){return this.style.getImage(d)}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new h.k(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d){return Mt.getImage(this._requestManager.transformRequest(d,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(d,e){return this._lazyInitEmptyStyle(),this.style.addLayer(d,e),this._update(!0)}moveLayer(d,e){return this.style.moveLayer(d,e),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(d,e,r){return this.style.setLayerZoomRange(d,e,r),this._update(!0)}setFilter(d,e,r={}){return this.style.setFilter(d,e,r),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,e,r,l={}){return this.style.setPaintProperty(d,e,r,l),this._update(!0)}getPaintProperty(d,e){return this.style.getPaintProperty(d,e)}setLayoutProperty(d,e,r,l={}){return this.style.setLayoutProperty(d,e,r,l),this._update(!0)}getLayoutProperty(d,e){return this.style.getLayoutProperty(d,e)}setGlyphs(d,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(d,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(d,e,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(d,e,r,l=>{l||this._update(!0)}),this}removeSprite(d){return this._lazyInitEmptyStyle(),this.style.removeSprite(d),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(d,e,r=>{r||this._update(!0)}),this}setLight(d,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(d,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(d,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(d,e){return this.style.setFeatureState(d,e),this._update()}removeFeatureState(d,e){return this.style.removeFeatureState(d,e),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let d=0,e=0;return this._container&&(d=this._container.clientWidth||400,e=this._container.clientHeight||300),[d,e]}_setupContainer(){const d=this._container;d.classList.add("maplibregl-map");const e=this._canvasContainer=ce.create("div","maplibregl-canvas-container",d);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ce.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const r=this._containerDimensions(),l=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],l);const u=this._controlContainer=ce.create("div","maplibregl-control-container",d),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(_=>{p[_]=ce.create("div",`maplibregl-ctrl-${_} `,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,e,r){this._canvas.width=Math.floor(r*d),this._canvas.height=Math.floor(r*e),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const d=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",l=>{e={requestedAttributes:d},l&&(e.statusMessage=l.statusMessage,e.type=l.type)},{once:!0});let r=null;if(r=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,d):this._canvas.getContext("webgl2",d)||this._canvas.getContext("webgl",d),!r){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new nh(r,this.transform),Ge.testSupport(r)}migrateProjection(d,e){super.migrateProjection(d,e),this.painter.transform=d,this.fire(new h.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_render(d){var e,r,l,u,p;const _=this._idleTriggered?this._fadeDuration:0,x=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._removed)return;let w=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,O=ze.now();this.style.zoomHistory.update(D,O);const $=new h.C(D,{now:O,fadeDuration:_,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),U=$.crossFadingFactor();U===1&&U===this._crossFadingFactor||(w=!0,this._crossFadingFactor=U),this.style.update($)}const P=((r=this.style.projection)===null||r===void 0?void 0:r.transitionState)>0!==x;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((u=this.style.projection)===null||u===void 0?void 0:u.transitionState,(p=this.style.projection)===null||p===void 0?void 0:p.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||P)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,_,this._crossSourceCollisions,P),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,showPadding:this.showPadding}),this.fire(new h.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cf.mark(h.cg.load),this.fire(new h.l("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const A=this._sourcesDirty||this._styleDirty||this._placementDirty;return A||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.l("idle")),!this._loaded||this._fullyLoaded||A||(this._fullyLoaded=!0,h.cf.mark(h.cg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var d;this._hash&&this._hash.remove();for(const r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Mt.removeThrottleControl(this._imageQueueHandle),(d=this._resizeObserver)===null||d===void 0||d.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ce.remove(this._canvasContainer),ce.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cf.clearMetrics(),this._removed=!0,this.fire(new h.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ze.frame(this._frameRequest,d=>{h.cf.frame(d),this._frameRequest=null;try{this._render(d)}catch(e){if(!h.ch(e)&&!function(r){return r.message===hc}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}get version(){return yc}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(d){return this._lazyInitEmptyStyle(),this.style.setProjection(d),this._update(!0)}},M.MapMouseEvent=Vr,M.MapTouchEvent=fn,M.MapWheelEvent=Ms,M.Marker=Qa,M.NavigationControl=class{constructor(d){this._updateZoomButtons=()=>{const e=this._map.getZoom(),r=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,r)=>{const l=this._map._getUIString(`NavigationControl.${r}`);e.title=l,e.setAttribute("aria-label",l)},this.options=h.e({},qo,d),this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),ce.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),ce.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=ce.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ce.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(d,e){const r=ce.create("button",d,this._container);return r.type="button",r.addEventListener("click",e),r}},M.Popup=class extends h.E{constructor(d){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:void 0)},this.remove=()=>(this._content&&ce.remove(this._content),this._container&&(ce.remove(this._container),delete this._container),this._closeButton&&this._closeButton.removeEventListener("click",this._onClose),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var r;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ce.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ce.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ya(this._lngLat,this._flatPos,this._map.transform):(r=this._lngLat)===null||r===void 0?void 0:r.wrap(),this._trackPointer&&!e)return;const l=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let u=this.options.anchor;const p=mo(this.options.offset);if(!u){const x=this._container.offsetWidth,w=this._container.offsetHeight;let P;P=l.y+p.bottom.y<w?["top"]:l.y>this._map.transform.height-w?["bottom"]:[],l.x<x/2?P.push("left"):l.x>this._map.transform.width-x/2&&P.push("right"),u=P.length===0?"bottom":P.join("-")}let _=l.add(p[u]);this.options.subpixelPositioning||(_=_.round()),ce.setTransform(this._container,`${eo[u]} translate(${_.x}px,${_.y}px)`),Rs(this._container,u,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(fl),d)}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(d){return this._lngLat=h.Q.convert(d),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(document.createTextNode(d))}setHTML(d){const e=document.createDocumentFragment(),r=document.createElement("body");let l;for(r.innerHTML=d;l=r.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var d;return(d=this._container)===null||d===void 0?void 0:d.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ce.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(d),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(d){return this._container&&this._container.classList.add(d),this}removeClassName(d){return this._container&&this._container.classList.remove(d),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){if(this._container)return this._container.classList.toggle(d)}setSubpixelPositioning(d){this.options.subpixelPositioning=d}_createCloseButton(){this.options.closeButton&&(this._closeButton=ce.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(fo);d&&d.focus()}},M.RasterDEMTileSource=tn,M.RasterTileSource=Tn,M.ScaleControl=class{constructor(d){this._onMove=()=>{Ao(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ao(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},bi),d)}getDefaultPosition(){return"bottom-left"}onAdd(d){return this._map=d,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ce.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},M.ScrollZoomHandler=Ri,M.Style=Ks,M.TerrainControl=class{constructor(d){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=d}onAdd(d){return this._map=d,this._container=ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ce.create("button","maplibregl-ctrl-terrain",this._container),ce.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ce.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},M.TwoFingersTouchPitchHandler=wa,M.TwoFingersTouchRotateHandler=oh,M.TwoFingersTouchZoomHandler=hu,M.TwoFingersTouchZoomRotateHandler=hl,M.VectorTileSource=$i,M.VideoSource=rn,M.addSourceType=(d,e)=>h._(void 0,void 0,void 0,function*(){if(ao(d))throw new Error(`A source type called "${d}" already exists.`);((r,l)=>{Ui[r]=l})(d,e)}),M.clearPrewarmedResources=function(){const d=ut;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(me),ut=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},M.createTileMesh=Ws,M.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},M.getRTLTextPluginStatus=function(){return ni().getRTLTextPluginStatus()},M.getVersion=function(){return Ds},M.getWorkerCount=function(){return Ae.workerCount},M.getWorkerUrl=function(){return h.a.WORKER_URL},M.importScriptInWorkers=function(d){return mt().broadcast("IS",d)},M.prewarm=function(){st().acquire(me)},M.setMaxParallelImageRequests=function(d){h.a.MAX_PARALLEL_IMAGE_REQUESTS=d},M.setRTLTextPlugin=function(d,e){return ni().setRTLTextPlugin(d,e)},M.setWorkerCount=function(d){Ae.workerCount=d},M.setWorkerUrl=function(d){h.a.WORKER_URL=d}});var ne=z;return ne})}(Pp)),Pp.exports}var _w=gw();const Af=Ad(_w),yw={0:[0,126,1,0],1:[0,119,13],2:[0,113,26],3:[0,107,39],4:[0,101,51],5:[0,95,64],6:[0,88,77],7:[0,82,89],8:[0,76,102],9:[0,70,115],10:[0,64,128],11:[0,64,128],12:[1,65,129],13:[1,66,129],14:[2,67,130],15:[2,68,131],16:[3,69,131],17:[3,70,132],18:[4,71,133],19:[5,72,133],20:[5,73,134],21:[6,74,135],22:[6,75,135],23:[7,76,136],24:[7,77,137],25:[8,78,137],26:[8,79,138],27:[9,80,139],28:[10,81,139],29:[10,82,140],30:[11,83,141],31:[11,84,141],32:[12,85,142],33:[12,86,143],34:[13,87,143],35:[13,88,144],36:[14,89,145],37:[15,90,145],38:[15,91,146],39:[16,92,147],40:[16,93,147],41:[17,94,148],42:[17,95,149],43:[18,96,149],44:[18,97,150],45:[19,98,151],46:[20,99,151],47:[20,100,152],48:[21,101,153],49:[21,102,153],50:[22,103,154],51:[22,104,155],52:[23,105,155],53:[23,106,156],54:[24,107,157],55:[25,108,157],56:[25,109,158],57:[26,110,159],58:[26,111,159],59:[27,112,160],60:[27,113,161],61:[28,114,161],62:[28,115,162],63:[29,116,163],64:[30,117,163],65:[30,118,164],66:[31,119,165],67:[31,120,165],68:[32,121,166],69:[32,122,167],70:[33,123,167],71:[33,124,168],72:[34,125,169],73:[35,126,169],74:[35,127,170],75:[36,128,171],76:[36,129,171],77:[37,130,172],78:[37,131,173],79:[38,132,173],80:[38,133,174],81:[39,134,175],82:[40,135,175],83:[40,136,176],84:[41,137,177],85:[41,138,177],86:[42,139,178],87:[42,140,179],88:[43,141,179],89:[43,142,180],90:[44,143,181],91:[45,144,181],92:[45,145,182],93:[46,146,183],94:[46,147,183],95:[47,148,184],96:[47,149,185],97:[48,150,185],98:[48,151,186],99:[49,152,187],100:[50,152,187],101:[51,153,188],102:[52,154,188],103:[53,155,189],104:[54,156,189],105:[55,157,190],106:[56,158,190],107:[57,159,191],108:[58,160,191],109:[59,161,192],110:[60,162,192],111:[61,163,193],112:[62,164,193],113:[63,165,194],114:[64,166,194],115:[65,167,195],116:[66,168,195],117:[67,169,196],118:[68,170,196],119:[69,171,197],120:[70,172,197],121:[71,173,198],122:[72,174,198],123:[73,175,199],124:[74,176,199],125:[75,177,200],126:[76,178,200],127:[77,179,201],128:[78,180,201],129:[79,181,202],130:[80,182,202],131:[81,183,203],132:[82,184,203],133:[83,185,204],134:[84,186,204],135:[85,187,205],136:[86,188,205],137:[87,189,206],138:[88,190,206],139:[89,191,207],140:[90,192,207],141:[91,193,208],142:[92,194,208],143:[93,195,209],144:[94,196,209],145:[95,197,210],146:[96,198,210],147:[97,199,211],148:[98,200,211],149:[99,201,212],150:[100,202,212],151:[101,203,213],152:[102,204,213],153:[103,205,214],154:[104,206,214],155:[105,207,215],156:[106,208,215],157:[107,209,216],158:[108,210,216],159:[109,211,217],160:[110,212,217],161:[111,213,218],162:[112,214,218],163:[113,215,219],164:[114,216,219],165:[115,217,220],166:[116,218,220],167:[117,219,221],168:[118,220,221],169:[119,221,222],170:[120,222,222],171:[121,223,223],172:[122,224,223],173:[123,225,224],174:[124,226,224],175:[125,227,225],176:[126,228,225],177:[127,229,226],178:[128,230,226],179:[129,231,227],180:[130,232,227],181:[131,233,228],182:[132,234,228],183:[133,235,229],184:[134,236,229],185:[135,237,230],186:[136,238,230],187:[137,239,231],188:[138,240,231],189:[139,241,232],190:[140,242,232],191:[141,243,233],192:[142,244,233],193:[143,245,234],194:[144,246,234],195:[145,247,235],196:[146,248,235],197:[147,249,236],198:[148,250,236],199:[149,251,237],200:[150,252,237],201:[151,253,238],202:[152,254,238],203:[153,255,239],204:[154,255,239],205:[155,255,240],206:[156,255,240],207:[157,255,241],208:[158,255,241],209:[159,255,242],210:[160,255,242],211:[161,255,243],212:[162,255,243],213:[163,255,244],214:[164,255,244],215:[165,255,245],216:[166,255,245],217:[167,255,246],218:[168,255,246],219:[169,255,247],220:[170,255,247],221:[171,255,248],222:[172,255,248],223:[173,255,249],224:[174,255,249],225:[175,255,250],226:[176,255,250],227:[177,255,251],228:[178,255,251],229:[179,255,252],230:[180,255,252],231:[181,255,253],232:[182,255,253],233:[183,255,254],234:[184,255,254],235:[185,255,255],236:[186,255,255],237:[187,255,255],238:[188,255,255],239:[189,255,255],240:[190,255,255],241:[191,255,255],242:[192,255,255],243:[193,255,255],244:[194,255,255],245:[195,255,255],246:[196,255,255],247:[197,255,255],248:[198,255,255],249:[199,255,255],250:[200,255,255],251:[201,255,255],252:[202,255,255],253:[203,255,255],254:[204,255,255],255:[255,255,255]};function vw(E){const{COGUrl:L,opacity:z}=E,[V,W]=Du.useState(!1);Du.useRef();const ne=encodeURIComponent(JSON.stringify(yw));return Du.useEffect(()=>{if(L&&!V){const M=new Af.Map({container:"App",zoom:3,center:[-90,55],style:{version:8,projection:{type:"globe"},sources:{satellite:{url:"https://api.maptiler.com/tiles/satellite-v2/tiles.json?key=get_your_own_OpIi9ZULNHzrESv6T2vL",type:"raster"},cog:{type:"raster",tiles:[`https://tiler.biodiversite-quebec.ca/cog/tiles/{z}/{x}/{y}?url=${L}&rescale=0,10&colormap=${ne}&resampling=cubic`],tileSize:256},terrain:{type:"raster-dem",tiles:["https://tiler.biodiversite-quebec.ca/cog/tiles/{z}/{x}/{y}?url=https://object-arbutus.cloud.computecanada.ca/bq-io/io/earthenv/topography/elevation_1KMmn_GMTEDmn.tif&rescale=0,2013&bidx=1&expression=b1"],tileSize:256},background:{type:"raster",tiles:["https://01.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png"],tileSize:256}},layers:[{id:"back",type:"raster",source:"background"},{id:"cog",type:"raster",source:"cog",paint:{"raster-opacity":z/100}}],sky:{"atmosphere-blend":["interpolate",["linear"],["zoom"],0,1,5,1,7,0]},light:{anchor:"viewport",position:[1.5,90,40],intensity:.25,color:"#555"}}});return M.addControl(new Af.GlobeControl),M.addControl(new Af.NavigationControl({showZoom:!0,showCompass:!1})),W(M),()=>{M.remove()}}},[]),Du.useEffect(()=>(V&&L&&(V.getSource("cog").setTiles([`https://tiler.biodiversite-quebec.ca/cog/tiles/{z}/{x}/{y}?url=${L}&rescale=0,10&colormap=${ne}&resampling=cubic`]),V.setPaintProperty("cog","raster-opacity",z/100),V.triggerRepaint()),()=>{}),[L,z]),ei.jsx("div",{id:"App",className:"App",style:{width:"100vw",height:"100vh",zIndex:"0",background:"url('/inat_canada_heatmap/night-sky.png')"}})}const{useEffect:Sw,useRef:xw}=ti;function bw(){const[E,L]=ti.useState("All"),[z,V]=ti.useState("https://object-arbutus.cloud.computecanada.ca/bq-io/io/inat_canada_heatmaps/All_density_inat.tif");xw();const W=ne=>{L(ne),V(`https://object-arbutus.cloud.computecanada.ca/bq-io/io/inat_canada_heatmaps/${E}_density_inat.tif`)};return ei.jsxs(ei.Fragment,{children:[ei.jsx(vw,{COGUrl:z,opacity:100}),ei.jsx(Jm,{onSelect:W,style:{backgroundColor:"#111111",top:"auto"},children:ei.jsxs(Jm.Nav,{defaultSelected:"all",children:[ei.jsx(Bc.NavItem,{eventKey:"All","data-tip":"All taxa",style:{marginTop:"20px",cursor:"pointer"},children:ei.jsx(ev,{style:{fontSize:"2em",marginLeft:"15px",marginRight:"10px"}})}),ei.jsx(Bc.NavItem,{eventKey:"Plantae","data-tip":"Plants",style:{marginTop:"20px"},children:ei.jsx(Xy,{style:{fontSize:"2em",marginLeft:"15px"}})}),ei.jsx(Bc.NavItem,{eventKey:"Aves","data-tip":"Birds",style:{marginTop:"20px"},children:ei.jsx(Yy,{style:{fontSize:"2em",marginLeft:"15px"}})}),ei.jsx(Bc.NavItem,{eventKey:"Mammalia","data-tip":"Mammals",style:{marginTop:"20px"},children:ei.jsx(Jy,{style:{fontSize:"2em",marginLeft:"15px"}})}),ei.jsx(Bc.NavItem,{eventKey:"Insecta","data-tip":"Insects",style:{marginTop:"20px"},children:ei.jsx(Qy,{style:{fontSize:"2em",marginLeft:"15px"}})}),ei.jsx(Bc.NavItem,{eventKey:"Amphibia","data-tip":"Amphibians",style:{marginTop:"20px"},children:ei.jsx(Ky,{style:{fontSize:"2em",marginLeft:"15px"}})})]})}),ei.jsx(fw,{effect:"solid",type:"dark",scrollHide:"true",event:"mousemove",eventOff:"mouseleave",delayHide:1e3})]})}const ww=document.getElementById("root"),Tw=Py.createRoot(ww);Tw.render(ei.jsx(bw,{}));
